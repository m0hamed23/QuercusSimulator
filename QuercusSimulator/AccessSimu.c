typedef unsigned char   undefined;

typedef unsigned char    bool;
typedef unsigned char    byte;
typedef unsigned int    dword;
float10
typedef unsigned long long    GUID;
typedef pointer32 ImageBaseOffset32;

typedef long long    longlong;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long long    undefined8;
typedef unsigned short    ushort;
typedef unsigned short    wchar16;
typedef short    wchar_t;
typedef unsigned short    word;
typedef struct _s_HandlerType _s_HandlerType, *P_s_HandlerType;

typedef struct _s_HandlerType HandlerType;

typedef struct TypeDescriptor TypeDescriptor, *PTypeDescriptor;

typedef int ptrdiff_t;

struct TypeDescriptor {
    void *pVFTable;
    void *spare;
    char name[0];
};

struct _s_HandlerType {
    uint adjectives;
    struct TypeDescriptor *pType;
    ptrdiff_t dispCatchObj;
    void *addressOfHandler;
};

typedef struct _s_UnwindMapEntry _s_UnwindMapEntry, *P_s_UnwindMapEntry;

typedef struct _s_UnwindMapEntry UnwindMapEntry;

typedef int __ehstate_t;

struct _s_UnwindMapEntry {
    __ehstate_t toState;
    void (*action)(void);
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion;

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct {
    dword OffsetToDirectory;
    dword DataIsDirectory;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion {
    dword OffsetToData;
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;
};

typedef struct _s_TryBlockMapEntry _s_TryBlockMapEntry, *P_s_TryBlockMapEntry;

struct _s_TryBlockMapEntry {
    __ehstate_t tryLow;
    __ehstate_t tryHigh;
    __ehstate_t catchHigh;
    int nCatches;
    HandlerType *pHandlerArray;
};

typedef struct _s__RTTIClassHierarchyDescriptor _s__RTTIClassHierarchyDescriptor, *P_s__RTTIClassHierarchyDescriptor;

typedef struct _s__RTTIBaseClassDescriptor _s__RTTIBaseClassDescriptor, *P_s__RTTIBaseClassDescriptor;

typedef struct _s__RTTIBaseClassDescriptor RTTIBaseClassDescriptor;

typedef struct PMD PMD, *PPMD;

typedef struct _s__RTTIClassHierarchyDescriptor RTTIClassHierarchyDescriptor;

struct PMD {
    ptrdiff_t mdisp;
    ptrdiff_t pdisp;
    ptrdiff_t vdisp;
};

struct _s__RTTIBaseClassDescriptor {
    struct TypeDescriptor *pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    dword numContainedBases; // count of extended classes in BaseClassArray (RTTI 2)
    struct PMD where; // member displacement structure
    dword attributes; // bit flags
    RTTIClassHierarchyDescriptor *pClassHierarchyDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3) for class
};

struct _s__RTTIClassHierarchyDescriptor {
    dword signature;
    dword attributes; // bit flags
    dword numBaseClasses; // number of base classes (i.e. rtti1Count)
    RTTIBaseClassDescriptor **pBaseClassArray; // ref to BaseClassArray (RTTI 2)
};

typedef struct _s_TryBlockMapEntry TryBlockMapEntry;

typedef struct _s__RTTICompleteObjectLocator _s__RTTICompleteObjectLocator, *P_s__RTTICompleteObjectLocator;

struct _s__RTTICompleteObjectLocator {
    dword signature;
    dword offset; // offset of vbtable within class
    dword cdOffset; // constructor displacement offset
    struct TypeDescriptor *pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    RTTIClassHierarchyDescriptor *pClassDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3)
};

typedef struct _s_ESTypeList _s_ESTypeList, *P_s_ESTypeList;

struct _s_ESTypeList {
    int nCount;
    HandlerType *pTypeArray;
};

typedef struct _s_ESTypeList ESTypeList;

typedef struct CLIENT_ID CLIENT_ID, *PCLIENT_ID;

struct CLIENT_ID {
    void *UniqueProcess;
    void *UniqueThread;
};

typedef struct _s_FuncInfo _s_FuncInfo, *P_s_FuncInfo;

typedef struct _s_FuncInfo FuncInfo;

struct _s_FuncInfo {
    uint magicNumber_and_bbtFlags;
    __ehstate_t maxState;
    UnwindMapEntry *pUnwindMap;
    uint nTryBlocks;
    TryBlockMapEntry *pTryBlockMap;
    uint nIPMapEntries;
    void *pIPToStateMap;
    ESTypeList *pESTypeList;
    int EHFlags;
};

typedef struct _s__RTTICompleteObjectLocator RTTICompleteObjectLocator;

typedef struct _cpinfoexA _cpinfoexA, *P_cpinfoexA;

typedef uint UINT;

typedef uchar BYTE;

typedef wchar_t WCHAR;

typedef char CHAR;

struct _cpinfoexA {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
    WCHAR UnicodeDefaultChar;
    UINT CodePage;
    CHAR CodePageName[260];
};

typedef struct _cpinfoexA *LPCPINFOEXA;

typedef struct _SECURITY_ATTRIBUTES _SECURITY_ATTRIBUTES, *P_SECURITY_ATTRIBUTES;

typedef ulong DWORD;

typedef void *LPVOID;

typedef int BOOL;

struct _SECURITY_ATTRIBUTES {
    DWORD nLength;
    LPVOID lpSecurityDescriptor;
    BOOL bInheritHandle;
};

typedef struct _WIN32_FIND_DATAA _WIN32_FIND_DATAA, *P_WIN32_FIND_DATAA;

typedef struct _WIN32_FIND_DATAA *LPWIN32_FIND_DATAA;

typedef struct _FILETIME _FILETIME, *P_FILETIME;

typedef struct _FILETIME FILETIME;

struct _FILETIME {
    DWORD dwLowDateTime;
    DWORD dwHighDateTime;
};

struct _WIN32_FIND_DATAA {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    CHAR cFileName[260];
    CHAR cAlternateFileName[14];
};

typedef enum _GET_FILEEX_INFO_LEVELS {
    GetFileExInfoStandard=0,
    GetFileExMaxInfoLevel=1
} _GET_FILEEX_INFO_LEVELS;

typedef struct _SYSTEMTIME _SYSTEMTIME, *P_SYSTEMTIME;

typedef ushort WORD;

struct _SYSTEMTIME {
    WORD wYear;
    WORD wMonth;
    WORD wDayOfWeek;
    WORD wDay;
    WORD wHour;
    WORD wMinute;
    WORD wSecond;
    WORD wMilliseconds;
};

typedef enum _GET_FILEEX_INFO_LEVELS GET_FILEEX_INFO_LEVELS;

typedef struct _RTL_CRITICAL_SECTION _RTL_CRITICAL_SECTION, *P_RTL_CRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION *PRTL_CRITICAL_SECTION;

typedef PRTL_CRITICAL_SECTION LPCRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION_DEBUG _RTL_CRITICAL_SECTION_DEBUG, *P_RTL_CRITICAL_SECTION_DEBUG;

typedef struct _RTL_CRITICAL_SECTION_DEBUG *PRTL_CRITICAL_SECTION_DEBUG;

typedef long LONG;

typedef void *HANDLE;

typedef ulong ULONG_PTR;

typedef struct _LIST_ENTRY _LIST_ENTRY, *P_LIST_ENTRY;

typedef struct _LIST_ENTRY LIST_ENTRY;

struct _RTL_CRITICAL_SECTION {
    PRTL_CRITICAL_SECTION_DEBUG DebugInfo;
    LONG LockCount;
    LONG RecursionCount;
    HANDLE OwningThread;
    HANDLE LockSemaphore;
    ULONG_PTR SpinCount;
};

struct _LIST_ENTRY {
    struct _LIST_ENTRY *Flink;
    struct _LIST_ENTRY *Blink;
};

struct _RTL_CRITICAL_SECTION_DEBUG {
    WORD Type;
    WORD CreatorBackTraceIndex;
    struct _RTL_CRITICAL_SECTION *CriticalSection;
    LIST_ENTRY ProcessLocksList;
    DWORD EntryCount;
    DWORD ContentionCount;
    DWORD Flags;
    WORD CreatorBackTraceIndexHigh;
    WORD SpareWORD;
};

typedef DWORD (*PTHREAD_START_ROUTINE)(LPVOID);

typedef PTHREAD_START_ROUTINE LPTHREAD_START_ROUTINE;

typedef struct _EXCEPTION_POINTERS _EXCEPTION_POINTERS, *P_EXCEPTION_POINTERS;

typedef LONG (*PTOP_LEVEL_EXCEPTION_FILTER)(struct _EXCEPTION_POINTERS *);

typedef struct _EXCEPTION_RECORD _EXCEPTION_RECORD, *P_EXCEPTION_RECORD;

typedef struct _EXCEPTION_RECORD EXCEPTION_RECORD;

typedef EXCEPTION_RECORD *PEXCEPTION_RECORD;

typedef struct _CONTEXT _CONTEXT, *P_CONTEXT;

typedef struct _CONTEXT CONTEXT;

typedef CONTEXT *PCONTEXT;

typedef void *PVOID;

typedef struct _FLOATING_SAVE_AREA _FLOATING_SAVE_AREA, *P_FLOATING_SAVE_AREA;

typedef struct _FLOATING_SAVE_AREA FLOATING_SAVE_AREA;

struct _FLOATING_SAVE_AREA {
    DWORD ControlWord;
    DWORD StatusWord;
    DWORD TagWord;
    DWORD ErrorOffset;
    DWORD ErrorSelector;
    DWORD DataOffset;
    DWORD DataSelector;
    BYTE RegisterArea[80];
    DWORD Cr0NpxState;
};

struct _CONTEXT {
    DWORD ContextFlags;
    DWORD Dr0;
    DWORD Dr1;
    DWORD Dr2;
    DWORD Dr3;
    DWORD Dr6;
    DWORD Dr7;
    FLOATING_SAVE_AREA FloatSave;
    DWORD SegGs;
    DWORD SegFs;
    DWORD SegEs;
    DWORD SegDs;
    DWORD Edi;
    DWORD Esi;
    DWORD Ebx;
    DWORD Edx;
    DWORD Ecx;
    DWORD Eax;
    DWORD Ebp;
    DWORD Eip;
    DWORD SegCs;
    DWORD EFlags;
    DWORD Esp;
    DWORD SegSs;
    BYTE ExtendedRegisters[512];
};

struct _EXCEPTION_RECORD {
    DWORD ExceptionCode;
    DWORD ExceptionFlags;
    struct _EXCEPTION_RECORD *ExceptionRecord;
    PVOID ExceptionAddress;
    DWORD NumberParameters;
    ULONG_PTR ExceptionInformation[15];
};

struct _EXCEPTION_POINTERS {
    PEXCEPTION_RECORD ExceptionRecord;
    PCONTEXT ContextRecord;
};

typedef struct _SECURITY_ATTRIBUTES *LPSECURITY_ATTRIBUTES;

typedef struct _SYSTEMTIME *LPSYSTEMTIME;

typedef PTOP_LEVEL_EXCEPTION_FILTER LPTOP_LEVEL_EXCEPTION_FILTER;

typedef CHAR *LPCSTR;

typedef union _LARGE_INTEGER _LARGE_INTEGER, *P_LARGE_INTEGER;

typedef struct _struct_19 _struct_19, *P_struct_19;

typedef struct _struct_20 _struct_20, *P_struct_20;

typedef double LONGLONG;

struct _struct_20 {
    DWORD LowPart;
    LONG HighPart;
};

struct _struct_19 {
    DWORD LowPart;
    LONG HighPart;
};

union _LARGE_INTEGER {
    struct _struct_19 s;
    struct _struct_20 u;
    LONGLONG QuadPart;
};

typedef union _LARGE_INTEGER LARGE_INTEGER;

typedef struct _IMAGE_SECTION_HEADER _IMAGE_SECTION_HEADER, *P_IMAGE_SECTION_HEADER;

typedef union _union_226 _union_226, *P_union_226;

union _union_226 {
    DWORD PhysicalAddress;
    DWORD VirtualSize;
};

struct _IMAGE_SECTION_HEADER {
    BYTE Name[8];
    union _union_226 Misc;
    DWORD VirtualAddress;
    DWORD SizeOfRawData;
    DWORD PointerToRawData;
    DWORD PointerToRelocations;
    DWORD PointerToLinenumbers;
    WORD NumberOfRelocations;
    WORD NumberOfLinenumbers;
    DWORD Characteristics;
};

typedef CHAR *LPSTR;

typedef WCHAR *LPWSTR;

typedef struct _IMAGE_SECTION_HEADER *PIMAGE_SECTION_HEADER;

typedef WCHAR *LPCWSTR;

typedef struct IMAGE_DOS_HEADER IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;

struct IMAGE_DOS_HEADER {
    char e_magic[2]; // Magic number
    word e_cblp; // Bytes of last page
    word e_cp; // Pages in file
    word e_crlc; // Relocations
    word e_cparhdr; // Size of header in paragraphs
    word e_minalloc; // Minimum extra paragraphs needed
    word e_maxalloc; // Maximum extra paragraphs needed
    word e_ss; // Initial (relative) SS value
    word e_sp; // Initial SP value
    word e_csum; // Checksum
    word e_ip; // Initial IP value
    word e_cs; // Initial (relative) CS value
    word e_lfarlc; // File address of relocation table
    word e_ovno; // Overlay number
    word e_res[4][4]; // Reserved words
    word e_oemid; // OEM identifier (for e_oeminfo)
    word e_oeminfo; // OEM information; e_oemid specific
    word e_res2[10][10]; // Reserved words
    dword e_lfanew; // File address of new exe header
    byte e_program[64]; // Actual DOS program
};

typedef struct tm tm, *Ptm;

struct tm {
    int tm_sec;
    int tm_min;
    int tm_hour;
    int tm_mday;
    int tm_mon;
    int tm_year;
    int tm_wday;
    int tm_yday;
    int tm_isdst;
};

typedef uint UINT_PTR;

typedef ULONG_PTR DWORD_PTR;

typedef ULONG_PTR SIZE_T;

typedef struct DotNetPdbInfo DotNetPdbInfo, *PDotNetPdbInfo;

struct DotNetPdbInfo {
    char signature[4];
    GUID guid;
    dword age;
    char pdbpath[60];
};

typedef struct _FILETIME *LPFILETIME;

typedef int (*FARPROC)(void);

typedef DWORD *LPDWORD;

typedef struct HINSTANCE__ HINSTANCE__, *PHINSTANCE__;

struct HINSTANCE__ {
    int unused;
};

typedef BOOL *LPBOOL;

typedef BYTE *PBYTE;

typedef struct HINSTANCE__ *HINSTANCE;

typedef HINSTANCE HMODULE;

typedef long *LPLONG;

typedef struct Var Var, *PVar;

struct Var {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct {
    dword NameOffset;
    dword NameIsString;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_52 IMAGE_RESOURCE_DIR_STRING_U_52, *PIMAGE_RESOURCE_DIR_STRING_U_52;

struct IMAGE_RESOURCE_DIR_STRING_U_52 {
    word Length;
    wchar16 NameString[26];
};

typedef struct IMAGE_DEBUG_DIRECTORY IMAGE_DEBUG_DIRECTORY, *PIMAGE_DEBUG_DIRECTORY;

struct IMAGE_DEBUG_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Type;
    dword SizeOfData;
    dword AddressOfRawData;
    dword PointerToRawData;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_14 IMAGE_RESOURCE_DIR_STRING_U_14, *PIMAGE_RESOURCE_DIR_STRING_U_14;

struct IMAGE_RESOURCE_DIR_STRING_U_14 {
    word Length;
    wchar16 NameString[7];
};

typedef struct StringTable StringTable, *PStringTable;

struct StringTable {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_SECTION_HEADER IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;

typedef union Misc Misc, *PMisc;

typedef enum SectionFlags {
    IMAGE_SCN_TYPE_NO_PAD=8,
    IMAGE_SCN_RESERVED_0001=16,
    IMAGE_SCN_CNT_CODE=32,
    IMAGE_SCN_CNT_INITIALIZED_DATA=64,
    IMAGE_SCN_CNT_UNINITIALIZED_DATA=128,
    IMAGE_SCN_LNK_OTHER=256,
    IMAGE_SCN_LNK_INFO=512,
    IMAGE_SCN_RESERVED_0040=1024,
    IMAGE_SCN_LNK_REMOVE=2048,
    IMAGE_SCN_LNK_COMDAT=4096,
    IMAGE_SCN_GPREL=32768,
    IMAGE_SCN_MEM_16BIT=131072,
    IMAGE_SCN_MEM_PURGEABLE=131072,
    IMAGE_SCN_MEM_LOCKED=262144,
    IMAGE_SCN_MEM_PRELOAD=524288,
    IMAGE_SCN_ALIGN_1BYTES=1048576,
    IMAGE_SCN_ALIGN_2BYTES=2097152,
    IMAGE_SCN_ALIGN_4BYTES=3145728,
    IMAGE_SCN_ALIGN_8BYTES=4194304,
    IMAGE_SCN_ALIGN_16BYTES=5242880,
    IMAGE_SCN_ALIGN_32BYTES=6291456,
    IMAGE_SCN_ALIGN_64BYTES=7340032,
    IMAGE_SCN_ALIGN_128BYTES=8388608,
    IMAGE_SCN_ALIGN_256BYTES=9437184,
    IMAGE_SCN_ALIGN_512BYTES=10485760,
    IMAGE_SCN_ALIGN_1024BYTES=11534336,
    IMAGE_SCN_ALIGN_2048BYTES=12582912,
    IMAGE_SCN_ALIGN_4096BYTES=13631488,
    IMAGE_SCN_ALIGN_8192BYTES=14680064,
    IMAGE_SCN_LNK_NRELOC_OVFL=16777216,
    IMAGE_SCN_MEM_DISCARDABLE=33554432,
    IMAGE_SCN_MEM_NOT_CACHED=67108864,
    IMAGE_SCN_MEM_NOT_PAGED=134217728,
    IMAGE_SCN_MEM_SHARED=268435456,
    IMAGE_SCN_MEM_EXECUTE=536870912,
    IMAGE_SCN_MEM_READ=1073741824,
    IMAGE_SCN_MEM_WRITE=2147483648
} SectionFlags;

union Misc {
    dword PhysicalAddress;
    dword VirtualSize;
};

struct IMAGE_SECTION_HEADER {
    char Name[8];
    union Misc Misc;
    ImageBaseOffset32 VirtualAddress;
    dword SizeOfRawData;
    dword PointerToRawData;
    dword PointerToRelocations;
    dword PointerToLinenumbers;
    word NumberOfRelocations;
    word NumberOfLinenumbers;
    enum SectionFlags Characteristics;
};

typedef struct IMAGE_DATA_DIRECTORY IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;

struct IMAGE_DATA_DIRECTORY {
    ImageBaseOffset32 VirtualAddress;
    dword Size;
};

typedef struct IMAGE_RESOURCE_DATA_ENTRY IMAGE_RESOURCE_DATA_ENTRY, *PIMAGE_RESOURCE_DATA_ENTRY;

struct IMAGE_RESOURCE_DATA_ENTRY {
    dword OffsetToData;
    dword Size;
    dword CodePage;
    dword Reserved;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_2 IMAGE_RESOURCE_DIR_STRING_U_2, *PIMAGE_RESOURCE_DIR_STRING_U_2;

struct IMAGE_RESOURCE_DIR_STRING_U_2 {
    word Length;
    wchar16 NameString[1];
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_40 IMAGE_RESOURCE_DIR_STRING_U_40, *PIMAGE_RESOURCE_DIR_STRING_U_40;

struct IMAGE_RESOURCE_DIR_STRING_U_40 {
    word Length;
    wchar16 NameString[20];
};

typedef struct IMAGE_RESOURCE_DIRECTORY IMAGE_RESOURCE_DIRECTORY, *PIMAGE_RESOURCE_DIRECTORY;

struct IMAGE_RESOURCE_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    word NumberOfNamedEntries;
    word NumberOfIdEntries;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_42 IMAGE_RESOURCE_DIR_STRING_U_42, *PIMAGE_RESOURCE_DIR_STRING_U_42;

struct IMAGE_RESOURCE_DIR_STRING_U_42 {
    word Length;
    wchar16 NameString[21];
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_48 IMAGE_RESOURCE_DIR_STRING_U_48, *PIMAGE_RESOURCE_DIR_STRING_U_48;

struct IMAGE_RESOURCE_DIR_STRING_U_48 {
    word Length;
    wchar16 NameString[24];
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion;

union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion {
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;
    dword Name;
    word Id;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_46 IMAGE_RESOURCE_DIR_STRING_U_46, *PIMAGE_RESOURCE_DIR_STRING_U_46;

struct IMAGE_RESOURCE_DIR_STRING_U_46 {
    word Length;
    wchar16 NameString[23];
};

typedef struct IMAGE_OPTIONAL_HEADER32 IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;

struct IMAGE_OPTIONAL_HEADER32 {
    word Magic;
    byte MajorLinkerVersion;
    byte MinorLinkerVersion;
    dword SizeOfCode;
    dword SizeOfInitializedData;
    dword SizeOfUninitializedData;
    ImageBaseOffset32 AddressOfEntryPoint;
    ImageBaseOffset32 BaseOfCode;
    ImageBaseOffset32 BaseOfData;
    pointer32 ImageBase;
    dword SectionAlignment;
    dword FileAlignment;
    word MajorOperatingSystemVersion;
    word MinorOperatingSystemVersion;
    word MajorImageVersion;
    word MinorImageVersion;
    word MajorSubsystemVersion;
    word MinorSubsystemVersion;
    dword Win32VersionValue;
    dword SizeOfImage;
    dword SizeOfHeaders;
    dword CheckSum;
    word Subsystem;
    word DllCharacteristics;
    dword SizeOfStackReserve;
    dword SizeOfStackCommit;
    dword SizeOfHeapReserve;
    dword SizeOfHeapCommit;
    dword LoaderFlags;
    dword NumberOfRvaAndSizes;
    struct IMAGE_DATA_DIRECTORY DataDirectory[16];
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_30 IMAGE_RESOURCE_DIR_STRING_U_30, *PIMAGE_RESOURCE_DIR_STRING_U_30;

struct IMAGE_RESOURCE_DIR_STRING_U_30 {
    word Length;
    wchar16 NameString[15];
};

typedef struct IMAGE_FILE_HEADER IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;

struct IMAGE_FILE_HEADER {
    word Machine; // 332
    word NumberOfSections;
    dword TimeDateStamp;
    dword PointerToSymbolTable;
    dword NumberOfSymbols;
    word SizeOfOptionalHeader;
    word Characteristics;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_36 IMAGE_RESOURCE_DIR_STRING_U_36, *PIMAGE_RESOURCE_DIR_STRING_U_36;

struct IMAGE_RESOURCE_DIR_STRING_U_36 {
    word Length;
    wchar16 NameString[18];
};

typedef struct IMAGE_NT_HEADERS32 IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;

struct IMAGE_NT_HEADERS32 {
    char Signature[4];
    struct IMAGE_FILE_HEADER FileHeader;
    struct IMAGE_OPTIONAL_HEADER32 OptionalHeader;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_38 IMAGE_RESOURCE_DIR_STRING_U_38, *PIMAGE_RESOURCE_DIR_STRING_U_38;

struct IMAGE_RESOURCE_DIR_STRING_U_38 {
    word Length;
    wchar16 NameString[19];
};

typedef struct StringFileInfo StringFileInfo, *PStringFileInfo;

struct StringFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_34 IMAGE_RESOURCE_DIR_STRING_U_34, *PIMAGE_RESOURCE_DIR_STRING_U_34;

struct IMAGE_RESOURCE_DIR_STRING_U_34 {
    word Length;
    wchar16 NameString[17];
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY;

union IMAGE_RESOURCE_DIRECTORY_ENTRY {
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion NameUnion;
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion DirectoryUnion;
};

typedef struct VS_VERSION_INFO VS_VERSION_INFO, *PVS_VERSION_INFO;

struct VS_VERSION_INFO {
    word StructLength;
    word ValueLength;
    word StructType;
    wchar16 Info[16];
    byte Padding[2];
    dword Signature;
    word StructVersion[2];
    word FileVersion[4];
    word ProductVersion[4];
    dword FileFlagsMask[2];
    dword FileFlags;
    dword FileOS;
    dword FileType;
    dword FileSubtype;
    dword FileTimestamp;
};

typedef struct VarFileInfo VarFileInfo, *PVarFileInfo;

struct VarFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_20 IMAGE_RESOURCE_DIR_STRING_U_20, *PIMAGE_RESOURCE_DIR_STRING_U_20;

struct IMAGE_RESOURCE_DIR_STRING_U_20 {
    word Length;
    wchar16 NameString[10];
};

typedef struct StringInfo StringInfo, *PStringInfo;

struct StringInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_26 IMAGE_RESOURCE_DIR_STRING_U_26, *PIMAGE_RESOURCE_DIR_STRING_U_26;

struct IMAGE_RESOURCE_DIR_STRING_U_26 {
    word Length;
    wchar16 NameString[13];
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_28 IMAGE_RESOURCE_DIR_STRING_U_28, *PIMAGE_RESOURCE_DIR_STRING_U_28;

struct IMAGE_RESOURCE_DIR_STRING_U_28 {
    word Length;
    wchar16 NameString[14];
};

typedef struct IMAGE_LOAD_CONFIG_DIRECTORY32 IMAGE_LOAD_CONFIG_DIRECTORY32, *PIMAGE_LOAD_CONFIG_DIRECTORY32;

struct IMAGE_LOAD_CONFIG_DIRECTORY32 {
    dword Size;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword GlobalFlagsClear;
    dword GlobalFlagsSet;
    dword CriticalSectionDefaultTimeout;
    dword DeCommitFreeBlockThreshold;
    dword DeCommitTotalFreeThreshold;
    pointer32 LockPrefixTable;
    dword MaximumAllocationSize;
    dword VirtualMemoryThreshold;
    dword ProcessHeapFlags;
    dword ProcessAffinityMask;
    word CsdVersion;
    word DependentLoadFlags;
    pointer32 EditList;
    pointer32 SecurityCookie;
    pointer32 SEHandlerTable;
    dword SEHandlerCount;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_24 IMAGE_RESOURCE_DIR_STRING_U_24, *PIMAGE_RESOURCE_DIR_STRING_U_24;

struct IMAGE_RESOURCE_DIR_STRING_U_24 {
    word Length;
    wchar16 NameString[12];
};

typedef struct _iobuf _iobuf, *P_iobuf;

struct _iobuf {
    char *_ptr;
    int _cnt;
    char *_base;
    int _flag;
    int _file;
    int _charbuf;
    int _bufsiz;
    char *_tmpfname;
};

typedef struct _iobuf FILE;

typedef char *va_list;

typedef uint uintptr_t;

typedef struct WSAData WSAData, *PWSAData;

typedef struct WSAData WSADATA;

struct WSAData {
    WORD wVersion;
    WORD wHighVersion;
    char szDescription[257];
    char szSystemStatus[129];
    ushort iMaxSockets;
    ushort iMaxUdpDg;
    char *lpVendorInfo;
};

typedef UINT_PTR SOCKET;

typedef ushort u_short;

typedef WSADATA *LPWSADATA;

typedef struct sockaddr sockaddr, *Psockaddr;

struct sockaddr {
    u_short sa_family;
    char sa_data[14];
};

typedef struct fd_set fd_set, *Pfd_set;

typedef uint u_int;

struct fd_set {
    u_int fd_count;
    SOCKET fd_array[64];
};

typedef struct timeval timeval, *Ptimeval;

struct timeval {
    long tv_sec;
    long tv_usec;
};

typedef struct hostent hostent, *Phostent;

struct hostent {
    char *h_name;
    char **h_aliases;
    short h_addrtype;
    short h_length;
    char **h_addr_list;
};

typedef struct type_info type_info, *Ptype_info;

struct type_info { // PlaceHolder Structure
};

typedef int (*_onexit_t)(void);

typedef longlong __time64_t;

typedef uint size_t;

typedef int errno_t;

typedef struct _startupinfo _startupinfo, *P_startupinfo;

struct _startupinfo {
    int newmode;
};




undefined4 * __thiscall FUN_00401000(void *this,byte param_1)

{
  *(undefined ***)this = CCamera::vftable;
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void FUN_00401020(void)

{
  undefined1 unaff_retaddr;
  undefined uVar1;
  
  uVar1 = 0xe8;
  FUN_0041a190("Camera: Terminate() begin",unaff_retaddr);
  FUN_0041a190("Camera: Terminate() end",uVar1);
  return;
}



void ** __fastcall FUN_00401040(void **param_1)

{
  void *pvVar1;
  void **in_EAX;
  
  if (*in_EAX != *param_1) {
    FUN_0041b310();
    memcpy(*param_1,*in_EAX,(size_t)in_EAX[1]);
    pvVar1 = in_EAX[1];
    param_1[1] = pvVar1;
    *(undefined *)((int)pvVar1 + (int)*param_1) = 0;
  }
  return param_1;
}



void FUN_00401080(void)

{
  char cVar1;
  char **in_EAX;
  char *pcVar2;
  char *unaff_ESI;
  
  if (unaff_ESI == (char *)0x0) {
    in_EAX[1] = (char *)0x0;
    if (*in_EAX != (char *)0x0) {
      **in_EAX = '\0';
    }
  }
  else if (unaff_ESI != *in_EAX) {
    pcVar2 = unaff_ESI;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    pcVar2 = pcVar2 + -(int)(unaff_ESI + 1);
    FUN_0041b310();
    memcpy(*in_EAX,unaff_ESI,(size_t)pcVar2);
    in_EAX[1] = pcVar2;
    pcVar2[(int)*in_EAX] = '\0';
    return;
  }
  return;
}



undefined4 * FUN_004010e0(undefined4 *param_1)

{
  void **ppvVar1;
  void **ppvVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004384ec;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  ppvVar1 = (void **)(param_1 + 5);
  *param_1 = CHistoric::vftable;
  *ppvVar1 = (void *)0x0;
  param_1[7] = 0;
  param_1[6] = 0;
  ppvVar2 = (void **)(param_1 + 8);
  local_4 = 0;
  *ppvVar2 = (void *)0x0;
  param_1[10] = 0;
  param_1[9] = 0;
  param_1[0xb] = 0;
  param_1[0xd] = 0;
  param_1[0xc] = 0;
  param_1[0xe] = aCriticalSection::vftable;
  param_1[0xf] = 0xffffffff;
  param_1[0x10] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x11));
  local_4 = CONCAT31(local_4._1_3_,3);
  if ((undefined **)*ppvVar1 != &PTR_0043b324) {
    FUN_0041b310();
    memcpy(*ppvVar1,&PTR_0043b324,0);
    param_1[6] = 0;
    *(undefined *)*ppvVar1 = 0;
  }
  if ((undefined **)*ppvVar2 != &PTR_0043b324) {
    FUN_0041b310();
    memcpy(*ppvVar2,&PTR_0043b324,0);
    param_1[9] = 0;
    *(undefined *)*ppvVar2 = 0;
  }
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_004011d0(void *this,byte param_1)

{
  FUN_004011f0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_004011f0(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  uint local_4;
  
  puStack_8 = &LAB_00437f76;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = CHistoric::vftable;
  local_4 = 1;
  param_1[0xe] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x11));
  if ((void *)param_1[0xb] != (void *)0x0) {
    free((void *)param_1[0xb]);
  }
  local_4 = local_4 & 0xffffff00;
  if ((void *)param_1[8] != (void *)0x0) {
    free((void *)param_1[8]);
  }
  local_4 = 0xffffffff;
  if ((void *)param_1[5] != (void *)0x0) {
    free((void *)param_1[5]);
  }
  ExceptionList = local_c;
  return;
}



void __thiscall
FUN_00401290(void *this,void *param_1,undefined4 param_2,undefined4 param_3,void *param_4)

{
  void **ppvVar1;
  char cVar2;
  bool bVar3;
  uint uVar4;
  undefined4 uVar5;
  char **ppcVar6;
  uint uVar7;
  char **ppcVar8;
  int iVar9;
  int iVar10;
  void **ppvVar11;
  FILE *_File;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  code *pcVar12;
  void *in_stack_fffffa78;
  LPCSTR pCVar13;
  undefined *puVar14;
  void **ppvVar15;
  char *pcVar16;
  char *pcVar17;
  char *pcVar18;
  undefined4 uVar19;
  undefined uVar20;
  undefined auStack_558 [4];
  char *local_554;
  char *local_550;
  undefined4 local_54c;
  undefined4 *puStack_548;
  undefined *puStack_544;
  void **local_540;
  void *local_53c;
  undefined4 local_538;
  int local_534 [3];
  void *apvStack_528 [3];
  undefined4 local_51c;
  undefined4 local_518;
  undefined4 local_514;
  char local_510 [256];
  char acStack_410 [1024];
  uint local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a473;
  local_c = ExceptionList;
  local_10 = DAT_0044a01c ^ (uint)auStack_558;
  uVar4 = DAT_0044a01c ^ (uint)&stack0xfffffa98;
  ExceptionList = &local_c;
  local_51c = 0;
  local_514 = 0;
  local_518 = 0;
  local_540 = (void **)0x0;
  local_538 = 0;
  local_53c = (void *)0x0;
  local_4._0_1_ = 3;
  local_4._1_3_ = 0;
  FUN_0041b630(&param_1,local_534);
  local_4._0_1_ = 4;
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,"Global/DiskHistoricSize");
  local_4._0_1_ = 5;
  uVar5 = FUN_0041bff0(local_534,(char *)&local_554,(long *)((int)this + 0x5c));
  pcVar12 = free_exref;
  local_4._0_1_ = 4;
  if (local_554 != (char *)0x0) {
    free(local_554);
  }
  if ((char)uVar5 == '\0') {
    FUN_0041a1f0("Historic: Missing or wrong configuration parameter (Global/DiskHistoricSize)",
                 (char)uVar4);
LAB_0040136e:
    local_4._0_1_ = 3;
    FUN_00402ab0();
  }
  else {
    local_554 = (char *)0x0;
    local_54c = 0;
    local_550 = (char *)0x0;
    local_4._0_1_ = 6;
    _getcwd(local_510,0x100);
    pcVar18 = local_510;
    ppvVar15 = apvStack_528;
    pcVar16 = "%s\\%s";
    ppcVar6 = (char **)FUN_0041b2a0(ppvVar15,"%s\\%s");
    local_4._0_1_ = 7;
    ppcVar8 = (char **)((int)this + 0x2c);
    uVar5 = extraout_ECX_00;
    if (*ppcVar6 != *(char **)((int)this + 0x2c)) {
      FUN_0041b310();
      pcVar18 = *ppcVar6;
      pcVar16 = *ppcVar8;
      ppvVar15 = (void **)0x401437;
      memcpy(pcVar16,pcVar18,(size_t)ppcVar6[1]);
      pcVar17 = ppcVar6[1];
      *(char **)((int)this + 0x30) = pcVar17;
      (*ppcVar8)[(int)pcVar17] = '\0';
      uVar5 = extraout_ECX_01;
    }
    pcVar12 = free_exref;
    local_4._0_1_ = 6;
    if (apvStack_528[0] != (void *)0x0) {
      pcVar18 = (char *)0x40145f;
      free(apvStack_528[0]);
      uVar5 = extraout_ECX_02;
    }
    uVar19 = 0;
    puStack_548 = (undefined4 *)&stack0xfffffa84;
    puVar14 = &DAT_0043b398;
    pCVar13 = (LPCSTR)0x40147c;
    FUN_0041aa80(uVar5,(char *)0x7fffffff,"*");
    local_4._0_1_ = 8;
    pcVar17 = &DAT_0044d0d5;
    if (*ppcVar8 != (char *)0x0) {
      pcVar17 = *ppcVar8;
    }
    puStack_544 = &stack0xfffffa78;
    FUN_0041aa80(pcVar17,(char *)0x7fffffff,pcVar17);
    local_4._0_1_ = 6;
    puStack_548 = FUN_0041a2d0(in_stack_fffffa78,pCVar13,puVar14,ppvVar15,pcVar16,pcVar18,uVar19);
    if (puStack_548 == (undefined4 *)0x0) {
      pcVar18 = &DAT_0044d0d5;
      if (*ppcVar8 != (char *)0x0) {
        pcVar18 = *ppcVar8;
      }
      FUN_0041a1f0("Historic can\'t open folder \'%s\'",(char)pcVar18);
      goto LAB_0040136e;
    }
    uVar7 = FUN_0041a500(&local_554,(uint *)&puStack_544);
    cVar2 = (char)uVar7;
    pcVar18 = local_554;
    while (uVar20 = (undefined)uVar4, local_554 = pcVar18, cVar2 != '\0') {
      ppcVar8 = (char **)FUN_0041b2a0(apvStack_528,"%s/%s");
      local_4._0_1_ = 9;
      if (*ppcVar8 != pcVar18) {
        FUN_0041b310();
        pcVar18 = local_554;
        memcpy(local_554,*ppcVar8,(size_t)ppcVar8[1]);
        local_550 = ppcVar8[1];
        pcVar18[(int)local_550] = '\0';
      }
      pcVar16 = local_550;
      local_4._0_1_ = 6;
      if (apvStack_528[0] != (void *)0x0) {
        free(apvStack_528[0]);
      }
      puStack_544 = &stack0xfffffa88;
      pcVar17 = (char *)0x0;
      puVar14 = &stack0xfffffa88;
      if (pcVar18 != (char *)0x0) {
        FUN_0041b310();
        memcpy(pcVar17,local_554,(size_t)pcVar16);
        pcVar17[(int)pcVar16] = '\0';
        pcVar18 = local_554;
        puVar14 = puStack_544;
      }
      puStack_544 = puVar14;
      iVar9 = FUN_0041a650(pcVar17);
      if ((0 < iVar9) &&
         ((pcVar16 = strstr(pcVar18,"cache.dat"), pcVar16 == (char *)0x0 ||
          ((int)pcVar16 - (int)pcVar18 == -1)))) {
        if (0xfffff < iVar9) {
          iVar10 = (int)(iVar9 + (iVar9 >> 0x1f & 0xfffffU)) >> 0x14;
          *(int *)((int)this + 4) = *(int *)((int)this + 4) + iVar10;
          iVar9 = iVar9 + iVar10 * -0x100000;
        }
        *(int *)((int)this + 8) = *(int *)((int)this + 8) + iVar9;
        if (0xfffff < *(int *)((int)this + 8)) {
          *(int *)((int)this + 4) = *(int *)((int)this + 4) + 1;
          *(int *)((int)this + 8) = *(int *)((int)this + 8) + -0x100000;
        }
      }
      uVar7 = FUN_0041a500(&local_554,(uint *)&puStack_544);
      pcVar18 = local_554;
      cVar2 = (char)uVar7;
    }
    ppvVar15 = apvStack_528;
    ppvVar11 = (void **)FUN_0041b2a0(ppvVar15,"%s/cache.dat");
    local_4._0_1_ = 10;
    if (*ppvVar11 != (void *)0x0) {
      FUN_0041b310();
      ppvVar1 = local_540;
      ppvVar15 = local_540;
      memcpy(local_540,*ppvVar11,(size_t)ppvVar11[1]);
      local_53c = ppvVar11[1];
      *(undefined *)((int)ppvVar1 + (int)local_53c) = 0;
    }
    pcVar12 = free_exref;
    local_4._0_1_ = 6;
    if (apvStack_528[0] != (void *)0x0) {
      free(apvStack_528[0]);
    }
    puStack_548 = (undefined4 *)&stack0xfffffa88;
    FUN_0041aa30((void **)&stack0xfffffa88);
    bVar3 = FUN_0041a760((LPCSTR)ppvVar15);
    if ((!bVar3) && (*(int *)((int)this + 4) == 0)) {
      FUN_0041a1b0("Historic: Empty folder, initialize complete",uVar20);
      local_4._0_1_ = 4;
      if (local_554 != (char *)0x0) {
        free(local_554);
      }
      local_4._0_1_ = 3;
      FUN_00402ab0();
      local_4._0_1_ = 2;
      if (local_540 != (void **)0x0) {
        free(local_540);
      }
      local_4 = (uint)local_4._1_3_ << 8;
      if (param_1 != (void *)0x0) {
        free(param_1);
      }
      local_4 = 0xffffffff;
      if (param_4 != (void *)0x0) {
        free(param_4);
      }
      goto LAB_004018d8;
    }
    ppvVar15 = local_540;
    if (local_540 == (void **)0x0) {
      ppvVar15 = (void **)&DAT_0044d0d5;
    }
    _File = fopen((char *)ppvVar15,"rb");
    if (_File != (FILE *)0x0) {
      fgets(acStack_410,0x400,_File);
      iVar9 = atoi(acStack_410);
      *(int *)((int)this + 0xc) = iVar9;
      fgets(acStack_410,0x400,_File);
      iVar9 = atoi(acStack_410);
      *(int *)((int)this + 0x10) = iVar9;
      fclose(_File);
      FUN_00402410((int)this);
      FUN_0041a190("Historic Initialized (size:[M:%d B:%d] maxSize:%d) (id\'s min:%d max:%d)",
                   (char)*(undefined4 *)((int)this + 4));
      local_4._0_1_ = 4;
      if (local_554 != (char *)0x0) {
        free(local_554);
      }
      local_4._0_1_ = 3;
      FUN_00402ab0();
      local_4._0_1_ = 2;
      if (local_540 != (void **)0x0) {
        free(local_540);
      }
      local_4 = (uint)local_4._1_3_ << 8;
      if (param_1 != (void *)0x0) {
        free(param_1);
      }
      local_4 = 0xffffffff;
      if (param_4 != (void *)0x0) {
        free(param_4);
      }
      goto LAB_004018d8;
    }
    FUN_0041a1f0("Historic can\'t open file cache.dat",uVar20);
    local_4._0_1_ = 4;
    if (local_554 != (char *)0x0) {
      free(local_554);
    }
    local_4._0_1_ = 3;
    FUN_00402ab0();
    local_4._0_1_ = 2;
    if (local_540 != (void **)0x0) {
      free(local_540);
    }
  }
  local_4 = (uint)local_4._1_3_ << 8;
  if (param_1 != (void *)0x0) {
    (*pcVar12)();
  }
  local_4 = 0xffffffff;
  if (param_4 != (void *)0x0) {
    (*pcVar12)();
  }
LAB_004018d8:
  ExceptionList = local_c;
  ___security_check_cookie_4(local_10 ^ (uint)auStack_558);
  return;
}



void thunk_FUN_00402ab0(void)

{
  undefined4 *puVar1;
  void *pvVar2;
  int *unaff_EBX;
  
  if (*unaff_EBX < 2) {
    if ((*unaff_EBX != 0) && (pvVar2 = (void *)unaff_EBX[2], pvVar2 != (void *)0x0)) {
      if (*(void **)((int)pvVar2 + 8) != (void *)0x0) {
        free(*(void **)((int)pvVar2 + 8));
      }
      operator_delete(pvVar2);
      return;
    }
  }
  else {
    for (puVar1 = *(undefined4 **)unaff_EBX[1]; puVar1 != (undefined4 *)0x0;
        puVar1 = (undefined4 *)*puVar1) {
      pvVar2 = (void *)puVar1[1];
      if (pvVar2 != (void *)0x0) {
        if (*(void **)((int)pvVar2 + 8) != (void *)0x0) {
          free(*(void **)((int)pvVar2 + 8));
        }
        operator_delete(pvVar2);
      }
    }
    pvVar2 = (void *)unaff_EBX[2];
    if (pvVar2 != (void *)0x0) {
      if (*(void **)((int)pvVar2 + 8) != (void *)0x0) {
        free(*(void **)((int)pvVar2 + 8));
      }
      operator_delete(pvVar2);
    }
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x00401b4d)
// WARNING: Removing unreachable block (ram,0x00401ab1)
// WARNING: Removing unreachable block (ram,0x00401a49)
// WARNING: Removing unreachable block (ram,0x00401a79)
// WARNING: Removing unreachable block (ram,0x00401bbb)

undefined __thiscall FUN_00401920(void *this,int *param_1,undefined **param_2)

{
  int *piVar1;
  byte bVar2;
  char cVar3;
  undefined uVar4;
  DWORD DVar5;
  void **ppvVar6;
  FILE *_File;
  FILE *pFVar7;
  size_t sVar8;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043aa88;
  local_c = ExceptionList;
  bVar2 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffc0;
  ExceptionList = &local_c;
  local_4 = 0;
  DVar5 = GetCurrentThreadId();
  if (*(DWORD *)((int)this + 0x3c) == DVar5) {
    *(int *)((int)this + 0x40) = *(int *)((int)this + 0x40) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x44));
    *(undefined4 *)((int)this + 0x40) = 1;
    DVar5 = GetCurrentThreadId();
    *(DWORD *)((int)this + 0x3c) = DVar5;
  }
  local_4._0_1_ = 1;
  if (*(int *)((int)this + 0x5c) == 0) {
    if (param_2 != (undefined **)0x0) {
      (**(code **)*param_2)();
    }
    DVar5 = GetCurrentThreadId();
    if (*(DWORD *)((int)this + 0x3c) == DVar5) {
      piVar1 = (int *)((int)this + 0x40);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        *(undefined4 *)((int)this + 0x3c) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x44));
      }
    }
    uVar4 = 1;
  }
  else {
    *(int *)((int)this + 0x10) = *(int *)((int)this + 0x10) + 1;
    ppvVar6 = (void **)FUN_0041b2a0(local_18,"%s/cache.dat");
    local_4._0_1_ = 2;
    if (*ppvVar6 != (void *)0x0) {
      FUN_0041b310();
      memcpy((void *)0x0,*ppvVar6,(size_t)ppvVar6[1]);
      *(undefined *)ppvVar6[1] = 0;
    }
    local_4 = CONCAT31(local_4._1_3_,1);
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    _File = fopen(&DAT_0044d0d5,"wb");
    if (_File == (FILE *)0x0) {
      if (param_2 != (undefined **)0x0) {
        (**(code **)*param_2)();
      }
      FUN_0041a1f0("Historic.Save can\'t open file \'%s\'",0xd5);
      DVar5 = GetCurrentThreadId();
      if (*(DWORD *)((int)this + 0x3c) == DVar5) {
        piVar1 = (int *)((int)this + 0x40);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 == 0) {
          *(undefined4 *)((int)this + 0x3c) = 0xffffffff;
          LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x44));
        }
      }
    }
    else {
      if (*(int *)((int)this + 0xc) == 0) {
        *(undefined4 *)((int)this + 0xc) = *(undefined4 *)((int)this + 0x10);
      }
      fprintf(_File,"%d\n");
      pFVar7 = _File;
      fprintf(_File,"%d\n");
      fclose(_File);
      sVar8 = 0x401b0c;
      cVar3 = FUN_00401be0((int)this,param_2,param_1);
      if (cVar3 != '\0') {
        FUN_0041aa30((void **)&stack0xffffffb0);
        FUN_00402330(pFVar7,sVar8);
        FUN_0041aa30((void **)&stack0xffffffb0);
        FUN_00402330(pFVar7,sVar8);
        uVar4 = FUN_00402410((int)this);
        DVar5 = GetCurrentThreadId();
        if (*(DWORD *)((int)this + 0x3c) != DVar5) {
          ExceptionList = local_c;
          return uVar4;
        }
        piVar1 = (int *)((int)this + 0x40);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 != 0) {
          ExceptionList = local_c;
          return uVar4;
        }
        *(undefined4 *)((int)this + 0x3c) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x44));
        ExceptionList = local_c;
        return uVar4;
      }
      FUN_0041a1f0("Can\'t save plate result.",bVar2);
      DVar5 = GetCurrentThreadId();
      if (*(DWORD *)((int)this + 0x3c) == DVar5) {
        piVar1 = (int *)((int)this + 0x40);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 == 0) {
          *(undefined4 *)((int)this + 0x3c) = 0xffffffff;
          LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x44));
        }
      }
    }
    uVar4 = 0;
  }
  ExceptionList = local_c;
  return uVar4;
}



void __fastcall FUN_00401be0(int param_1,undefined **param_2,int *param_3)

{
  char cVar1;
  undefined **ppuVar2;
  undefined *puVar3;
  bool bVar4;
  undefined uVar5;
  uint uVar6;
  FILE *_File;
  tm *ptVar7;
  int iVar8;
  undefined4 *puVar9;
  char *extraout_ECX;
  char *extraout_ECX_00;
  char **ppcVar10;
  char **ppcVar11;
  char *in_stack_fffffd78;
  undefined4 uVar12;
  char *pcVar13;
  void *pvVar14;
  undefined4 uVar15;
  char *pcVar16;
  undefined **ppuStack_254;
  undefined **local_250;
  undefined **local_24c;
  FILE *local_248;
  undefined4 uStack_244;
  undefined4 *local_240 [2];
  int iStack_238;
  int iStack_234;
  undefined *puStack_230;
  undefined *puStack_22c;
  char **local_228;
  int local_224;
  char **local_220;
  char acStack_214 [256];
  undefined auStack_114 [256];
  uint local_14;
  undefined uStack_10;
  undefined4 local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043aa42;
  local_c = ExceptionList;
  local_14 = DAT_0044a01c ^ (uint)&ppuStack_254;
  ExceptionList = &local_c;
  local_24c = aDiskFile::vftable;
  local_248 = (FILE *)0x0;
  local_4 = 0;
  pcVar16 = "%s\\%.8d.jpg";
  local_250 = param_2;
  local_224 = param_1;
  local_228 = (char **)FUN_0041b2a0(local_240,"%s\\%.8d.jpg");
  local_4._0_1_ = 1;
  pcVar13 = *local_228;
  ppcVar10 = (char **)(param_1 + 0x14);
  local_220 = ppcVar10;
  if (pcVar13 != *ppcVar10) {
    FUN_0041b310();
    ppcVar11 = local_228;
    pcVar16 = *ppcVar10;
    memcpy(pcVar16,*local_228,(size_t)local_228[1]);
    pcVar13 = ppcVar11[1];
    *(char **)(param_1 + 0x18) = pcVar13;
    pcVar13[(int)*ppcVar10] = '\0';
    pcVar13 = extraout_ECX;
    param_2 = local_250;
  }
  local_4._0_1_ = 0;
  if (local_240[0] != (undefined4 *)0x0) {
    free(local_240[0]);
    pcVar13 = extraout_ECX_00;
  }
  local_228 = (char **)&stack0xfffffd8c;
  FUN_0041aa80(pcVar13,(char *)0x7fffffff,"wb");
  puStack_22c = &stack0xfffffd80;
  local_4._0_1_ = 2;
  pcVar13 = (char *)0x0;
  iVar8 = 0;
  uVar15 = 0;
  puVar3 = &stack0xfffffd80;
  if (*ppcVar10 != (char *)0x0) {
    FUN_0041b310();
    in_stack_fffffd78 = *ppcVar10;
    memcpy(pcVar13,in_stack_fffffd78,*(size_t *)(param_1 + 0x18));
    iVar8 = *(int *)(param_1 + 0x18);
    pcVar13[iVar8] = '\0';
    param_2 = local_250;
    puVar3 = puStack_22c;
  }
  puStack_22c = puVar3;
  local_4 = (uint)local_4._1_3_ << 8;
  uVar12 = 0x401d3b;
  bVar4 = FUN_0041a810(&local_24c,pcVar13,iVar8,uVar15,pcVar16);
  ppuVar2 = local_250;
  if (bVar4) {
    uVar6 = FUN_0040ee20(0x4b);
    fclose(local_248);
    local_248 = (FILE *)0x0;
    if (ppuVar2 != (undefined **)0x0) {
      (**(code **)*ppuVar2)();
    }
    iVar8 = local_224;
    if ((uVar6 & 0xff) == 0) {
      pcVar13 = *local_220;
      if (pcVar13 == (char *)0x0) {
        pcVar13 = &DAT_0044d0d5;
      }
      FUN_0041a1f0("Historic.SaveJpeg: Can\'t save file \'%s\'",(char)pcVar13);
      local_24c = aDiskFile::vftable;
      if (local_248 != (FILE *)0x0) {
        fclose(local_248);
      }
      goto LAB_004022fe;
    }
    ppcVar10 = (char **)FUN_0041b2a0(local_240,"%s\\%.8d.xml");
    local_4._0_1_ = 3;
    ppcVar11 = (char **)(iVar8 + 0x20);
    if (*ppcVar10 != *ppcVar11) {
      FUN_0041b310();
      memcpy(*ppcVar11,*ppcVar10,(size_t)ppcVar10[1]);
      pcVar13 = ppcVar10[1];
      *(char **)(iVar8 + 0x24) = pcVar13;
      pcVar13[(int)*ppcVar11] = '\0';
    }
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_240[0] != (undefined4 *)0x0) {
      free(local_240[0]);
    }
    pcVar13 = *ppcVar11;
    if (pcVar13 == (char *)0x0) {
      pcVar13 = &DAT_0044d0d5;
    }
    _File = fopen(pcVar13,"wb");
    if (_File != (FILE *)0x0) {
      fprintf(_File,"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n");
      fprintf(_File,"<Car>\n");
      (**(code **)(*param_3 + 0x78))();
      fprintf(_File,"\t<Id>%d</Id>\n");
      (**(code **)(*param_3 + 0x68))();
      fprintf(_File,"\t<TriggerId>%d</TriggerId>\n");
      (**(code **)(*param_3 + 0x24))();
      fprintf(_File,"\t<IsGrammarOk>%d</IsGrammarOk>\n");
      (**(code **)(*param_3 + 0x2c))();
      fprintf(_File,"\t<Country>%s</Country>\n");
      if (uStack_244 != (undefined4 *)0x0) {
        free(uStack_244);
      }
      (**(code **)(*param_3 + 0x4c))();
      fprintf(_File,"\t<AvgQuality>%.2f</AvgQuality>\n");
      puStack_230 = &stack0xfffffd88;
      pvVar14 = (void *)0x401f76;
      (**(code **)(*param_3 + 0x3c))();
      puStack_22c = &stack0xfffffd78;
      pcVar13 = &stack0xfffffd78;
      local_c = (void *)CONCAT31(local_c._1_3_,4);
      (**(code **)(*param_3 + 0x1c))();
      uStack_10 = 0;
      FUN_00410160(pcVar13,in_stack_fffffd78,uVar12,pvVar14);
      fprintf(_File,"\t<License>%s</License>\n");
      if (local_24c != (undefined **)0x0) {
        free(local_24c);
      }
      (**(code **)(*param_3 + 0x44))();
      fprintf(_File,"\t<MinQuality>%.2f</MinQuality>\n");
      (**(code **)(*param_3 + 0x60))();
      fprintf(_File,"\t<NumberOfUnknownChars>%d</NumberOfUnknownChars>\n");
      fprintf(_File,"\t<ROI>\n");
      (**(code **)(*param_3 + 0x34))();
      fprintf(_File,"\t\t<Left>%d</Left>\n");
      local_250 = CRectangle2::vftable;
      if (local_240[0] != (undefined4 *)0x0) {
        (**(code **)*local_240[0])();
      }
      (**(code **)(*param_3 + 0x34))();
      fprintf(_File,"\t\t<Top>%d</Top>\n");
      ppuStack_254 = CRectangle2::vftable;
      if (uStack_244 != (undefined4 *)0x0) {
        (**(code **)*uStack_244)();
      }
      (**(code **)(*param_3 + 0x34))();
      fprintf(_File,"\t\t<Right>%d</Right>\n");
      if (local_248 != (FILE *)0x0) {
        (**(code **)local_248->_ptr)();
      }
      (**(code **)(*param_3 + 0x34))();
      fprintf(_File,"\t\t<Bottom>%d</Bottom>\n");
      if (local_24c != (undefined **)0x0) {
        (**(code **)*local_24c)();
      }
      fprintf(_File,"\t</ROI>\n");
      iStack_238 = (**(code **)(*param_3 + 0x80))();
      iStack_234 = iStack_238 >> 0x1f;
      ptVar7 = _localtime64((__time64_t *)&iStack_238);
      fprintf(_File,"\t<TimeStamp>\n");
      (**(code **)(*param_3 + 0x80))();
      fprintf(_File,"\t\t<Seconds>%ld</Seconds>\n");
      (**(code **)(*param_3 + 0x88))();
      fprintf(_File,"\t\t<USeconds>%ld</USeconds>\n");
      fprintf(_File,"\t\t<Date>%.4d-%.2d-%.2d</Date>\n",ptVar7->tm_year + 0x76c,ptVar7->tm_mon + 1);
      (**(code **)(*param_3 + 0x88))();
      fprintf(_File,"\t\t<Time>%.2d:%.2d:%.2d.%ld</Time>\n",ptVar7->tm_hour,ptVar7->tm_min,
              ptVar7->tm_sec);
      fprintf(_File,"\t</TimeStamp>\n");
      fprintf(_File,"\t<Chars>\n");
      iVar8 = (**(code **)(*param_3 + 0x54))();
      puVar9 = (undefined4 *)FUN_0040e220(iVar8);
      puVar9 = (undefined4 *)*puVar9;
      ppcVar10 = (char **)(**(code **)(*param_3 + 0x14))();
      pcVar13 = &DAT_0044d0d5;
      if (*ppcVar10 != (char *)0x0) {
        pcVar13 = *ppcVar10;
      }
      pcVar16 = acStack_214;
      do {
        cVar1 = *pcVar13;
        *pcVar16 = cVar1;
        pcVar13 = pcVar13 + 1;
        pcVar16 = pcVar16 + 1;
      } while (cVar1 != '\0');
      if (local_240[0] != (undefined4 *)0x0) {
        free(local_240[0]);
      }
      uStack_244._0_2_ = (ushort)(byte)uStack_244;
      for (; puVar9 != (undefined4 *)0x0; puVar9 = (undefined4 *)*puVar9) {
        fprintf(_File,"\t\t<Char>\n");
        fprintf(_File,"\t\t\t<Index>%d</Index>\n");
        uStack_244 = (undefined4 *)CONCAT31(uStack_244._1_3_,acStack_214[(int)local_250]);
        (**(code **)(*param_3 + 0x3c))();
        local_4._0_1_ = 5;
        FUN_004158f0(&DAT_0043b7b8,(char *)&uStack_244,auStack_114,0x100);
        local_4 = (uint)local_4._1_3_ << 8;
        if (local_240[0] != (undefined4 *)0x0) {
          free(local_240[0]);
        }
        fprintf(_File,"\t\t\t<Value>%s</Value>\n");
        fprintf(_File,"\t\t\t<Quality>%.2f</Quality>\n");
        fprintf(_File,"\t\t</Char>\n");
        local_250 = (undefined **)((int)local_250 + 1);
      }
      fprintf(_File,"\t</Chars>\n");
      fprintf(_File,"</Car>\n");
      fclose(_File);
      local_24c = aDiskFile::vftable;
      if (local_248 != (FILE *)0x0) {
        fclose(local_248);
      }
      goto LAB_004022fe;
    }
    pcVar13 = *ppcVar11;
    if (pcVar13 == (char *)0x0) {
      pcVar13 = &DAT_0044d0d5;
    }
    uVar5 = SUB41(pcVar13,0);
    pcVar13 = "Historic.SaveXml: Can\'t create file \'%s\'";
  }
  else {
    if (param_2 != (undefined **)0x0) {
      (**(code **)*param_2)();
    }
    pcVar13 = &DAT_0044d0d5;
    if (*ppcVar10 != (char *)0x0) {
      pcVar13 = *ppcVar10;
    }
    uVar5 = SUB41(pcVar13,0);
    pcVar13 = "Historic.SaveJpeg: Can\'t create file \'%s\'";
  }
  FUN_0041a1f0(pcVar13,uVar5);
  local_24c = aDiskFile::vftable;
  if (local_248 != (FILE *)0x0) {
    fclose(local_248);
  }
LAB_004022fe:
  ExceptionList = local_c;
  ___security_check_cookie_4(local_14 ^ (uint)&ppuStack_254);
  return;
}



void FUN_00402330(void *param_1,size_t param_2)

{
  int iVar1;
  int iVar2;
  int unaff_ESI;
  char *_Dst;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439018;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  _Dst = (char *)0x0;
  if (param_1 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_1,param_2);
    _Dst[param_2] = '\0';
  }
  iVar1 = FUN_0041a650(_Dst);
  if (0 < iVar1) {
    if (0xfffff < iVar1) {
      iVar2 = (int)(iVar1 + (iVar1 >> 0x1f & 0xfffffU)) >> 0x14;
      *(int *)(unaff_ESI + 4) = *(int *)(unaff_ESI + 4) + iVar2;
      iVar1 = iVar1 + iVar2 * -0x100000;
    }
    *(int *)(unaff_ESI + 8) = *(int *)(unaff_ESI + 8) + iVar1;
    if (0xfffff < *(int *)(unaff_ESI + 8)) {
      *(int *)(unaff_ESI + 4) = *(int *)(unaff_ESI + 4) + 1;
      *(int *)(unaff_ESI + 8) = *(int *)(unaff_ESI + 8) + -0x100000;
    }
  }
  local_4 = 0xffffffff;
  if (param_1 != (void *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return;
}



void FUN_00402410(int param_1)

{
  int *piVar1;
  undefined *puVar2;
  byte bVar3;
  DWORD DVar4;
  char **ppcVar5;
  char *pcVar6;
  FILE *pFVar7;
  int iVar8;
  void **ppvVar9;
  uint uVar10;
  BOOL BVar11;
  int iVar12;
  undefined1 *puVar13;
  void *pvVar14;
  LPCSTR _Dst;
  char *_Filename;
  char *_Memory;
  size_t sVar15;
  undefined auStack_474 [3];
  char cStack_471;
  undefined1 *local_470;
  void *local_46c;
  int local_468;
  undefined4 *puStack_464;
  int iStack_460;
  int local_45c;
  undefined4 local_458;
  undefined4 local_454;
  int iStack_450;
  void *local_44c [3];
  undefined *puStack_440;
  undefined auStack_438 [36];
  char acStack_414 [1024];
  uint local_14;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439751;
  local_c = ExceptionList;
  local_14 = DAT_0044a01c ^ (uint)auStack_474;
  bVar3 = (byte)DAT_0044a01c ^ (byte)&stack0xfffffb7c;
  ExceptionList = &local_c;
  pvVar14 = (void *)0x0;
  local_470 = (undefined1 *)0x0;
  local_468 = 0;
  local_46c = (void *)0x0;
  local_45c = 0;
  local_458 = 0;
  local_454 = 0;
  local_4._0_1_ = 1;
  local_4._1_3_ = 0;
  FUN_0041a190("AdjustHistoricSize maxSize:%d  currentSize:%d.%d  ",
               (char)*(undefined4 *)(param_1 + 0x5c));
  if (*(int *)(param_1 + 4) < *(int *)(param_1 + 0x5c)) {
    local_4 = (uint)local_4._1_3_ << 8;
    FUN_00402ab0();
  }
  else {
    DVar4 = GetCurrentThreadId();
    if (*(DWORD *)(param_1 + 0x3c) == DVar4) {
      *(int *)(param_1 + 0x40) = *(int *)(param_1 + 0x40) + 1;
    }
    else {
      EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x44));
      *(undefined4 *)(param_1 + 0x40) = 1;
      DVar4 = GetCurrentThreadId();
      *(DWORD *)(param_1 + 0x3c) = DVar4;
    }
    ppcVar5 = (char **)FUN_0041b2a0(local_44c,"%s/cache.dat");
    pcVar6 = *ppcVar5;
    if (pcVar6 == (char *)0x0) {
      pcVar6 = &DAT_0044d0d5;
    }
    pFVar7 = fopen(pcVar6,"rb");
    if (local_44c[0] != (void *)0x0) {
      free(local_44c[0]);
    }
    if (pFVar7 == (FILE *)0x0) {
      FUN_0041a1f0("AdjustHistoricSize can\'t open file cache.dat",bVar3);
      local_4 = (uint)local_4._1_3_ << 8;
      FUN_00402ab0();
    }
    else {
      fgets(acStack_414,0x400,pFVar7);
      iVar8 = atoi(acStack_414);
      pcVar6 = acStack_414;
      iStack_460 = iVar8;
      fgets(pcVar6,0x400,pFVar7);
      iStack_450 = atoi(acStack_414);
      sVar15 = 0x4025ac;
      fclose(pFVar7);
      DVar4 = GetCurrentThreadId();
      if (*(DWORD *)(param_1 + 0x3c) == DVar4) {
        piVar1 = (int *)(param_1 + 0x40);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 == 0) {
          *(undefined4 *)(param_1 + 0x3c) = 0xffffffff;
          sVar15 = 0x4025cf;
          LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x44));
        }
      }
      if (iVar8 < iStack_450) {
        do {
          if ((*(int *)(param_1 + 4) < *(int *)(param_1 + 0x5c)) && (*(int *)(param_1 + 0x5c) != 0))
          break;
          cStack_471 = '\0';
          FUN_00402c10();
          puStack_464 = (undefined4 *)&stack0xfffffb6c;
          FUN_0041b2a0((undefined4 *)&stack0xfffffb6c,"%.8d.jpg");
          FUN_00402b40(&local_45c,pcVar6,sVar15);
          puStack_464 = (undefined4 *)&stack0xfffffb6c;
          FUN_0041b2a0((undefined4 *)&stack0xfffffb6c,"%.8d.xml");
          FUN_00402b40(&local_45c,pcVar6,sVar15);
          puStack_464 = (undefined4 *)FUN_0040e220((int)&local_45c);
          for (puStack_464 = (undefined4 *)*puStack_464; puStack_464 != (undefined4 *)0x0;
              puStack_464 = (undefined4 *)*puStack_464) {
            ppvVar9 = (void **)FUN_0041b2a0(local_44c,"%s/%s");
            local_4._0_1_ = 2;
            if ((undefined1 *)*ppvVar9 != local_470) {
              pvVar14 = ppvVar9[1];
              if (local_468 <= (int)pvVar14) {
                if (local_470 == (undefined1 *)0x0) {
                  uVar10 = (uint)pvVar14 & 0x8000001f;
                  if ((int)uVar10 < 0) {
                    uVar10 = (uVar10 - 1 | 0xffffffe0) + 1;
                  }
                  iVar8 = (int)pvVar14 - uVar10;
                  local_470 = (undefined1 *)malloc(iVar8 + 0x21);
                }
                else {
                  uVar10 = (uint)pvVar14 & 0x8000001f;
                  if ((int)uVar10 < 0) {
                    uVar10 = (uVar10 - 1 | 0xffffffe0) + 1;
                  }
                  iVar8 = (int)pvVar14 - uVar10;
                  local_470 = (undefined1 *)realloc(local_470,iVar8 + 0x21);
                }
                local_468 = iVar8 + 0x20;
                *(undefined *)((int)pvVar14 + (int)local_470) = 0;
              }
              puVar13 = local_470;
              memcpy(local_470,*ppvVar9,(size_t)ppvVar9[1]);
              pvVar14 = ppvVar9[1];
              *(undefined *)((int)pvVar14 + (int)puVar13) = 0;
              local_46c = pvVar14;
            }
            local_4._0_1_ = 1;
            if (local_44c[0] != (void *)0x0) {
              free(local_44c[0]);
            }
            puVar13 = local_470;
            _Dst = (LPCSTR)0x0;
            if (local_470 != (undefined1 *)0x0) {
              if (-1 < (int)pvVar14) {
                uVar10 = (uint)pvVar14 & 0x8000001f;
                if ((int)uVar10 < 0) {
                  uVar10 = (uVar10 - 1 | 0xffffffe0) + 1;
                }
                _Dst = (LPCSTR)malloc((int)pvVar14 + (0x21 - uVar10));
                *(CHAR *)((int)pvVar14 + (int)_Dst) = '\0';
              }
              memcpy(_Dst,puVar13,(size_t)pvVar14);
              *(CHAR *)((int)pvVar14 + (int)_Dst) = '\0';
            }
            pcVar6 = &DAT_0044d0d5;
            if (_Dst != (LPCSTR)0x0) {
              pcVar6 = _Dst;
            }
            sVar15 = 0;
            BVar11 = GetFileAttributesExA(pcVar6,GetFileExInfoStandard,auStack_438);
            if (_Dst != (LPCSTR)0x0) {
              sVar15 = 0x4027b1;
              free(_Dst);
            }
            if (BVar11 != 0) {
              puStack_440 = &stack0xfffffb6c;
              pcVar6 = (char *)0x0;
              puVar2 = &stack0xfffffb6c;
              if (local_470 != (undefined1 *)0x0) {
                puVar2 = &stack0xfffffb6c;
                if (-1 < (int)pvVar14) {
                  uVar10 = (uint)pvVar14 & 0x8000001f;
                  if ((int)uVar10 < 0) {
                    uVar10 = (uVar10 - 1 | 0xffffffe0) + 1;
                  }
                  pcVar6 = (char *)malloc((int)pvVar14 + (0x21 - uVar10));
                  pcVar6[(int)pvVar14] = '\0';
                  puVar2 = puStack_440;
                }
                puStack_440 = puVar2;
                memcpy(pcVar6,local_470,(size_t)pvVar14);
                *(char *)((int)pvVar14 + (int)pcVar6) = '\0';
                puVar2 = puStack_440;
              }
              puStack_440 = puVar2;
              iVar8 = FUN_0041a650(pcVar6);
              puVar13 = local_470;
              if (iVar8 < 0x100000) {
                *(int *)(param_1 + 8) = *(int *)(param_1 + 8) - iVar8;
              }
              else {
                iVar12 = (int)(iVar8 + (iVar8 >> 0x1f & 0xfffffU)) >> 0x14;
                *(int *)(param_1 + 4) = *(int *)(param_1 + 4) - iVar12;
                *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + (iVar12 * 0x100000 - iVar8);
              }
              if (*(int *)(param_1 + 8) < 0) {
                *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + -1;
                *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x100000;
              }
              _Filename = (char *)0x0;
              _Memory = _Filename;
              if (local_470 == (undefined1 *)0x0) {
LAB_004028a7:
                _Filename = &DAT_0044d0d5;
              }
              else {
                if (-1 < (int)pvVar14) {
                  uVar10 = (uint)pvVar14 & 0x8000001f;
                  if ((int)uVar10 < 0) {
                    uVar10 = (uVar10 - 1 | 0xffffffe0) + 1;
                  }
                  _Filename = (char *)malloc((int)pvVar14 + (0x21 - uVar10));
                  *(char *)((int)pvVar14 + (int)_Filename) = '\0';
                }
                pcVar6 = _Filename;
                memcpy(_Filename,puVar13,(size_t)pvVar14);
                *(char *)((int)pvVar14 + (int)_Filename) = '\0';
                _Memory = _Filename;
                if (_Filename == (char *)0x0) goto LAB_004028a7;
              }
              sVar15 = 0x4028b7;
              remove(_Filename);
              if (_Memory != (char *)0x0) {
                sVar15 = 0x4028c5;
                free(_Memory);
              }
              cStack_471 = '\x01';
            }
          }
          iVar8 = iStack_460 + 1;
          iStack_460 = iVar8;
          if (cStack_471 != '\0') {
            DVar4 = GetCurrentThreadId();
            if (*(DWORD *)(param_1 + 0x3c) == DVar4) {
              *(int *)(param_1 + 0x40) = *(int *)(param_1 + 0x40) + 1;
            }
            else {
              sVar15 = 0x40290e;
              EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x44));
              *(undefined4 *)(param_1 + 0x40) = 1;
              DVar4 = GetCurrentThreadId();
              *(DWORD *)(param_1 + 0x3c) = DVar4;
            }
            *(int *)(param_1 + 0xc) = iVar8;
            DVar4 = GetCurrentThreadId();
            if (*(DWORD *)(param_1 + 0x3c) == DVar4) {
              piVar1 = (int *)(param_1 + 0x40);
              *piVar1 = *piVar1 + -1;
              if (*piVar1 == 0) {
                *(undefined4 *)(param_1 + 0x3c) = 0xffffffff;
                sVar15 = 0x402939;
                LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x44));
              }
            }
          }
        } while (iVar8 < iStack_450);
      }
      DVar4 = GetCurrentThreadId();
      if (*(DWORD *)(param_1 + 0x3c) == DVar4) {
        *(int *)(param_1 + 0x40) = *(int *)(param_1 + 0x40) + 1;
      }
      else {
        EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x44));
        *(undefined4 *)(param_1 + 0x40) = 1;
        DVar4 = GetCurrentThreadId();
        *(DWORD *)(param_1 + 0x3c) = DVar4;
      }
      ppcVar5 = (char **)FUN_0041b2a0(local_44c,"%s/cache.dat");
      pcVar6 = *ppcVar5;
      if (pcVar6 == (char *)0x0) {
        pcVar6 = &DAT_0044d0d5;
      }
      pFVar7 = fopen(pcVar6,"wb");
      if (local_44c[0] != (void *)0x0) {
        free(local_44c[0]);
      }
      if (pFVar7 == (FILE *)0x0) {
        puVar13 = local_470;
        if (local_470 == (undefined1 *)0x0) {
          puVar13 = &DAT_0044d0d5;
        }
        FUN_0041a1f0("Historic.Save can\'t open file \'%s\'",(char)puVar13);
        local_4 = (uint)local_4._1_3_ << 8;
        FUN_00402ab0();
        local_4 = -1;
        if (local_470 != (undefined1 *)0x0) {
          free(local_470);
        }
      }
      else {
        fprintf(pFVar7,"%d\n");
        fprintf(pFVar7,"%d\n");
        fclose(pFVar7);
        DVar4 = GetCurrentThreadId();
        if (*(DWORD *)(param_1 + 0x3c) == DVar4) {
          piVar1 = (int *)(param_1 + 0x40);
          *piVar1 = *piVar1 + -1;
          if (*piVar1 == 0) {
            *(undefined4 *)(param_1 + 0x3c) = 0xffffffff;
            LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x44));
          }
        }
        local_4 = (uint)local_4._1_3_ << 8;
        FUN_00402ab0();
        local_4 = -1;
        if (local_470 != (undefined1 *)0x0) {
          free(local_470);
        }
      }
    }
  }
  ExceptionList = local_c;
  ___security_check_cookie_4(local_14 ^ (uint)auStack_474);
  return;
}



void FUN_00402ab0(void)

{
  undefined4 *puVar1;
  void *pvVar2;
  int *unaff_EBX;
  
  if (*unaff_EBX < 2) {
    if ((*unaff_EBX != 0) && (pvVar2 = (void *)unaff_EBX[2], pvVar2 != (void *)0x0)) {
      if (*(void **)((int)pvVar2 + 8) != (void *)0x0) {
        free(*(void **)((int)pvVar2 + 8));
      }
      operator_delete(pvVar2);
      return;
    }
  }
  else {
    for (puVar1 = *(undefined4 **)unaff_EBX[1]; puVar1 != (undefined4 *)0x0;
        puVar1 = (undefined4 *)*puVar1) {
      pvVar2 = (void *)puVar1[1];
      if (pvVar2 != (void *)0x0) {
        if (*(void **)((int)pvVar2 + 8) != (void *)0x0) {
          free(*(void **)((int)pvVar2 + 8));
        }
        operator_delete(pvVar2);
      }
    }
    pvVar2 = (void *)unaff_EBX[2];
    if (pvVar2 != (void *)0x0) {
      if (*(void **)((int)pvVar2 + 8) != (void *)0x0) {
        free(*(void **)((int)pvVar2 + 8));
      }
      operator_delete(pvVar2);
    }
  }
  return;
}



void FUN_00402b40(int *param_1,void *param_2,size_t param_3)

{
  void **ppvVar1;
  int iVar2;
  undefined4 *puVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438fe8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  iVar2 = param_1[2];
  puVar3 = (undefined4 *)operator_new(0x14);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    puVar3[2] = 0;
    puVar3[4] = 0;
    puVar3[3] = 0;
  }
  puVar3[1] = iVar2;
  ppvVar1 = (void **)(puVar3 + 2);
  *puVar3 = 0;
  if (param_2 != *ppvVar1) {
    FUN_0041b310();
    memcpy(*ppvVar1,param_2,param_3);
    puVar3[3] = param_3;
    *(undefined *)(param_3 + (int)*ppvVar1) = 0;
  }
  if ((undefined4 *)param_1[2] == (undefined4 *)0x0) {
    param_1[1] = (int)puVar3;
  }
  else {
    *(undefined4 *)param_1[2] = puVar3;
  }
  *param_1 = *param_1 + 1;
  param_1[2] = (int)puVar3;
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return;
}



void FUN_00402c10(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *unaff_EDI;
  
  iVar2 = unaff_EDI[1];
  while (iVar2 != 0) {
    puVar1 = (undefined4 *)unaff_EDI[1];
    unaff_EDI[1] = *puVar1;
    if (puVar1 != (undefined4 *)0x0) {
      if ((void *)puVar1[2] != (void *)0x0) {
        free((void *)puVar1[2]);
      }
      operator_delete(puVar1);
    }
    iVar2 = unaff_EDI[1];
  }
  *unaff_EDI = 0;
  unaff_EDI[1] = 0;
  unaff_EDI[2] = 0;
  return;
}



undefined4 * __thiscall FUN_00402c60(void *this,byte param_1)

{
  *(undefined ***)this = CIOCard::vftable;
  *(undefined ***)((int)this + 0x54) = aSyncObj::vftable;
  *(undefined ***)((int)this + 0x5c) = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  *(undefined ***)((int)this + 0x30) = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)((int)this + 0x3c));
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



undefined4 FUN_00402cb0(void)

{
  int in_EAX;
  undefined4 uVar1;
  undefined1 unaff_SI;
  
  FUN_0041a190("IOCard: Initialize() begin",unaff_SI);
  *(undefined *)(in_EAX + 5) = 0;
  *(undefined4 *)(in_EAX + 0xc) = 0;
  *(undefined4 *)(in_EAX + 8) = 0;
  *(undefined4 *)(in_EAX + 0x10) = 0;
  *(undefined4 *)(in_EAX + 0x14) = 0;
  *(undefined4 *)(in_EAX + 0x18) = 0;
  *(undefined4 *)(in_EAX + 0x1c) = 0;
  *(undefined4 *)(in_EAX + 0x20) = 0;
  *(undefined4 *)(in_EAX + 0x24) = 0;
  *(undefined4 *)(in_EAX + 0x28) = 0;
  *(undefined4 *)(in_EAX + 0x2c) = 0;
  *(undefined4 *)(in_EAX + 0x7c) = 0;
  FUN_0041c150();
  uVar1 = FUN_0041a190("IOCard: Initialize() end",unaff_SI);
  return CONCAT31((int3)((uint)uVar1 >> 8),1);
}



void FUN_00402d00(int param_1)

{
  undefined uVar1;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_004384a0;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_0041a190("IOCard: Terminate() begin",(byte)DAT_0044a01c ^ (byte)&stack0xfffffffc);
  local_8 = 0;
  uVar1 = 0xff;
  (**(code **)(*(int *)(param_1 + 0x54) + 0x10))();
  local_8 = 0xffffffff;
  FUN_0041a190("IOCard: Terminate() end",uVar1);
  ExceptionList = local_10;
  return;
}



undefined4 Catch_All_00402d75(void)

{
  return 0x402d54;
}



uint FUN_00402d80(int param_1)

{
  int *piVar1;
  uint uVar2;
  DWORD DVar3;
  undefined4 *puVar4;
  DWORD unaff_EBX;
  void *unaff_EDI;
  
  uVar2 = FUN_0041a190("IOCard: SetBit(%d,%d)",(char)unaff_EBX);
  if ((int)unaff_EBX < 1) {
    if (param_1 != -1) {
      DVar3 = GetCurrentThreadId();
      if (*(DWORD *)((int)unaff_EDI + 0x34) == DVar3) {
        *(int *)((int)unaff_EDI + 0x38) = *(int *)((int)unaff_EDI + 0x38) + 1;
      }
      else {
        EnterCriticalSection((LPCRITICAL_SECTION)((int)unaff_EDI + 0x3c));
        *(undefined4 *)((int)unaff_EDI + 0x38) = 1;
        DVar3 = GetCurrentThreadId();
        *(DWORD *)((int)unaff_EDI + 0x34) = DVar3;
      }
      piVar1 = (int *)((int)unaff_EDI + unaff_EBX * 4 + 0x10);
      *piVar1 = *piVar1 + 1;
      DVar3 = GetCurrentThreadId();
      if (*(DWORD *)((int)unaff_EDI + 0x34) == DVar3) {
        piVar1 = (int *)((int)unaff_EDI + 0x38);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 == 0) {
          *(undefined4 *)((int)unaff_EDI + 0x34) = 0xffffffff;
          LeaveCriticalSection((LPCRITICAL_SECTION)((int)unaff_EDI + 0x3c));
        }
      }
      puVar4 = (undefined4 *)operator_new(0x4c);
      if (puVar4 != (undefined4 *)0x0) {
        *puVar4 = aThread::vftable;
        FUN_0041db50();
        puVar4[2] = aCondition::vftable;
        *(undefined *)(puVar4 + 0xb) = 0;
        *puVar4 = COutputActuator::vftable;
      }
      uVar2 = FUN_00402f00(unaff_EDI,unaff_EBX,param_1);
    }
    return CONCAT31((int3)(uVar2 >> 8),1);
  }
  return uVar2 & 0xffffff00;
}



uint __fastcall FUN_00402e40(undefined4 param_1,int param_2,uint *param_3,undefined4 param_4)

{
  char cVar1;
  uint uVar2;
  uint in_EAX;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  bool bVar6;
  
  uVar4 = *(uint *)(param_2 + 8);
  uVar2 = *(uint *)(param_2 + 0xc);
  if (uVar4 == uVar2) {
    return in_EAX & 0xffffff00;
  }
  uVar3 = 1;
  while( true ) {
    uVar5 = DAT_0044c6a4 + uVar3 & 0x80000001;
    if ((int)uVar5 < 0) {
      uVar5 = (uVar5 - 1 | 0xfffffffe) + 1;
    }
    if (((uVar2 ^ uVar4) & 1 << ((byte)uVar5 & 0x1f)) != 0) break;
    uVar3 = uVar3 + 1;
    if (2 < (int)uVar3) {
      return uVar3 & 0xffffff00;
    }
  }
  DAT_0044c6a4 = DAT_0044c6a4 + uVar3 & 0x80000001;
  if ((int)DAT_0044c6a4 < 0) {
    DAT_0044c6a4 = (DAT_0044c6a4 - 1 | 0xfffffffe) + 1;
  }
  *param_3 = DAT_0044c6a4;
  *(uint *)(param_2 + 8) = 1 << ((byte)DAT_0044c6a4 & 0x1f) ^ uVar4;
  uVar4 = (int)uVar2 >> ((byte)DAT_0044c6a4 & 0x1f) & 0xffffff01;
  bVar6 = (char)uVar4 == '\x01';
  cVar1 = *(char *)(param_2 + 5);
  *(bool *)param_4 = bVar6;
  if (cVar1 != '\0') {
    *(bool *)param_4 = !bVar6;
  }
  return CONCAT31((int3)(uVar4 >> 8),1);
}



undefined4 __thiscall FUN_00402f00(void *this,DWORD param_1,undefined4 param_2)

{
  int **ppiVar1;
  DWORD DVar2;
  HANDLE pvVar3;
  int *piVar4;
  int *extraout_EAX;
  LPVOID unaff_ESI;
  int *piStack_14;
  void *local_c;
  undefined *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00439708;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar2 = GetCurrentThreadId();
  ppiVar1 = (int **)((int)this + 0x34);
  if (*(DWORD *)((int)this + 0x34) == DVar2) {
    *(int *)((int)this + 0x38) = *(int *)((int)this + 0x38) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x3c));
    *(undefined4 *)((int)this + 0x38) = 1;
    piVar4 = (int *)GetCurrentThreadId();
    *ppiVar1 = piVar4;
  }
  piStack_14 = (int *)((int)this + 0x38);
  DVar2 = timeGetTime();
  *(void **)((int)unaff_ESI + 0x40) = this;
  *(DWORD *)((int)unaff_ESI + 0x48) = DVar2;
  FUN_0041c210();
  piVar4 = (int *)(*(int *)((int)unaff_ESI + 0x40) + 0x7c);
  *piVar4 = *piVar4 + 1;
  *(DWORD *)((int)unaff_ESI + 0x44) = param_1;
  *(undefined4 *)((int)unaff_ESI + 0x3c) = param_2;
  *(undefined *)((int)unaff_ESI + 0x35) = 1;
  *(undefined4 *)((int)unaff_ESI + 0x30) = 0;
  *(undefined *)((int)unaff_ESI + 4) = 0;
  *(undefined *)((int)unaff_ESI + 0x34) = 0;
  FUN_0041c210();
  pvVar3 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,(LPTHREAD_START_ROUTINE)&LAB_0041c690,unaff_ESI
                        ,0,&param_1);
  *(HANDLE *)((int)unaff_ESI + 0x38) = pvVar3;
  piVar4 = (int *)GetCurrentThreadId();
  if ((*ppiVar1 == piVar4) &&
     (*piStack_14 = *piStack_14 + -1, piVar4 = piStack_14, *piStack_14 == 0)) {
    *ppiVar1 = (int *)0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x3c));
    piVar4 = extraout_EAX;
  }
  ExceptionList = local_c;
  return CONCAT31((int3)((uint)piVar4 >> 8),1);
}



void __fastcall FUN_00403010(int param_1)

{
  int *piVar1;
  int iVar2;
  DWORD DVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00439178;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar3 = timeGetTime();
  if ((int)DVar3 < *(int *)(param_1 + 0x48)) {
    *(DWORD *)(param_1 + 0x48) = DVar3;
  }
  DVar3 = (*(int *)(param_1 + 0x3c) - DVar3) + *(int *)(param_1 + 0x48);
  if (0 < (int)DVar3) {
    Sleep(DVar3);
  }
  iVar2 = *(int *)(param_1 + 0x40);
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)(iVar2 + 0x34) == DVar3) {
    *(int *)(iVar2 + 0x38) = *(int *)(iVar2 + 0x38) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(iVar2 + 0x3c));
    *(undefined4 *)(iVar2 + 0x38) = 1;
    DVar3 = GetCurrentThreadId();
    *(DWORD *)(iVar2 + 0x34) = DVar3;
  }
  uStack_4 = 0;
  piVar1 = (int *)(*(int *)(param_1 + 0x40) + 0x10 + *(int *)(param_1 + 0x44) * 4);
  if (0 < *(int *)(*(int *)(param_1 + 0x40) + 0x10 + *(int *)(param_1 + 0x44) * 4)) {
    *piVar1 = *piVar1 + -1;
  }
  piVar1 = (int *)(*(int *)(param_1 + 0x40) + 0x7c);
  *piVar1 = *piVar1 + -1;
  if (*(int *)(*(int *)(param_1 + 0x40) + 0x7c) == 0) {
    FUN_0041c150();
  }
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)(iVar2 + 0x34) == DVar3) {
    piVar1 = (int *)(iVar2 + 0x38);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(iVar2 + 0x34) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(iVar2 + 0x3c));
    }
  }
  ExceptionList = local_c;
  return;
}



undefined4 * __thiscall FUN_004030f0(void *this,byte param_1)

{
  FUN_00403110((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_00403110(undefined4 *param_1)

{
  uint uVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004396e3;
  local_c = ExceptionList;
  uVar1 = DAT_0044a01c ^ (uint)&stack0xffffffe8;
  ExceptionList = &local_c;
  *param_1 = CIOManager::vftable;
  local_4 = 1;
  if ((undefined4 *)param_1[0x13] != (undefined4 *)0x0) {
    (***(code ***)(undefined4 *)param_1[0x13])(1,uVar1);
  }
  param_1[0x15] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x18));
  *param_1 = aThread::vftable;
  param_1[2] = aSyncObj::vftable;
  param_1[4] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  ExceptionList = local_c;
  return;
}



uint FUN_004031a0(void *param_1,undefined4 param_2)

{
  int in_EAX;
  uint uVar1;
  void *pvVar2;
  int *piVar3;
  undefined4 uVar4;
  undefined1 unaff_DI;
  
  FUN_0041a190("IOMananger: Initialize() begin",unaff_DI);
  uVar1 = FUN_00403330(param_1,in_EAX);
  if ((char)uVar1 != '\0') {
    pvVar2 = operator_new(0x80);
    if (pvVar2 == (void *)0x0) {
      uVar1 = 0;
    }
    else {
      uVar1 = FUN_00403230();
    }
    *(uint *)(in_EAX + 0x4c) = uVar1;
    if (uVar1 != 0) {
      uVar1 = FUN_00402cb0();
      if ((char)uVar1 != '\0') {
        piVar3 = FUN_0040cd20();
        *(undefined *)(in_EAX + 0x52) = *(undefined *)((int)piVar3 + 0xf1);
        *(undefined4 *)(in_EAX + 0x48) = param_2;
        *(undefined *)(in_EAX + 0x3c) = 1;
        FUN_0041c710('\x01');
        uVar4 = FUN_0041a190("IOMananger: Initialize() end",unaff_DI);
        return CONCAT31((int3)((uint)uVar4 >> 8),1);
      }
    }
  }
  return uVar1 & 0xffffff00;
}



void FUN_00403230(void)

{
  undefined4 *unaff_EDI;
  
  *unaff_EDI = CIOCard::vftable;
  unaff_EDI[0xc] = aCriticalSection::vftable;
  unaff_EDI[0xd] = 0xffffffff;
  unaff_EDI[0xe] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(unaff_EDI + 0xf));
  FUN_0041db50();
  unaff_EDI[0x15] = aCondition::vftable;
  *(undefined *)(unaff_EDI + 0x1e) = 0;
  return;
}



void __fastcall FUN_00403270(int *param_1)

{
  code *pcVar1;
  byte bVar2;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_004396b0;
  local_10 = ExceptionList;
  bVar2 = (byte)DAT_0044a01c ^ (byte)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_0041a190("IOMananger: Terminate() begin",bVar2);
  local_8 = 0;
  if (param_1[0x13] != 0) {
    FUN_00402d00(param_1[0x13]);
  }
  if (*(char *)(param_1 + 0xf) != '\0') {
    FUN_0041c150();
    pcVar1 = *(code **)(*param_1 + 4);
    *(undefined *)(param_1 + 1) = 1;
    (*pcVar1)();
    if (*(char *)(param_1 + 0xd) == '\0') {
      WaitForSingleObject((HANDLE)param_1[0xe],0xffffffff);
      CloseHandle((HANDLE)param_1[0xe]);
    }
  }
  if ((undefined4 *)param_1[0x13] != (undefined4 *)0x0) {
    (***(code ***)(undefined4 *)param_1[0x13])(1);
    param_1[0x13] = 0;
  }
  local_8 = 0xffffffff;
  FUN_0041a190("IOMananger: Terminate() end",bVar2);
  ExceptionList = local_10;
  return;
}



undefined * Catch_All_00403327(void)

{
  return &DAT_0040332d;
}



undefined4 __thiscall FUN_00403330(void *this,int param_1)

{
  int iVar1;
  char cVar2;
  undefined4 *puVar3;
  uint uVar4;
  long *plVar5;
  void **ppvVar6;
  undefined4 uVar7;
  undefined1 *puVar8;
  char *_Control;
  size_t sVar9;
  long **pplVar10;
  long lVar11;
  long *plVar12;
  int iVar13;
  code *pcVar14;
  undefined1 *puVar15;
  undefined uVar16;
  long *local_64;
  long *local_60;
  long *local_5c;
  int local_58;
  undefined1 *local_54;
  void *local_50;
  undefined4 local_4c;
  undefined4 *local_48;
  undefined4 uStack_44;
  undefined4 uStack_40;
  int local_3c [3];
  char *pcStack_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  char *pcStack_24;
  int iStack_20;
  undefined4 uStack_1c;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a3e2;
  local_c = ExceptionList;
  uVar4 = DAT_0044a01c ^ (uint)&stack0xffffff84;
  ExceptionList = &local_c;
  puVar15 = (undefined1 *)0x0;
  local_54 = (undefined1 *)0x0;
  local_4c = 0;
  local_50 = (void *)0x0;
  local_60 = (long *)0x0;
  local_58 = 0;
  local_5c = (long *)0x0;
  local_4._0_1_ = 1;
  local_4._1_3_ = 0;
  FUN_0041b630(this,local_3c);
  plVar5 = (long *)(param_1 + 0x40);
  local_4._0_1_ = 2;
  cVar2 = '\0';
  iVar13 = 1;
  do {
    local_64 = plVar5;
    ppvVar6 = (void **)FUN_0041b2a0(&local_48,"IO/SensorChannel%d");
    local_4._0_1_ = 3;
    if ((undefined1 *)*ppvVar6 != puVar15) {
      FUN_0041b310();
      puVar15 = local_54;
      memcpy(local_54,*ppvVar6,(size_t)ppvVar6[1]);
      local_50 = ppvVar6[1];
      *(undefined *)((int)local_50 + (int)puVar15) = 0;
      plVar5 = local_64;
    }
    local_4._0_1_ = 2;
    if (local_48 != (undefined4 *)0x0) {
      free(local_48);
    }
    uVar7 = FUN_0041bff0(local_3c,(char *)&local_54,plVar5);
    if ((char)uVar7 == '\0') {
      FUN_0041a1d0("IOManager: Missing or wrong configuration parameter (IO/SensorChannel%d) assuming -1"
                   ,(char)iVar13);
      *plVar5 = -1;
    }
    else {
      iVar1 = *plVar5;
      if (((iVar1 < 0) || (1 < iVar1)) && (iVar1 != -1)) {
        FUN_0041a1f0("IOManager: Invalid configuration parameter (IO/SensorChannel%d=%d)",
                     cVar2 + '\x01');
        local_4 = CONCAT31(local_4._1_3_,1);
        puVar8 = (undefined1 *)FUN_00402ab0();
        local_4 = 0xffffffff;
        if (puVar15 != (undefined1 *)0x0) {
          free(puVar15);
        }
        goto LAB_00403552;
      }
    }
    uVar16 = (undefined)uVar4;
    cVar2 = cVar2 + '\x01';
    plVar5 = plVar5 + 1;
    iVar13 = iVar13 + 1;
  } while (iVar13 < 3);
  local_64 = plVar5;
  FUN_0041a1b0("IOManager: Sensor channels are (%d,%d)",(char)*(undefined4 *)(param_1 + 0x40));
  *(undefined2 *)(param_1 + 0x50) = 0;
  local_48 = (undefined4 *)0x0;
  uStack_40 = 0;
  uStack_44 = 0;
  FUN_0041b310();
  puVar3 = local_48;
  *local_48 = 0x552f4f49;
  local_48[1] = 0x49646573;
  local_48[2] = 0x7475706e;
  *(undefined *)(local_48 + 3) = 0x73;
  uStack_44 = 0xd;
  *(undefined *)((int)local_48 + 0xd) = 0;
  local_4._0_1_ = 4;
  uVar7 = FUN_0041bbf0(&local_48,(int)local_3c,&local_54);
  pcVar14 = free_exref;
  local_4._0_1_ = 2;
  free(puVar3);
  if ((char)uVar7 == '\0') {
    FUN_0041a1f0("IOManager: Missing or wrong configuration parameter (IO/UsedInputs), assuming \"none\""
                 ,uVar16);
  }
  else {
    local_48 = (undefined4 *)0x0;
    uStack_40 = 0;
    uStack_44 = 0;
    FUN_0041b310();
    puVar3 = local_48;
    *(undefined *)local_48 = 0x2c;
    uStack_44 = 1;
    *(undefined *)((int)local_48 + 1) = 0;
    pcStack_30 = (char *)0x0;
    uStack_28 = 0;
    uStack_2c = 0;
    pcStack_24 = (char *)0x0;
    uStack_1c = 0;
    iStack_20 = 0;
    local_4._0_1_ = 7;
    FUN_0041cb50(&local_54,&local_48);
    local_4._0_1_ = 9;
    free(puVar3);
    while( true ) {
      _Control = pcStack_30;
      if (pcStack_30 == (char *)0x0) {
        _Control = &DAT_0044d0d5;
      }
      if (((iStack_20 < 1) || (sVar9 = strspn(pcStack_24,_Control), iStack_20 <= (int)sVar9)) ||
         (sVar9 == 0xffffffff)) break;
      pplVar10 = (long **)FUN_0041cc10(&pcStack_30,(char **)&local_48);
      local_4._0_1_ = 10;
      plVar5 = local_60;
      if (*pplVar10 != local_60) {
        plVar5 = pplVar10[1];
        if (local_58 <= (int)plVar5) {
          if (local_60 == (long *)0x0) {
            uVar4 = (uint)plVar5 & 0x8000001f;
            if ((int)uVar4 < 0) {
              uVar4 = (uVar4 - 1 | 0xffffffe0) + 1;
            }
            iVar13 = (int)plVar5 - uVar4;
            local_60 = (long *)malloc(iVar13 + 0x21);
          }
          else {
            uVar4 = (uint)plVar5 & 0x8000001f;
            if ((int)uVar4 < 0) {
              uVar4 = (uVar4 - 1 | 0xffffffe0) + 1;
            }
            iVar13 = (int)plVar5 - uVar4;
            local_60 = (long *)realloc(local_60,iVar13 + 0x21);
          }
          local_58 = iVar13 + 0x20;
          *(char *)((int)plVar5 + (int)local_60) = '\0';
        }
        plVar5 = local_60;
        memcpy(local_60,*pplVar10,(size_t)pplVar10[1]);
        local_5c = pplVar10[1];
        *(char *)((int)local_5c + (int)plVar5) = '\0';
      }
      local_4._0_1_ = 9;
      if (local_48 != (undefined4 *)0x0) {
        free(local_48);
      }
      plVar12 = (long *)&DAT_0044d0d5;
      if (plVar5 != (long *)0x0) {
        plVar12 = plVar5;
      }
      lVar11 = strtol((char *)plVar12,(char **)&local_64,10);
      pcVar14 = free_exref;
      if ((*(char *)local_64 != '\0') || (local_64 == plVar12)) {
        plVar12 = (long *)&DAT_0044d0d5;
        if (plVar5 != (long *)0x0) {
          plVar12 = plVar5;
        }
        FUN_0041a1f0("IOManager: Invalid configuration parameter (IO/UsedInputs=%s)",(char)plVar12);
        local_4._0_1_ = 2;
        FUN_004037f0(&pcStack_30);
        local_4._0_1_ = 1;
        FUN_00402ab0();
        local_4 = (uint)local_4._1_3_ << 8;
        if (plVar5 != (long *)0x0) {
          free(plVar5);
        }
        local_4 = 0xffffffff;
        puVar8 = local_54;
        if (local_54 != (undefined1 *)0x0) {
          free(local_54);
          ExceptionList = local_c;
          return (uint)local_54 & 0xffffff00;
        }
LAB_00403552:
        ExceptionList = local_c;
        return (uint)puVar8 & 0xffffff00;
      }
      *(undefined *)(param_1 + 0x50 + lVar11) = 1;
    }
    local_4._0_1_ = 2;
    FUN_004037f0(&pcStack_30);
  }
  puVar15 = local_54;
  puVar8 = &DAT_0044d0d5;
  if (local_54 != (undefined1 *)0x0) {
    puVar8 = local_54;
  }
  FUN_0041a1b0("IOManager: Used inputs are(%s)",(char)puVar8);
  local_4._0_1_ = 1;
  FUN_00402ab0();
  local_4 = (uint)local_4._1_3_ << 8;
  plVar5 = local_60;
  if (local_60 != (long *)0x0) {
    plVar5 = (long *)(*pcVar14)(local_60);
  }
  local_4 = 0xffffffff;
  if (puVar15 != (undefined1 *)0x0) {
    plVar5 = (long *)(*pcVar14)(puVar15);
  }
  ExceptionList = local_c;
  return CONCAT31((int3)((uint)plVar5 >> 8),1);
}



void FUN_004037f0(void **param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00437f38;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  if (param_1[3] != (void *)0x0) {
    free(param_1[3]);
  }
  local_4 = 0xffffffff;
  if (*param_1 != (void *)0x0) {
    free(*param_1);
  }
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_00403860(int param_1)

{
  char cVar1;
  int iVar2;
  DWORD DVar3;
  uint uVar4;
  code *pcVar5;
  undefined4 unaff_EDI;
  undefined uVar6;
  undefined4 uStack_8;
  uint uStack_4;
  
  DVar3 = GetCurrentThreadId();
  FUN_0041a190("IOMananger: Body(%ld) begin",(char)DVar3);
  *(undefined *)(param_1 + 0x35) = 1;
  FUN_0041c150();
  uVar6 = (undefined)unaff_EDI;
  cVar1 = *(char *)(param_1 + 4);
  do {
    if (cVar1 != '\0') {
      FUN_0041a190("IOMananger: Body() end",uVar6);
      return;
    }
    iVar2 = *(int *)(param_1 + 0x4c);
    uVar4 = FUN_00402e40(&uStack_8,iVar2,&uStack_4,&uStack_8);
    if ((char)uVar4 == '\0') {
      uVar4 = FUN_0040cc90();
      if (uVar4 != 0) {
        if (*(int *)(uVar4 + 0xc) == 0) {
          *(uint *)(iVar2 + 0xc) = *(uint *)(iVar2 + 0xc) & 0xfffffffe;
        }
        else {
          *(uint *)(iVar2 + 0xc) = *(uint *)(iVar2 + 0xc) | 1;
        }
        if (*(int *)(uVar4 + 0x10) == 0) {
          *(uint *)(iVar2 + 0xc) = *(uint *)(iVar2 + 0xc) & 0xfffffffd;
        }
        else {
          *(uint *)(iVar2 + 0xc) = *(uint *)(iVar2 + 0xc) | 2;
        }
        uVar4 = FUN_00402e40(&uStack_4,iVar2,&uStack_4,&uStack_8);
        if ((char)uVar4 != '\0') goto LAB_004038f0;
      }
    }
    else {
LAB_004038f0:
      uVar6 = (undefined)unaff_EDI;
      if (*(uint *)(param_1 + 0x40) == uStack_4) {
        if (*(undefined4 **)(param_1 + 0x48) == (undefined4 *)0x0) {
          FUN_0041a1d0("IOManager: There is no event handler installed.",uVar6);
        }
        else {
          (**(code **)**(undefined4 **)(param_1 + 0x48))(0,uStack_8);
        }
      }
      else if (*(uint *)(param_1 + 0x44) == uStack_4) {
        if (*(undefined4 **)(param_1 + 0x48) == (undefined4 *)0x0) {
          FUN_0041a1d0("IOManager: There is no event handler installed.",uVar6);
        }
        else {
          pcVar5 = *(code **)**(undefined4 **)(param_1 + 0x48);
          uVar4 = 1;
LAB_0040396e:
          (*pcVar5)(uVar4,uStack_8);
        }
      }
      else if (*(char *)(uStack_4 + 0x50 + param_1) != '\0') {
        if (*(int **)(param_1 + 0x48) != (int *)0x0) {
          pcVar5 = *(code **)(**(int **)(param_1 + 0x48) + 4);
          uVar4 = uStack_4;
          goto LAB_0040396e;
        }
        FUN_0041a1d0("IOManager: There is no event handler installed.",uVar6);
      }
    }
    FUN_004039a0();
    uVar6 = (undefined)unaff_EDI;
    cVar1 = *(char *)(param_1 + 4);
  } while( true );
}



void FUN_004039a0(void)

{
  char cVar1;
  byte bVar2;
  DWORD DVar3;
  int *piVar4;
  int unaff_EDI;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439178;
  local_c = ExceptionList;
  bVar2 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffe4;
  ExceptionList = &local_c;
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)(unaff_EDI + 0x58) == DVar3) {
    *(int *)(unaff_EDI + 0x5c) = *(int *)(unaff_EDI + 0x5c) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(unaff_EDI + 0x60));
    *(undefined4 *)(unaff_EDI + 0x5c) = 1;
    DVar3 = GetCurrentThreadId();
    *(DWORD *)(unaff_EDI + 0x58) = DVar3;
  }
  local_4 = 0;
  piVar4 = FUN_0040cd20();
  cVar1 = *(char *)((int)piVar4 + 0xf1);
  if (cVar1 != *(char *)(unaff_EDI + 0x52)) {
    *(char *)(unaff_EDI + 0x52) = cVar1;
    if (*(int **)(unaff_EDI + 0x48) == (int *)0x0) {
      FUN_0041a1d0("IOManager: There is no event handler installed.",bVar2);
    }
    else {
      (**(code **)(**(int **)(unaff_EDI + 0x48) + 8))(cVar1);
    }
  }
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)(unaff_EDI + 0x58) == DVar3) {
    piVar4 = (int *)(unaff_EDI + 0x5c);
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      *(undefined4 *)(unaff_EDI + 0x58) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(unaff_EDI + 0x60));
    }
  }
  ExceptionList = local_c;
  return;
}



undefined4 * __fastcall FUN_00403a70(undefined4 *param_1)

{
  FUN_0041ce60(param_1);
  return param_1;
}



void FUN_00403a80(void)

{
  undefined *puVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  DWORD DVar5;
  undefined4 *puVar6;
  undefined1 *puVar7;
  int iVar8;
  void *apvStack_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 uStack_4;
  
  iVar8 = DAT_0044c6b0;
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_0043a178;
  local_c = ExceptionList;
  uVar4 = DAT_0044a01c ^ (uint)&stack0xffffffdc;
  ExceptionList = &local_c;
  puVar1 = (undefined *)(DAT_0044c6b0 + 0x6c);
  if (*(char *)(DAT_0044c6b0 + 0x6c) != '\x01') {
    FUN_0041c210();
    DVar5 = timeGetTime();
    *(DWORD *)(iVar8 + 0x70) = DVar5;
    *puVar1 = 1;
  }
  DAT_0044d0d4 = 1;
  iVar8 = 0x1e;
  do {
    puVar6 = FUN_0041b2a0(apvStack_18,"Simulation will resume in %d second%s");
    uStack_4 = 0;
    puVar7 = (undefined1 *)*puVar6;
    if (puVar7 == (undefined1 *)0x0) {
      puVar7 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar7,(char)uVar4);
    uStack_4 = 0xffffffff;
    if (apvStack_18[0] != (void *)0x0) {
      free(apvStack_18[0]);
    }
    Sleep(1000);
    iVar3 = DAT_0044c6b0;
    iVar8 = iVar8 + -1;
  } while (iVar8 != 0);
  puVar1 = (undefined *)(DAT_0044c6b0 + 0x6c);
  if (*(char *)(DAT_0044c6b0 + 0x6c) != '\0') {
    DVar5 = timeGetTime();
    iVar8 = *(int *)(iVar3 + 0x70);
    if (iVar8 < (int)DVar5) {
      piVar2 = (int *)(iVar3 + 4);
      *piVar2 = *piVar2 + (DVar5 - iVar8);
    }
    FUN_0041c150();
    *puVar1 = 0;
  }
  DAT_0044d0d4 = 0;
  ExceptionList = local_c;
  return;
}



void FUN_00403b90(void)

{
  undefined4 *unaff_EBX;
  undefined local_10c [260];
  uint local_8;
  
  local_8 = DAT_0044a01c ^ (uint)local_10c;
  FUN_0041c840("Description");
  printf("%s\n",local_10c);
  FUN_0041c840("Copyright");
  printf("Copyright %s\n\n",local_10c);
  printf("Usage: %s <configFile> <defaultsFile> <passwordFile> <logFile> <simulationFolder> <persistenceFolder>\n"
         ,*unaff_EBX);
  printf("Where:\n");
  printf("\t<configFile>        configuration file containing current configuration.\n");
  printf("\t<defaultsFile>      configuration file containing default configuration.\n");
  printf("\t<passwordFile>      text file containing configuration password.\n");
  printf("\t<logFile>           name of the file to record log information.\n");
  printf("\t<simulationFolder>  folder with simulation data.\n");
  printf("\t<persistenceFolder> folder with simulation recognitions.\n");
  ___security_check_cookie_4(local_8 ^ (uint)local_10c);
  return;
}



void __cdecl FUN_00403c50(int param_1,undefined *param_2)

{
  undefined4 uVar1;
  void **ppvVar2;
  uint uVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  char *pcVar4;
  char *pcVar5;
  size_t sVar6;
  void *pvVar7;
  undefined4 *puVar8;
  char *pcVar9;
  char *pcVar10;
  void *pvVar11;
  undefined *puVar12;
  undefined auStack_5dc [4];
  undefined *local_5d8;
  char *local_5d4;
  void *local_5d0;
  undefined4 local_5cc;
  void *local_5c8;
  char *local_5bc;
  void *local_5b8;
  undefined4 local_5b4;
  char *local_5b0;
  void *local_5ac;
  undefined4 local_5a8;
  char *local_5a4;
  void *local_5a0;
  undefined4 local_59c;
  char *local_598;
  void *local_594;
  undefined4 local_590;
  char *local_58c;
  void *local_588;
  undefined4 local_584;
  undefined *puStack_580;
  undefined *puStack_57c;
  undefined4 auStack_578 [20];
  undefined4 local_528 [82];
  undefined4 local_3e0 [218];
  int iStack_78;
  uint local_1c;
  void *local_14;
  undefined *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_0043a9c4;
  local_14 = ExceptionList;
  local_1c = DAT_0044a01c ^ (uint)auStack_5dc;
  ExceptionList = &local_14;
  local_5d8 = param_2;
  FUN_00409240(local_3e0);
  local_5d4 = (char *)0x0;
  local_5cc = 0;
  local_5d0 = (void *)0x0;
  local_598 = (char *)0x0;
  local_590 = 0;
  local_594 = (void *)0x0;
  local_5bc = (char *)0x0;
  local_5b4 = 0;
  local_5b8 = (void *)0x0;
  local_5b0 = (char *)0x0;
  local_5a8 = 0;
  local_5ac = (void *)0x0;
  local_5a4 = (char *)0x0;
  local_59c = 0;
  local_5a0 = (void *)0x0;
  local_58c = (char *)0x0;
  local_584 = 0;
  local_588 = (void *)0x0;
  local_c._0_1_ = 6;
  local_c._1_3_ = 0;
  FUN_0041e930(local_528);
  local_c._0_1_ = 7;
  FUN_0041c780("Company","Quercus Technologies");
  pcVar10 = "2002-2015 Quercus Technologies";
  pcVar9 = "Copyright";
  FUN_0041c780("Copyright","2002-2015 Quercus Technologies");
  FUN_0041c780("File name","AccessSimu");
  FUN_0041c780("File version","4.1.0");
  pcVar5 = "SmartLPR Access";
  FUN_0041c780("Product name","SmartLPR Access");
  FUN_0041c780("Product version","4.1.0");
  FUN_0041c780("Description","SmartLPR Access Remote Unit Simulator");
  FUN_0041c780("Build",&DAT_0043bf24);
  uVar1 = FUN_0041c9d0(param_1);
  if ((char)uVar1 == '\0') {
    if (param_1 == 7) {
      ppvVar2 = (void **)FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,*(char **)(param_2 + 4));
      local_c._0_1_ = 8;
      uVar1 = extraout_ECX_00;
      if (*ppvVar2 != (void *)0x0) {
        FUN_0041b310();
        pcVar4 = local_5d4;
        pcVar9 = (char *)0x403e51;
        pcVar10 = local_5d4;
        memcpy(local_5d4,*ppvVar2,(size_t)ppvVar2[1]);
        local_5d0 = ppvVar2[1];
        *(char *)((int)local_5d0 + (int)pcVar4) = '\0';
        uVar1 = extraout_ECX_01;
        param_2 = local_5d8;
      }
      local_c._0_1_ = 7;
      if (local_5c8 != (void *)0x0) {
        free(local_5c8);
        uVar1 = extraout_ECX_02;
      }
      ppvVar2 = (void **)FUN_0041aa80(uVar1,(char *)0x7fffffff,*(char **)(param_2 + 8));
      local_c._0_1_ = 9;
      uVar1 = extraout_ECX_03;
      if (*ppvVar2 != (void *)0x0) {
        FUN_0041b310();
        pcVar4 = local_598;
        pcVar9 = (char *)0x403ebb;
        pcVar10 = local_598;
        memcpy(local_598,*ppvVar2,(size_t)ppvVar2[1]);
        local_594 = ppvVar2[1];
        *(char *)((int)local_594 + (int)pcVar4) = '\0';
        uVar1 = extraout_ECX_04;
      }
      local_c._0_1_ = 7;
      if (local_5c8 != (void *)0x0) {
        free(local_5c8);
        uVar1 = extraout_ECX_05;
      }
      ppvVar2 = (void **)FUN_0041aa80(uVar1,(char *)0x7fffffff,*(char **)(local_5d8 + 0xc));
      local_c._0_1_ = 10;
      if (*ppvVar2 != (void *)0x0) {
        FUN_0041b310();
        pcVar4 = local_5bc;
        pcVar9 = (char *)0x403f25;
        pcVar10 = local_5bc;
        memcpy(local_5bc,*ppvVar2,(size_t)ppvVar2[1]);
        local_5b8 = ppvVar2[1];
        *(char *)((int)local_5b8 + (int)pcVar4) = '\0';
      }
      local_c._0_1_ = 7;
      if (local_5c8 != (void *)0x0) {
        free(local_5c8);
      }
      ppvVar2 = (void **)FUN_0041aa80(*(undefined4 *)(local_5d8 + 0x10),(char *)0x7fffffff,
                                      (char *)*(undefined4 *)(local_5d8 + 0x10));
      local_c._0_1_ = 0xb;
      if (*ppvVar2 != (void *)0x0) {
        FUN_0041b310();
        pcVar4 = local_5b0;
        pcVar9 = (char *)0x403f8f;
        pcVar10 = local_5b0;
        memcpy(local_5b0,*ppvVar2,(size_t)ppvVar2[1]);
        local_5ac = ppvVar2[1];
        *(char *)((int)local_5ac + (int)pcVar4) = '\0';
      }
      local_c._0_1_ = 7;
      if (local_5c8 != (void *)0x0) {
        free(local_5c8);
      }
      ppvVar2 = (void **)FUN_0041aa80(local_5d8,(char *)0x7fffffff,*(char **)(local_5d8 + 0x14));
      local_c._0_1_ = 0xc;
      uVar1 = extraout_ECX_06;
      if (*ppvVar2 != (void *)0x0) {
        FUN_0041b310();
        pcVar4 = local_5a4;
        pcVar9 = (char *)0x403ff9;
        pcVar10 = local_5a4;
        memcpy(local_5a4,*ppvVar2,(size_t)ppvVar2[1]);
        local_5a0 = ppvVar2[1];
        *(char *)((int)local_5a0 + (int)pcVar4) = '\0';
        uVar1 = extraout_ECX_07;
      }
      local_c._0_1_ = 7;
      if (local_5c8 != (void *)0x0) {
        free(local_5c8);
        uVar1 = extraout_ECX_08;
      }
      pvVar11 = (void *)0x404037;
      ppvVar2 = (void **)FUN_0041aa80(uVar1,(char *)0x7fffffff,*(char **)(local_5d8 + 0x18));
      local_c._0_1_ = 0xd;
      pcVar4 = local_58c;
      if (*ppvVar2 != (void *)0x0) {
        FUN_0041b310();
        pcVar4 = local_58c;
        pvVar11 = *ppvVar2;
        pcVar9 = (char *)0x404063;
        pcVar10 = local_58c;
        memcpy(local_58c,pvVar11,(size_t)ppvVar2[1]);
        local_588 = ppvVar2[1];
        *(char *)((int)local_588 + (int)pcVar4) = '\0';
      }
      local_c._0_1_ = 7;
      if (local_5c8 != (void *)0x0) {
        pvVar11 = (void *)0x404090;
        free(local_5c8);
      }
      uVar1 = 10000000;
      local_5d8 = &stack0xfffffa04;
      FUN_0041aa30((void **)&stack0xfffffa04);
      puVar8 = auStack_578;
      pvVar7 = (void *)0x4040b7;
      FUN_00419360(puVar8,pcVar9,(size_t)pcVar10,pvVar11,uVar1);
      local_c._0_1_ = 0xe;
      puVar12 = (undefined *)0x4040c9;
      local_5d8 = (undefined *)operator_new(0x188);
      local_c._0_1_ = 0xf;
      if (local_5d8 == (undefined *)0x0) {
        DAT_0044c6b0 = (void *)0x0;
      }
      else {
        puVar12 = (undefined *)0x4040e2;
        DAT_0044c6b0 = (void *)FUN_00404560((int)local_5d8);
      }
      local_c._0_1_ = 0xe;
      local_5d8 = &stack0xfffffa08;
      FUN_0041aa30((void **)&stack0xfffffa08);
      uVar1 = FUN_0040c450(pcVar10,(size_t)puVar12);
      if ((char)uVar1 == '\0') {
        local_c._0_1_ = 7;
        FUN_004194b0(auStack_578);
        local_c._0_1_ = 6;
        FUN_0041eaa0(local_528);
        local_c._0_1_ = 5;
        if (pcVar4 != (char *)0x0) {
          free(pcVar4);
        }
        local_c._0_1_ = 4;
        if (local_5a4 != (char *)0x0) {
          free(local_5a4);
        }
        local_c._0_1_ = 3;
        if (local_5b0 != (char *)0x0) {
          free(local_5b0);
        }
        local_c._0_1_ = 2;
        if (local_5bc != (char *)0x0) {
          free(local_5bc);
        }
        local_c._0_1_ = 1;
        if (local_598 != (char *)0x0) {
          free(local_598);
        }
        local_c = (uint)local_c._1_3_ << 8;
        if (local_5d4 != (char *)0x0) {
          free(local_5d4);
        }
        local_c = 0xffffffff;
        FUN_00409460(local_3e0);
      }
      else {
        pvVar11 = (void *)0x4041ea;
        local_5d8 = &stack0xfffffa08;
        FUN_0041aa30((void **)&stack0xfffffa08);
        puStack_580 = &stack0xfffff9fc;
        local_c._0_1_ = 0x10;
        FUN_0041aa30((void **)&stack0xfffff9fc);
        local_c._0_1_ = 0xe;
        sVar6 = 0x40421c;
        uVar3 = FUN_004095d0(local_3e0,pvVar7,puVar8,pvVar11,pcVar10,puVar12);
        if ((char)uVar3 == '\0') {
          local_c._0_1_ = 7;
          FUN_004194b0(auStack_578);
          local_c._0_1_ = 6;
          FUN_0041eaa0(local_528);
          local_c._0_1_ = 5;
          if (pcVar4 != (char *)0x0) {
            free(pcVar4);
          }
          local_c._0_1_ = 4;
          if (local_5a4 != (char *)0x0) {
            free(local_5a4);
          }
          local_c._0_1_ = 3;
          if (local_5b0 != (char *)0x0) {
            free(local_5b0);
          }
          local_c._0_1_ = 2;
          if (local_5bc != (char *)0x0) {
            free(local_5bc);
          }
          local_c._0_1_ = 1;
          if (local_598 != (char *)0x0) {
            free(local_598);
          }
          local_c = (uint)local_c._1_3_ << 8;
          if (local_5d4 != (char *)0x0) {
            free(local_5d4);
          }
          local_c = 0xffffffff;
          FUN_00409460(local_3e0);
        }
        else {
          pvVar11 = (void *)0x4042fc;
          puStack_580 = &stack0xfffffa08;
          FUN_0041aa30((void **)&stack0xfffffa08);
          local_5d8 = &stack0xfffff9fc;
          local_c._0_1_ = 0x11;
          uVar1 = 0x404316;
          FUN_0041aa30((void **)&stack0xfffff9fc);
          puStack_57c = &stack0xfffff9f0;
          local_c._0_1_ = 0x12;
          FUN_0041aa30((void **)&stack0xfffff9f0);
          local_c = CONCAT31(local_c._1_3_,0xe);
          uVar1 = FUN_0041ebd0((int)local_528,pcVar5,sVar6,uVar1,pvVar7,(size_t)puVar8,pvVar11,
                               pcVar10,(size_t)puVar12);
          if ((char)uVar1 == '\0') {
            FUN_0040cbb0();
            pvVar11 = DAT_0044c6b0;
            if (DAT_0044c6b0 != (void *)0x0) {
              FUN_00404610((int)DAT_0044c6b0);
              operator_delete(pvVar11);
            }
            local_c._0_1_ = 7;
            FUN_004194b0(auStack_578);
            local_c._0_1_ = 6;
            FUN_0041eaa0(local_528);
            local_c._0_1_ = 5;
            if (pcVar4 != (char *)0x0) {
              free(pcVar4);
            }
            local_c._0_1_ = 4;
            if (local_5a4 != (char *)0x0) {
              free(local_5a4);
            }
            local_c._0_1_ = 3;
            if (local_5b0 != (char *)0x0) {
              free(local_5b0);
            }
            local_c._0_1_ = 2;
            if (local_5bc != (char *)0x0) {
              free(local_5bc);
            }
            local_c._0_1_ = 1;
            if (local_598 != (char *)0x0) {
              free(local_598);
            }
            local_c = (uint)local_c._1_3_ << 8;
            if (local_5d4 != (char *)0x0) {
              free(local_5d4);
            }
            local_c = 0xffffffff;
            FUN_00409460(local_3e0);
          }
          else {
            (**(code **)(iStack_78 + 0x10))();
            FUN_0041ef90();
            FUN_0040cbb0();
            pvVar11 = DAT_0044c6b0;
            if (DAT_0044c6b0 != (void *)0x0) {
              FUN_00404610((int)DAT_0044c6b0);
              operator_delete(pvVar11);
            }
            local_c._0_1_ = 7;
            FUN_004194b0(auStack_578);
            local_c._0_1_ = 6;
            FUN_0041eaa0(local_528);
            local_c._0_1_ = 5;
            if (pcVar4 != (char *)0x0) {
              free(pcVar4);
            }
            local_c._0_1_ = 4;
            if (local_5a4 != (char *)0x0) {
              free(local_5a4);
            }
            local_c._0_1_ = 3;
            if (local_5b0 != (char *)0x0) {
              free(local_5b0);
            }
            local_c._0_1_ = 2;
            if (local_5bc != (char *)0x0) {
              free(local_5bc);
            }
            local_c._0_1_ = 1;
            if (local_598 != (char *)0x0) {
              free(local_598);
            }
            local_c = (uint)local_c._1_3_ << 8;
            if (local_5d4 != (char *)0x0) {
              free(local_5d4);
            }
            local_c = 0xffffffff;
            FUN_00409460(local_3e0);
          }
        }
      }
    }
    else {
      FUN_00403b90();
      local_c = CONCAT31(local_c._1_3_,6);
      FUN_0041eaa0(local_528);
      local_c = 0xffffffff;
      FUN_00409460(local_3e0);
    }
  }
  else {
    local_c = CONCAT31(local_c._1_3_,6);
    FUN_0041eaa0(local_528);
    local_c = 0xffffffff;
    FUN_00409460(local_3e0);
  }
  ExceptionList = local_14;
  ___security_check_cookie_4(local_1c ^ (uint)auStack_5dc);
  return;
}



int FUN_00404560(int param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438fc1;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x14) = 0;
  local_4 = 0;
  FUN_0041db50();
  *(undefined ***)(param_1 + 0x1c) = aCondition::vftable;
  *(undefined *)(param_1 + 0x40) = 0;
  FUN_0041db50();
  *(undefined ***)(param_1 + 0x44) = aCondition::vftable;
  *(undefined *)(param_1 + 0x68) = 0;
  local_4 = CONCAT31(local_4._1_3_,2);
  *(undefined ***)(param_1 + 0x78) = CSimulationState::vftable;
  FUN_00410260((undefined4 *)(param_1 + 0x90),0,0);
  *(undefined4 *)(param_1 + 0x170) = 0;
  *(undefined4 *)(param_1 + 0x178) = 0;
  *(undefined4 *)(param_1 + 0x17c) = 0;
  *(undefined4 *)(param_1 + 0x180) = 0;
  ExceptionList = local_c;
  return param_1;
}



void FUN_00404610(int param_1)

{
  undefined4 *puVar1;
  void **ppvVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438f81;
  local_c = ExceptionList;
  local_4 = 2;
  if (*(int *)(param_1 + 0x178) < 2) {
    ExceptionList = &local_c;
    if (*(int *)(param_1 + 0x178) == 0) goto LAB_0040467c;
  }
  else {
    ppvVar2 = &local_c;
    for (puVar1 = (undefined4 *)**(undefined4 **)(param_1 + 0x17c); ExceptionList = ppvVar2,
        puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)*puVar1) {
      operator_delete((void *)puVar1[1]);
      ppvVar2 = (void **)ExceptionList;
    }
  }
  operator_delete(*(void **)(param_1 + 0x180));
LAB_0040467c:
  FUN_0040c3d0((undefined4 *)(param_1 + 0x78));
  *(undefined ***)(param_1 + 0x44) = aSyncObj::vftable;
  *(undefined ***)(param_1 + 0x4c) = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  *(undefined ***)(param_1 + 0x1c) = aSyncObj::vftable;
  *(undefined ***)(param_1 + 0x24) = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  local_4 = 0xffffffff;
  if (*(void **)(param_1 + 0x10) != (void *)0x0) {
    free(*(void **)(param_1 + 0x10));
  }
  ExceptionList = local_c;
  return;
}



undefined4 * FUN_004046e0(undefined4 *param_1)

{
  *param_1 = ITimerEH::vftable;
  param_1[1] = aThread::vftable;
  FUN_0041db50();
  param_1[3] = aCondition::vftable;
  *(undefined *)(param_1 + 0xc) = 0;
  *param_1 = CPhotoProcessor::vftable;
  param_1[1] = CPhotoProcessor::vftable;
  param_1[0x11] = aCriticalSection::vftable;
  param_1[0x12] = 0xffffffff;
  param_1[0x13] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x14));
  param_1[0x1a] = aCollection<int,class_CDibRef*>::vftable;
  param_1[0x1b] = aMap<int,class_CDibRef*>::vftable;
  param_1[0x1c] = 0;
  param_1[0x1e] = 0;
  param_1[0x1f] = 0;
  param_1[0x20] = 0;
  param_1[0x1d] = 0x11;
  param_1[0x21] = 10;
  param_1[0x22] = 0;
  param_1[0x23] = 0;
  param_1[0x24] = 0;
  param_1[0x25] = aCollection<int,class_CPlateResult*>::vftable;
  param_1[0x26] = aMap<int,class_CPlateResult*>::vftable;
  param_1[0x28] = 0x11;
  param_1[0x27] = 0;
  param_1[0x29] = 0;
  param_1[0x2a] = 0;
  param_1[0x2b] = 0;
  param_1[0x2c] = 10;
  param_1[0x2d] = 0;
  param_1[0x2e] = 0;
  param_1[0x2f] = 0;
  param_1[0x30] = aCriticalSection::vftable;
  param_1[0x31] = 0xffffffff;
  param_1[0x32] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x33));
  FUN_0041d320();
  FUN_0041db50();
  *(undefined *)(param_1 + 0x6f) = 0;
  param_1[0x66] = aCondition::vftable;
  return param_1;
}



undefined4 * __thiscall FUN_00404810(void *this,byte param_1)

{
  FUN_00404830((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_00404830(undefined4 *param_1)

{
  *param_1 = CPhotoProcessor::vftable;
  param_1[1] = CPhotoProcessor::vftable;
  param_1[0x66] = aSyncObj::vftable;
  param_1[0x68] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  param_1[0x3b] = aTimer::vftable;
  param_1[0x55] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x58));
  param_1[0x4a] = aSyncObj::vftable;
  param_1[0x4c] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  param_1[0x3b] = aThread::vftable;
  param_1[0x3d] = aSyncObj::vftable;
  param_1[0x3f] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  param_1[0x30] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x33));
  FUN_00405df0(param_1 + 0x25);
  FUN_00405cf0(param_1 + 0x1a);
  param_1[0x11] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x14));
  param_1[1] = aThread::vftable;
  param_1[3] = aSyncObj::vftable;
  param_1[5] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  return;
}



undefined FUN_00404920(void)

{
  int *piVar1;
  undefined uVar2;
  int in_EAX;
  DWORD DVar3;
  
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)(in_EAX + 0x48) == DVar3) {
    *(int *)(in_EAX + 0x4c) = *(int *)(in_EAX + 0x4c) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(in_EAX + 0x50));
    *(undefined4 *)(in_EAX + 0x4c) = 1;
    DVar3 = GetCurrentThreadId();
    *(DWORD *)(in_EAX + 0x48) = DVar3;
  }
  if (-1 < *(int *)(in_EAX + 0xe4)) {
    DVar3 = GetCurrentThreadId();
    if (*(DWORD *)(in_EAX + 0x48) == DVar3) {
      piVar1 = (int *)(in_EAX + 0x4c);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        *(undefined4 *)(in_EAX + 0x48) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)(in_EAX + 0x50));
      }
    }
    return 1;
  }
  uVar2 = *(undefined *)(in_EAX + 0x40);
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)(in_EAX + 0x48) == DVar3) {
    piVar1 = (int *)(in_EAX + 0x4c);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(in_EAX + 0x48) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(in_EAX + 0x50));
    }
  }
  return uVar2;
}



undefined4 FUN_004049a0(DWORD param_1)

{
  int in_EAX;
  undefined4 *puVar1;
  HANDLE pvVar2;
  undefined4 uVar3;
  undefined1 unaff_DI;
  undefined uVar4;
  
  FUN_0041a190("PhotoProcessor: Initialize() begin",unaff_DI);
  puVar1 = (undefined4 *)operator_new(0x10);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    *puVar1 = CCamera::vftable;
  }
  *(undefined4 **)(in_EAX + 400) = puVar1;
  FUN_0041a190("Camera: Initialize() begin",unaff_DI);
  uVar4 = 0xa8;
  puVar1[1] = 0x400;
  puVar1[2] = 0x1e0;
  puVar1[3] = 8;
  FUN_0041a1b0("Camera: Image format is %dx%dx%d",0);
  FUN_0041a190("Camera: Initialize() end",uVar4);
  *(DWORD *)(in_EAX + 0x18c) = param_1;
  *(undefined4 *)(in_EAX + 0x194) = 0;
  *(undefined *)(in_EAX + 0x40) = 0;
  *(undefined4 *)(in_EAX + 0xe8) = 0xffffffff;
  *(undefined4 *)(in_EAX + 0xe4) = 0xffffffff;
  FUN_0041d440();
  *(undefined *)(in_EAX + 0x39) = 1;
  *(undefined4 *)(in_EAX + 0x34) = 0;
  *(undefined *)(in_EAX + 8) = 0;
  *(undefined *)(in_EAX + 0x38) = 0;
  FUN_0041c210();
  pvVar2 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,(LPTHREAD_START_ROUTINE)&LAB_0041c690,
                        (LPVOID)(in_EAX + 4),0,&param_1);
  *(HANDLE *)(in_EAX + 0x3c) = pvVar2;
  if (pvVar2 != (HANDLE)0x0) {
    (**(code **)(*(int *)(in_EAX + 0xc) + 0x10))(0xffffffff);
  }
  uVar3 = FUN_0041a190("PhotoProcessor: Initialize() end",unaff_DI);
  return CONCAT31((int3)((uint)uVar3 >> 8),1);
}



void __fastcall FUN_00404aa0(int param_1)

{
  int *piVar1;
  code *pcVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  DWORD DVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined uVar9;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00439690;
  local_10 = ExceptionList;
  uVar5 = DAT_0044a01c ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_0041a190("PhotoProcessor: Terminate() begin",(char)uVar5);
  local_8 = 0;
  FUN_0041c150();
  pcVar2 = *(code **)(*(int *)(param_1 + 4) + 4);
  *(undefined *)(param_1 + 8) = 1;
  (*pcVar2)();
  if (*(char *)(param_1 + 0x38) == '\0') {
    WaitForSingleObject(*(HANDLE *)(param_1 + 0x3c),0xffffffff);
    CloseHandle(*(HANDLE *)(param_1 + 0x3c));
  }
  if (*(int **)(param_1 + 0x194) != (int *)0x0) {
    (**(code **)(**(int **)(param_1 + 0x194) + 8))();
    *(undefined4 *)(param_1 + 0x194) = 0;
  }
  DVar6 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0xc4) == DVar6) {
    *(int *)(param_1 + 200) = *(int *)(param_1 + 200) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xcc));
    *(undefined4 *)(param_1 + 200) = 1;
    DVar6 = GetCurrentThreadId();
    *(DWORD *)(param_1 + 0xc4) = DVar6;
  }
  puVar7 = (undefined4 *)FUN_00405d90();
  puVar8 = (undefined4 *)*puVar7;
  iVar3 = puVar7[1];
  do {
    if (puVar8 == (undefined4 *)0x0) {
      while (puVar8 = *(undefined4 **)(param_1 + 0x8c), puVar8 != (undefined4 *)0x0) {
        *(undefined4 *)(param_1 + 0x8c) = *puVar8;
        operator_delete(puVar8);
      }
      *(undefined4 *)(param_1 + 0x88) = 0;
      *(undefined4 *)(param_1 + 0x8c) = 0;
      *(undefined4 *)(param_1 + 0x90) = 0;
      FUN_00406070();
      puVar7 = (undefined4 *)FUN_00405d90();
      puVar8 = (undefined4 *)*puVar7;
      iVar3 = puVar7[1];
      do {
        if (puVar8 == (undefined4 *)0x0) {
          while (uVar9 = (undefined)uVar5, puVar8 = *(undefined4 **)(param_1 + 0xb8),
                puVar8 != (undefined4 *)0x0) {
            *(undefined4 *)(param_1 + 0xb8) = *puVar8;
            operator_delete(puVar8);
          }
          *(undefined4 *)(param_1 + 0xb4) = 0;
          *(undefined4 *)(param_1 + 0xb8) = 0;
          *(undefined4 *)(param_1 + 0xbc) = 0;
          FUN_00406070();
          DVar6 = GetCurrentThreadId();
          if (*(DWORD *)(param_1 + 0xc4) == DVar6) {
            piVar1 = (int *)(param_1 + 200);
            *piVar1 = *piVar1 + -1;
            if (*piVar1 == 0) {
              *(undefined4 *)(param_1 + 0xc4) = 0xffffffff;
              LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xcc));
            }
          }
          FUN_00401020();
          if (*(undefined4 **)(param_1 + 400) != (undefined4 *)0x0) {
            (**(code **)**(undefined4 **)(param_1 + 400))(1);
          }
          local_8 = 0xffffffff;
          FUN_0041a190("PhotoProcessor: Terminate() end",uVar9);
          ExceptionList = local_10;
          return;
        }
        iVar4 = *(int *)(iVar3 + 4);
        if (iVar4 != 0) {
          for (puVar7 = *(undefined4 **)
                         (iVar4 + (((uint)puVar8[2] >> 4) % *(uint *)(iVar3 + 8)) * 4);
              puVar7 != (undefined4 *)0x0; puVar7 = (undefined4 *)*puVar7) {
            if (puVar7[2] == puVar8[2]) goto LAB_00404c3f;
          }
        }
        puVar7 = (undefined4 *)0x0;
LAB_00404c3f:
        (**(code **)(*(int *)puVar7[3] + 8))();
        puVar8 = (undefined4 *)*puVar8;
      } while( true );
    }
    iVar4 = *(int *)(iVar3 + 4);
    if (iVar4 != 0) {
      for (puVar7 = *(undefined4 **)(iVar4 + (((uint)puVar8[2] >> 4) % *(uint *)(iVar3 + 8)) * 4);
          puVar7 != (undefined4 *)0x0; puVar7 = (undefined4 *)*puVar7) {
        if (puVar7[2] == puVar8[2]) goto LAB_00404baf;
      }
    }
    puVar7 = (undefined4 *)0x0;
LAB_00404baf:
    (**(code **)(*(int *)(puVar7[3] + 0x18) + 8))();
    puVar8 = (undefined4 *)*puVar8;
  } while( true );
}



undefined4 Catch_All_00404cf3(void)

{
  return 0x404cd4;
}



uint FUN_00404d00(int param_1,int *param_2,int **param_3)

{
  DWORD DVar1;
  int *piVar2;
  uint uVar3;
  uint extraout_EAX;
  int iVar4;
  DWORD extraout_EAX_00;
  undefined4 extraout_ECX;
  int unaff_EBX;
  void *local_14;
  undefined *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00438478;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  DVar1 = GetCurrentThreadId();
  if (*(DWORD *)(unaff_EBX + 0xc4) == DVar1) {
    *(int *)(unaff_EBX + 200) = *(int *)(unaff_EBX + 200) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(unaff_EBX + 0xcc));
    *(undefined4 *)(unaff_EBX + 200) = 1;
    DVar1 = GetCurrentThreadId();
    *(DWORD *)(unaff_EBX + 0xc4) = DVar1;
  }
  local_c = 0;
  FUN_0041a190("PhotoProcessor: GetPicture(%d)",(char)param_1);
  piVar2 = (int *)FUN_00405d70(extraout_ECX,param_1);
  if (*piVar2 == 0) {
    if (param_2 != (int *)0x0) {
      *param_2 = 0;
    }
    if (param_3 != (int **)0x0) {
      *param_3 = (int *)0x0;
    }
    uVar3 = GetCurrentThreadId();
    if (*(DWORD *)(unaff_EBX + 0xc4) == uVar3) {
      uVar3 = 0xffffffff;
      piVar2 = (int *)(unaff_EBX + 200);
      *piVar2 = *piVar2 + -1;
      if (*piVar2 == 0) {
        *(undefined4 *)(unaff_EBX + 0xc4) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)(unaff_EBX + 0xcc));
        uVar3 = extraout_EAX;
      }
    }
    ExceptionList = local_14;
    return uVar3 & 0xffffff00;
  }
  FUN_00405d70(*piVar2,param_1);
  if (param_2 != (int *)0x0) {
    iVar4 = FUN_00405db0();
    *param_2 = iVar4;
    (**(code **)(*(int *)(iVar4 + 0x18) + 4))();
  }
  if (param_3 != (int **)0x0) {
    piVar2 = (int *)FUN_00405db0();
    *param_3 = piVar2;
    (**(code **)(*piVar2 + 4))();
  }
  DVar1 = GetCurrentThreadId();
  if (*(DWORD *)(unaff_EBX + 0xc4) == DVar1) {
    DVar1 = 0xffffffff;
    piVar2 = (int *)(unaff_EBX + 200);
    *piVar2 = *piVar2 + -1;
    if (*piVar2 == 0) {
      *(undefined4 *)(unaff_EBX + 0xc4) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(unaff_EBX + 0xcc));
      DVar1 = extraout_EAX_00;
    }
  }
  ExceptionList = local_14;
  return CONCAT31((int3)(DVar1 >> 8),1);
}



uint __thiscall FUN_00404e70(void *this,undefined4 param_1,int param_2)

{
  int *piVar1;
  char cVar2;
  DWORD DVar3;
  uint uVar4;
  uint extraout_EAX;
  undefined4 uVar5;
  DWORD extraout_EAX_00;
  DWORD extraout_EAX_01;
  void *unaff_EDI;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439178;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)((int)unaff_EDI + 0x48) == DVar3) {
    *(int *)((int)unaff_EDI + 0x4c) = *(int *)((int)unaff_EDI + 0x4c) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)((int)unaff_EDI + 0x50));
    *(undefined4 *)((int)unaff_EDI + 0x4c) = 1;
    DVar3 = GetCurrentThreadId();
    *(DWORD *)((int)unaff_EDI + 0x48) = DVar3;
  }
  local_4 = 0;
  FUN_0041a190("PhotoProcessor: TakePictures(%d,%d)",(char)param_1);
  cVar2 = FUN_00404920();
  if (cVar2 != '\0') {
    uVar4 = GetCurrentThreadId();
    if (*(DWORD *)((int)unaff_EDI + 0x48) == uVar4) {
      uVar4 = 0xffffffff;
      piVar1 = (int *)((int)unaff_EDI + 0x4c);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        *(undefined4 *)((int)unaff_EDI + 0x48) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)((int)unaff_EDI + 0x50));
        uVar4 = extraout_EAX;
      }
    }
    ExceptionList = local_c;
    return uVar4 & 0xffffff00;
  }
  if (param_2 == 0) {
    uVar5 = FUN_00405060(unaff_EDI,param_1,this);
    DVar3 = GetCurrentThreadId();
    if (*(DWORD *)((int)unaff_EDI + 0x48) == DVar3) {
      DVar3 = 0xffffffff;
      piVar1 = (int *)((int)unaff_EDI + 0x4c);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        *(undefined4 *)((int)unaff_EDI + 0x48) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)((int)unaff_EDI + 0x50));
        DVar3 = extraout_EAX_00;
      }
    }
    ExceptionList = local_c;
    return CONCAT31((int3)(DVar3 >> 8),(char)uVar5);
  }
  *(undefined4 *)((int)unaff_EDI + 0xe4) = param_1;
  *(void **)((int)unaff_EDI + 0xe8) = this;
  FUN_0041d4a0((void *)((int)unaff_EDI + 0xec),param_2);
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)((int)unaff_EDI + 0x48) == DVar3) {
    DVar3 = 0xffffffff;
    piVar1 = (int *)((int)unaff_EDI + 0x4c);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)((int)unaff_EDI + 0x48) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)((int)unaff_EDI + 0x50));
      DVar3 = extraout_EAX_01;
    }
  }
  ExceptionList = local_c;
  return CONCAT31((int3)(DVar3 >> 8),1);
}



void __fastcall FUN_00404fc0(void *param_1)

{
  FUN_0041a190("PhotoProcessor: OnTimer(%d,%d)",(char)*(undefined4 *)((int)param_1 + 0xe4));
  FUN_00405060(param_1,*(undefined4 *)((int)param_1 + 0xe4),*(undefined4 *)((int)param_1 + 0xe8));
  *(undefined4 *)((int)param_1 + 0xe8) = 0xffffffff;
  *(undefined4 *)((int)param_1 + 0xe4) = 0xffffffff;
  FUN_0041d550((int)param_1 + 0xec);
  return;
}



void FUN_00405020(void)

{
  char cVar1;
  
  FUN_0041c150();
  cVar1 = FUN_00404920();
  while (cVar1 != '\0') {
    Sleep(200);
    cVar1 = FUN_00404920();
  }
  return;
}



undefined4 __thiscall FUN_00405060(void *this,undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438edb;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)this + 0x40) = 1;
  puVar1 = (undefined4 *)operator_new(0xd8);
  local_4 = 0;
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_00410260(puVar1,param_1,param_2);
  }
  local_4 = 0xffffffff;
  *(undefined4 **)((int)this + 0x194) = puVar1;
  uVar2 = FUN_0041c150();
  ExceptionList = local_c;
  return CONCAT31((int3)((uint)uVar2 >> 8),1);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __fastcall FUN_004050f0(int param_1)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  DWORD DVar4;
  int *piVar5;
  undefined4 *puVar6;
  DWORD unaff_ESI;
  longlong lVar7;
  undefined8 uVar8;
  undefined uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uStack_20;
  _FILETIME a_Stack_18 [2];
  
  DVar4 = GetCurrentThreadId();
  FUN_0041a190("PhotoProcessor: Body(%ld) begin",(char)DVar4);
  *(undefined *)(param_1 + 0x35) = 1;
  FUN_0041c150();
  uVar11 = 0xffffffff;
  (**(code **)(*(int *)(param_1 + 0x194) + 0x10))();
  FUN_0041c210();
  cVar1 = *(char *)(param_1 + 4);
  while (cVar1 == '\0') {
    piVar5 = FUN_0040cd20();
    DVar4 = timeGetTime();
    piVar2 = *(int **)(param_1 + 400);
    iVar3 = piVar2[0x30];
    (**(code **)(*piVar2 + 0xc))(piVar5 + 6);
    piVar2[0x32] = DVar4;
    piVar2[0x30] = iVar3;
    piVar2[0x31] = iVar3;
    if (&stack0x00000000 != (undefined *)0x20) {
      GetSystemTimeAsFileTime(a_Stack_18);
      lVar7 = __aulldiv(a_Stack_18[0].dwLowDateTime,a_Stack_18[0].dwHighDateTime,10,0);
      uVar8 = __aulldvrm((uint)(lVar7 + -0x295e9648864000),
                         (uint)((ulonglong)(lVar7 + -0x295e9648864000) >> 0x20),1000000,0);
      uStack_20 = (undefined4)uVar8;
    }
    (**(code **)(**(int **)(param_1 + 400) + 0x84))(uStack_20);
    uVar10 = uStack_20;
    (**(code **)(**(int **)(param_1 + 400) + 0x8c))();
    uVar9 = (undefined)uVar10;
    FUN_004054c0(param_1 + -4,piVar5[0x3e]);
    DVar4 = timeGetTime();
    if ((int)DVar4 < (int)unaff_ESI) {
      unaff_ESI = DVar4;
    }
    if (0 < (int)(DVar4 + (piVar5[0x3d] - unaff_ESI))) {
      (**(code **)(*(int *)(DAT_0044c6b0 + 0x1c) + 0x10))();
    }
    puVar6 = (undefined4 *)operator_new(0x44);
    if (puVar6 == (undefined4 *)0x0) {
      puVar6 = (undefined4 *)0x0;
    }
    else {
      *puVar6 = CDib::vftable;
      puVar6[3] = 0;
      puVar6[1] = 0;
      puVar6[2] = 0;
      puVar6[5] = 0;
      puVar6[6] = aSyncRefCounter::vftable;
      puVar6[8] = aCriticalSection::vftable;
      puVar6[9] = 0xffffffff;
      puVar6[10] = 0;
      InitializeCriticalSection((LPCRITICAL_SECTION)(puVar6 + 0xb));
      puVar6[7] = 1;
      *puVar6 = CDibRef::vftable;
      puVar6[6] = CDibRef::vftable;
    }
    FUN_0040e6a0(piVar5[0x3e],(int)puVar6);
    if (*(int *)(param_1 + 0x188) == 0) {
      FUN_0041a1d0("PhotoProcessor: There is no event handler installed.",uVar9);
    }
    else {
      (**(code **)**(undefined4 **)(param_1 + 0x188))(*(undefined4 *)(param_1 + 400));
    }
    (**(code **)(**(int **)(param_1 + 400) + 8))();
    *(undefined4 *)(param_1 + 400) = 0;
    DVar4 = GetCurrentThreadId();
    if (*(DWORD *)(param_1 + 0x44) == DVar4) {
      *(int *)(param_1 + 0x48) = *(int *)(param_1 + 0x48) + 1;
    }
    else {
      EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x4c));
      *(undefined4 *)(param_1 + 0x48) = 1;
      DVar4 = GetCurrentThreadId();
      *(DWORD *)(param_1 + 0x44) = DVar4;
    }
    *(undefined *)(param_1 + 0x3c) = 0;
    DVar4 = GetCurrentThreadId();
    if (*(DWORD *)(param_1 + 0x44) == DVar4) {
      piVar2 = (int *)(param_1 + 0x48);
      *piVar2 = *piVar2 + -1;
      if (*piVar2 == 0) {
        *(undefined4 *)(param_1 + 0x44) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x4c));
      }
    }
    (**(code **)(*(int *)(param_1 + 0x194) + 0x10))();
    DVar4 = GetCurrentThreadId();
    if (DAT_0044b588 == DVar4) {
      _DAT_0044b58c = _DAT_0044b58c + 1;
    }
    else {
      EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
      _DAT_0044b58c = 1;
      DAT_0044b588 = GetCurrentThreadId();
    }
    *(undefined *)(param_1 + 0x1b8) = 0;
    *(undefined *)(param_1 + 0x1b9) = 0;
    DVar4 = GetCurrentThreadId();
    if ((DAT_0044b588 == DVar4) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
      DAT_0044b588 = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    }
    cVar1 = *(char *)(param_1 + 4);
  }
  FUN_0041a190("PhotoProcessor: Body() end",(char)uVar11);
  return;
}



void FUN_004053e0(void)

{
  undefined4 *unaff_ESI;
  
  unaff_ESI[3] = 0;
  unaff_ESI[1] = 0;
  unaff_ESI[2] = 0;
  unaff_ESI[5] = 0;
  *unaff_ESI = CDib::vftable;
  unaff_ESI[6] = aSyncRefCounter::vftable;
  unaff_ESI[10] = 0;
  unaff_ESI[8] = aCriticalSection::vftable;
  unaff_ESI[9] = 0xffffffff;
  InitializeCriticalSection((LPCRITICAL_SECTION)(unaff_ESI + 0xb));
  unaff_ESI[7] = 1;
  *unaff_ESI = CDibRef::vftable;
  unaff_ESI[6] = CDibRef::vftable;
  return;
}



void * __thiscall FUN_00405430(void *this,byte param_1)

{
  FUN_00405450();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return this;
}



void FUN_00405450(void)

{
  undefined4 *puVar1;
  undefined4 *unaff_ESI;
  
  if (unaff_ESI == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = unaff_ESI + 6;
  }
  *puVar1 = aSyncRefCounter::vftable;
  puVar1[2] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(puVar1 + 5));
  *unaff_ESI = CDib::vftable;
  if ((void *)unaff_ESI[3] != (void *)0x0) {
    operator_delete__((void *)unaff_ESI[3]);
  }
  unaff_ESI[3] = 0;
  unaff_ESI[1] = 0;
  unaff_ESI[2] = 0;
  if (unaff_ESI[5] != 0) {
    FUN_0040f1e0();
    if ((undefined4 *)unaff_ESI[5] != (undefined4 *)0x0) {
      (***(code ***)(undefined4 *)unaff_ESI[5])(1);
    }
    unaff_ESI[5] = 0;
  }
  return;
}



void FUN_004054c0(int param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  int *in_EAX;
  void *pvVar3;
  int iVar4;
  DWORD DVar5;
  int *piVar6;
  undefined4 *puVar7;
  
  pvVar3 = operator_new(0x44);
  if (pvVar3 == (void *)0x0) {
    iVar4 = 0;
  }
  else {
    iVar4 = FUN_004053e0();
  }
  FUN_0040e6a0(param_2,iVar4);
  FUN_004056c0(in_EAX,iVar4);
  DVar5 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0xc4) == DVar5) {
    *(int *)(param_1 + 200) = *(int *)(param_1 + 200) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xcc));
    *(undefined4 *)(param_1 + 200) = 1;
    DVar5 = GetCurrentThreadId();
    *(DWORD *)(param_1 + 0xc4) = DVar5;
  }
  (**(code **)(*in_EAX + 0x78))();
  FUN_00405e70(iVar4);
  piVar6 = in_EAX;
  (**(code **)(*in_EAX + 0x78))();
  FUN_00405e70(piVar6);
  (**(code **)(*in_EAX + 4))();
  if (5 < *(int *)(param_1 + 0x88)) {
    piVar6 = (int *)FUN_00405d90();
    iVar4 = piVar6[1];
    iVar1 = *piVar6;
    uVar2 = *(uint *)(iVar1 + 8);
    puVar7 = (undefined4 *)0x0;
    if (*(int *)(iVar4 + 4) != 0) {
      for (puVar7 = *(undefined4 **)
                     (*(int *)(iVar4 + 4) + ((uVar2 >> 4) % *(uint *)(iVar4 + 8)) * 4);
          puVar7 != (undefined4 *)0x0; puVar7 = (undefined4 *)*puVar7) {
        if (puVar7[2] == uVar2) goto LAB_004055bd;
      }
      puVar7 = (undefined4 *)0x0;
    }
LAB_004055bd:
    (**(code **)(*(int *)(puVar7[3] + 0x18) + 8))();
    piVar6 = *(int **)(iVar4 + 4);
    uVar2 = *(uint *)(iVar1 + 8);
    if (piVar6 != (int *)0x0) {
      for (puVar7 = (undefined4 *)piVar6[(uVar2 >> 4) % *(uint *)(iVar4 + 8)];
          (puVar7 != (undefined4 *)0x0 && (puVar7[2] != uVar2)); puVar7 = (undefined4 *)*puVar7) {
      }
    }
    FUN_00405ef0(piVar6);
    piVar6 = (int *)FUN_00405d90();
    iVar4 = piVar6[1];
    iVar1 = *piVar6;
    uVar2 = *(uint *)(iVar1 + 8);
    puVar7 = (undefined4 *)0x0;
    if (*(int *)(iVar4 + 4) != 0) {
      for (puVar7 = *(undefined4 **)
                     (*(int *)(iVar4 + 4) + ((uVar2 >> 4) % *(uint *)(iVar4 + 8)) * 4);
          puVar7 != (undefined4 *)0x0; puVar7 = (undefined4 *)*puVar7) {
        if (puVar7[2] == uVar2) goto LAB_0040563d;
      }
      puVar7 = (undefined4 *)0x0;
    }
LAB_0040563d:
    (**(code **)(*(int *)puVar7[3] + 8))();
    piVar6 = *(int **)(iVar4 + 4);
    uVar2 = *(uint *)(iVar1 + 8);
    if (piVar6 != (int *)0x0) {
      for (puVar7 = (undefined4 *)piVar6[(uVar2 >> 4) % *(uint *)(iVar4 + 8)];
          (puVar7 != (undefined4 *)0x0 && (puVar7[2] != uVar2)); puVar7 = (undefined4 *)*puVar7) {
      }
    }
    FUN_00405ef0(piVar6);
  }
  DVar5 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0xc4) == DVar5) {
    piVar6 = (int *)(param_1 + 200);
    *piVar6 = *piVar6 + -1;
    if (*piVar6 == 0) {
      *(undefined4 *)(param_1 + 0xc4) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xcc));
    }
  }
  return;
}



void __thiscall FUN_004056c0(void *this,int param_1)

{
  undefined *puVar1;
  char cVar2;
  char **ppcVar3;
  char *pcVar4;
  int iVar5;
  int **ppiVar6;
  void **ppvVar7;
  void *this_00;
  void *this_01;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar8;
  void *this_02;
  void *this_03;
  undefined *puVar9;
  void *this_04;
  void *this_05;
  void *this_06;
  void *this_07;
  void *this_08;
  void *this_09;
  void *this_10;
  void *extraout_ECX_02;
  void *extraout_ECX_03;
  void *extraout_ECX_04;
  void *extraout_ECX_05;
  void *extraout_ECX_06;
  void *extraout_ECX_07;
  void *extraout_ECX_08;
  void *extraout_ECX_09;
  void *pvVar10;
  void *pvVar11;
  undefined *puVar12;
  undefined *puVar13;
  char *pcVar14;
  void *in_stack_fffffe7c;
  void *in_stack_fffffe80;
  int **ppiStack_17c;
  undefined *puStack_178;
  undefined *puStack_164;
  undefined4 local_160;
  undefined4 *local_15c;
  undefined **local_158;
  undefined **local_154;
  void *local_150;
  undefined2 local_14c;
  undefined2 local_14a;
  undefined4 *local_148;
  void *local_144;
  int *piStack_140;
  void *pvStack_13c;
  undefined *puStack_138;
  void *pvStack_134;
  int iStack_130;
  int iStack_12c;
  undefined auStack_124 [8];
  char acStack_11c [240];
  uint uStack_2c;
  void *pvStack_24;
  undefined4 uStack_1c;
  undefined4 local_14;
  undefined uStack_10;
  undefined4 local_c;
  undefined4 uStack_8;
  undefined4 local_4;
  
  uStack_8 = &LAB_0043965e;
  local_c = ExceptionList;
  local_14 = DAT_0044a01c ^ (uint)&puStack_164;
  puStack_178 = (undefined *)(DAT_0044a01c ^ (uint)&stack0xfffffe8c);
  ExceptionList = &local_c;
  local_160 = 0;
  local_158 = (undefined **)0x0;
  local_15c = (undefined4 *)0x0;
  local_154 = CRectangle2::vftable;
  local_148 = (undefined4 *)((uint)local_148 & 0xffff0000);
  local_14a = 0;
  local_14c = 0;
  local_150 = (void *)0x0;
  local_144 = (void *)0x0;
  local_4 = 1;
                    // WARNING: Load size is inaccurate
  ppiStack_17c = (int **)0x40574d;
  (**(code **)(*this + 0x78))();
  puStack_164 = &stack0xfffffe7c;
  FUN_0041b2a0((undefined4 *)&stack0xfffffe7c,"%d");
  FUN_0040eb30(this_00,param_1,"CarId",in_stack_fffffe7c,in_stack_fffffe80);
                    // WARNING: Load size is inaccurate
  ppiStack_17c = (int **)0x405779;
  (**(code **)(*this + 0x68))();
  puStack_164 = &stack0xfffffe7c;
  FUN_0041b2a0((undefined4 *)&stack0xfffffe7c,"%d");
  FUN_0040eb30(this_01,param_1,"TriggerId",in_stack_fffffe7c,in_stack_fffffe80);
                    // WARNING: Load size is inaccurate
  ppiStack_17c = &piStack_140;
  (**(code **)(*this + 0x3c))();
  uStack_8 = (undefined *)CONCAT31(uStack_8._1_3_,2);
                    // WARNING: Load size is inaccurate
  ppcVar3 = (char **)(**(code **)(*this + 0x14))();
  local_c._0_1_ = 3;
  pcVar4 = *ppcVar3;
  if (pcVar4 == (char *)0x0) {
    pcVar4 = &DAT_0044d0d5;
  }
  pcVar14 = acStack_11c;
  FUN_004158f0(&DAT_0043c0ac,pcVar4,pcVar14,0x100);
  local_c._0_1_ = 2;
  uVar8 = extraout_ECX;
  if (pvStack_134 != (void *)0x0) {
    pcVar14 = (char *)0x405813;
    free(pvStack_134);
    uVar8 = extraout_ECX_00;
  }
  local_c = (void *)CONCAT31(local_c._1_3_,1);
  if (local_148 != (undefined4 *)0x0) {
    pcVar14 = (char *)0x40582d;
    free(local_148);
    uVar8 = extraout_ECX_01;
  }
  FUN_0041aa80(uVar8,(char *)0x7fffffff,acStack_11c);
  FUN_0040eb30(this_02,param_1,"Chars",pcVar4,pcVar14);
                    // WARNING: Load size is inaccurate
  (**(code **)(*this + 0x3c))();
  uStack_10 = 4;
                    // WARNING: Load size is inaccurate
  ppcVar3 = (char **)(**(code **)(*this + 0x1c))();
  local_14._0_1_ = 5;
  pcVar4 = &DAT_0044d0d5;
  if (*ppcVar3 != (char *)0x0) {
    pcVar4 = *ppcVar3;
  }
  puVar13 = auStack_124;
  FUN_004158f0(&DAT_0043c0ac,pcVar4,puVar13,0x100);
  local_14._0_1_ = 4;
  if (local_150 != (void *)0x0) {
    puVar13 = (undefined *)0x4058cc;
    free(local_150);
  }
  local_14 = CONCAT31(local_14._1_3_,1);
  if (pvStack_13c != (void *)0x0) {
    puVar13 = (undefined *)0x4058e6;
    free(pvStack_13c);
  }
  FUN_0041aa80(auStack_124,(char *)0x7fffffff,auStack_124);
  FUN_0040eb30(this_03,param_1,"License",pcVar4,puVar13);
                    // WARNING: Load size is inaccurate
  cVar2 = (**(code **)(*this + 0x24))();
  puVar9 = &DAT_0043c0c8;
  if (cVar2 == '\0') {
    puVar9 = &DAT_0043c0cc;
  }
  FUN_0041aa80(puVar9,(char *)0x7fffffff,puVar9);
  FUN_0040eb30(this_04,param_1,"GrammarOk",pcVar4,puVar13);
                    // WARNING: Load size is inaccurate
  puVar13 = &stack0xfffffe6c;
  puVar9 = &stack0xfffffe6c;
  (**(code **)(*this + 0x2c))();
  FUN_0040eb30(this_05,param_1,"Country",puVar9,pcVar4);
                    // WARNING: Load size is inaccurate
  (**(code **)(*this + 0x60))();
  puStack_178 = &stack0xfffffe68;
  FUN_0041b2a0((undefined4 *)&stack0xfffffe68,"%d");
  FUN_0040eb30(this_06,param_1,"NumberOfUnknownChars",puVar9,pcVar4);
                    // WARNING: Load size is inaccurate
  (**(code **)(*this + 0x4c))();
  puStack_178 = &stack0xfffffe68;
  FUN_0041b2a0((undefined4 *)&stack0xfffffe68,"%.2f");
  FUN_0040eb30(this_07,param_1,"AvgQuality",puVar9,pcVar4);
                    // WARNING: Load size is inaccurate
  (**(code **)(*this + 0x44))();
  puStack_178 = &stack0xfffffe68;
  FUN_0041b2a0((undefined4 *)&stack0xfffffe68,"%.2f");
  FUN_0040eb30(this_08,param_1,"MinQuality",puVar9,pcVar4);
                    // WARNING: Load size is inaccurate
  iStack_130 = (**(code **)(*this + 0x80))();
  iStack_12c = iStack_130 >> 0x1f;
  pvVar10 = (void *)0x405a0e;
  _localtime64((__time64_t *)&iStack_130);
                    // WARNING: Load size is inaccurate
  (**(code **)(*this + 0x88))();
  puStack_178 = &stack0xfffffe68;
  FUN_0041b2a0((undefined4 *)&stack0xfffffe68,"%.4d-%.2d-%.2d %.2d:%.2d:%.2d.%d");
  pcVar4 = "Timestamp";
  FUN_0040eb30(this_09,param_1,"Timestamp",puVar9,pvVar10);
                    // WARNING: Load size is inaccurate
  (**(code **)(*this + 0x34))();
  uStack_1c._0_1_ = 6;
  FUN_0040f5a0();
  uStack_1c._0_1_ = 1;
  local_158 = CRectangle2::vftable;
  if (local_148 != (undefined4 *)0x0) {
    puVar9 = (undefined *)0x405aa2;
    (**(code **)*local_148)();
  }
  ppiStack_17c = (int **)&stack0xfffffe64;
  FUN_0041b2a0((undefined4 *)&stack0xfffffe64,"(%d,%d)-(%d,%d)");
  FUN_0040eb30(this_10,param_1,"ROI",pcVar4,puVar9);
                    // WARNING: Load size is inaccurate
  iVar5 = (**(code **)(*this + 0x54))();
  ppiVar6 = (int **)FUN_0040e220(iVar5);
  ppiVar6 = (int **)*ppiVar6;
  if (ppiVar6 == (int **)0x0) {
    ppiStack_17c = (int **)0x0;
    pvVar10 = extraout_ECX_02;
  }
  else {
    ppiStack_17c = ppiVar6;
    ppvVar7 = (void **)FUN_0041b2a0(&local_158,"%.2f");
    uStack_1c._0_1_ = 7;
    pvVar10 = extraout_ECX_03;
    puVar13 = &stack0xfffffe6c;
    if (*ppvVar7 != (void *)0x0) {
      FUN_0041b310();
      puVar9 = puStack_178;
      memcpy(puStack_178,*ppvVar7,(size_t)ppvVar7[1]);
      puVar13 = (undefined *)ppvVar7[1];
      puVar13[(int)puVar9] = 0;
      pvVar10 = extraout_ECX_04;
      ppiVar6 = ppiStack_17c;
    }
    uStack_1c._0_1_ = 1;
    if (local_158 != (undefined **)0x0) {
      free(local_158);
      pvVar10 = extraout_ECX_05;
    }
    ppiVar6 = (int **)*ppiVar6;
    ppiStack_17c = ppiVar6;
    if (ppiVar6 != (int **)0x0) {
      do {
        ppiStack_17c = ppiVar6;
        ppvVar7 = (void **)FUN_0041b2a0(&local_144,",%.2f");
        uStack_1c._0_1_ = 8;
        ppvVar7 = FUN_0041b380(&puStack_178,&local_158,ppvVar7);
        uStack_1c._0_1_ = 9;
        pvVar10 = extraout_ECX_06;
        if ((undefined *)*ppvVar7 != puStack_178) {
          FUN_0041b310();
          puVar9 = puStack_178;
          memcpy(puStack_178,*ppvVar7,(size_t)ppvVar7[1]);
          puVar13 = (undefined *)ppvVar7[1];
          puVar13[(int)puVar9] = 0;
          pvVar10 = extraout_ECX_07;
          ppiVar6 = ppiStack_17c;
        }
        uStack_1c._0_1_ = 8;
        if (local_158 != (undefined **)0x0) {
          free(local_158);
          pvVar10 = extraout_ECX_08;
        }
        uStack_1c._0_1_ = 1;
        if (local_144 != (void *)0x0) {
          free(local_144);
          pvVar10 = extraout_ECX_09;
        }
        ppiVar6 = (int **)*ppiVar6;
      } while (ppiVar6 != (int **)0x0);
      ppiStack_17c = (int **)0x0;
    }
  }
  puVar9 = puStack_178;
  puStack_138 = &stack0xfffffe64;
  puVar1 = &stack0xfffffe64;
  pvVar11 = (void *)0x0;
  puVar12 = (undefined *)0x0;
  if (puStack_178 != (undefined *)0x0) {
    pvVar10 = (void *)0x0;
    FUN_0041b310();
    memcpy(pvVar10,puVar9,(size_t)puVar13);
    puVar13[(int)pvVar10] = 0;
    puVar1 = puStack_138;
    pvVar11 = pvVar10;
    puVar12 = puVar13;
  }
  puStack_138 = puVar1;
  FUN_0040eb30(pvVar10,param_1,"Qualities",pvVar11,puVar12);
  uStack_1c = (uint)uStack_1c._1_3_ << 8;
  if (local_15c != (undefined4 *)0x0) {
    (**(code **)*local_15c)();
  }
  uStack_1c = 0xffffffff;
  if (puVar9 != (undefined *)0x0) {
    free(puVar9);
  }
  ExceptionList = pvStack_24;
  ___security_check_cookie_4(uStack_2c ^ (uint)&ppiStack_17c);
  return;
}



void __fastcall FUN_00405cf0(undefined4 *param_1)

{
  undefined4 *puVar1;
  
  *param_1 = aCollection<int,class_CDibRef*>::vftable;
  if (1 < (int)param_1[8]) {
    for (puVar1 = *(undefined4 **)param_1[9]; puVar1 != (undefined4 *)0x0;
        puVar1 = (undefined4 *)*puVar1) {
      operator_delete((void *)puVar1[1]);
    }
    operator_delete((void *)param_1[10]);
    param_1[1] = aMap<int,class_CDibRef*>::vftable;
    FUN_00406070();
    return;
  }
  if (param_1[8] != 0) {
    operator_delete((void *)param_1[10]);
  }
  param_1[1] = aMap<int,class_CDibRef*>::vftable;
  FUN_00406070();
  return;
}



void __fastcall FUN_00405d70(undefined4 param_1,int param_2)

{
  int in_EAX;
  undefined4 *puVar1;
  undefined4 *unaff_ESI;
  
  puVar1 = (undefined4 *)FUN_00406000(in_EAX + 0x20,param_2);
  *unaff_ESI = *puVar1;
  unaff_ESI[1] = in_EAX + 4;
  return;
}



void FUN_00405d90(void)

{
  int in_EAX;
  undefined4 *puVar1;
  undefined4 *unaff_ESI;
  
  puVar1 = (undefined4 *)FUN_0040e220(in_EAX + 0x20);
  *unaff_ESI = *puVar1;
  unaff_ESI[1] = in_EAX + 4;
  return;
}



undefined4 FUN_00405db0(void)

{
  int iVar1;
  undefined4 *puVar2;
  int *in_EAX;
  
  iVar1 = *(int *)(in_EAX[1] + 4);
  if (iVar1 != 0) {
    for (puVar2 = *(undefined4 **)
                   (iVar1 + ((*(uint *)(*in_EAX + 8) >> 4) % *(uint *)(in_EAX[1] + 8)) * 4);
        puVar2 != (undefined4 *)0x0; puVar2 = (undefined4 *)*puVar2) {
      if (puVar2[2] == *(uint *)(*in_EAX + 8)) {
        return puVar2[3];
      }
    }
  }
  return uRam0000000c;
}



void __fastcall FUN_00405df0(undefined4 *param_1)

{
  undefined4 *puVar1;
  
  *param_1 = aCollection<int,class_CPlateResult*>::vftable;
  if (1 < (int)param_1[8]) {
    for (puVar1 = *(undefined4 **)param_1[9]; puVar1 != (undefined4 *)0x0;
        puVar1 = (undefined4 *)*puVar1) {
      operator_delete((void *)puVar1[1]);
    }
    operator_delete((void *)param_1[10]);
    param_1[1] = aMap<int,class_CPlateResult*>::vftable;
    FUN_00406070();
    return;
  }
  if (param_1[8] != 0) {
    operator_delete((void *)param_1[10]);
  }
  param_1[1] = aMap<int,class_CPlateResult*>::vftable;
  FUN_00406070();
  return;
}



uint FUN_00405e70(undefined4 param_1)

{
  undefined4 uVar1;
  uint in_EAX;
  undefined4 *puVar2;
  uint unaff_EBX;
  int unaff_ESI;
  
  puVar2 = (undefined4 *)0x0;
  if (*(int *)(unaff_ESI + 8) != 0) {
    in_EAX = (unaff_EBX >> 4) / *(uint *)(unaff_ESI + 0xc);
    for (puVar2 = *(undefined4 **)
                   (*(int *)(unaff_ESI + 8) + ((unaff_EBX >> 4) % *(uint *)(unaff_ESI + 0xc)) * 4);
        puVar2 != (undefined4 *)0x0; puVar2 = (undefined4 *)*puVar2) {
      if (puVar2[2] == unaff_EBX) goto LAB_00405e9d;
    }
    puVar2 = (undefined4 *)0x0;
  }
LAB_00405e9d:
  if ((unaff_ESI != -8) && (puVar2 != (undefined4 *)0x0)) {
    return in_EAX & 0xffffff00;
  }
  uVar1 = *(undefined4 *)(unaff_ESI + 0x28);
  puVar2 = (undefined4 *)operator_new(0xc);
  puVar2[1] = uVar1;
  *puVar2 = 0;
  puVar2[2] = unaff_EBX;
  if (*(undefined4 **)(unaff_ESI + 0x28) == (undefined4 *)0x0) {
    *(undefined4 **)(unaff_ESI + 0x24) = puVar2;
  }
  else {
    **(undefined4 **)(unaff_ESI + 0x28) = puVar2;
  }
  *(int *)(unaff_ESI + 0x20) = *(int *)(unaff_ESI + 0x20) + 1;
  *(undefined4 **)(unaff_ESI + 0x28) = puVar2;
  puVar2 = FUN_00406140(unaff_EBX);
  *puVar2 = param_1;
  return CONCAT31((int3)((uint)puVar2 >> 8),1);
}



uint __fastcall FUN_00405ef0(int *param_1)

{
  uint in_EAX;
  undefined4 *puVar1;
  int unaff_EBX;
  uint unaff_EDI;
  
  puVar1 = (undefined4 *)0x0;
  if (*(int *)(unaff_EBX + 8) != 0) {
    in_EAX = (unaff_EDI >> 4) / *(uint *)(unaff_EBX + 0xc);
    for (puVar1 = *(undefined4 **)
                   (*(int *)(unaff_EBX + 8) + ((unaff_EDI >> 4) % *(uint *)(unaff_EBX + 0xc)) * 4);
        puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)*puVar1) {
      if (puVar1[2] == unaff_EDI) goto LAB_00405f1d;
    }
    puVar1 = (undefined4 *)0x0;
  }
LAB_00405f1d:
  if ((unaff_EBX != -8) && (puVar1 != (undefined4 *)0x0)) {
    FUN_00406020();
    FUN_00406000(unaff_EBX + 0x20,unaff_EDI);
    if (param_1 != (int *)0x0) {
      param_1 = (int *)FUN_004060d0(param_1);
    }
    return CONCAT31((int3)((uint)param_1 >> 8),1);
  }
  return in_EAX & 0xffffff00;
}



undefined4 * __thiscall FUN_00405f60(void *this,byte param_1)

{
  FUN_00405cf0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



undefined4 * __thiscall FUN_00405f80(void *this,byte param_1)

{
  *(undefined ***)this = aMap<int,class_CDibRef*>::vftable;
  FUN_00406070();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



undefined4 * __thiscall FUN_00405fb0(void *this,byte param_1)

{
  FUN_00405df0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



undefined4 * __thiscall FUN_00405fd0(void *this,byte param_1)

{
  *(undefined ***)this = aMap<int,class_CPlateResult*>::vftable;
  FUN_00406070();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_00406000(int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 *in_EAX;
  
  puVar1 = *(undefined4 **)(param_1 + 4);
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      *in_EAX = 0;
      return;
    }
    if (puVar1[2] == param_2) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  *in_EAX = puVar1;
  return;
}



uint FUN_00406020(void)

{
  int **ppiVar1;
  int *piVar2;
  int **ppiVar3;
  int **in_EAX;
  int **ppiVar4;
  uint uVar5;
  int *unaff_ESI;
  
  piVar2 = *in_EAX;
  ppiVar4 = in_EAX;
  if (piVar2 != (int *)0x0) {
    uVar5 = ((uint)unaff_ESI >> 4) % (uint)in_EAX[1];
    ppiVar3 = (int **)piVar2[uVar5];
    ppiVar1 = (int **)(piVar2 + uVar5);
    while (ppiVar4 = ppiVar3, ppiVar4 != (int **)0x0) {
      if (ppiVar4[2] == unaff_ESI) {
        *ppiVar1 = *ppiVar4;
        *ppiVar4 = in_EAX[3];
        ppiVar1 = in_EAX + 2;
        *ppiVar1 = (int *)((int)*ppiVar1 + -1);
        in_EAX[3] = (int *)ppiVar4;
        if (*ppiVar1 == (int *)0x0) {
          ppiVar4 = (int **)FUN_00406070();
        }
        return CONCAT31((int3)((uint)ppiVar4 >> 8),1);
      }
      ppiVar1 = ppiVar4;
      ppiVar3 = (int **)*ppiVar4;
    }
  }
  return (uint)ppiVar4 & 0xffffff00;
}



void FUN_00406070(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  void *pvVar4;
  void **unaff_EDI;
  
  puVar1 = (undefined4 *)*unaff_EDI;
  if ((puVar1 != (undefined4 *)0x0) && (unaff_EDI[1] != (void *)0x0)) {
    pvVar4 = unaff_EDI[1];
    puVar3 = puVar1;
    do {
      for (puVar2 = (undefined4 *)*puVar3; puVar2 != (undefined4 *)0x0;
          puVar2 = (undefined4 *)*puVar2) {
      }
      puVar3 = puVar3 + 1;
      pvVar4 = (void *)((int)pvVar4 + -1);
    } while (pvVar4 != (void *)0x0);
  }
  operator_delete__(puVar1);
  *unaff_EDI = (void *)0x0;
  unaff_EDI[2] = (void *)0x0;
  unaff_EDI[3] = (void *)0x0;
  puVar1 = (undefined4 *)unaff_EDI[4];
  while (puVar1 != (undefined4 *)0x0) {
    puVar3 = (undefined4 *)*puVar1;
    operator_delete__(puVar1);
    puVar1 = puVar3;
  }
  unaff_EDI[4] = (void *)0x0;
  return;
}



void FUN_004060d0(int *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int *unaff_ESI;
  
  if (1 < *unaff_ESI) {
    if (param_1 == (int *)unaff_ESI[1]) {
      iVar1 = *(int *)unaff_ESI[1];
      unaff_ESI[1] = iVar1;
      *(undefined4 *)(iVar1 + 4) = 0;
    }
    else if (param_1 == (int *)unaff_ESI[2]) {
      puVar2 = (undefined4 *)((int *)unaff_ESI[2])[1];
      unaff_ESI[2] = (int)puVar2;
      *puVar2 = 0;
    }
    else {
      *(int *)param_1[1] = *param_1;
      *(int *)(*param_1 + 4) = param_1[1];
    }
  }
  operator_delete(param_1);
  *unaff_ESI = *unaff_ESI + -1;
  if (*unaff_ESI == 0) {
    unaff_ESI[2] = 0;
    unaff_ESI[1] = 0;
  }
  return;
}



undefined4 * FUN_00406140(uint param_1)

{
  int *in_EAX;
  undefined4 *puVar1;
  uint uVar2;
  
  uVar2 = (param_1 >> 4) % (uint)in_EAX[1];
  if (*in_EAX == 0) {
    FUN_004061a0();
  }
  else {
    for (puVar1 = *(undefined4 **)(*in_EAX + uVar2 * 4); puVar1 != (undefined4 *)0x0;
        puVar1 = (undefined4 *)*puVar1) {
      if (puVar1[2] == param_1) goto LAB_0040618e;
    }
  }
  puVar1 = (undefined4 *)FUN_004061f0();
  puVar1[1] = uVar2;
  puVar1[2] = param_1;
  *puVar1 = *(undefined4 *)(*in_EAX + uVar2 * 4);
  *(undefined4 **)(*in_EAX + uVar2 * 4) = puVar1;
LAB_0040618e:
  return puVar1 + 3;
}



void FUN_004061a0(void)

{
  void *_Dst;
  void **unaff_ESI;
  void *unaff_EDI;
  
  if (*unaff_ESI != (void *)0x0) {
    operator_delete__(*unaff_ESI);
    *unaff_ESI = (void *)0x0;
  }
  _Dst = operator_new(-(uint)((int)(ZEXT48(unaff_EDI) * 4 >> 0x20) != 0) |
                      (uint)(ZEXT48(unaff_EDI) * 4));
  *unaff_ESI = _Dst;
  memset(_Dst,0,(int)unaff_EDI * 4);
  unaff_ESI[1] = unaff_EDI;
  return;
}



void FUN_004061f0(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  int unaff_ESI;
  
  if (*(int *)(unaff_ESI + 0xc) == 0) {
    puVar3 = (undefined4 *)operator_new(*(int *)(unaff_ESI + 0x14) * 0x10 + 4);
    *puVar3 = *(undefined4 *)(unaff_ESI + 0x10);
    *(undefined4 **)(unaff_ESI + 0x10) = puVar3;
    iVar1 = *(int *)(unaff_ESI + 0x14);
    puVar3 = puVar3 + iVar1 * 4 + -3;
    while (iVar1 = iVar1 + -1, -1 < iVar1) {
      *puVar3 = *(undefined4 *)(unaff_ESI + 0xc);
      *(undefined4 **)(unaff_ESI + 0xc) = puVar3;
      puVar3 = puVar3 + -4;
    }
  }
  puVar3 = *(undefined4 **)(unaff_ESI + 0xc);
  uVar2 = *puVar3;
  *(int *)(unaff_ESI + 8) = *(int *)(unaff_ESI + 8) + 1;
  *(undefined4 *)(unaff_ESI + 0xc) = uVar2;
  puVar3[2] = 0;
  puVar3[3] = 0;
  return;
}



void __thiscall FUN_00406250(void *this,byte param_1)

{
  FUN_00405430((void *)((int)this + -0x18),param_1);
  return;
}



void __thiscall FUN_00406260(void *this,byte param_1)

{
  FUN_00404810((void *)((int)this + -4),param_1);
  return;
}



undefined4 * __thiscall FUN_00406270(void *this,byte param_1)

{
  *(undefined4 *)((int)this + 0x44) = 0;
  *(undefined ***)this = aThread::vftable;
  *(undefined ***)((int)this + 8) = aSyncObj::vftable;
  *(undefined ***)((int)this + 0x10) = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_004062b0(undefined4 *param_1)

{
  param_1[0x11] = 0;
  *param_1 = aThread::vftable;
  param_1[2] = aSyncObj::vftable;
  param_1[4] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  return;
}



uint FUN_004062e0(void *param_1,undefined4 param_2)

{
  int in_EAX;
  uint uVar1;
  SOCKET SVar2;
  int iVar3;
  undefined4 uVar4;
  undefined1 unaff_DI;
  
  FUN_0041a190("MessageReceiver: Initialize() begin",unaff_DI);
  uVar1 = FUN_00406440(param_1);
  if ((char)uVar1 != '\0') {
    *(undefined4 *)(in_EAX + 0x50) = param_2;
    DAT_0044c6a8 = 0;
    *(undefined4 *)(in_EAX + 0x4c) = 0xffffffff;
    SVar2 = socket(2,2,0);
    *(SOCKET *)(in_EAX + 0x44) = SVar2;
    if (0 < (int)SVar2) {
      iVar3 = FUN_00416160(SVar2,*(u_short *)(in_EAX + 0x3c));
      if (iVar3 == 0) {
        closesocket(*(SOCKET *)(in_EAX + 0x44));
        uVar1 = FUN_0041a1f0("MessageReceiver: Can\'t bind a socket to port %d (Check if other application is using it)."
                             ,(char)*(undefined4 *)(in_EAX + 0x3c));
        return uVar1 & 0xffffff00;
      }
      FUN_0041c710('\x01');
      uVar4 = FUN_0041a190("MessageReceiver: Initialize() end",unaff_DI);
      return CONCAT31((int3)((uint)uVar4 >> 8),1);
    }
    uVar1 = FUN_0041a1f0("MessageReceiver: Can\'t initialize socket.",unaff_DI);
  }
  return uVar1 & 0xffffff00;
}



void __fastcall FUN_004063a0(int *param_1)

{
  code *pcVar1;
  byte bVar2;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_004395d0;
  local_10 = ExceptionList;
  bVar2 = (byte)DAT_0044a01c ^ (byte)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_0041a190("MessageReceiver: Terminate() begin",bVar2);
  local_8 = 0;
  FUN_0041c150();
  pcVar1 = *(code **)(*param_1 + 4);
  *(undefined *)(param_1 + 1) = 1;
  (*pcVar1)();
  if (*(char *)(param_1 + 0xd) == '\0') {
    WaitForSingleObject((HANDLE)param_1[0xe],0xffffffff);
    CloseHandle((HANDLE)param_1[0xe]);
  }
  local_8 = 0xffffffff;
  FUN_0041a190("MessageReceiver: Terminate() end",bVar2);
  ExceptionList = local_10;
  return;
}



undefined4 Catch_All_00406436(void)

{
  return 0x406417;
}



uint __fastcall FUN_00406440(void *param_1)

{
  long *plVar1;
  int iVar2;
  byte bVar3;
  undefined4 uVar4;
  uint uVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  int unaff_EDI;
  undefined uVar6;
  char *pcVar7;
  int local_24 [3];
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_0043a370;
  local_c = ExceptionList;
  bVar3 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffc8;
  ExceptionList = &local_c;
  FUN_0041b630(param_1,local_24);
  local_4 = 0;
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,"Communications/Timeout");
  local_4._0_1_ = 1;
  uVar4 = FUN_0041bff0(local_24,(char *)local_18,(long *)(unaff_EDI + 0x40));
  local_4._0_1_ = 0;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  if ((char)uVar4 == '\0') {
    pcVar7 = "MessageReceiver: Missing or wrong configuration parameter (Communications/Timeout)";
  }
  else {
    iVar2 = *(long *)(unaff_EDI + 0x40);
    uVar6 = (undefined)iVar2;
    if (iVar2 < 0) {
      FUN_0041a1f0("MessageReceiver: Invalid configuration parameter (Communications/Timeout=%d)",
                   uVar6);
      goto LAB_004064d2;
    }
    FUN_0041a1b0("MessageReceiver: Communications timeout is %d",uVar6);
    FUN_0041aa80(extraout_ECX_00,(char *)0x7fffffff,"Communications/ListeningPort");
    local_4._0_1_ = 2;
    uVar4 = FUN_0041bff0(local_24,(char *)local_18,(long *)(unaff_EDI + 0x3c));
    local_4._0_1_ = 0;
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    if ((char)uVar4 == '\0') {
      pcVar7 = 
      "MessageReceiver: Missing or wrong configuration parameter (Communications/ListeningPort)";
    }
    else {
      iVar2 = *(long *)(unaff_EDI + 0x3c);
      uVar6 = (undefined)iVar2;
      if (iVar2 < 1) {
        FUN_0041a1f0("MessageReceiver: Invalid configuration parameter (Communications/ListeningPort=%d)"
                     ,uVar6);
        goto LAB_004064d2;
      }
      FUN_0041a1b0("MessageReceiver: Port used to receive messages is %d",uVar6);
      FUN_0041aa80(extraout_ECX_01,(char *)0x7fffffff,"Global/SystemId");
      plVar1 = (long *)(unaff_EDI + 0x48);
      local_4._0_1_ = 3;
      uVar4 = FUN_0041bff0(local_24,(char *)local_18,plVar1);
      local_4._0_1_ = 0;
      if (local_18[0] != (void *)0x0) {
        free(local_18[0]);
      }
      if ((char)uVar4 != '\0') {
        if (*plVar1 < 0) {
          *plVar1 = 0;
        }
        local_4 = 0xffffffff;
        uVar4 = FUN_00402ab0();
        ExceptionList = local_c;
        return CONCAT31((int3)((uint)uVar4 >> 8),1);
      }
      pcVar7 = "MessageReceiver: Missing or wrong configuration parameter (Global/SystemId)";
    }
  }
  FUN_0041a1f0(pcVar7,bVar3);
LAB_004064d2:
  local_4 = 0xffffffff;
  uVar5 = FUN_00402ab0();
  ExceptionList = local_c;
  return uVar5 & 0xffffff00;
}



// WARNING: Function: __alloca_probe replaced with injection: alloca_probe

void __fastcall FUN_00406620(int param_1)

{
  char cVar1;
  uint uVar2;
  DWORD DVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  code *pcVar7;
  undefined4 unaff_EDI;
  char *in_stack_ffff01b0;
  char *pcVar8;
  char *pcVar9;
  undefined uVar10;
  undefined auStack_fe34 [4];
  uint uStack_fe30;
  char *pcStack_fe2c;
  int local_fe28;
  char *pcStack_fe24;
  undefined *puStack_fe20;
  undefined4 uStack_fe1c;
  undefined auStack_fe18 [65036];
  uint local_c;
  
  local_c = DAT_0044a01c ^ (uint)auStack_fe34;
  local_fe28 = param_1;
  DVar3 = GetCurrentThreadId();
  pcVar8 = (char *)0x406658;
  FUN_0041a190("MessageReceiver: Body(%ld) begin",(char)DVar3);
  *(undefined *)(param_1 + 0x35) = 1;
  FUN_0041c150();
  uVar10 = (undefined)unaff_EDI;
  cVar1 = *(char *)(param_1 + 4);
  while (cVar1 == '\0') {
    if (DAT_0044d0d4 == '\0') {
      pcStack_fe2c = (char *)0x0;
      iVar4 = FUN_00416260(*(void **)(param_1 + 0x40),&uStack_fe30);
      pcVar9 = pcStack_fe2c;
      uVar2 = uStack_fe30;
      uVar10 = (undefined)unaff_EDI;
      if (iVar4 != 0) {
        if (*(char *)(local_fe28 + 4) != '\0') break;
        if (pcStack_fe2c != (char *)0x0) {
          iVar5 = FUN_00406df0(uStack_fe30);
          iVar4 = local_fe28;
          if (iVar5 < 0) {
            puVar6 = FUN_00411bc0((int)pcVar9,(int)auStack_fe18);
            if (puVar6 != (undefined4 *)0x0) {
              if (((*(char *)((int)puVar6 + 0xe) != '\0') && (*(char *)((int)puVar6 + 0xf) != '\0'))
                 && (*(short *)(puVar6[1] + 9) == 0x4f)) {
                pcVar8 = (char *)(uStack_fe30 >> 8 & 0xff);
                in_stack_ffff01b0 = (char *)(uStack_fe30 & 0xff);
                pcStack_fe2c = pcVar8;
                pcStack_fe24 = in_stack_ffff01b0;
                FUN_0041a1b0("MessageReceiver: Receive message RecognitionStatisticsQuery from address %d.%d.%d.%d"
                             ,(char)uStack_fe30);
                puStack_fe20 = &stack0xffff01b0;
                FUN_0041b2a0((undefined4 *)&stack0xffff01b0,"%d.%d.%d.%d");
                FUN_00406e60(local_fe28,*(undefined4 *)(puVar6[1] + 1),
                             *(undefined4 *)(puVar6[1] + 0xd),in_stack_ffff01b0,pcVar8);
                (**(code **)*puVar6)();
                goto LAB_00406cf0;
              }
              (**(code **)*puVar6)();
            }
            pcVar8 = (char *)(uVar2 >> 8 & 0xff);
            in_stack_ffff01b0 = (char *)(uVar2 & 0xff);
            FUN_0041a1f0("MessageReceiver: Unexpected message from address %d.%d.%d.%d",(char)uVar2)
            ;
          }
          else {
            if (iVar5 != DAT_0044c6a8) {
              if (*(int **)(local_fe28 + 0x50) == (int *)0x0) {
                FUN_0041a1d0("MessageReceiver: There is no event handler installed.",(char)unaff_EDI
                            );
              }
              else {
                (**(code **)(**(int **)(local_fe28 + 0x50) + 0x28))();
              }
            }
            puVar6 = FUN_00411bc0((int)pcStack_fe2c,(int)auStack_fe18);
            uVar10 = (undefined)unaff_EDI;
            if ((puVar6 == (undefined4 *)0x0) || (*(char *)((int)puVar6 + 0xe) == '\0')) {
              FUN_0041a1f0("MessageReceiver: Unknown message",uVar10);
              if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                FUN_0041a1d0("MessageReceiver: There is no event handler installed.",(char)unaff_EDI
                            );
              }
              else {
                pcVar7 = *(code **)(**(int **)(iVar4 + 0x50) + 0x34);
LAB_00406ce0:
                pcVar8 = (char *)0x406ce2;
                (*pcVar7)();
              }
            }
            else if (*(char *)((int)puVar6 + 0xf) == '\0') {
              FUN_0041a1f0("MessageReceiver: Wrong message checksum",uVar10);
              if (*(int **)(iVar4 + 0x50) != (int *)0x0) {
                pcVar7 = *(code **)(**(int **)(iVar4 + 0x50) + 0x38);
                goto LAB_00406ce0;
              }
              FUN_0041a1d0("MessageReceiver: There is no event handler installed.",(char)unaff_EDI);
            }
            else if ((*(int *)(iVar4 + 0x48) < 1) ||
                    (*(int *)(puVar6[1] + 1) == *(int *)(iVar4 + 0x48))) {
              iVar5 = puVar6[1];
              if (*(char *)(puVar6 + 4) == '\0') {
                pcVar9 = *(char **)(iVar5 + 0xd);
                in_stack_ffff01b0 = "MessageReceiver: Incompatible version (%d,%d,%d)";
                FUN_0041a1f0("MessageReceiver: Incompatible version (%d,%d,%d)",(char)pcVar9);
                pcVar8 = *(char **)(puVar6[1] + 0xd);
                if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                  FUN_0041a1d0("MessageReceiver: There is no event handler installed.",
                               (char)unaff_EDI);
                  pcVar8 = pcVar9;
                }
                else {
                  in_stack_ffff01b0 = (char *)0x4068e3;
                  (**(code **)(**(int **)(iVar4 + 0x50) + 0x3c))();
                }
              }
              else {
                switch(*(undefined2 *)(iVar5 + 9)) {
                case 0x40:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  else {
                    *(int *)(iVar4 + 0x4c) = *(int *)(iVar5 + 0xd);
                    (**(code **)(**(int **)(iVar4 + 0x50) + 4))();
                  }
                  break;
                case 0x41:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else {
                    if (*(int **)(iVar4 + 0x50) != (int *)0x0) {
                      *(undefined4 *)(iVar4 + 0x4c) = *(undefined4 *)(puVar6[1] + 0xd);
                      pcVar7 = *(code **)(**(int **)(iVar4 + 0x50) + 0xc);
                      goto LAB_00406ce0;
                    }
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  break;
                case 0x42:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else {
                    pcVar9 = *(char **)(puVar6[1] + 0xd);
                    if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                      FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                    }
                    else {
                      *(char **)(iVar4 + 0x4c) = pcVar9;
                      in_stack_ffff01b0 = (char *)0x4069d6;
                      (**(code **)(**(int **)(iVar4 + 0x50) + 8))();
                      pcVar8 = pcVar9;
                    }
                  }
                  break;
                case 0x43:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else {
                    if (*(int **)(iVar4 + 0x50) != (int *)0x0) {
                      *(undefined4 *)(iVar4 + 0x4c) = *(undefined4 *)(puVar6[1] + 0xd);
                      pcVar7 = *(code **)(**(int **)(iVar4 + 0x50) + 0x10);
                      goto LAB_00406ce0;
                    }
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  break;
                case 0x44:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else if (*(undefined4 **)(iVar4 + 0x50) == (undefined4 *)0x0) {
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  else {
                    *(undefined4 *)(iVar4 + 0x4c) = *(undefined4 *)(puVar6[1] + 0xd);
                    pcVar8 = (char *)0x406a64;
                    (**(code **)**(undefined4 **)(iVar4 + 0x50))();
                  }
                  break;
                case 0x45:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  else {
                    *(int *)(iVar4 + 0x4c) = *(int *)(iVar5 + 0xd);
                    (**(code **)(**(int **)(iVar4 + 0x50) + 0x14))();
                  }
                  break;
                case 0x46:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else {
                    uStack_fe1c = CONCAT31(uStack_fe1c._1_3_,*(char *)(puVar6[1] + 0x11) != '\0');
                    if (*(int **)(iVar4 + 0x50) != (int *)0x0) {
                      *(undefined4 *)(iVar4 + 0x4c) = *(undefined4 *)(puVar6[1] + 0xd);
                      pcVar7 = *(code **)(**(int **)(iVar4 + 0x50) + 0x18);
                      goto LAB_00406ce0;
                    }
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  break;
                case 0x47:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  else {
                    *(undefined4 *)(iVar4 + 0x4c) = *(undefined4 *)(puVar6[1] + 0xd);
                    pcVar8 = (char *)0x406b3c;
                    (**(code **)(**(int **)(iVar4 + 0x50) + 0x1c))();
                  }
                  break;
                case 0x48:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else {
                    if (*(int **)(iVar4 + 0x50) != (int *)0x0) {
                      *(undefined4 *)(iVar4 + 0x4c) = *(undefined4 *)(puVar6[1] + 0xd);
                      pcVar7 = *(code **)(**(int **)(iVar4 + 0x50) + 0x20);
                      goto LAB_00406ce0;
                    }
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  break;
                case 0x49:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  else {
                    *(undefined4 *)(iVar4 + 0x4c) = *(undefined4 *)(puVar6[1] + 0xd);
                    pcVar8 = (char *)0x406bca;
                    (**(code **)(**(int **)(iVar4 + 0x50) + 0x24))();
                  }
                  break;
                default:
                  pcVar9 = *(char **)(iVar5 + 0xd);
                  if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  else {
                    in_stack_ffff01b0 = (char *)0x406caa;
                    (**(code **)(**(int **)(iVar4 + 0x50) + 0x30))();
                    pcVar8 = pcVar9;
                  }
                  break;
                case 0x4f:
                  if (*(int *)(iVar5 + 0xd) == *(int *)(iVar4 + 0x4c)) {
                    FUN_00406e40();
                  }
                  else {
                    puStack_fe20 = &stack0xffff01b0;
                    FUN_0041b2a0((undefined4 *)&stack0xffff01b0,"%d.%d.%d.%d");
                    FUN_00406e60(iVar4,*(undefined4 *)(puVar6[1] + 1),
                                 *(undefined4 *)(puVar6[1] + 0xd),in_stack_ffff01b0,pcVar8);
                  }
                  break;
                case 0xc0:
                  if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  else {
                    (**(code **)(**(int **)(iVar4 + 0x50) + 0x40))();
                  }
                  break;
                case 0xc1:
                  pcVar9 = *(char **)(iVar5 + 0xd);
                  if (*(int **)(iVar4 + 0x50) == (int *)0x0) {
                    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",uVar10);
                  }
                  else {
                    in_stack_ffff01b0 = (char *)0x406c7d;
                    (**(code **)(**(int **)(iVar4 + 0x50) + 0x44))();
                    pcVar8 = pcVar9;
                  }
                }
              }
            }
            else {
              pcVar8 = "MessageReceiver: Incorrect UnitId (%d,%d)";
              in_stack_ffff01b0 = (char *)0x40685d;
              FUN_0041a1f0("MessageReceiver: Incorrect UnitId (%d,%d)",
                           (char)*(undefined4 *)(puVar6[1] + 0xd));
              if (*(int **)(iVar4 + 0x50) != (int *)0x0) {
                pcVar7 = *(code **)(**(int **)(iVar4 + 0x50) + 0x48);
                goto LAB_00406ce0;
              }
              FUN_0041a1d0("MessageReceiver: There is no event handler installed.",(char)unaff_EDI);
            }
            if (puVar6 != (undefined4 *)0x0) {
              (**(code **)*puVar6)();
            }
          }
        }
      }
    }
LAB_00406cf0:
    uVar10 = (undefined)unaff_EDI;
    param_1 = local_fe28;
    cVar1 = *(char *)(local_fe28 + 4);
  }
  FUN_0041a190("MessageReceiver: Body() end",uVar10);
  ___security_check_cookie_4(local_c ^ (uint)auStack_fe34);
  return;
}



void __fastcall FUN_00406de0(int param_1)

{
  closesocket(*(SOCKET *)(param_1 + 0x44));
  return;
}



int FUN_00406df0(undefined4 param_1)

{
  int iVar1;
  char *pcVar2;
  
  iVar1 = 0;
  if (0 < DAT_0044c6ac) {
    pcVar2 = &DAT_0044d0f9;
    do {
      if ((((pcVar2[-1] == (char)param_1) && (*pcVar2 == (char)((uint)param_1 >> 8))) &&
          (pcVar2[1] == param_1._2_1_)) && (pcVar2[2] == param_1._3_1_)) {
        return iVar1;
      }
      iVar1 = iVar1 + 1;
      pcVar2 = pcVar2 + 0x18;
    } while (iVar1 < DAT_0044c6ac);
  }
  return -1;
}



void FUN_00406e40(void)

{
  int in_EAX;
  undefined1 unaff_retaddr;
  
  if (*(int *)(in_EAX + 0x50) == 0) {
    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",unaff_retaddr);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00406e5e. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(int **)(in_EAX + 0x50) + 0x4c))();
  return;
}



void FUN_00406e60(int param_1,undefined4 param_2,undefined4 param_3,void *param_4,undefined *param_5
                 )

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438f38;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  if (*(int *)(param_1 + 0x50) == 0) {
    FUN_0041a1d0("MessageReceiver: There is no event handler installed.",
                 (byte)DAT_0044a01c ^ (byte)&stack0xffffffe4);
  }
  else {
    if (param_4 != (void *)0x0) {
      FUN_0041b310();
      memcpy((void *)0x0,param_4,(size_t)param_5);
      *param_5 = 0;
    }
    (**(code **)(**(int **)(param_1 + 0x50) + 0x2c))(param_2,param_3);
  }
  if (param_4 != (void *)0x0) {
    local_4 = 0xffffffff;
    free(param_4);
  }
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_00406f40(undefined4 *param_1)

{
  *param_1 = aSyncObj::vftable;
  param_1[2] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  return;
}



undefined4 * FUN_00406f60(undefined4 *param_1,undefined4 param_2)

{
  void *pvVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00437f08;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)(param_1 + 3) = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CChangeCentralHostMsg::vftable;
  pvVar1 = operator_new(0x11);
  param_1[1] = pvVar1;
  *(undefined2 *)((int)pvVar1 + 9) = 0xff;
  *(undefined4 *)(param_1[1] + 0xd) = param_2;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * FUN_00406fe0(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_004395a8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = aThread::vftable;
  FUN_0041db50();
  param_1[2] = aCondition::vftable;
  *(undefined *)(param_1 + 0xb) = 0;
  local_4 = 0;
  *param_1 = CRemoteMessageSender::vftable;
  FUN_00408be0(param_1 + 0xf);
  param_1[0x2a] = aCriticalSection::vftable;
  param_1[0x2b] = 0xffffffff;
  param_1[0x2c] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x2d));
  FUN_0041db50();
  param_1[0x34] = aCondition::vftable;
  *(undefined *)(param_1 + 0x3d) = 0;
  param_1[0x41] = 0;
  param_1[0x42] = 0;
  param_1[0x43] = 0;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_004070a0(void *this,byte param_1)

{
  FUN_004070c0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_004070c0(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  uint local_4;
  
  puStack_8 = &LAB_0043957e;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = CRemoteMessageSender::vftable;
  local_4 = 3;
  FUN_00408fc0();
  param_1[0x34] = aSyncObj::vftable;
  param_1[0x36] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  param_1[0x2a] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x2d));
  local_4 = local_4 & 0xffffff00;
  FUN_00408cc0(param_1 + 0xf);
  *param_1 = aThread::vftable;
  param_1[2] = aSyncObj::vftable;
  param_1[4] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  ExceptionList = local_c;
  return;
}



uint FUN_00407180(void *param_1)

{
  int in_EAX;
  uint uVar1;
  SOCKET SVar2;
  undefined4 uVar3;
  undefined1 unaff_DI;
  
  FUN_0041a190("MessageSender: Initialize() begin",unaff_DI);
  uVar1 = FUN_004078b0(in_EAX,param_1);
  if ((char)uVar1 != '\0') {
    *(undefined *)(in_EAX + 0xcc) = 0;
    *(undefined4 *)(in_EAX + 0xf8) = 0;
    *(undefined4 *)(in_EAX + 0xfc) = 0;
    SVar2 = socket(2,2,0);
    *(SOCKET *)(in_EAX + 0x100) = SVar2;
    if (0 < (int)SVar2) {
      SVar2 = socket(2,2,0);
      *(SOCKET *)(in_EAX + 0x110) = SVar2;
      if (0 < (int)SVar2) {
        FUN_0041c710('\x01');
        uVar3 = FUN_0041a190("MessageSender: Initialize() end",unaff_DI);
        return CONCAT31((int3)((uint)uVar3 >> 8),1);
      }
    }
    uVar1 = FUN_0041a1f0("MessageSender: Can\'t initialize socket.",unaff_DI);
  }
  return uVar1 & 0xffffff00;
}



void __fastcall FUN_00407220(int *param_1)

{
  code *pcVar1;
  byte bVar2;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00439530;
  local_10 = ExceptionList;
  bVar2 = (byte)DAT_0044a01c ^ (byte)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_0041a190("MessageSender: Terminate() begin",bVar2);
  local_8 = 0;
  FUN_0041c150();
  pcVar1 = *(code **)(*param_1 + 4);
  *(undefined *)(param_1 + 1) = 1;
  (*pcVar1)();
  if (*(char *)(param_1 + 0xd) == '\0') {
    WaitForSingleObject((HANDLE)param_1[0xe],0xffffffff);
    CloseHandle((HANDLE)param_1[0xe]);
  }
  closesocket(param_1[0x40]);
  closesocket(param_1[0x44]);
  if ((undefined4 *)param_1[0x3f] != (undefined4 *)0x0) {
    (***(code ***)(undefined4 *)param_1[0x3f])(1);
    param_1[0x3f] = 0;
  }
  local_8 = 0xffffffff;
  FUN_0041a190("MessageSender: Terminate() end",bVar2);
  ExceptionList = local_10;
  return;
}



undefined4 Catch_All_004072e3(void)

{
  return 0x4072c4;
}



undefined4 __fastcall FUN_004072f0(undefined4 param_1,undefined param_2,undefined4 param_3)

{
  undefined4 uVar1;
  int unaff_EDI;
  void *local_18;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438449;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  if ((unaff_EDI != 0) && (*(short *)(*(int *)(unaff_EDI + 4) + 9) != 0xff)) {
    FUN_00412a90(param_1);
    local_4 = 0;
    FUN_0041a190("MessageSender: SendMessage(%d,%s)",
                 (char)*(undefined4 *)(*(int *)(unaff_EDI + 4) + 0xd));
    local_4 = 0xffffffff;
    if (local_18 != (void *)0x0) {
      free(local_18);
    }
  }
  uVar1 = FUN_00408e20();
  ExceptionList = local_c;
  return CONCAT31((int3)((uint)uVar1 >> 8),1);
}



undefined4 FUN_004073b0(int param_1)

{
  int *piVar1;
  DWORD DVar2;
  DWORD extraout_EAX;
  uint uVar3;
  uint extraout_EAX_00;
  int unaff_EBX;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438408;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(unaff_EBX + 0xac) == DVar2) {
    *(int *)(unaff_EBX + 0xb0) = *(int *)(unaff_EBX + 0xb0) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(unaff_EBX + 0xb4));
    *(undefined4 *)(unaff_EBX + 0xb0) = 1;
    DVar2 = GetCurrentThreadId();
    *(DWORD *)(unaff_EBX + 0xac) = DVar2;
  }
  local_4 = 0;
  FUN_0041a190("MessageSender: ResendLastResponse(%d)",(char)param_1);
  if ((*(int *)(unaff_EBX + 0xfc) != 0) &&
     (param_1 == *(int *)(*(int *)(*(int *)(unaff_EBX + 0xfc) + 4) + 0xd))) {
    FUN_00408e20();
    DVar2 = GetCurrentThreadId();
    if (*(DWORD *)(unaff_EBX + 0xac) == DVar2) {
      DVar2 = 0xffffffff;
      piVar1 = (int *)(unaff_EBX + 0xb0);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        *(undefined4 *)(unaff_EBX + 0xac) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)(unaff_EBX + 0xb4));
        DVar2 = extraout_EAX;
      }
    }
    ExceptionList = local_c;
    return CONCAT31((int3)(DVar2 >> 8),1);
  }
  uVar3 = GetCurrentThreadId();
  if (*(DWORD *)(unaff_EBX + 0xac) == uVar3) {
    uVar3 = 0xffffffff;
    piVar1 = (int *)(unaff_EBX + 0xb0);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(unaff_EBX + 0xac) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(unaff_EBX + 0xb4));
      uVar3 = extraout_EAX_00;
    }
  }
  ExceptionList = local_c;
  return uVar3 & 0xffffff00;
}



void __fastcall FUN_004074b0(int param_1)

{
  int *piVar1;
  DWORD DVar2;
  int unaff_EBX;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439178;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0xac) == DVar2) {
    *(int *)(param_1 + 0xb0) = *(int *)(param_1 + 0xb0) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xb4));
    *(undefined4 *)(param_1 + 0xb0) = 1;
    DVar2 = GetCurrentThreadId();
    *(DWORD *)(param_1 + 0xac) = DVar2;
  }
  local_4 = 0;
  FUN_0041a190("MessageSender: OnACK(%d)",(char)unaff_EBX);
  if ((*(int *)(param_1 + 0xf8) != 0) &&
     (*(int *)(*(int *)(*(int *)(param_1 + 0xf8) + 4) + 0xd) == unaff_EBX)) {
    *(undefined *)(param_1 + 0xcc) = 0;
    FUN_0041c150();
  }
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0xac) == DVar2) {
    piVar1 = (int *)(param_1 + 0xb0);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(param_1 + 0xac) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xb4));
    }
  }
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_00407580(void *this,int param_1,undefined4 param_2)

{
  int *piVar1;
  char cVar2;
  uint uVar3;
  DWORD DVar4;
  undefined uVar5;
  char *pcVar6;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438f08;
  local_c = ExceptionList;
  uVar3 = DAT_0044a01c ^ (uint)&stack0xffffffe4;
  ExceptionList = &local_c;
  DVar4 = GetCurrentThreadId();
  if (*(DWORD *)((int)this + 0xac) == DVar4) {
    *(int *)((int)this + 0xb0) = *(int *)((int)this + 0xb0) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0xb4));
    *(undefined4 *)((int)this + 0xb0) = 1;
    DVar4 = GetCurrentThreadId();
    *(DWORD *)((int)this + 0xac) = DVar4;
  }
  local_4 = 0;
  uVar5 = (undefined)param_1;
  FUN_0041a190("MessageSender: OnNAK(%d,%d,%d)",uVar5);
  if ((*(int *)((int)this + 0xf8) == 0) ||
     (*(int *)(*(int *)(*(int *)((int)this + 0xf8) + 4) + 0xd) != param_1)) goto LAB_004076a1;
  switch(param_2) {
  case 0:
    pcVar6 = "MessageSender: Received NAK (%d Unknown message)";
    goto LAB_0040762b;
  case 1:
    FUN_0041a1d0("MessageSender: Received NAK (%d Bad format)",uVar5);
    goto switchD_0040761e_caseD_7;
  case 2:
    pcVar6 = "MessageSender: Received NAK (%d Unknown error)";
    break;
  case 3:
    pcVar6 = "MessageSender: Received NAK (%d Bad parameters)";
    break;
  case 4:
    pcVar6 = "MessageSender: Received NAK (%d Can\'t complete)";
    break;
  case 5:
    pcVar6 = "MessageSender: Received NAK (%d Incorrect unit id)";
    break;
  case 6:
    pcVar6 = "MessageSender: Received NAK (%d Incompatible version)";
LAB_0040762b:
    FUN_0041a1d0(pcVar6,uVar5);
    cVar2 = (**(code **)(**(int **)((int)this + 0xf8) + 8))(uVar3);
    *(bool *)((int)this + 0xcc) = cVar2 != '\0';
  default:
    goto switchD_0040761e_caseD_7;
  case 10:
    pcVar6 = "MessageSender: Received NAK (%d Bad Auth)";
  }
  FUN_0041a1d0(pcVar6,uVar5);
  *(undefined *)((int)this + 0xcc) = 0;
switchD_0040761e_caseD_7:
  FUN_0041c150();
LAB_004076a1:
  DVar4 = GetCurrentThreadId();
  if (*(DWORD *)((int)this + 0xac) == DVar4) {
    piVar1 = (int *)((int)this + 0xb0);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)((int)this + 0xac) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0xb4));
    }
  }
  ExceptionList = local_c;
  return;
}



void FUN_00407710(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 *puVar1;
  undefined **local_38;
  void *local_34;
  int local_30;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439508;
  local_c = ExceptionList;
  local_10 = DAT_0044a01c ^ (uint)&local_38;
  ExceptionList = &local_c;
  FUN_0041ce60(&local_38);
  local_4 = 0;
  local_1c = param_2;
  local_14 = param_4;
  local_18 = param_3;
  puVar1 = (undefined4 *)FUN_0040e220(param_1 + 0x104);
  for (puVar1 = (undefined4 *)*puVar1; puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)*puVar1)
  {
    if ((void *)puVar1[3] != local_34) {
      FUN_0041b310();
      memcpy(local_34,(void *)puVar1[3],puVar1[4]);
      local_30 = puVar1[4];
      *(undefined *)(local_30 + (int)local_34) = 0;
    }
    local_28 = puVar1[6];
    local_24 = puVar1[7];
    FUN_004161d0(0xc,&local_1c,*(SOCKET *)(param_1 + 0x110),local_28,(u_short)local_24);
  }
  local_4 = 0xffffffff;
  local_38 = aIpAddr::vftable;
  if (local_34 != (void *)0x0) {
    free(local_34);
  }
  ExceptionList = local_c;
  ___security_check_cookie_4(local_10 ^ (uint)&local_38);
  return;
}



void FUN_00407830(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438edb;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_00406f60(puVar1,param_2);
    uVar2 = extraout_ECX_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,(char)param_1,param_1);
  ExceptionList = local_c;
  return;
}



uint FUN_004078b0(int param_1,void *param_2)

{
  undefined *puVar1;
  char cVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  undefined1 *puVar6;
  undefined4 uVar7;
  undefined4 *puVar8;
  undefined1 *puVar9;
  undefined1 *puVar10;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  undefined4 extraout_ECX_09;
  undefined4 extraout_ECX_10;
  undefined4 extraout_ECX_11;
  undefined4 extraout_ECX_12;
  undefined4 extraout_ECX_13;
  code *pcVar11;
  code *pcVar12;
  long *plVar13;
  undefined **ppuVar14;
  void *_Dst;
  char **ppcVar15;
  void *pvVar16;
  int *piVar17;
  size_t sVar18;
  undefined uVar19;
  char *pcVar20;
  undefined uVar21;
  void *local_d4 [3];
  undefined *local_c8;
  int local_c4 [3];
  undefined1 *local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined1 *local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined1 *local_a0;
  int local_9c;
  undefined4 local_98;
  undefined **local_94;
  undefined1 *local_90;
  size_t local_8c;
  undefined4 local_84;
  undefined *local_80;
  int local_7c;
  void *local_78;
  int local_74;
  undefined4 local_70;
  char *local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined *local_60;
  undefined1 *local_5c;
  undefined4 local_58;
  undefined4 local_54;
  char *local_50 [3];
  void *local_44 [3];
  char *local_38 [8];
  void *local_18;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a32a;
  local_c = ExceptionList;
  uVar3 = DAT_0044a01c ^ (uint)&stack0xffffff18;
  ExceptionList = &local_c;
  local_ac = (undefined1 *)0x0;
  local_a4 = 0;
  local_a8 = 0;
  local_6c = (char *)0x0;
  local_64 = 0;
  local_68 = 0;
  local_5c = (undefined1 *)0x0;
  local_54 = 0;
  local_58 = 0;
  local_78 = (void *)0x0;
  local_70 = 0;
  local_74 = 0;
  local_4._0_1_ = 3;
  local_4._1_3_ = 0;
  FUN_0041ce60(&local_94);
  local_a0 = (undefined1 *)0x0;
  local_98 = 0;
  local_9c = 0;
  local_b8 = (undefined1 *)0x0;
  local_b0 = 0;
  local_b4 = 0;
  local_4._0_1_ = 6;
  FUN_0041b630(param_2,local_c4);
  local_4._0_1_ = 7;
  DAT_0044c6ac = (undefined *)0x1;
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,"Communications/CentralSystemPort");
  local_4._0_1_ = 8;
  uVar4 = FUN_0041bff0(local_c4,(char *)local_d4,&DAT_0044d0fc);
  pcVar11 = free_exref;
  local_4._0_1_ = 7;
  if (local_d4[0] != (void *)0x0) {
    free(local_d4[0]);
  }
  if ((char)uVar4 == '\0') {
    FUN_0041a1f0("MessageSender: Missing  or wrong configuration parameter (Communications/CentralSystemPort)"
                 ,(char)uVar3);
LAB_0040869f:
    local_4._0_1_ = 6;
    FUN_00402ab0();
LAB_004086b0:
    local_4 = CONCAT31(local_4._1_3_,3);
    local_94 = aIpAddr::vftable;
    pcVar12 = pcVar11;
  }
  else {
    if (0xfffe < DAT_0044d0fc - 1U) {
      FUN_0041a1f0("MessageSender: Invalid configuration parameter (Communications/CentralSystemPort=%d)"
                   ,(char)DAT_0044d0fc);
      goto LAB_0040869f;
    }
    FUN_0041a1b0("MessageSender: Central port used to send messages to is %d",(char)DAT_0044d0fc);
    FUN_0041aa80(extraout_ECX_00,(char *)0x7fffffff,"Communications/Protocol");
    local_4._0_1_ = 9;
    uVar4 = FUN_0041bbf0(local_d4,(int)local_c4,&local_b8);
    local_4._0_1_ = 7;
    if (local_d4[0] != (void *)0x0) {
      free(local_d4[0]);
    }
    if ((char)uVar4 == '\0') {
      FUN_0041a1f0("MessageSender: Missing or wrong configuration parameter (Communications/Protocol)"
                   ,(char)uVar3);
      local_4._0_1_ = 6;
      FUN_00402ab0();
      local_4._0_1_ = 5;
      if (local_b8 != (undefined1 *)0x0) {
        free(local_b8);
      }
      goto LAB_004086b0;
    }
    FUN_0041ada0(&local_b8,local_d4);
    iVar5 = FUN_0041ab00((byte *)"custom");
    if (local_d4[0] != (void *)0x0) {
      free(local_d4[0]);
    }
    uVar21 = (undefined)uVar3;
    if (iVar5 == 0) {
      pcVar20 = "MessageSender: Protocol used is \"custom\"";
LAB_00407b0a:
      FUN_0041a1b0(pcVar20,uVar21);
      FUN_0041d0c0();
      uVar4 = extraout_ECX_01;
      puVar9 = (undefined1 *)0x0;
    }
    else {
      FUN_0041ada0(&local_b8,local_d4);
      iVar5 = FUN_0041ab00((byte *)"serial");
      if (local_d4[0] != (void *)0x0) {
        free(local_d4[0]);
      }
      uVar21 = (undefined)uVar3;
      if (iVar5 == 0) {
        pcVar20 = "MessageSender: Protocol used is \"serial\"";
        goto LAB_00407b0a;
      }
      FUN_0041ada0(&local_b8,local_d4);
      iVar5 = FUN_0041ab00(&DAT_0043cbcc);
      uVar4 = extraout_ECX_02;
      if (local_d4[0] != (void *)0x0) {
        free(local_d4[0]);
        uVar4 = extraout_ECX_03;
      }
      puVar9 = local_b8;
      if (iVar5 != 0) {
        puVar10 = &DAT_0044d0d5;
        if (local_b8 != (undefined1 *)0x0) {
          puVar10 = local_b8;
        }
        FUN_0041a1f0("MessageSender: Invalid configuration parameter (Communications/Protocol=%s)",
                     (char)puVar10);
        local_4._0_1_ = 6;
        FUN_00402ab0();
        local_4._0_1_ = 5;
joined_r0x00407c77:
        if (puVar9 != (undefined1 *)0x0) {
          free(puVar9);
        }
        local_4 = CONCAT31(local_4._1_3_,3);
        local_90 = (undefined1 *)FUN_0041cf00(&local_94);
        goto LAB_004086ce;
      }
      FUN_0041aa80(uVar4,(char *)0x7fffffff,"Communications/CentralSystemHost");
      piVar17 = local_c4;
      local_4._0_1_ = 10;
      pcVar20 = (char *)0x407b86;
      uVar4 = FUN_0041bbf0(local_d4,(int)piVar17,&local_a0);
      local_4._0_1_ = 7;
      if (local_d4[0] != (void *)0x0) {
        piVar17 = (int *)0x407ba0;
        free(local_d4[0]);
      }
      if ((char)uVar4 == '\0') {
        FUN_0041a1f0("MessageSender: Missing or wrong configuration parameter (Communications/CentralSystemHost)"
                     ,(char)uVar3);
        local_4._0_1_ = 6;
        FUN_00402ab0();
        local_4._0_1_ = 5;
        if (local_b8 != (undefined1 *)0x0) {
          free(local_b8);
        }
        local_4._0_1_ = 4;
        puVar9 = local_a0;
        goto joined_r0x00407c77;
      }
      local_c8 = &stack0xffffff08;
      FUN_0041aa30((void **)&stack0xffffff08);
      cVar2 = FUN_0041cf50(&DAT_0044d0e8,pcVar20,(size_t)piVar17);
      puVar9 = local_a0;
      if (cVar2 == '\0') {
        puVar10 = &DAT_0044d0d5;
        if (local_a0 != (undefined1 *)0x0) {
          puVar10 = local_a0;
        }
        FUN_0041a1f0("MessageSender: Invalid configuration parameter (Communications/CentralSystemHost=%s): The address can\'t be resolved"
                     ,(char)puVar10);
        local_4._0_1_ = 6;
        FUN_00402ab0();
        local_4._0_1_ = 5;
        if (local_b8 != (undefined1 *)0x0) {
          free(local_b8);
        }
        local_4._0_1_ = 4;
        goto joined_r0x00407c77;
      }
      puVar8 = (undefined4 *)FUN_0041cf20();
      local_4._0_1_ = 0xb;
      puVar9 = (undefined1 *)*puVar8;
      if (puVar9 == (undefined1 *)0x0) {
        puVar9 = &DAT_0044d0d5;
      }
      FUN_0041a1b0("MessageSender: Central system ip is %s",(char)puVar9);
      local_4._0_1_ = 7;
      if (local_d4[0] != (void *)0x0) {
        free(local_d4[0]);
      }
      local_c8 = (undefined *)0x1;
      local_7c = 2;
      plVar13 = &DAT_0044d114;
      do {
        FUN_0041b2a0(local_d4,"Communications/CentralSystemHost%d");
        local_4._0_1_ = 0xc;
        FUN_00401040(&local_ac);
        pcVar11 = free_exref;
        local_4._0_1_ = 7;
        if (local_d4[0] != (void *)0x0) {
          free(local_d4[0]);
        }
        FUN_00401080();
        piVar17 = local_c4;
        pcVar20 = (char *)0x407d45;
        uVar7 = FUN_0041bbf0(&local_ac,(int)piVar17,&local_a0);
        uVar21 = (undefined)uVar3;
        uVar4 = extraout_ECX_04;
        if (((char)uVar7 == '\0') || (local_9c == 0)) break;
        local_60 = &stack0xffffff08;
        FUN_0041aa30((void **)&stack0xffffff08);
        cVar2 = FUN_0041cf50(plVar13 + -5,pcVar20,(size_t)piVar17);
        puVar10 = local_a0;
        puVar9 = local_ac;
        if (cVar2 == '\0') {
          puVar6 = &DAT_0044d0d5;
          if (local_ac != (undefined1 *)0x0) {
            puVar6 = local_ac;
          }
          FUN_0041a1f0("MessageSender: Invalid configuration parameter (%s=%s): The address can\'t be resolved"
                       ,(char)puVar6);
          local_4._0_1_ = 6;
          FUN_00402ab0();
          pcVar11 = free_exref;
          local_4._0_1_ = 5;
          if (local_b8 != (undefined1 *)0x0) {
            free(local_b8);
          }
joined_r0x00407fa0:
          if (puVar10 != (undefined1 *)0x0) {
            local_4._0_1_ = 4;
            (*pcVar11)();
          }
          local_4 = CONCAT31(local_4._1_3_,3);
          local_90 = (undefined1 *)FUN_0041cf00(&local_94);
          local_4 = 0xffffffff;
          if (puVar9 != (undefined1 *)0x0) {
            local_90 = (undefined1 *)(*pcVar11)();
          }
          goto LAB_004086ce;
        }
        FUN_0041b2a0(local_44,"Communications/CentralSystemPort%d");
        local_4._0_1_ = 0xd;
        FUN_00401040(&local_ac);
        pcVar11 = free_exref;
        local_4._0_1_ = 7;
        if (local_44[0] != (void *)0x0) {
          free(local_44[0]);
        }
        uVar4 = FUN_0041bff0(local_c4,(char *)&local_ac,plVar13);
        puVar9 = local_ac;
        if ((char)uVar4 == '\0') {
          puVar10 = &DAT_0044d0d5;
          if (local_ac != (undefined1 *)0x0) {
            puVar10 = local_ac;
          }
          FUN_0041a1f0("MessageSender: Missing  or wrong configuration parameter (%s)",(char)puVar10
                      );
LAB_00407ff1:
          local_4._0_1_ = 6;
          FUN_00402ab0();
          local_4._0_1_ = 5;
          puVar10 = local_a0;
          if (local_b8 != (undefined1 *)0x0) {
            free(local_b8);
            puVar10 = local_a0;
          }
          goto joined_r0x00407fa0;
        }
        if ((*plVar13 < 1) || (0xffff < *plVar13)) {
          puVar10 = &DAT_0044d0d5;
          if (local_ac != (undefined1 *)0x0) {
            puVar10 = local_ac;
          }
          FUN_0041a1f0("MessageSender: Invalid configuration parameter (%s=%d)",(char)puVar10);
          goto LAB_00407ff1;
        }
        puVar8 = (undefined4 *)FUN_0041cf20();
        local_4._0_1_ = 0xe;
        puVar9 = (undefined1 *)*puVar8;
        if (puVar9 == (undefined1 *)0x0) {
          puVar9 = &DAT_0044d0d5;
        }
        FUN_0041a1b0("MessageSender: Extra central system (%s:%d) configured",(char)puVar9);
        local_4._0_1_ = 7;
        uVar4 = extraout_ECX_05;
        if (local_50[0] != (char *)0x0) {
          free(local_50[0]);
          uVar4 = extraout_ECX_06;
        }
        uVar21 = (undefined)uVar3;
        local_c8 = local_c8 + 1;
        local_7c = local_7c + 1;
        plVar13 = plVar13 + 6;
        pcVar11 = free_exref;
      } while ((int)plVar13 < 0x44d1ec);
      DAT_0044c6ac = local_c8;
      puVar9 = local_a0;
    }
    FUN_0041aa80(uVar4,(char *)0x7fffffff,"Communications/Retries");
    local_4._0_1_ = 0xf;
    uVar4 = FUN_0041bff0(local_c4,(char *)local_d4,(long *)(param_1 + 0xa0));
    local_4._0_1_ = 7;
    if (local_d4[0] != (void *)0x0) {
      (*pcVar11)();
    }
    if ((char)uVar4 == '\0') {
      pcVar20 = "MessageSender: Missing or wrong configuration parameter (Communications/Retries)";
LAB_00407ed6:
      FUN_0041a1f0(pcVar20,uVar21);
    }
    else {
      iVar5 = *(long *)(param_1 + 0xa0);
      uVar19 = (undefined)iVar5;
      if (iVar5 < 0) {
        FUN_0041a1f0("MessageSender: Invalid configuration parameter (Communications/Retries=%d)",
                     uVar19);
      }
      else {
        FUN_0041a1b0("MessageSender: Communications retries is %d",uVar19);
        FUN_0041aa80(extraout_ECX_07,(char *)0x7fffffff,"Communications/Timeout");
        local_4._0_1_ = 0x10;
        uVar4 = FUN_0041bff0(local_c4,(char *)local_d4,(long *)(param_1 + 0xa4));
        local_4._0_1_ = 7;
        if (local_d4[0] != (void *)0x0) {
          (*pcVar11)();
        }
        if ((char)uVar4 == '\0') {
          pcVar20 = 
          "MessageSender: Missing or wrong configuration parameter (Communications/Timeout)";
          goto LAB_00407ed6;
        }
        iVar5 = *(long *)(param_1 + 0xa4);
        uVar19 = (undefined)iVar5;
        if (-1 < iVar5) {
          FUN_0041a1b0("MessageSender: Communications timeout is %d",uVar19);
          FUN_0041aa80(extraout_ECX_08,(char *)0x7fffffff,"Communications/ObserversDefaultPort");
          local_4._0_1_ = 0x11;
          uVar7 = FUN_0041bff0(local_c4,(char *)local_d4,(long *)&local_c8);
          local_4 = CONCAT31(local_4._1_3_,7);
          uVar4 = extraout_ECX_09;
          if (local_d4[0] != (void *)0x0) {
            (*pcVar11)();
            uVar4 = extraout_ECX_10;
          }
          if ((char)uVar7 == '\0') {
            FUN_0041a1d0("MessageSender: Missing or wrong configuration parameter (Communications/ObserversDefaultPort)"
                         ,uVar21);
            local_c8 = (undefined *)0xffffffff;
            uVar4 = extraout_ECX_11;
          }
          FUN_0041aa80(uVar4,(char *)0x7fffffff,"Communications/ObserversList");
          local_4._0_1_ = 0x12;
          uVar7 = FUN_0041bbf0(local_d4,(int)local_c4,&local_ac);
          local_4._0_1_ = 7;
          uVar4 = extraout_ECX_12;
          if (local_d4[0] != (void *)0x0) {
            (*pcVar11)();
            uVar4 = extraout_ECX_13;
          }
          if ((char)uVar7 == '\0') {
            FUN_0041a1d0("MessageSender: Missing or wrong configuration parameter (Communications/ObserversList)"
                         ,uVar21);
          }
          else {
            FUN_0041aa80(uVar4,(char *)0x7fffffff,",");
            local_4._0_1_ = 0x13;
            FUN_0041cae0(&local_ac,local_38,local_d4);
            local_4 = CONCAT31(local_4._1_3_,0x15);
            if (local_d4[0] != (void *)0x0) {
              (*pcVar11)();
            }
            uVar4 = FUN_0041cbe0();
            pcVar12 = free_exref;
            cVar2 = (char)uVar4;
            while (cVar2 != '\0') {
              FUN_0041cc10(local_38,local_50);
              local_4._0_1_ = 0x16;
              FUN_00401040(&local_6c);
              local_4._0_1_ = 0x15;
              if (local_50[0] != (char *)0x0) {
                free(local_50[0]);
              }
              ppcVar15 = &local_6c;
              FUN_0041abf0(local_44,ppcVar15,local_44,':');
              local_4._0_1_ = 0x17;
              FUN_00401040(&local_5c);
              local_4._0_1_ = 0x15;
              if (local_44[0] != (void *)0x0) {
                free(local_44[0]);
              }
              sVar18 = 0x4082db;
              FUN_0041ad20(':',local_d4);
              local_4._0_1_ = 0x18;
              FUN_00401040(&local_78);
              local_4 = CONCAT31(local_4._1_3_,0x15);
              if (local_d4[0] != (void *)0x0) {
                sVar18 = 0x408301;
                free(local_d4[0]);
              }
              puVar9 = local_5c;
              if (local_74 != 0) {
                sVar18 = 0x40832a;
                uVar4 = FUN_0041b170((long *)&local_80);
                puVar9 = local_5c;
                if ((char)uVar4 != '\0') goto LAB_00408332;
                puVar10 = &DAT_0044d0d5;
                if (local_5c != (undefined1 *)0x0) {
                  puVar10 = local_5c;
                }
                FUN_0041a1f0("MessageSender: Invalid configuration parameter (Communications/ObserversList), invalid port for address \"%s\""
                             ,(char)puVar10);
LAB_00408547:
                local_4._0_1_ = 7;
                FUN_004037f0(local_38);
                local_4._0_1_ = 6;
                FUN_00402ab0();
                local_4._0_1_ = 5;
                if (local_b8 != (undefined1 *)0x0) {
                  free(local_b8);
                }
                local_4._0_1_ = 4;
                if (local_a0 != (undefined1 *)0x0) {
                  free(local_a0);
                }
                local_4._0_1_ = 3;
                FUN_0041cf00(&local_94);
                local_4._0_1_ = 2;
                if (local_78 != (void *)0x0) {
                  free(local_78);
                }
                local_4._0_1_ = 1;
                if (puVar9 != (undefined1 *)0x0) {
                  free(puVar9);
                }
                local_4 = (uint)local_4._1_3_ << 8;
                if (local_6c == (char *)0x0) goto LAB_00407f28;
                free(local_6c);
                local_4 = 0xffffffff;
                local_90 = local_ac;
                goto LAB_004086c4;
              }
              if ((int)local_c8 < 0) {
                puVar10 = &DAT_0044d0d5;
                if (local_5c != (undefined1 *)0x0) {
                  puVar10 = local_5c;
                }
                FUN_0041a1f0("MessageSender: Invalid configuration parameter (Communications/ObserversList), no port specified for address \"%s\""
                             ,(char)puVar10);
                goto LAB_00408547;
              }
              local_80 = local_c8;
LAB_00408332:
              puVar9 = local_5c;
              puVar10 = &DAT_0044d0d5;
              if (local_5c != (undefined1 *)0x0) {
                puVar10 = local_5c;
              }
              local_60 = &stack0xffffff08;
              FUN_0041aa80(puVar10,(char *)0x7fffffff,puVar10);
              cVar2 = FUN_0041cf50(&local_94,(char *)ppcVar15,sVar18);
              if (cVar2 == '\0') {
                puVar10 = &DAT_0044d0d5;
                if (puVar9 != (undefined1 *)0x0) {
                  puVar10 = puVar9;
                }
                FUN_0041a1f0("MessageSender: Invalid configuration parameter (Communications/ObserversList), can\'t resolve \"%s\""
                             ,(char)puVar10);
                goto LAB_00408547;
              }
              puVar8 = (undefined4 *)FUN_0041cf20();
              local_4._0_1_ = 0x19;
              puVar9 = (undefined1 *)*puVar8;
              if (puVar9 == (undefined1 *)0x0) {
                puVar9 = &DAT_0044d0d5;
              }
              FUN_0041a1b0("MessageSender: Registered observer at (%s:%d)",(char)puVar9);
              local_4 = CONCAT31(local_4._1_3_,0x15);
              if (local_18 != (void *)0x0) {
                free(local_18);
              }
              local_60 = &stack0xfffffefc;
              ppuVar14 = aIpAddr::vftable;
              _Dst = (void *)0x0;
              pvVar16 = (void *)0x0;
              sVar18 = 0;
              puVar1 = &stack0xfffffefc;
              if (local_90 != (undefined1 *)0x0) {
                FUN_0041b310();
                memcpy(_Dst,local_90,local_8c);
                *(undefined *)(local_8c + (int)_Dst) = 0;
                sVar18 = local_8c;
                puVar1 = local_60;
              }
              local_60 = puVar1;
              FUN_00409040((int *)(param_1 + 0x104),ppuVar14,_Dst,sVar18,pvVar16,local_84,local_80);
              uVar4 = FUN_0041cbe0();
              pcVar11 = free_exref;
              puVar9 = local_a0;
              cVar2 = (char)uVar4;
            }
            local_4._1_3_ = (uint3)((uint)local_4 >> 8);
            local_4._0_1_ = 7;
            FUN_004037f0(local_38);
          }
          local_4._0_1_ = 6;
          FUN_00402ab0();
          local_4._0_1_ = 5;
          if (local_b8 != (undefined1 *)0x0) {
            (*pcVar11)();
          }
          local_4._0_1_ = 4;
          if (puVar9 != (undefined1 *)0x0) {
            (*pcVar11)();
          }
          local_4._0_1_ = 3;
          FUN_0041cf00(&local_94);
          local_4._0_1_ = 2;
          if (local_78 != (void *)0x0) {
            (*pcVar11)();
          }
          local_4._0_1_ = 1;
          if (local_5c != (undefined1 *)0x0) {
            (*pcVar11)();
          }
          local_4 = (uint)local_4._1_3_ << 8;
          if (local_6c != (char *)0x0) {
            (*pcVar11)();
          }
          local_4 = 0xffffffff;
          if (local_ac != (undefined1 *)0x0) {
            local_ac = (undefined1 *)(*pcVar11)();
          }
          ExceptionList = local_c;
          return CONCAT31((int3)((uint)local_ac >> 8),1);
        }
        FUN_0041a1f0("MessageSender: Invalid configuration parameter (Communications/Timeout=%d)",
                     uVar19);
      }
    }
    local_4._0_1_ = 6;
    FUN_00402ab0();
    local_4._0_1_ = 5;
    if (local_b8 != (undefined1 *)0x0) {
      (*pcVar11)();
    }
    local_4._0_1_ = 4;
    if (puVar9 != (undefined1 *)0x0) {
      (*pcVar11)();
    }
    local_4 = CONCAT31(local_4._1_3_,3);
    FUN_0041cf00(&local_94);
    pcVar12 = pcVar11;
LAB_00407f28:
    local_4 = 0xffffffff;
    local_90 = local_ac;
  }
LAB_004086c4:
  if (local_90 != (undefined1 *)0x0) {
    local_90 = (undefined1 *)(*pcVar12)();
  }
LAB_004086ce:
  ExceptionList = local_c;
  return (uint)local_90 & 0xffffff00;
}



undefined4 * FUN_004086f0(undefined4 *param_1)

{
  void **ppvVar1;
  int iVar2;
  int unaff_ESI;
  
  *param_1 = aIpAddr::vftable;
  ppvVar1 = (void **)(param_1 + 1);
  *ppvVar1 = (void *)0x0;
  param_1[3] = 0;
  param_1[2] = 0;
  if (*(int *)(unaff_ESI + 4) != 0) {
    FUN_0041b310();
    memcpy(*ppvVar1,*(void **)(unaff_ESI + 4),*(size_t *)(unaff_ESI + 8));
    iVar2 = *(int *)(unaff_ESI + 8);
    param_1[2] = iVar2;
    *(undefined *)(iVar2 + (int)*ppvVar1) = 0;
  }
  param_1[4] = *(undefined4 *)(unaff_ESI + 0x10);
  return param_1;
}



undefined4 * __thiscall FUN_00408750(void *this,byte param_1)

{
  *(undefined ***)this = aIpAddr::vftable;
  if (*(void **)((int)this + 4) != (void *)0x0) {
    free(*(void **)((int)this + 4));
  }
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __fastcall FUN_00408780(int param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  char cVar3;
  uint uVar4;
  DWORD DVar5;
  undefined4 uVar6;
  int iVar7;
  code *pcVar8;
  undefined uVar9;
  undefined4 *puStack_28;
  void *pvStack_24;
  void *local_14;
  undefined *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_004394d8;
  local_14 = ExceptionList;
  uVar4 = DAT_0044a01c ^ (uint)&stack0xffffffc8;
  ExceptionList = &local_14;
  DVar5 = GetCurrentThreadId();
  FUN_0041a190("MessageSender: Body(%ld) begin",(char)DVar5);
  *(undefined *)(param_1 + 0x35) = 1;
  FUN_0041c150();
  uVar9 = (undefined)uVar4;
  cVar3 = *(char *)(param_1 + 4);
  while (cVar3 == '\0') {
    puStack_28 = (undefined4 *)0x0;
    *(undefined4 *)(param_1 + 0xf8) = 0;
    FUN_00408ea0((void *)(param_1 + 0x3c),(int *)&puStack_28);
    uVar9 = (undefined)uVar4;
    if (*(char *)(param_1 + 4) != '\0') break;
    if (*(short *)(puStack_28[1] + 9) == 0xff) {
      DAT_0044c6a8 = *(int *)(puStack_28[1] + 0xd);
      (**(code **)*puStack_28)(1);
    }
    else {
      iVar7 = *(int *)(param_1 + 0xa0);
      *(undefined4 **)(param_1 + 0xf8) = puStack_28;
      *(undefined *)(param_1 + 0xcc) = 1;
      cVar3 = '\0';
      FUN_00412a90(puStack_28[1]);
      uStack_c = 0;
      FUN_0041a190("MessageSender: Body() Sending message(%d,%s)",
                   (char)*(undefined4 *)(*(int *)(*(int *)(param_1 + 0xf8) + 4) + 0xd));
      uStack_c = 0xffffffff;
      if (pvStack_24 != (void *)0x0) {
        free(pvStack_24);
      }
      pcVar8 = GetCurrentThreadId_exref;
      if (*(char *)(*(int *)(param_1 + 0xf8) + 0xc) == '\0') {
        while ((0 < iVar7 && (*(char *)(param_1 + 0xcc) != '\0'))) {
          (**(code **)(**(int **)(param_1 + 0xf8) + 4))
                    (*(undefined4 *)(param_1 + 0x100),&DAT_0044d0e8 + DAT_0044c6a8 * 0x18,
                     (&DAT_0044d0fc)[DAT_0044c6a8 * 6],*(undefined4 *)(param_1 + 0xa4));
          iVar7 = iVar7 + -1;
          (**(code **)(*(int *)(param_1 + 0xd0) + 0x10))(*(undefined4 *)(param_1 + 0xa4));
          DVar5 = GetCurrentThreadId();
          if (DAT_0044b588 == DVar5) {
            _DAT_0044b58c = _DAT_0044b58c + 1;
          }
          else {
            EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
            _DAT_0044b58c = 1;
            DAT_0044b588 = GetCurrentThreadId();
          }
          *(undefined *)(param_1 + 0xf4) = 0;
          *(undefined *)(param_1 + 0xf5) = 0;
          DVar5 = GetCurrentThreadId();
          if ((DAT_0044b588 == DVar5) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
            DAT_0044b588 = 0xffffffff;
            LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
          }
        }
        DVar5 = GetCurrentThreadId();
        if (*(DWORD *)(param_1 + 0xac) == DVar5) {
          *(int *)(param_1 + 0xb0) = *(int *)(param_1 + 0xb0) + 1;
        }
        else {
          EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xb4));
          *(undefined4 *)(param_1 + 0xb0) = 1;
          DVar5 = GetCurrentThreadId();
          *(DWORD *)(param_1 + 0xac) = DVar5;
        }
        if (*(undefined4 **)(param_1 + 0xf8) != (undefined4 *)0x0) {
          (**(code **)**(undefined4 **)(param_1 + 0xf8))(1);
        }
        *(undefined4 *)(param_1 + 0xf8) = 0;
        DVar5 = GetCurrentThreadId();
        if (*(DWORD *)(param_1 + 0xac) == DVar5) {
          piVar1 = (int *)(param_1 + 0xb0);
          *piVar1 = *piVar1 + -1;
          iVar7 = *piVar1;
          goto joined_r0x00408b75;
        }
      }
      else {
        DVar5 = GetCurrentThreadId();
        if (*(DWORD *)(param_1 + 0xac) == DVar5) {
          *(int *)(param_1 + 0xb0) = *(int *)(param_1 + 0xb0) + 1;
        }
        else {
          EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xb4));
          *(undefined4 *)(param_1 + 0xb0) = 1;
          DVar5 = GetCurrentThreadId();
          *(DWORD *)(param_1 + 0xac) = DVar5;
        }
        puVar2 = *(undefined4 **)(param_1 + 0xfc);
        if ((puVar2 != (undefined4 *)0x0) && (puVar2 != *(undefined4 **)(param_1 + 0xf8))) {
          (**(code **)*puVar2)(1);
        }
        *(undefined4 *)(param_1 + 0xfc) = *(undefined4 *)(param_1 + 0xf8);
        DVar5 = GetCurrentThreadId();
        if (*(DWORD *)(param_1 + 0xac) == DVar5) {
          piVar1 = (int *)(param_1 + 0xb0);
          *piVar1 = *piVar1 + -1;
          if (*piVar1 == 0) {
            *(undefined4 *)(param_1 + 0xac) = 0xffffffff;
            LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xb4));
          }
        }
        while ((0 < iVar7 && (cVar3 == '\0'))) {
          piVar1 = *(int **)(param_1 + 0xf8);
          if (*(short *)(piVar1[1] + 9) == 0x8f) {
            cVar3 = (**(code **)(*piVar1 + 4))
                              (*(undefined4 *)(param_1 + 0x100),piVar1 + 5,piVar1[10]);
            pcVar8 = GetCurrentThreadId_exref;
          }
          else {
            cVar3 = (**(code **)(*piVar1 + 4))
                              (*(undefined4 *)(param_1 + 0x100),&DAT_0044d0e8 + DAT_0044c6a8 * 0x18,
                               (&DAT_0044d0fc)[DAT_0044c6a8 * 6],*(undefined4 *)(param_1 + 0xa4));
          }
          if (cVar3 == '\0') {
            FUN_0041a190("MessageSender: Failed attempt %d of sending message(%d)",
                         ((char)*(undefined4 *)(param_1 + 0xa0) - (char)iVar7) + '\x01');
          }
          iVar7 = iVar7 + -1;
        }
        iVar7 = (*pcVar8)();
        if (*(int *)(param_1 + 0xac) == iVar7) {
          *(int *)(param_1 + 0xb0) = *(int *)(param_1 + 0xb0) + 1;
        }
        else {
          EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xb4));
          *(undefined4 *)(param_1 + 0xb0) = 1;
          uVar6 = (*pcVar8)();
          *(undefined4 *)(param_1 + 0xac) = uVar6;
        }
        *(undefined4 *)(param_1 + 0xf8) = 0;
        iVar7 = (*pcVar8)();
        if (*(int *)(param_1 + 0xac) == iVar7) {
          piVar1 = (int *)(param_1 + 0xb0);
          *piVar1 = *piVar1 + -1;
          iVar7 = *piVar1;
joined_r0x00408b75:
          if (iVar7 == 0) {
            *(undefined4 *)(param_1 + 0xac) = 0xffffffff;
            LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xb4));
          }
        }
      }
    }
    uVar9 = (undefined)uVar4;
    cVar3 = *(char *)(param_1 + 4);
  }
  FUN_0041a190("MessageSender: Body() end",uVar9);
  ExceptionList = local_14;
  return;
}



void FUN_00408bc0(void)

{
  FUN_00408e20();
  return;
}



undefined4 * FUN_00408be0(undefined4 *param_1)

{
  undefined4 *puVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_004394b1;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = aSynchroQueue<class_CMsg*>::vftable;
  FUN_0041db50();
  param_1[3] = aSemaphore::vftable;
  param_1[0xc] = 0;
  param_1[0xd] = 0;
  local_4 = 0;
  FUN_0041db50();
  param_1[0xe] = aSemaphore::vftable;
  param_1[0x17] = 1;
  param_1[0x18] = 1;
  local_4._0_1_ = 1;
  param_1[1] = 1;
  puVar1 = (undefined4 *)operator_new(0x10);
  local_4 = CONCAT31(local_4._1_3_,2);
  if (puVar1 == (undefined4 *)0x0) {
    param_1[2] = 0;
  }
  else {
    *puVar1 = 1;
    _eh_vector_constructor_iterator_
              (puVar1 + 1,0xc,1,(_func_void_void_ptr *)&LAB_004091c0,
               (_func_void_void_ptr *)&LAB_004091d0);
    param_1[2] = puVar1 + 1;
  }
  ExceptionList = local_c;
  return param_1;
}



void __fastcall FUN_00408cc0(undefined4 *param_1)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  void *pvVar5;
  uint uVar6;
  int **ppiVar7;
  int iVar8;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439466;
  local_c = ExceptionList;
  uVar6 = DAT_0044a01c ^ (uint)&stack0xffffffd8;
  ExceptionList = &local_c;
  *param_1 = aSynchroQueue<class_CMsg*>::vftable;
  local_4 = 1;
  (**(code **)(param_1[0xe] + 0x10))(0xffffffff,uVar6);
  uVar6 = 0;
  if (param_1[1] != 0) {
    iVar8 = 0;
    do {
      iVar2 = *(int *)(iVar8 + param_1[2]);
      while (iVar2 != 0) {
        piVar1 = (int *)(iVar8 + param_1[2]);
        ppiVar7 = (int **)FUN_0040e220((int)piVar1);
        piVar3 = *ppiVar7;
        if (1 < *piVar1) {
          if (piVar3 == (int *)piVar1[1]) {
            iVar2 = *(int *)piVar1[1];
            piVar1[1] = iVar2;
            *(undefined4 *)(iVar2 + 4) = 0;
          }
          else if (piVar3 == (int *)piVar1[2]) {
            puVar4 = (undefined4 *)((int *)piVar1[2])[1];
            piVar1[2] = (int)puVar4;
            *puVar4 = 0;
          }
          else {
            *(int *)piVar3[1] = *piVar3;
            *(int *)(*piVar3 + 4) = piVar3[1];
          }
        }
        operator_delete(piVar3);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 == 0) {
          piVar1[2] = 0;
          piVar1[1] = 0;
        }
        iVar2 = *(int *)(iVar8 + param_1[2]);
      }
      uVar6 = uVar6 + 1;
      iVar8 = iVar8 + 0xc;
    } while (uVar6 < (uint)param_1[1]);
  }
  pvVar5 = (void *)param_1[2];
  if (pvVar5 != (void *)0x0) {
    _eh_vector_destructor_iterator_
              (pvVar5,0xc,*(int *)((int)pvVar5 + -4),(_func_void_void_ptr *)&LAB_004091d0);
    operator_delete__((void *)((int)pvVar5 + -4));
  }
  (**(code **)(param_1[0xe] + 8))(0);
  param_1[0xe] = aSyncObj::vftable;
  param_1[0x10] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  param_1[3] = aSyncObj::vftable;
  param_1[5] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  ExceptionList = param_1;
  return;
}



uint FUN_00408e20(void)

{
  int *piVar1;
  int iVar2;
  char cVar3;
  int in_EAX;
  uint uVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  undefined4 unaff_ESI;
  
  (**(code **)(*(int *)(in_EAX + 0x38) + 0x10))(0xffffffff);
  cVar3 = (**(code **)(*(int *)(in_EAX + 0xc) + 8))(0);
  if (cVar3 == '\0') {
    uVar4 = (**(code **)(*(int *)(in_EAX + 0x38) + 8))(0);
    return uVar4 & 0xffffff00;
  }
  piVar1 = *(int **)(in_EAX + 8);
  iVar2 = piVar1[2];
  puVar5 = (undefined4 *)operator_new(0xc);
  puVar5[1] = iVar2;
  *puVar5 = 0;
  puVar5[2] = unaff_ESI;
  if ((undefined4 *)piVar1[2] == (undefined4 *)0x0) {
    piVar1[1] = (int)puVar5;
  }
  else {
    *(undefined4 *)piVar1[2] = puVar5;
  }
  *piVar1 = *piVar1 + 1;
  piVar1[2] = (int)puVar5;
  uVar6 = (**(code **)(*(int *)(in_EAX + 0x38) + 8))(0);
  return CONCAT31((int3)((uint)uVar6 >> 8),1);
}



uint __thiscall FUN_00408ea0(void *this,int *param_1)

{
  int *piVar1;
  uint uVar2;
  int *piVar3;
  uint uVar4;
  uint uVar5;
  int **ppiVar6;
  undefined4 uVar7;
  int *piVar8;
  undefined **local_20;
  int *local_1c;
  undefined4 local_18;
  undefined local_14;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438ea8;
  local_c = ExceptionList;
  uVar2 = DAT_0044a01c ^ (uint)&stack0xffffffcc;
  ExceptionList = &local_c;
  local_18 = 2;
  piVar1 = (int *)((int)this + 0x38);
  local_20 = aMultiLock::vftable;
  piVar3 = (int *)operator_new(8);
  *piVar3 = (int)this + 0xc;
  piVar3[1] = (int)piVar1;
  local_14 = 1;
  local_4 = 0;
  local_1c = piVar3;
  uVar4 = FUN_0041dd40((int)&local_20);
  if (-1 < (int)uVar4) {
    uVar4 = *(uint *)((int)this + 4);
    uVar5 = 0;
    if (uVar4 != 0) {
      piVar8 = *(int **)((int)this + 8);
      do {
        if (*piVar8 != 0) break;
        uVar5 = uVar5 + 1;
        piVar8 = piVar8 + 3;
      } while (uVar5 < uVar4);
    }
    if (uVar5 != uVar4) {
      ppiVar6 = (int **)FUN_0040e220(*(int *)((int)this + 8) + uVar5 * 0xc);
      piVar8 = *ppiVar6;
      *param_1 = piVar8[2];
      FUN_004060d0(piVar8);
      uVar7 = (**(code **)(*piVar1 + 8))(0,uVar2);
      if (piVar3 != (int *)0x0) {
        operator_delete__(piVar3);
      }
      ExceptionList = local_c;
      return CONCAT31((int3)((uint)uVar7 >> 8),1);
    }
    uVar4 = (**(code **)(*piVar1 + 8))(0);
  }
  if (piVar3 != (int *)0x0) {
    operator_delete__(piVar3);
  }
  ExceptionList = local_c;
  return uVar4 & 0xffffff00;
}



void FUN_00408fc0(void)

{
  undefined4 *puVar1;
  void *pvVar2;
  int *unaff_EBX;
  
  if (*unaff_EBX < 2) {
    if (*unaff_EBX == 0) {
      return;
    }
  }
  else {
    for (puVar1 = *(undefined4 **)unaff_EBX[1]; puVar1 != (undefined4 *)0x0;
        puVar1 = (undefined4 *)*puVar1) {
      pvVar2 = (void *)puVar1[1];
      if (pvVar2 != (void *)0x0) {
        *(undefined ***)((int)pvVar2 + 8) = aIpAddr::vftable;
        if (*(void **)((int)pvVar2 + 0xc) != (void *)0x0) {
          free(*(void **)((int)pvVar2 + 0xc));
        }
        operator_delete(pvVar2);
      }
    }
  }
  pvVar2 = (void *)unaff_EBX[2];
  if (pvVar2 != (void *)0x0) {
    *(undefined ***)((int)pvVar2 + 8) = aIpAddr::vftable;
    if (*(void **)((int)pvVar2 + 0xc) != (void *)0x0) {
      free(*(void **)((int)pvVar2 + 0xc));
    }
    operator_delete(pvVar2);
  }
  return;
}



void FUN_00409040(int *param_1,undefined4 param_2,void *param_3,size_t param_4,undefined4 param_5,
                 undefined4 param_6,undefined4 param_7)

{
  int iVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439428;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  iVar1 = FUN_00409150(param_1[2]);
  if (param_3 != *(void **)(iVar1 + 0xc)) {
    FUN_0041b310();
    memcpy(*(void **)(iVar1 + 0xc),param_3,param_4);
    *(size_t *)(iVar1 + 0x10) = param_4;
    *(undefined *)(param_4 + (int)*(void **)(iVar1 + 0xc)) = 0;
  }
  *(undefined4 *)(iVar1 + 0x18) = param_6;
  *(undefined4 *)(iVar1 + 0x1c) = param_7;
  if ((int *)param_1[2] == (int *)0x0) {
    param_1[1] = iVar1;
  }
  else {
    *(int *)param_1[2] = iVar1;
  }
  *param_1 = *param_1 + 1;
  param_1[2] = iVar1;
  local_4 = 0xffffffff;
  if (param_3 != (void *)0x0) {
    free(param_3);
  }
  ExceptionList = local_c;
  return;
}



undefined4 * __thiscall FUN_00409100(void *this,byte param_1)

{
  *(undefined ***)this = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



undefined4 * __thiscall FUN_00409130(void *this,byte param_1)

{
  FUN_00408cc0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void FUN_00409150(undefined4 param_1)

{
  undefined4 *puVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438edb;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  puVar1 = (undefined4 *)operator_new(0x20);
  local_4 = 0;
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    FUN_0041ce60(puVar1 + 2);
  }
  puVar1[1] = param_1;
  *puVar1 = 0;
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_00409220(int param_1)

{
  if (*(void **)(param_1 + 0x3c) != (void *)0x0) {
    FUN_00409980(*(void **)(param_1 + 0x3c),*(char *)(param_1 + 0x40));
  }
  return;
}



undefined4 * FUN_00409240(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439f05;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  param_1[1] = IPhotoProcessorEH::vftable;
  param_1[2] = IRemoteMessageReceiverEH::vftable;
  param_1[3] = ITimerEH::vftable;
  *param_1 = CRemoteUnit::vftable;
  param_1[1] = CRemoteUnit::vftable;
  param_1[2] = CRemoteUnit::vftable;
  param_1[3] = CRemoteUnit::vftable;
  param_1[0x10] = aThread::vftable;
  FUN_0041db50();
  param_1[0x12] = aCondition::vftable;
  *(undefined *)(param_1 + 0x1b) = 0;
  param_1[0x10] = CRemoteMessageReceiver::vftable;
  local_4 = 0;
  FUN_00406fe0(param_1 + 0x25);
  param_1[0x6a] = aThread::vftable;
  FUN_0041db50();
  param_1[0x6c] = aCondition::vftable;
  *(undefined *)(param_1 + 0x75) = 0;
  param_1[0x6a] = CIOManager::vftable;
  param_1[0x7f] = aCriticalSection::vftable;
  param_1[0x80] = 0xffffffff;
  param_1[0x81] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x82));
  param_1[0x7d] = 0;
  FUN_0041d320();
  local_4 = CONCAT31(local_4._1_3_,3);
  FUN_004010e0(param_1 + 0xb1);
  param_1[0xc9] = 0;
  param_1[0xca] = 0;
  param_1[0xcb] = 0;
  param_1[0xcc] = aCriticalSection::vftable;
  param_1[0xcd] = 0xffffffff;
  param_1[0xce] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xcf));
  FUN_0041db50();
  param_1[0xda] = aCondition::vftable;
  *(undefined *)(param_1 + 0xe3) = 0;
  param_1[0xe4] = aCriticalSection::vftable;
  param_1[0xe5] = 0xffffffff;
  param_1[0xe6] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xe7));
  param_1[0xed] = 0;
  param_1[0xef] = 0;
  param_1[0xee] = 0;
  param_1[0x88] = 0;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_004093e0(void *this,byte param_1)

{
  FUN_00409460((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void FUN_00409400(void)

{
  undefined4 *puVar1;
  int *unaff_EDI;
  
  unaff_EDI[3] = (int)aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(unaff_EDI + 6));
  if (*unaff_EDI < 2) {
    if (*unaff_EDI != 0) {
      operator_delete((void *)unaff_EDI[2]);
    }
    return;
  }
  for (puVar1 = *(undefined4 **)unaff_EDI[1]; puVar1 != (undefined4 *)0x0;
      puVar1 = (undefined4 *)*puVar1) {
    operator_delete((void *)puVar1[1]);
  }
  operator_delete((void *)unaff_EDI[2]);
  return;
}



void __fastcall FUN_00409460(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439eac;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = CRemoteUnit::vftable;
  param_1[1] = CRemoteUnit::vftable;
  param_1[2] = CRemoteUnit::vftable;
  param_1[3] = CRemoteUnit::vftable;
  local_4 = 7;
  if ((void *)param_1[0xed] != (void *)0x0) {
    free((void *)param_1[0xed]);
  }
  param_1[0xe4] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xe7));
  param_1[0xda] = aSyncObj::vftable;
  param_1[0xdc] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  FUN_00409400();
  local_4._0_1_ = 3;
  FUN_004011f0(param_1 + 0xb1);
  param_1[0x89] = aTimer::vftable;
  param_1[0xa3] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xa6));
  param_1[0x98] = aSyncObj::vftable;
  param_1[0x9a] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  param_1[0x89] = aThread::vftable;
  param_1[0x8b] = aSyncObj::vftable;
  param_1[0x8d] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  local_4._0_1_ = 1;
  FUN_00403110(param_1 + 0x6a);
  local_4 = (uint)local_4._1_3_ << 8;
  FUN_004070c0(param_1 + 0x25);
  param_1[0x21] = 0;
  param_1[0x10] = aThread::vftable;
  param_1[0x12] = aSyncObj::vftable;
  param_1[0x14] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  ExceptionList = local_c;
  return;
}



// WARNING: Removing unreachable block (ram,0x0040968c)
// WARNING: Removing unreachable block (ram,0x004096a6)

uint FUN_004095d0(void *param_1,void *param_2,undefined4 param_3,undefined4 param_4,char *param_5,
                 undefined *param_6)

{
  char *_Src;
  undefined *_Size;
  byte bVar1;
  char cVar2;
  undefined4 uVar3;
  undefined1 *puVar4;
  BOOL BVar5;
  int iVar6;
  char *pcVar7;
  uint uVar8;
  undefined4 *puVar9;
  void *in_stack_ffffff90;
  undefined4 in_stack_ffffff94;
  undefined local_30 [36];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a8c8;
  local_c = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffac;
  ExceptionList = &local_c;
  local_4 = 1;
  uVar3 = FUN_0040b370((int)param_1,&param_2);
  _Size = param_6;
  _Src = param_5;
  if ((char)uVar3 == '\0') {
    local_4 = local_4 & 0xffffff00;
    if (param_2 != (void *)0x0) {
      free(param_2);
    }
    local_4 = 0xffffffff;
    pcVar7 = param_5;
    if (param_5 != (char *)0x0) {
      free(param_5);
      pcVar7 = param_5;
    }
  }
  else {
    if (param_5 != (char *)0x0) {
      FUN_0041b310();
      memcpy((void *)0x0,_Src,(size_t)_Size);
      *_Size = 0;
    }
    puVar4 = &DAT_0044d0d5;
    BVar5 = GetFileAttributesExA(&DAT_0044d0d5,GetFileExInfoStandard,local_30);
    if (BVar5 == 0) {
      pcVar7 = &DAT_0044d0d5;
      if (_Src != (char *)0x0) {
        pcVar7 = _Src;
      }
      iVar6 = _mkdir(pcVar7);
      if (iVar6 != 0) {
        pcVar7 = &DAT_0044d0d5;
        if (_Src != (char *)0x0) {
          pcVar7 = _Src;
        }
        FUN_0041a1f0("Unit: Can\'t create path %s",(char)pcVar7);
        local_4 = local_4 & 0xffffff00;
        pcVar7 = (char *)param_2;
        if (param_2 != (void *)0x0) {
          free(param_2);
        }
        local_4 = 0xffffffff;
        if (_Src != (char *)0x0) {
          free(_Src);
          ExceptionList = local_c;
          return (uint)pcVar7 & 0xffffff00;
        }
        goto LAB_00409640;
      }
    }
    *(undefined *)((int)param_1 + 0x1c) = 1;
    FUN_0041c210();
    *(undefined4 *)((int)param_1 + 0x20) = 0;
    *(undefined4 *)((int)param_1 + 0x28) = 0;
    *(undefined *)((int)param_1 + 0x26) = 0;
    *(undefined *)((int)param_1 + 0x25) = 0;
    *(undefined *)((int)param_1 + 0x24) = 0;
    *(undefined4 *)((int)param_1 + 0x354) = 1000;
    *(undefined4 *)((int)param_1 + 0x358) = 0;
    *(undefined4 *)((int)param_1 + 0x35c) = 0;
    *(undefined4 *)((int)param_1 + 0x360) = 0;
    *(undefined4 *)((int)param_1 + 0x364) = 0;
    uVar3 = 0x409773;
    FUN_0041aa30((void **)&stack0xffffff9c);
    local_4._0_1_ = 2;
    FUN_0041aa30((void **)&stack0xffffff90);
    local_4._0_1_ = 1;
    cVar2 = FUN_00401290((void *)((int)param_1 + 0x2c4),in_stack_ffffff90,in_stack_ffffff94,uVar3,
                         puVar4);
    if (cVar2 == '\0') {
      local_4 = (uint)local_4._1_3_ << 8;
      pcVar7 = (char *)param_2;
      if (param_2 != (void *)0x0) {
        free(param_2);
      }
      local_4 = 0xffffffff;
      if (_Src != (char *)0x0) {
        free(_Src);
        ExceptionList = local_c;
        return (uint)pcVar7 & 0xffffff00;
      }
    }
    else {
      FUN_00411b10();
      FUN_0041a1b0("Unit: System is starting",bVar1);
      iVar6 = FUN_00416040();
      if (iVar6 != 0) {
        uVar3 = FUN_00407180(&param_2);
        if ((char)uVar3 == '\0') {
          iVar6 = 1;
        }
        else {
          uVar3 = FUN_004031a0(&param_2,param_1);
          if ((char)uVar3 == '\0') {
            iVar6 = 2;
          }
          else {
            puVar9 = (undefined4 *)operator_new(0x1c0);
            if (puVar9 == (undefined4 *)0x0) {
              puVar9 = (undefined4 *)0x0;
            }
            else {
              puVar9 = FUN_004046e0(puVar9);
            }
            *(undefined4 **)((int)param_1 + 0x220) = puVar9;
            uVar3 = FUN_004049a0((int)param_1 + 4);
            if ((char)uVar3 == '\0') {
              iVar6 = 3;
            }
            else {
              uVar3 = FUN_004062e0(&param_2,(int)param_1 + 8);
              if ((char)uVar3 == '\0') {
                iVar6 = 4;
              }
              else {
                uVar3 = FUN_0041d440();
                if ((char)uVar3 != '\0') {
                  FUN_0040bf90(param_1,'\x01');
                  local_4 = (uint)local_4._1_3_ << 8;
                  if (param_2 != (void *)0x0) {
                    free(param_2);
                  }
                  local_4 = 0xffffffff;
                  if (param_5 != (char *)0x0) {
                    free(param_5);
                  }
                  ExceptionList = local_c;
                  return CONCAT31((int3)((uint)param_5 >> 8),1);
                }
                iVar6 = 5;
              }
            }
          }
        }
        uVar8 = FUN_0040c1f0(iVar6);
        local_4 = (uint)local_4._1_3_ << 8;
        if (param_2 != (void *)0x0) {
          free(param_2);
        }
        local_4 = 0xffffffff;
        if (param_5 != (char *)0x0) {
          free(param_5);
        }
        ExceptionList = local_c;
        return CONCAT31((int3)((uint)param_5 >> 8),(char)uVar8);
      }
      FUN_0041a1f0("Unit: Can\'t initialize networking.",bVar1);
      local_4 = (uint)local_4._1_3_ << 8;
      if (param_2 != (void *)0x0) {
        free(param_2);
      }
      local_4 = 0xffffffff;
      pcVar7 = param_5;
      if (param_5 != (char *)0x0) {
        free(param_5);
        ExceptionList = local_c;
        return (uint)param_5 & 0xffffff00;
      }
    }
  }
LAB_00409640:
  ExceptionList = local_c;
  return (uint)pcVar7 & 0xffffff00;
}



void __thiscall FUN_00409980(void *this,char param_1)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar3;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined extraout_DL_01;
  undefined uVar4;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439e16;
  local_c = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffe8;
  ExceptionList = &local_c;
  puVar2 = (undefined4 *)operator_new(0x14);
  uVar3 = extraout_ECX;
  uVar4 = extraout_DL;
  if (param_1 == '\0') {
    local_4 = 1;
    if (puVar2 != (undefined4 *)0x0) {
      FUN_004149b0(puVar2,*(undefined4 *)((int)this + 0x10),4);
      uVar3 = extraout_ECX_01;
      uVar4 = extraout_DL_01;
    }
  }
  else {
    local_4 = 0;
    if (puVar2 != (undefined4 *)0x0) {
      FUN_004149b0(puVar2,*(undefined4 *)((int)this + 0x10),3);
      uVar3 = extraout_ECX_00;
      uVar4 = extraout_DL_00;
    }
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar3,uVar4,(int *)((int)this + 0x94));
  FUN_004063a0((int *)((int)this + 0x40));
  if (*(int *)((int)this + 0x220) != 0) {
    FUN_00404aa0(*(int *)((int)this + 0x220));
    if (*(int *)((int)this + 0x220) != 0) {
      (***(code ***)(*(int *)((int)this + 0x220) + 4))(1);
    }
    *(undefined4 *)((int)this + 0x220) = 0;
  }
  FUN_00403270((int *)((int)this + 0x1a8));
  FUN_00407220((int *)((int)this + 0x94));
  FUN_0040e240();
  FUN_004160f0();
  FUN_0041a1d0("System is going down now",bVar1);
  FUN_0041c150();
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_00409a90(void *this,int param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  int *piVar2;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar3;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar4;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438e7b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnStatusQuery(%d)",(char)param_2);
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar3 = extraout_ECX;
  uVar4 = extraout_DL;
  if (puVar1 != (undefined4 *)0x0) {
    piVar2 = FUN_0040cd20();
    uVar4 = *(undefined *)(piVar2 + 0x3c);
    piVar2 = FUN_0040cd20();
    FUN_00413560(*(void **)((int)this + 8),puVar1,param_1,param_2,*(undefined *)((int)this + 0x14),
                 *(undefined *)((int)piVar2 + 0xf1),uVar4);
    uVar3 = extraout_ECX_00;
    uVar4 = extraout_DL_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar3,uVar4,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_00409b50(void *this,undefined4 param_1,undefined4 *param_2)

{
  undefined4 *lpParameter;
  HANDLE pvVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439ddb;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnStatusQuery(%d,%d)",(char)param_1);
  param_2 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  if (param_2 != (undefined4 *)0x0) {
    FUN_004136e0(param_2,param_1,*(undefined4 *)((int)this + 8));
    uVar2 = extraout_ECX_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,(char)((int)this + 0x8c),(int)this + 0x8c);
  lpParameter = (undefined4 *)operator_new(0x44);
  if (lpParameter == (undefined4 *)0x0) {
    lpParameter = (undefined4 *)0x0;
  }
  else {
    *lpParameter = aThread::vftable;
    FUN_0041db50();
    lpParameter[2] = aCondition::vftable;
    *(undefined *)(lpParameter + 0xb) = 0;
    *lpParameter = CRemoteUnitTerminator::vftable;
    lpParameter[0xf] = (int)this + -8;
    *(undefined *)(lpParameter + 0x10) = 1;
  }
  *(undefined *)((int)lpParameter + 0x35) = 1;
  lpParameter[0xc] = 0;
  *(undefined *)(lpParameter + 1) = 0;
  *(undefined *)(lpParameter + 0xd) = 0;
  FUN_0041c210();
  pvVar1 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,(LPTHREAD_START_ROUTINE)&LAB_0041c690,
                        lpParameter,0,(LPDWORD)&param_2);
  lpParameter[0xe] = pvVar1;
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_00409c50(void *this,undefined4 param_1,int param_2,int param_3)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 uVar3;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined extraout_DL_01;
  undefined extraout_DL_02;
  undefined extraout_DL_03;
  undefined extraout_DL_04;
  undefined extraout_DL_05;
  undefined uVar4;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_0043a20c;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnOutputQuery(%d,%d,%d)",(char)param_1);
  if (*(char *)((int)this + 0x14) == '\0') {
    puVar1 = (undefined4 *)operator_new(0x14);
    local_4 = 0;
    uVar3 = extraout_ECX;
    uVar4 = extraout_DL;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_00413190(puVar1,param_1,*(undefined4 *)((int)this + 8),4);
      uVar3 = extraout_ECX_00;
      uVar4 = extraout_DL_00;
    }
  }
  else if (param_2 < 1) {
    FUN_0041a190("IOManager: ActivateOutput(%d,%d)",(char)param_2);
    uVar2 = FUN_00402d80(param_3);
    FUN_004039a0();
    puVar1 = (undefined4 *)operator_new(0x14);
    uVar3 = extraout_ECX_03;
    uVar4 = extraout_DL_03;
    if ((char)uVar2 == '\0') {
      local_4 = 3;
      if (puVar1 != (undefined4 *)0x0) {
        FUN_00413190(puVar1,param_1,*(undefined4 *)((int)this + 8),2);
        uVar3 = extraout_ECX_05;
        uVar4 = extraout_DL_05;
      }
    }
    else {
      local_4 = 2;
      if (puVar1 != (undefined4 *)0x0) {
        FUN_004136e0(puVar1,param_1,*(undefined4 *)((int)this + 8));
        uVar3 = extraout_ECX_04;
        uVar4 = extraout_DL_04;
      }
    }
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x14);
    local_4 = 1;
    uVar3 = extraout_ECX_01;
    uVar4 = extraout_DL_01;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_00413190(puVar1,param_1,*(undefined4 *)((int)this + 8),3);
      uVar3 = extraout_ECX_02;
      uVar4 = extraout_DL_02;
    }
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar3,uVar4,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_00409da0(void *this,undefined4 param_1,void *param_2)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 uVar3;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined extraout_DL_01;
  undefined extraout_DL_02;
  undefined uVar4;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439da6;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnTriggerQuery(%d,%d)",(char)param_1);
  *(int *)((int)this + 0x18) = *(int *)((int)this + 0x18) + 1;
  if ((*(char *)((int)this + 0x14) == '\0') ||
     (uVar1 = FUN_00404e70(param_2,*(undefined4 *)((int)this + 0x18),*(int *)((int)this + 0x28)),
     (char)uVar1 == '\0')) {
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0;
    uVar3 = extraout_ECX_01;
    uVar4 = extraout_DL_01;
    if (puVar2 != (undefined4 *)0x0) {
      FUN_00413190(puVar2,param_1,*(undefined4 *)((int)this + 8),4);
      uVar3 = extraout_ECX_02;
      uVar4 = extraout_DL_02;
    }
  }
  else {
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 1;
    uVar3 = extraout_ECX;
    uVar4 = extraout_DL;
    if (puVar2 != (undefined4 *)0x0) {
      FUN_004136e0(puVar2,param_1,*(undefined4 *)((int)this + 8));
      uVar3 = extraout_ECX_00;
      uVar4 = extraout_DL_00;
    }
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar3,uVar4,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void FUN_00409e80(undefined4 param_1)

{
  undefined uVar1;
  char **ppcVar2;
  char *pcVar3;
  undefined4 *puVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar6;
  char *_Memory;
  char *in_stack_fffffe5c;
  undefined4 in_stack_fffffe60;
  undefined4 uVar7;
  char *pcVar8;
  undefined auStack_17c [4];
  char *pcStack_178;
  char *local_174;
  char *local_170;
  undefined4 local_16c;
  char *local_168 [3];
  int local_15c;
  char *pcStack_158;
  undefined4 *puStack_154;
  char *pcStack_150;
  void *local_14c [3];
  char *local_140 [8];
  undefined local_120 [260];
  uint local_1c;
  void *local_14;
  undefined *puStack_10;
  undefined4 local_c;
  long lVar4;
  
  puStack_10 = &LAB_00439d5d;
  local_14 = ExceptionList;
  local_1c = DAT_0044a01c ^ (uint)auStack_17c;
  ExceptionList = &local_14;
  _Memory = (char *)0x0;
  local_174 = (char *)0x0;
  local_16c = 0;
  local_170 = (char *)0x0;
  local_c = 0;
  FUN_0041a190("Unit: OnVersionQuery(%d)",(char)param_1);
  FUN_0041c840("File version");
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,".");
  local_c._0_1_ = 1;
  FUN_0041aa80(local_120,(char *)0x7fffffff,local_120);
  local_c._0_1_ = 2;
  FUN_0041cae0(local_14c,local_140,local_168);
  local_c._0_1_ = 4;
  if (local_14c[0] != (void *)0x0) {
    free(local_14c[0]);
  }
  local_c._0_1_ = 5;
  if (local_168[0] != (char *)0x0) {
    free(local_168[0]);
  }
  ppcVar2 = FUN_0041cc10(local_140,local_168);
  local_c._0_1_ = 6;
  if (*ppcVar2 != (char *)0x0) {
    FUN_0041b310();
    _Memory = local_174;
    memcpy(local_174,*ppcVar2,(size_t)ppcVar2[1]);
    local_170 = ppcVar2[1];
    local_170[(int)_Memory] = '\0';
  }
  local_c._0_1_ = 5;
  if (local_168[0] != (char *)0x0) {
    free(local_168[0]);
  }
  pcVar3 = &DAT_0044d0d5;
  if (_Memory != (char *)0x0) {
    pcVar3 = _Memory;
  }
  pcStack_178 = (char *)strtol(pcVar3,&pcStack_178,10);
  ppcVar2 = FUN_0041cc10(local_140,local_168);
  local_c._0_1_ = 7;
  if (*ppcVar2 != _Memory) {
    FUN_0041b310();
    _Memory = local_174;
    memcpy(local_174,*ppcVar2,(size_t)ppcVar2[1]);
    local_170 = ppcVar2[1];
    local_170[(int)_Memory] = '\0';
  }
  local_c._0_1_ = 5;
  if (local_168[0] != (char *)0x0) {
    free(local_168[0]);
  }
  pcVar3 = &DAT_0044d0d5;
  if (_Memory != (char *)0x0) {
    pcVar3 = _Memory;
  }
  pcStack_158 = (char *)strtol(pcVar3,&pcStack_158,10);
  ppcVar2 = FUN_0041cc10(local_140,local_168);
  local_c._0_1_ = 8;
  if (*ppcVar2 != _Memory) {
    FUN_0041b310();
    _Memory = local_174;
    memcpy(local_174,*ppcVar2,(size_t)ppcVar2[1]);
    local_170 = ppcVar2[1];
    local_170[(int)_Memory] = '\0';
  }
  local_c._0_1_ = 5;
  if (local_168[0] != (char *)0x0) {
    free(local_168[0]);
  }
  pcVar3 = &DAT_0044d0d5;
  if (_Memory != (char *)0x0) {
    pcVar3 = _Memory;
  }
  uVar7 = 0x40a0f2;
  lVar4 = strtol(pcVar3,&pcStack_150,10);
  uVar1 = (undefined)lVar4;
  FUN_0041c840("Description");
  puVar5 = (undefined4 *)operator_new(0x14);
  local_c._0_1_ = 9;
  uVar6 = extraout_ECX_00;
  puStack_154 = puVar5;
  if (puVar5 != (undefined4 *)0x0) {
    pcVar3 = pcStack_178;
    pcVar8 = pcStack_158;
    pcStack_178 = &stack0xfffffe5c;
    FUN_0041aa80(local_120,(char *)0x7fffffff,local_120);
    FUN_00414520(puVar5,param_1,*(undefined4 *)(local_15c + 8),in_stack_fffffe5c,in_stack_fffffe60,
                 uVar7,(char)pcVar3,(char)pcVar8,uVar1);
    uVar6 = extraout_ECX_01;
  }
  local_c._0_1_ = 5;
  FUN_004072f0(uVar6,(char)(local_15c + 0x8c),local_15c + 0x8c);
  local_c = (uint)local_c._1_3_ << 8;
  FUN_004037f0(local_140);
  local_c = 0xffffffff;
  if (_Memory != (char *)0x0) {
    free(_Memory);
  }
  ExceptionList = local_14;
  ___security_check_cookie_4(local_1c ^ (uint)auStack_17c);
  return;
}



void __thiscall FUN_0040a1d0(void *this,undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined extraout_DL_01;
  undefined extraout_DL_02;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438e46;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnInputValuesQuery(%d)",(char)param_1);
  if (*(char *)((int)this + 0x14) == '\0') {
    puVar1 = (undefined4 *)operator_new(0x14);
    local_4 = 0;
    uVar2 = extraout_ECX;
    uVar3 = extraout_DL;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_00413190(puVar1,param_1,*(undefined4 *)((int)this + 8),4);
      uVar2 = extraout_ECX_00;
      uVar3 = extraout_DL_00;
    }
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x14);
    local_4 = 1;
    uVar2 = extraout_ECX_01;
    uVar3 = extraout_DL_01;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_00414c00(puVar1,param_1,*(undefined4 *)((int)this + 8),
                   *(undefined4 *)(*(int *)((int)this + 0x1ec) + 8));
      uVar2 = extraout_ECX_02;
      uVar3 = extraout_DL_02;
    }
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040a290(void *this,undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438e0b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnActivateQuery(%d,%d)",(char)param_1);
  *(undefined *)((int)this + 0x14) = (undefined)param_2;
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_004136e0(puVar1,param_1,*(undefined4 *)((int)this + 8));
    uVar2 = extraout_ECX_00;
    uVar3 = extraout_DL_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



int * FUN_0040a330(int param_1)

{
  int iVar1;
  int *piVar2;
  void *pvVar3;
  int iVar4;
  int unaff_EBX;
  undefined4 unaff_ESI;
  longlong lVar5;
  undefined uVar6;
  
  piVar2 = (int *)operator_new(0x14);
  if (piVar2 == (int *)0x0) {
    piVar2 = (int *)0x0;
  }
  else {
    *piVar2 = (int)aMemFile::vftable;
    piVar2[1] = 0;
    piVar2[2] = 0;
  }
  *(undefined *)(piVar2 + 4) = 1;
  piVar2[3] = 65000;
  pvVar3 = operator_new(65000);
  piVar2[1] = (int)pvVar3;
  piVar2[2] = 0;
  iVar4 = *(int *)(param_1 + 0x3c);
  while( true ) {
    pvVar3 = (void *)0x0;
    (**(code **)(*piVar2 + 8))(0,0,0);
    iVar1 = *(int *)(unaff_EBX + 0xc);
    FUN_0040f780(*(undefined4 *)(unaff_EBX + 0x10),(void **)&stack0xffffffe0,*(int *)(unaff_EBX + 4)
                 ,*(int *)(iVar1 + 4),*(uint *)(iVar1 + 8),(uint)*(ushort *)(iVar1 + 0xe),iVar4,
                 (int *)&stack0xffffffe4,*(uint *)(unaff_EBX + 0x14));
    uVar6 = 0;
    (**(code **)(*piVar2 + 4))(0,unaff_ESI,1);
    operator_delete__(pvVar3);
    iVar4 = (int)(iVar4 * 3 + (iVar4 * 3 >> 0x1f & 3U)) >> 2;
    lVar5 = (**(code **)(*piVar2 + 0xc))();
    if (lVar5 == 65000) {
      FUN_0041a1d0("RemoteUnit: recompressing image",uVar6);
    }
    lVar5 = (**(code **)(*piVar2 + 0xc))();
    if (lVar5 != 65000) break;
    if (iVar4 < 10) {
      (**(code **)(*piVar2 + 0x14))(1);
      piVar2 = (int *)0x0;
LAB_0040a45e:
      if (piVar2[2] == 0) {
        operator_delete((void *)piVar2[1]);
        piVar2[1] = 0;
        piVar2[3] = piVar2[2];
        return piVar2;
      }
      pvVar3 = operator_new(piVar2[2]);
      memcpy(pvVar3,(void *)piVar2[1],piVar2[2]);
      operator_delete((void *)piVar2[1]);
      piVar2[1] = (int)pvVar3;
      piVar2[3] = piVar2[2];
      return piVar2;
    }
  }
  if (iVar4 < 10) {
    (**(code **)(*piVar2 + 0x14))(1);
    piVar2 = (int *)0x0;
  }
  goto LAB_0040a45e;
}



void __thiscall FUN_0040a4d0(void *this,int param_1,int param_2)

{
  void *pvVar1;
  int iVar2;
  uint uVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  int *piVar6;
  int *piVar7;
  size_t sVar8;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar9;
  undefined extraout_DL_01;
  undefined extraout_DL_02;
  undefined extraout_DL_03;
  undefined extraout_DL_04;
  undefined extraout_DL_05;
  int *unaff_EBX;
  undefined4 unaff_retaddr;
  int *local_3c;
  undefined auStack_38 [4];
  undefined **local_34;
  undefined2 local_30;
  undefined2 local_2e;
  undefined2 local_2c;
  undefined2 local_2a;
  undefined2 local_28;
  undefined **local_24;
  undefined local_20 [12];
  undefined4 *puStack_14;
  void *local_c;
  undefined4 uStack_8;
  undefined4 local_4;
  
  iVar2 = param_2;
  uStack_8 = &LAB_0043ab6c;
  local_c = ExceptionList;
  uVar3 = DAT_0044a01c ^ (uint)&stack0xffffffb4;
  ExceptionList = &local_c;
  local_34 = CRectangle2::vftable;
  local_2e = 0;
  local_2c = 0;
  local_2a = 0;
  local_28 = 0;
  local_30 = 0;
  local_24 = (undefined **)0x0;
  local_4 = 0;
  FUN_0041a190("Unit: OnPictureQuery(%d,%d)",(char)param_1);
  if (*(char *)((int)this + 0x14) == '\0') {
    puVar4 = (undefined4 *)operator_new(0x14);
    local_4._0_1_ = 1;
    uVar5 = extraout_ECX;
    uVar9 = extraout_DL;
    if (puVar4 != (undefined4 *)0x0) {
      FUN_00413190(puVar4,param_1,*(undefined4 *)((int)this + 8),4);
      uVar5 = extraout_ECX_00;
      uVar9 = extraout_DL_00;
    }
    local_4 = (uint)local_4._1_3_ << 8;
    FUN_004072f0(uVar5,uVar9,(int)this + 0x8c);
    ExceptionList = local_c;
    return;
  }
  param_2 = 0;
  uVar5 = FUN_00404d00(iVar2,&param_2,&local_3c);
  if ((char)uVar5 == '\0') {
    puVar4 = (undefined4 *)operator_new(0x14);
    local_4 = CONCAT31(local_4._1_3_,5);
    uVar5 = extraout_ECX_04;
    uVar9 = extraout_DL_04;
    if (puVar4 != (undefined4 *)0x0) {
      FUN_00414aa0(&local_34,puVar4,param_1,*(undefined4 *)((int)this + 8),(void *)0x0,0);
      uVar5 = extraout_ECX_05;
      uVar9 = extraout_DL_05;
    }
  }
  else {
    piVar6 = FUN_0040a330((int)this + -8);
    if (piVar6 != (int *)0x0) {
      (**(code **)(*local_3c + 0x34))(local_20,uVar3);
      uStack_8._0_1_ = 2;
      FUN_0040f5a0();
      uStack_8._0_1_ = 0;
      local_24 = CRectangle2::vftable;
      if (puStack_14 != (undefined4 *)0x0) {
        (**(code **)*puStack_14)(1);
      }
      piVar7 = (int *)operator_new(0x14);
      uStack_8._0_1_ = 3;
      local_3c = piVar7;
      if (piVar7 != (int *)0x0) {
        pvVar1 = (void *)piVar6[1];
        sVar8 = (**(code **)(*piVar6 + 0xc))();
        FUN_00414aa0(auStack_38,piVar7,unaff_retaddr,*(undefined4 *)((int)this + 8),pvVar1,sVar8);
      }
      uStack_8 = (undefined *)((uint)uStack_8._1_3_ << 8);
      (**(code **)(*(int *)(param_1 + 0x18) + 8))();
      (**(code **)(*unaff_EBX + 8))();
      if ((*(char *)(piVar6 + 4) != '\0') && ((void *)piVar6[1] != (void *)0x0)) {
        operator_delete((void *)piVar6[1]);
        piVar6[1] = 0;
      }
      (**(code **)(*piVar6 + 0x14))(1);
      uVar5 = extraout_ECX_01;
      uVar9 = extraout_DL_01;
      goto LAB_0040a6df;
    }
    puVar4 = (undefined4 *)operator_new(0x14);
    local_4 = CONCAT31(local_4._1_3_,4);
    uVar5 = extraout_ECX_02;
    uVar9 = extraout_DL_02;
    if (puVar4 != (undefined4 *)0x0) {
      FUN_00414aa0(&local_34,puVar4,param_1,*(undefined4 *)((int)this + 8),(void *)0x0,0);
      uVar5 = extraout_ECX_03;
      uVar9 = extraout_DL_03;
    }
  }
  local_4 = local_4 & 0xffffff00;
LAB_0040a6df:
  FUN_004072f0(uVar5,uVar9,(int)this + 0x8c);
  local_4 = 0xffffffff;
  if (local_24 != (undefined **)0x0) {
    (**(code **)*local_24)(1);
  }
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040a720(void *this,undefined4 param_1)

{
  int iVar1;
  void *pvVar2;
  undefined4 *puVar3;
  int *piVar4;
  void *this_00;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 uVar5;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar6;
  undefined extraout_DL_01;
  undefined extraout_DL_02;
  undefined extraout_DL_03;
  undefined extraout_DL_04;
  _RTL_CRITICAL_SECTION local_24;
  void *local_c;
  undefined *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_0043ab09;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  InitializeCriticalSection(&local_24);
  uStack_4 = 0;
  FUN_0041a190("Unit: OnCurrentFrameQuery(%d,%d)",(char)param_1);
  if (*(char *)((int)this + 0x14) == '\0') {
    puVar3 = (undefined4 *)operator_new(0x14);
    uStack_4._0_1_ = 1;
    uVar5 = extraout_ECX;
    uVar6 = extraout_DL;
    if (puVar3 != (undefined4 *)0x0) {
      FUN_00413190(puVar3,param_1,*(undefined4 *)((int)this + 8),4);
      uVar5 = extraout_ECX_00;
      uVar6 = extraout_DL_00;
    }
    uStack_4 = (uint)uStack_4._1_3_ << 8;
    FUN_004072f0(uVar5,uVar6,(int)this + 0x8c);
  }
  else {
    iVar1 = *(int *)(*(int *)((int)this + 0x218) + 400);
    FUN_0040ea20(*(int *)(iVar1 + 4),*(int *)(iVar1 + 0xc));
    piVar4 = FUN_0040cd20();
    if ((piVar4 == (int *)0x0) || (piVar4[0x3e] == 0)) {
      puVar3 = (undefined4 *)operator_new(0x14);
      uStack_4._0_1_ = 3;
      uVar5 = extraout_ECX_03;
      uVar6 = extraout_DL_03;
      if (puVar3 != (undefined4 *)0x0) {
        FUN_00414680((void *)0x0,puVar3,param_1,*(undefined4 *)((int)this + 8),(void *)0x0);
        uVar5 = extraout_ECX_04;
        uVar6 = extraout_DL_04;
      }
      uStack_4 = (uint)uStack_4._1_3_ << 8;
    }
    else {
      memcpy((void *)0x0,*(void **)(piVar4[0x3e] + 4),
             *(int *)(*(int *)(piVar4[0x3e] + 0xc) + 8) * *(int *)(piVar4[0x3e] + 0x10));
      piVar4 = FUN_0040a330((int)this + -8);
      uVar5 = extraout_ECX_01;
      uVar6 = extraout_DL_01;
      if (piVar4 != (int *)0x0) {
        puVar3 = (undefined4 *)operator_new(0x14);
        uStack_4._0_1_ = 2;
        if (puVar3 != (undefined4 *)0x0) {
          pvVar2 = (void *)piVar4[1];
          this_00 = (void *)(**(code **)(*piVar4 + 0xc))();
          FUN_00414680(this_00,puVar3,param_1,*(undefined4 *)((int)this + 8),pvVar2);
        }
        uStack_4 = (uint)uStack_4._1_3_ << 8;
        if ((*(char *)(piVar4 + 4) != '\0') && ((void *)piVar4[1] != (void *)0x0)) {
          operator_delete((void *)piVar4[1]);
          piVar4[1] = 0;
        }
        (**(code **)(*piVar4 + 0x14))(1);
        uVar5 = extraout_ECX_02;
        uVar6 = extraout_DL_02;
      }
    }
    FUN_004072f0(uVar5,uVar6,(int)this + 0x8c);
  }
  uStack_4 = 0xffffffff;
  FUN_00405450();
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040a960(void *this,undefined4 param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined extraout_DL_01;
  undefined extraout_DL_02;
  undefined extraout_DL_03;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438de1;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnFocusControlQuery(%d,%d)",(char)param_1);
  if (*(char *)((int)this + 0x14) == '\0') {
    puVar1 = (undefined4 *)operator_new(0x14);
    local_4 = 0;
    uVar2 = extraout_ECX;
    uVar3 = extraout_DL;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_00413190(puVar1,param_1,*(undefined4 *)((int)this + 8),4);
      uVar2 = extraout_ECX_00;
      uVar3 = extraout_DL_00;
    }
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x14);
    uVar2 = extraout_ECX_01;
    uVar3 = extraout_DL_01;
    if (param_2 < 0) {
      local_4 = 2;
      if (puVar1 != (undefined4 *)0x0) {
        FUN_00413190(puVar1,param_1,*(undefined4 *)((int)this + 8),3);
        uVar2 = extraout_ECX_03;
        uVar3 = extraout_DL_03;
      }
    }
    else {
      local_4 = 1;
      if (puVar1 != (undefined4 *)0x0) {
        FUN_004136e0(puVar1,param_1,*(undefined4 *)((int)this + 8));
        uVar2 = extraout_ECX_02;
        uVar3 = extraout_DL_02;
      }
    }
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040aa40(void *this,undefined4 param_1)

{
  FUN_00407830((int)this + 0x8c,param_1);
  return;
}



void __thiscall FUN_0040aa60(void *this,undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438d9b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnUnexpectedMessage(%d,%d,%d)",(char)param_1);
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_00413190(puVar1,param_1,*(undefined4 *)((int)this + 8),0);
    uVar2 = extraout_ECX_00;
    uVar3 = extraout_DL_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040ab00(void *this,undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438d9b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnIncompatibleMessageVersion(%d,%d,%d)",(char)param_1);
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_00413190(puVar1,param_1,*(undefined4 *)((int)this + 8),6);
    uVar2 = extraout_ECX_00;
    uVar3 = extraout_DL_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040aba0(void *this,int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined extraout_DL_01;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438d66;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnUnknownMessage(%d)",(char)param_2);
  puVar1 = (undefined4 *)operator_new(0x14);
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (param_2 < 0x11) {
    local_4 = 0;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_00413190(puVar1,0xffffffff,*(undefined4 *)((int)this + 8),0);
      uVar2 = extraout_ECX_00;
      uVar3 = extraout_DL_00;
    }
  }
  else {
    local_4 = 1;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_00413190(puVar1,*(undefined4 *)(param_1 + 0xd),*(undefined4 *)((int)this + 8),0);
      uVar2 = extraout_ECX_01;
      uVar3 = extraout_DL_01;
    }
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040ac60(void *this,int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined extraout_DL_01;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438d66;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnIncorrectMessageBcc(%d)",(char)param_2);
  puVar1 = (undefined4 *)operator_new(0x14);
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (param_2 < 0x11) {
    local_4 = 0;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_00413190(puVar1,0xffffffff,*(undefined4 *)((int)this + 8),1);
      uVar2 = extraout_ECX_00;
      uVar3 = extraout_DL_00;
    }
  }
  else {
    local_4 = 1;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_00413190(puVar1,*(undefined4 *)(param_1 + 0xd),*(undefined4 *)((int)this + 8),1);
      uVar2 = extraout_ECX_01;
      uVar3 = extraout_DL_01;
    }
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0040ad20(int param_1,undefined param_2,undefined4 param_3)

{
  FUN_0041a190("Unit: OnACK(%d)",(undefined1)param_3);
  FUN_004074b0(param_1 + 0x8c);
  return;
}



void __thiscall FUN_0040ad50(void *this,int param_1,undefined4 param_2)

{
  FUN_0041a190("Unit: OnNAK(%d,%d,%d)",(char)param_1);
  FUN_00407580((void *)((int)this + 0x8c),param_1,param_2);
  return;
}



void __thiscall FUN_0040ad90(void *this,undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438d2b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnIncorrectUnitId(%d,%d)",(char)param_1);
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_00413190(puVar1,param_1,*(undefined4 *)((int)this + 8),5);
    uVar2 = extraout_ECX_00;
    uVar3 = extraout_DL_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,(int)this + 0x8c);
  ExceptionList = local_c;
  return;
}



void FUN_0040ae20(int param_1)

{
  FUN_004073b0(param_1);
  return;
}



void __thiscall FUN_0040ae40(void *this,int *param_1,undefined **param_2)

{
  int iVar1;
  undefined uVar2;
  undefined4 *puVar3;
  undefined1 *puVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined extraout_DL;
  undefined extraout_DL_00;
  void *pvStack_28;
  undefined local_24 [12];
  void *pvStack_18;
  void *local_14;
  undefined *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_0043aac3;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  puVar3 = (undefined4 *)
           (**(code **)(*param_1 + 0x14))(local_24,DAT_0044a01c ^ (uint)&stack0xffffffc8);
  puStack_10 = (undefined *)0x0;
  puVar4 = (undefined1 *)*puVar3;
  if (puVar4 == (undefined1 *)0x0) {
    puVar4 = &DAT_0044d0d5;
  }
  uVar5 = (**(code **)(*param_1 + 0x68))(puVar4);
  uVar2 = (**(code **)(*param_1 + 0x78))(uVar5);
  FUN_0041a190("Unit: OnLicenseRecognized(%d,%d,%s)",uVar2);
  puStack_10 = (undefined *)0xffffffff;
  if (pvStack_28 != (void *)0x0) {
    free(pvStack_28);
  }
  FUN_0040e3f0(param_1,(int *)((int)this + 800));
  FUN_004056c0(param_1,(int)param_2);
  FUN_00401920((void *)((int)this + 0x2c0),param_1,param_2);
  puVar3 = (undefined4 *)operator_new(0x14);
  puStack_10 = (undefined *)0x1;
  uVar2 = extraout_DL;
  if (puVar3 != (undefined4 *)0x0) {
    FUN_004137d0(param_1,puVar3,*(undefined4 *)((int)this + 0xc));
    uVar2 = extraout_DL_00;
  }
  iVar1 = (int)this + 0x90;
  puStack_10 = (undefined *)0xffffffff;
  FUN_004072f0(iVar1,uVar2,iVar1);
  uVar5 = *(undefined4 *)((int)this + 0x2d0);
  uVar6 = (**(code **)(*param_1 + 0x78))();
  FUN_00407710(iVar1,*(undefined4 *)((int)this + 0xc),uVar6,uVar5);
  ExceptionList = pvStack_18;
  return;
}



void FUN_0040af70(undefined4 param_1,undefined4 param_2,void *param_3,size_t param_4,
                 undefined4 param_5,undefined4 param_6)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 extraout_ECX;
  void *_Dst;
  size_t sVar3;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  int local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438d03;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  FUN_0040e320(&local_20,&local_14,&local_18,&local_1c);
  FUN_0041a190("Unit.OnRecognitionStatisticsQuery(%d) recognitions:%d recognitionsWithLicense:%d recognitionsWithGrammarOk:%d numberOfUnknownChars:%d avgQuality:%d  (send to %s:%d)"
               ,(char)param_2);
  puVar1 = (undefined4 *)operator_new(0x2c);
  uVar2 = 0;
  local_4._0_1_ = 1;
  if (puVar1 != (undefined4 *)0x0) {
    _Dst = (void *)0x0;
    uVar2 = 0;
    sVar3 = 0;
    if (param_3 != (void *)0x0) {
      FUN_0041b310();
      memcpy(_Dst,param_3,param_4);
      *(undefined *)(param_4 + (int)_Dst) = 0;
      sVar3 = param_4;
    }
    FUN_00413320(puVar1,_Dst,sVar3,uVar2,param_6,param_2,param_1,local_20,local_24,local_14,local_18
                 ,local_1c);
    uVar2 = extraout_ECX;
  }
  local_4 = (uint)local_4._1_3_ << 8;
  FUN_004072f0(uVar2,(char)(local_10 + 0x8c),local_10 + 0x8c);
  local_4 = 0xffffffff;
  if (param_3 != (void *)0x0) {
    free(param_3);
  }
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040b0d0(void *this,int param_1,undefined param_2)

{
  int iVar1;
  undefined uVar2;
  undefined uStack00000009;
  undefined uStack0000000a;
  
  uVar2 = param_2;
  FUN_0041a190("Unit: OnSensorChange(%d,%d)",(char)param_1);
  if ((*(char *)((int)this + 0x1c) != '\0') && (*(int *)((int)this + 0x18) != 0)) {
    uStack0000000a = *(undefined *)((int)this + 0x26);
    param_2 = *(undefined *)((int)this + 0x24);
    uStack00000009 = *(undefined *)((int)this + 0x25);
    iVar1 = *(int *)((int)this + 0x2c);
    (&param_2)[param_1] = uVar2;
    if (iVar1 == 1) {
      FUN_0040bb00(&param_2,(int)this);
    }
    else if (iVar1 - 2U < 2) {
      FUN_0040bca0(&param_2,(int)this,'\0');
      *(undefined *)(param_1 + 0x24 + (int)this) = uVar2;
      return;
    }
    *(undefined *)(param_1 + 0x24 + (int)this) = uVar2;
  }
  return;
}



void __thiscall FUN_0040b150(void *this,undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438e0b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_0041a190("Unit: OnInputChange(%d,%d)",(undefined)param_1);
  if (*(char *)((int)this + 0x1c) != '\0') {
    puVar1 = (undefined4 *)operator_new(0x14);
    local_4 = 0;
    uVar2 = extraout_ECX;
    uVar3 = extraout_DL;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_004147a0(puVar1,*(undefined4 *)((int)this + 0x10),(undefined)param_1,(undefined)param_2);
      uVar2 = extraout_ECX_00;
      uVar3 = extraout_DL_00;
    }
    local_4 = 0xffffffff;
    FUN_004072f0(uVar2,uVar3,(int)this + 0x94);
  }
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0040b1f0(int param_1,undefined param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438ccb;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  uVar3 = 0x90;
  if ((char)param_3 == '\0') {
    uVar3 = 0x98;
  }
  FUN_0041a190("Unit: OnCameraStatusChange(%s)",uVar3);
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_004149b0(puVar1,*(undefined4 *)(param_1 + 0xc),0);
    uVar2 = extraout_ECX_00;
    uVar3 = extraout_DL_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,param_1 + 0x90);
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0040b290(int param_1,undefined param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438ccb;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  uVar3 = 0x90;
  if ((char)param_3 == '\0') {
    uVar3 = 0x98;
  }
  FUN_0041a190("Unit: OnIOCardStatusChange(%s)",uVar3);
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_004149b0(puVar1,*(undefined4 *)(param_1 + 0x10),0);
    uVar2 = extraout_ECX_00;
    uVar3 = extraout_DL_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,param_1 + 0x94);
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0040b330(int param_1,undefined param_2,undefined4 param_3)

{
  if (*(int *)(param_1 + 0x20) != 1) {
    if (*(int *)(param_1 + 0x20) - 2U < 2) {
      FUN_0040bca0((void *)(param_1 + 0x18),param_1 + -0xc,'\x01');
    }
    return;
  }
  FUN_0040bb00((void *)(param_1 + 0x18),param_1 + -0xc);
  return;
}



uint FUN_0040b370(int param_1,void *param_2)

{
  long *plVar1;
  code *pcVar2;
  undefined1 *puVar3;
  void *_Size;
  uint uVar4;
  undefined4 uVar5;
  undefined1 *puVar6;
  int iVar7;
  void **ppvVar8;
  undefined1 *puVar9;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  void *_Dst;
  void *pvVar10;
  undefined uVar11;
  char *pcVar12;
  undefined uVar13;
  int local_3c [3];
  undefined1 *local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined1 *local_24;
  void *local_20;
  undefined4 local_1c;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a888;
  local_c = ExceptionList;
  uVar4 = DAT_0044a01c ^ (uint)&stack0xffffffb0;
  ExceptionList = &local_c;
  local_30 = (undefined1 *)0x0;
  local_28 = 0;
  local_2c = 0;
  local_24 = (undefined1 *)0x0;
  local_1c = 0;
  local_20 = (void *)0x0;
  local_4._0_1_ = 1;
  local_4._1_3_ = 0;
  FUN_0041b630(param_2,local_3c);
  local_4._0_1_ = 2;
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,"Global/LogFilter");
  local_4._0_1_ = 3;
  uVar5 = FUN_0041bbf0(local_18,(int)local_3c,&local_24);
  local_4._0_1_ = 2;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  _Size = local_20;
  puVar9 = local_24;
  if ((char)uVar5 != '\0') {
    _Dst = (void *)0x0;
    pvVar10 = (void *)0x0;
    if (local_24 != (undefined1 *)0x0) {
      FUN_0041b310();
      memcpy(_Dst,puVar9,(size_t)_Size);
      *(undefined *)((int)_Size + (int)_Dst) = 0;
      pvVar10 = _Size;
    }
    FUN_0041a210(_Dst,(size_t)pvVar10);
  }
  if (DAT_0044cee4 != 0) {
    FUN_00419550(1);
  }
  FUN_0041a190("Unit: Initialize() begin",(char)uVar4);
  if ((DAT_0044cee4 != 0) && (uVar5 = FUN_00419690(param_2), (char)uVar5 != '\0')) {
    FUN_0041aa80(extraout_ECX_00,(char *)0x7fffffff,"Global/SystemId");
    plVar1 = (long *)(param_1 + 0x10);
    local_4._0_1_ = 4;
    uVar5 = FUN_0041bff0(local_3c,(char *)local_18,plVar1);
    local_4._0_1_ = 2;
    param_2 = (void *)CONCAT31(param_2._1_3_,(char)uVar5 == '\0');
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    if ((char)param_2 == '\0') {
      if (*plVar1 < 1) {
        *plVar1 = 0;
      }
      FUN_0041a1b0("Unit: Unit identifier is %d",(char)*plVar1);
      FUN_0041aa80(extraout_ECX_01,(char *)0x7fffffff,"Global/WorkingMode");
      local_4._0_1_ = 5;
      uVar5 = FUN_0041bbf0(local_18,(int)local_3c,&local_30);
      pcVar2 = free_exref;
      local_4._0_1_ = 2;
      param_2 = (void *)CONCAT31(param_2._1_3_,(char)uVar5 == '\0');
      if (local_18[0] != (void *)0x0) {
        free(local_18[0]);
      }
      if ((char)param_2 != '\0') {
        FUN_0041a1f0("Unit: Missing or wrong configuration parameter (Global/WorkingMode)",
                     (char)uVar4);
        local_4._0_1_ = 1;
        FUN_00402ab0();
        local_4 = (uint)local_4._1_3_ << 8;
        puVar6 = local_30;
        puVar3 = local_30;
        if (puVar9 != (undefined1 *)0x0) {
          free(puVar9);
          puVar6 = local_30;
          puVar3 = local_30;
        }
joined_r0x0040b5b2:
        if (puVar3 != (undefined1 *)0x0) {
          local_4 = 0xffffffff;
          puVar6 = (undefined1 *)(*pcVar2)();
        }
        goto LAB_0040bae5;
      }
      FUN_0041aea0('\x01');
      FUN_0041aea0('\0');
      FUN_0041ada0(&local_30,local_18);
      iVar7 = FUN_0041ab00((byte *)"software");
      param_2 = (void *)CONCAT31(param_2._1_3_,iVar7 == 0);
      if (local_18[0] != (void *)0x0) {
        free(local_18[0]);
      }
      pcVar2 = free_exref;
      if ((char)param_2 == '\0') {
        FUN_0041ada0(&local_30,local_18);
        iVar7 = FUN_0041ab00((byte *)"hardware");
        param_2 = (void *)CONCAT31(param_2._1_3_,iVar7 == 0);
        if (local_18[0] != (void *)0x0) {
          free(local_18[0]);
        }
        puVar3 = local_30;
        if ((char)param_2 == '\0') {
          puVar9 = &DAT_0044d0d5;
          if (local_30 != (undefined1 *)0x0) {
            puVar9 = local_30;
          }
          FUN_0041a1f0("Unit: Invalid configuration parameter (Global/WorkingMode=%s)",(char)puVar9)
          ;
          local_4._0_1_ = 1;
          FUN_00402ab0();
          local_4 = (uint)local_4._1_3_ << 8;
          puVar6 = local_24;
          if (local_24 != (undefined1 *)0x0) {
            free(local_24);
          }
          goto joined_r0x0040b5b2;
        }
        FUN_0041a1b0("Unit: Working mode is set to \"hardware\"",(char)uVar4);
        *(undefined4 *)(param_1 + 0x18) = 1;
      }
      else {
        FUN_0041a1b0("Unit: Working mode is set to \"software\"",(char)uVar4);
        *(undefined4 *)(param_1 + 0x18) = 0;
      }
      *(undefined4 *)(param_1 + 0x2c) = 0;
      puVar9 = local_24;
      do {
        ppvVar8 = (void **)FUN_0041b2a0(local_18,"IO/SensorChannel%d");
        local_4._0_1_ = 6;
        if ((undefined1 *)*ppvVar8 != puVar9) {
          FUN_0041b310();
          puVar9 = local_24;
          memcpy(local_24,*ppvVar8,(size_t)ppvVar8[1]);
          local_20 = ppvVar8[1];
          *(undefined *)((int)local_20 + (int)puVar9) = 0;
        }
        local_4._0_1_ = 2;
        if (local_18[0] != (void *)0x0) {
          free(local_18[0]);
        }
        uVar5 = FUN_0041bff0(local_3c,(char *)&local_24,(long *)&param_2);
        uVar13 = (undefined)uVar4;
      } while ((((char)uVar5 != '\0') && (param_2 != (void *)0xffffffff)) &&
              (*(int *)(param_1 + 0x2c) = *(int *)(param_1 + 0x2c) + 1, *(int *)(param_1 + 0x2c) < 2
              ));
      FUN_0041a1b0("Unit: %d sensor(s) mode detected",(char)*(undefined4 *)(param_1 + 0x2c));
      if ((*(int *)(param_1 + 0x18) == 1) && (*(int *)(param_1 + 0x2c) == 0)) {
        pcVar12 = "Unit: Can\'t work in hardware mode without at least one sensor defined";
LAB_0040b725:
        FUN_0041a1f0(pcVar12,uVar13);
      }
      else {
        FUN_0041aa80(extraout_ECX_02,(char *)0x7fffffff,"Communications/CompressionQuality");
        local_4._0_1_ = 7;
        uVar5 = FUN_0041bff0(local_3c,(char *)local_18,(long *)(param_1 + 0x3c));
        local_4._0_1_ = 2;
        param_2 = (void *)CONCAT31(param_2._1_3_,(char)uVar5 == '\0');
        if (local_18[0] != (void *)0x0) {
          free(local_18[0]);
        }
        if ((char)param_2 != '\0') {
          pcVar12 = 
          "Unit: Missing or wrong configuration parameter (Communications/CompressionQuality)";
          goto LAB_0040b725;
        }
        iVar7 = *(long *)(param_1 + 0x3c);
        if ((iVar7 < 0) || (100 < iVar7)) {
          FUN_0041a1f0("Unit: Invalid configuration parameter (Communications/CompressionQuality=%d)"
                       ,(char)iVar7);
        }
        else {
          FUN_0041a1b0("Unit: Compression quality (for JPEGs) is %d",(char)iVar7);
          FUN_0041aa80(extraout_ECX_03,(char *)0x7fffffff,"Recognizer/DelayTime1");
          local_4._0_1_ = 8;
          uVar5 = FUN_0041bff0(local_3c,(char *)local_18,(long *)(param_1 + 0x30));
          local_4._0_1_ = 2;
          param_2 = (void *)CONCAT31(param_2._1_3_,(char)uVar5 == '\0');
          if (local_18[0] != (void *)0x0) {
            free(local_18[0]);
          }
          if ((char)param_2 != '\0') {
            pcVar12 = "Unit: Missing or wrong configuration parameter (Recognizer/DelayTime1)";
            goto LAB_0040b725;
          }
          iVar7 = *(long *)(param_1 + 0x30);
          uVar11 = (undefined)iVar7;
          if (iVar7 < 0) {
            FUN_0041a1f0("Unit: Invalid configuration parameter (Recognizer/DelayTime1=%d)",uVar11);
          }
          else {
            FUN_0041a1b0("Unit: Delay time 1 is %d",uVar11);
            FUN_0041aa80(extraout_ECX_04,(char *)0x7fffffff,"Recognizer/DelayTime2");
            local_4._0_1_ = 9;
            uVar5 = FUN_0041bff0(local_3c,(char *)local_18,(long *)(param_1 + 0x34));
            local_4._0_1_ = 2;
            param_2 = (void *)CONCAT31(param_2._1_3_,(char)uVar5 == '\0');
            if (local_18[0] != (void *)0x0) {
              free(local_18[0]);
            }
            if ((char)param_2 != '\0') {
              pcVar12 = "Unit: Missing or wrong configuration parameter (Recognizer/DelayTime2)";
              goto LAB_0040b725;
            }
            iVar7 = *(long *)(param_1 + 0x34);
            uVar11 = (undefined)iVar7;
            if (iVar7 < 0) {
              FUN_0041a1f0("Unit: Invalid configuration parameter (Recognizer/DelayTime2=%d)",uVar11
                          );
            }
            else {
              FUN_0041a1b0("Unit: Delay time 2 is %d",uVar11);
              FUN_0041aa80(extraout_ECX_05,(char *)0x7fffffff,"Recognizer/DecisionTime");
              local_4._0_1_ = 10;
              uVar5 = FUN_0041bff0(local_3c,(char *)local_18,(long *)(param_1 + 0x38));
              local_4._0_1_ = 2;
              param_2 = (void *)CONCAT31(param_2._1_3_,(char)uVar5 == '\0');
              if (local_18[0] != (void *)0x0) {
                free(local_18[0]);
              }
              if ((char)param_2 != '\0') {
                pcVar12 = "Unit: Missing or wrong configuration parameter (Recognizer/DecisionTime)"
                ;
                goto LAB_0040b725;
              }
              iVar7 = *(long *)(param_1 + 0x38);
              uVar11 = (undefined)iVar7;
              if (-1 < iVar7) {
                FUN_0041a1b0("Unit: Decision time is %d",uVar11);
                FUN_00401040((void **)(param_1 + 0x3b4));
                FUN_0041aa80(extraout_ECX_06,(char *)0x7fffffff,"Communications/Password");
                local_4._0_1_ = 0xb;
                uVar5 = FUN_0041bbf0(local_18,(int)local_3c,(void **)(param_1 + 0x3b4));
                local_4._0_1_ = 2;
                param_2 = (void *)CONCAT31(param_2._1_3_,(char)uVar5 == '\0');
                if (local_18[0] != (void *)0x0) {
                  free(local_18[0]);
                }
                if ((char)param_2 == '\0') {
                  if (*(int *)(param_1 + 0x3b8) == 0) {
                    pcVar12 = "Unit: Using plain communications";
                  }
                  else {
                    pcVar12 = "Unit: Using encrypted communications";
                  }
                }
                else {
                  pcVar12 = "Unit: Using plain communications";
                }
                FUN_0041a1b0(pcVar12,uVar13);
                FUN_0041aa80(extraout_ECX_07,(char *)0x7fffffff,"Communications/MaxMsgVersion");
                local_4._0_1_ = 0xc;
                uVar5 = FUN_0041bff0(local_3c,(char *)local_18,&DAT_0044c6b4);
                local_4._0_1_ = 2;
                param_2 = (void *)CONCAT31(param_2._1_3_,(char)uVar5 == '\0');
                if (local_18[0] != (void *)0x0) {
                  free(local_18[0]);
                }
                if ((char)param_2 != '\0') {
                  DAT_0044c6b4 = 0xffffffff;
                }
                FUN_0041a1b0("Unit: Max message version is %d",(char)DAT_0044c6b4);
                local_4._0_1_ = 1;
                FUN_00402ab0();
                local_4 = (uint)local_4._1_3_ << 8;
                if (puVar9 != (undefined1 *)0x0) {
                  free(puVar9);
                }
                local_4 = 0xffffffff;
                if (local_30 != (undefined1 *)0x0) {
                  free(local_30);
                }
                ExceptionList = local_c;
                return CONCAT31((int3)((uint)local_30 >> 8),1);
              }
              FUN_0041a1f0("Unit: Invalid configuration parameter (Recognizer/DecisionTime=%d)",
                           uVar11);
            }
          }
        }
      }
      local_4._0_1_ = 1;
      FUN_00402ab0();
      local_4 = (uint)local_4._1_3_ << 8;
      if (puVar9 != (undefined1 *)0x0) {
        free(puVar9);
      }
      local_4 = 0xffffffff;
      puVar6 = local_30;
      if (local_30 != (undefined1 *)0x0) {
        free(local_30);
        puVar6 = local_30;
      }
      goto LAB_0040bae5;
    }
    FUN_0041a1f0("Unit: Missing or wrong configuration parameter (Global/SystemId)",(char)uVar4);
  }
  local_4._0_1_ = 1;
  puVar6 = (undefined1 *)FUN_00402ab0();
  local_4 = (uint)local_4._1_3_ << 8;
  if (puVar9 != (undefined1 *)0x0) {
    free(puVar9);
  }
LAB_0040bae5:
  ExceptionList = local_c;
  return (uint)puVar6 & 0xffffff00;
}



void __thiscall FUN_0040bb00(void *this,int param_1)

{
  int *piVar1;
  char cVar2;
  DWORD DVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 uVar4;
  void *local_18;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439cd8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0x394) == DVar3) {
    *(int *)(param_1 + 0x398) = *(int *)(param_1 + 0x398) + 1;
    uVar4 = extraout_ECX;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x39c));
    *(undefined4 *)(param_1 + 0x398) = 1;
    DVar3 = GetCurrentThreadId();
    *(DWORD *)(param_1 + 0x394) = DVar3;
    uVar4 = extraout_ECX_00;
  }
  local_4 = 0;
  FUN_0040c140(uVar4);
  local_4._0_1_ = 1;
  FUN_0041a190("Unit: UpdateState%d State=%s",1);
  local_4 = (uint)local_4._1_3_ << 8;
  uVar4 = extraout_ECX_01;
  if (local_18 != (void *)0x0) {
    free(local_18);
    uVar4 = extraout_ECX_02;
  }
  if (*(int *)(param_1 + 0x28) == 0) {
                    // WARNING: Load size is inaccurate
    if ((*this != '\0') && (*(char *)(param_1 + 0x24) == '\0')) {
      cVar2 = FUN_00404920();
      if (cVar2 == '\0') {
        FUN_0040c030(0,param_1);
        FUN_00404e70((void *)0xffffffff,*(undefined4 *)(param_1 + 0x20),*(int *)(param_1 + 0x30));
        *(undefined4 *)(param_1 + 0x28) = 3;
        uVar4 = extraout_ECX_04;
      }
      else {
        FUN_0040c0c0(param_1);
        uVar4 = extraout_ECX_05;
      }
    }
  }
  else {
                    // WARNING: Load size is inaccurate
    if ((*(int *)(param_1 + 0x28) == 3) && (*this == '\0')) {
      FUN_0040c030(1,param_1);
      *(undefined4 *)(param_1 + 0x28) = 0;
      uVar4 = extraout_ECX_03;
    }
  }
  FUN_0040c140(uVar4);
  local_4._0_1_ = 2;
  FUN_0041a190("Unit: UpdateState%d New state=%s",1);
  local_4 = (uint)local_4._1_3_ << 8;
  if (local_18 != (void *)0x0) {
    free(local_18);
  }
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0x394) == DVar3) {
    piVar1 = (int *)(param_1 + 0x398);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(param_1 + 0x394) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x39c));
    }
  }
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040bca0(void *this,int param_1,char param_2)

{
  int *piVar1;
  char cVar2;
  char cVar3;
  DWORD DVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 uVar5;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  int iVar6;
  undefined4 extraout_ECX_09;
  undefined4 extraout_ECX_10;
  void *local_18;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439cd8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar4 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0x394) == DVar4) {
    *(int *)(param_1 + 0x398) = *(int *)(param_1 + 0x398) + 1;
    uVar5 = extraout_ECX;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x39c));
    *(undefined4 *)(param_1 + 0x398) = 1;
    DVar4 = GetCurrentThreadId();
    *(DWORD *)(param_1 + 0x394) = DVar4;
    uVar5 = extraout_ECX_00;
  }
  local_4 = 0;
  FUN_0040c140(uVar5);
  local_4._0_1_ = 1;
  FUN_0041a190("Unit: UpdateState%d Cur.State=%s",3);
  local_4 = (uint)local_4._1_3_ << 8;
  uVar5 = extraout_ECX_01;
  if (local_18 != (void *)0x0) {
    free(local_18);
    uVar5 = extraout_ECX_02;
  }
  iVar6 = *(int *)(param_1 + 0x28);
  if (iVar6 == 0) {
                    // WARNING: Load size is inaccurate
    if ((*this == '\0') || (*(char *)(param_1 + 0x24) != '\0')) goto LAB_0040bf12;
    cVar3 = FUN_00404920();
    if (cVar3 != '\0') {
      FUN_0040c0c0(param_1);
      uVar5 = extraout_ECX_10;
      goto LAB_0040bf12;
    }
    FUN_0040c030(0,param_1);
    iVar6 = *(int *)(param_1 + 0x30);
LAB_0040bef3:
    uVar5 = *(undefined4 *)(param_1 + 0x20);
    goto LAB_0040bef8;
  }
  if (iVar6 == 3) {
                    // WARNING: Load size is inaccurate
    cVar3 = *this;
    uVar5 = CONCAT31((int3)((uint)uVar5 >> 8),cVar3);
    cVar2 = *(char *)((int)this + 1);
    if (cVar3 == '\0') {
      if ((cVar2 == '\0') && (*(char *)(param_1 + 0x25) != '\0')) {
        FUN_0040c030(1,param_1);
        *(undefined4 *)(param_1 + 0x28) = 0;
        uVar5 = extraout_ECX_05;
        goto LAB_0040bf12;
      }
      if ((*(char *)((int)this + 2) == '\0') && (*(char *)(param_1 + 0x26) != '\0')) {
        FUN_0040c030(2,param_1);
        *(undefined4 *)(param_1 + 0x28) = 0;
        uVar5 = extraout_ECX_06;
        goto LAB_0040bf12;
      }
LAB_0040be97:
      if (((*(char *)(param_1 + 0x24) != '\0') && (cVar2 == '\0')) &&
         (*(char *)((int)this + 2) == '\0')) {
        if (*(int *)(param_1 + 0x38) == 0) {
          FUN_0040c030(3,param_1);
          *(undefined4 *)(param_1 + 0x28) = 0;
          uVar5 = extraout_ECX_08;
        }
        else {
          FUN_0041d4a0((void *)(param_1 + 0x224),*(int *)(param_1 + 0x38));
          *(undefined4 *)(param_1 + 0x28) = 4;
          uVar5 = extraout_ECX_07;
        }
      }
      goto LAB_0040bf12;
    }
    if ((cVar2 == '\0') && (*(char *)(param_1 + 0x25) != '\0')) {
      FUN_0040c030(1,param_1);
      cVar3 = FUN_00404920();
      if (cVar3 != '\0') {
LAB_0040bdba:
        FUN_0040c0c0(param_1);
        *(undefined4 *)(param_1 + 0x28) = 0;
        uVar5 = extraout_ECX_04;
        goto LAB_0040bf12;
      }
      FUN_0040c030(0,param_1);
      iVar6 = *(int *)(param_1 + 0x34);
      uVar5 = *(undefined4 *)(param_1 + 0x20);
    }
    else {
      if (cVar3 == '\0') goto LAB_0040be97;
      if ((*(char *)((int)this + 2) != '\0') || (*(char *)(param_1 + 0x26) == '\0'))
      goto LAB_0040bf12;
      FUN_0040c030(2,param_1);
      cVar3 = FUN_00404920();
      if (cVar3 != '\0') goto LAB_0040bdba;
      FUN_0040c030(0,param_1);
      iVar6 = *(int *)(param_1 + 0x34);
      uVar5 = *(undefined4 *)(param_1 + 0x20);
    }
LAB_0040bef8:
    FUN_00404e70((void *)0xffffffff,uVar5,iVar6);
    uVar5 = extraout_ECX_09;
  }
  else {
    if (iVar6 != 4) goto LAB_0040bf12;
    if ((*(char *)((int)this + 1) == '\0') && (*(char *)((int)this + 2) == '\0')) {
      if (param_2 == '\0') goto LAB_0040bf12;
                    // WARNING: Load size is inaccurate
      if (*this == '\0') {
        FUN_0040c030(3,param_1);
        *(undefined4 *)(param_1 + 0x28) = 0;
        uVar5 = extraout_ECX_03;
        goto LAB_0040bf12;
      }
      FUN_0040c030(3,param_1);
      cVar3 = FUN_00404920();
      if (cVar3 != '\0') goto LAB_0040bdba;
      FUN_0040c030(0,param_1);
      iVar6 = *(int *)(param_1 + 0x34);
      goto LAB_0040bef3;
    }
  }
  *(undefined4 *)(param_1 + 0x28) = 3;
LAB_0040bf12:
  FUN_0040c140(uVar5);
  local_4._0_1_ = 2;
  FUN_0041a190("Unit: UpdateState%d New state=%s",3);
  local_4 = (uint)local_4._1_3_ << 8;
  if (local_18 != (void *)0x0) {
    free(local_18);
  }
  DVar4 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0x394) == DVar4) {
    piVar1 = (int *)(param_1 + 0x398);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(param_1 + 0x394) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x39c));
    }
  }
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0040bf90(void *this,char param_1)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined extraout_DL_01;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438e46;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  puVar1 = (undefined4 *)operator_new(0x14);
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (param_1 == '\0') {
    local_4 = 1;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_004149b0(puVar1,*(undefined4 *)((int)this + 0x10),2);
      uVar2 = extraout_ECX_01;
      uVar3 = extraout_DL_01;
    }
  }
  else {
    local_4 = 0;
    if (puVar1 != (undefined4 *)0x0) {
      FUN_004149b0(puVar1,*(undefined4 *)((int)this + 0x10),1);
      uVar2 = extraout_ECX_00;
      uVar3 = extraout_DL_00;
    }
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,(int)this + 0x94);
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0040c030(int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438c9b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  if (param_1 == 0) {
    *(int *)(param_2 + 0x20) = *(int *)(param_2 + 0x20) + 1;
  }
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_004148b0(puVar1,*(undefined4 *)(param_2 + 0x10),*(undefined4 *)(param_2 + 0x20),
                 (char)param_1);
    uVar2 = extraout_ECX_00;
    uVar3 = extraout_DL_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,param_2 + 0x94);
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0040c0c0(int param_1)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar2;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438c9b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  puVar1 = (undefined4 *)operator_new(0x14);
  local_4 = 0;
  uVar2 = extraout_ECX;
  uVar3 = extraout_DL;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_004149b0(puVar1,*(undefined4 *)(param_1 + 0x10),5);
    uVar2 = extraout_ECX_00;
    uVar3 = extraout_DL_00;
  }
  local_4 = 0xffffffff;
  FUN_004072f0(uVar2,uVar3,param_1 + 0x94);
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0040c140(undefined4 param_1)

{
  undefined4 in_EAX;
  
  switch(in_EAX) {
  case 0:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"WAITING CAR");
    return;
  case 1:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"WAITING POS1");
    return;
  case 2:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"WAITING POS2");
    return;
  case 3:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"WAITING DEPARTURE");
    return;
  case 4:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"WAITING DECISION");
    return;
  default:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"UNKNOWN");
    return;
  }
}



uint FUN_0040c1f0(int param_1)

{
  code *pcVar1;
  uint uVar2;
  void **ppvVar3;
  undefined4 *puVar4;
  undefined extraout_DL;
  undefined extraout_DL_00;
  undefined uVar5;
  int unaff_EBX;
  void *local_c;
  undefined *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00439c9b;
  local_c = ExceptionList;
  uVar2 = DAT_0044a01c ^ (uint)&stack0xffffffe4;
  ppvVar3 = &local_c;
  ExceptionList = ppvVar3;
  if (param_1 == 6) {
    FUN_0041c150();
    pcVar1 = *(code **)(*(int *)(unaff_EBX + 0x224) + 4);
    *(undefined *)(unaff_EBX + 0x228) = 1;
    ppvVar3 = (void **)(*pcVar1)(uVar2);
    if (*(char *)(unaff_EBX + 600) == '\0') {
      WaitForSingleObject(*(HANDLE *)(unaff_EBX + 0x25c),0xffffffff);
      ppvVar3 = (void **)CloseHandle(*(HANDLE *)(unaff_EBX + 0x25c));
    }
  }
  if (param_1 == 6) {
    puVar4 = (undefined4 *)operator_new(0x14);
    uStack_4 = 1;
    uVar5 = extraout_DL;
    if (puVar4 != (undefined4 *)0x0) {
      FUN_004149b0(puVar4,*(undefined4 *)(unaff_EBX + 0x10),2);
      uVar5 = extraout_DL_00;
    }
    uStack_4 = 0xffffffff;
    FUN_004072f0(unaff_EBX + 0x94,uVar5,unaff_EBX + 0x94);
    Sleep(200);
    ppvVar3 = (void **)FUN_004063a0((int *)(unaff_EBX + 0x40));
  }
  if (param_1 == 6) {
    FUN_00404aa0(*(int *)(unaff_EBX + 0x220));
    ppvVar3 = *(void ***)(unaff_EBX + 0x220);
    if (ppvVar3 != (void **)0x0) {
                    // WARNING: Load size is inaccurate
      ppvVar3 = (void **)(**ppvVar3[1])(1);
    }
    *(undefined4 *)(unaff_EBX + 0x220) = 0;
  }
  if (param_1 == 6) {
    FUN_00403270((int *)(unaff_EBX + 0x1a8));
    FUN_00407220((int *)(unaff_EBX + 0x94));
    ppvVar3 = (void **)FUN_004160f0();
  }
  ExceptionList = local_c;
  return (uint)ppvVar3 & 0xffffff00;
}



undefined4 * __thiscall FUN_0040c330(void *this,byte param_1)

{
  FUN_0040c3d0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void FUN_0040c350(void)

{
  code *pcVar1;
  int iVar2;
  int in_EAX;
  int unaff_ESI;
  
  *(undefined4 *)(unaff_ESI + 8) = *(undefined4 *)(in_EAX + 8);
  pcVar1 = *(code **)(*(int *)(unaff_ESI + 0x18) + 0xc);
  *(undefined4 *)(unaff_ESI + 0xc) = *(undefined4 *)(in_EAX + 0xc);
  *(undefined4 *)(unaff_ESI + 0x10) = *(undefined4 *)(in_EAX + 0x10);
  (*pcVar1)(in_EAX + 0x18);
  *(undefined *)(unaff_ESI + 0xf0) = *(undefined *)(in_EAX + 0xf0);
  *(undefined *)(unaff_ESI + 0xf1) = *(undefined *)(in_EAX + 0xf1);
  *(undefined4 *)(unaff_ESI + 0xf4) = *(undefined4 *)(in_EAX + 0xf4);
  if (*(int *)(unaff_ESI + 0xf8) != 0) {
    (**(code **)(*(int *)(*(int *)(unaff_ESI + 0xf8) + 0x18) + 8))();
  }
  iVar2 = *(int *)(in_EAX + 0xf8);
  *(int *)(unaff_ESI + 0xf8) = iVar2;
  if (iVar2 != 0) {
    (**(code **)(*(int *)(iVar2 + 0x18) + 4))();
  }
  return;
}



void __fastcall FUN_0040c3d0(undefined4 *param_1)

{
  uint uVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004383db;
  local_c = ExceptionList;
  uVar1 = DAT_0044a01c ^ (uint)&stack0xffffffec;
  ExceptionList = &local_c;
  *param_1 = CSimulationState::vftable;
  local_4 = 0;
  if (param_1[0x3e] != 0) {
    (**(code **)(*(int *)(param_1[0x3e] + 0x18) + 8))(uVar1);
  }
  param_1[0x3e] = 0;
  local_4 = 0xffffffff;
  FUN_004103a0(param_1 + 6);
  ExceptionList = local_c;
  return;
}



// WARNING: Restarted to delay deadcode elimination for space: stack

uint FUN_0040c450(void *param_1,size_t param_2)

{
  bool bVar1;
  bool bVar2;
  char *pcVar3;
  int *piVar4;
  char cVar5;
  undefined uVar6;
  void **ppvVar7;
  FILE *_File;
  int iVar8;
  int *piVar9;
  undefined4 *puVar10;
  DWORD DVar11;
  undefined1 *puVar12;
  undefined4 uVar13;
  code *pcVar14;
  int *piVar15;
  undefined4 *puVar16;
  int *piVar17;
  char *pcVar18;
  int iStack_148;
  undefined4 *puStack_144;
  char *local_140;
  void *local_13c;
  undefined4 local_138;
  undefined **local_134;
  undefined2 local_130;
  undefined2 local_12e;
  undefined2 local_12c;
  undefined2 local_12a;
  undefined2 local_128;
  undefined4 local_124;
  undefined **local_114 [2];
  int local_10c;
  undefined4 local_108;
  undefined4 local_104;
  undefined4 local_fc [54];
  undefined local_24;
  undefined local_23;
  undefined4 local_20;
  undefined4 *local_1c;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  piVar4 = DAT_0044c6b0;
  puStack_8 = &LAB_0043a7f0;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  bVar2 = false;
  local_4 = 0;
  local_114[0] = CSimulationState::vftable;
  FUN_00410260(local_fc,0,0);
  local_1c = (undefined4 *)0x0;
  local_140 = (char *)0x0;
  local_138 = 0;
  local_13c = (void *)0x0;
  local_4 = CONCAT31(local_4._1_3_,2);
  puVar12 = &DAT_0044d0d5;
  if (param_1 != (void *)0x0) {
    puVar12 = (undefined1 *)param_1;
  }
  FUN_0041a190("Simulator: Initialize(%s) begin",(char)puVar12);
  ppvVar7 = (void **)(piVar4 + 4);
  if (param_1 != *ppvVar7) {
    FUN_0041b310();
    memcpy(*ppvVar7,param_1,param_2);
    piVar4[5] = param_2;
    *(undefined *)(param_2 + (int)*ppvVar7) = 0;
  }
  *(undefined8 *)(piVar4 + 2) = 0x3ff0000000000000;
  *(undefined *)(piVar4 + 0x1b) = 0;
  FUN_0041c150();
  *piVar4 = 0;
  local_10c = 0;
  local_108 = 0;
  local_104 = 0;
  puVar16 = (undefined4 *)0x0;
  FUN_0041b310();
  *puVar16 = 0x2d465455;
  *(undefined *)(puVar16 + 1) = 0x38;
  *(undefined *)((int)puVar16 + 5) = 0;
  FUN_00410af0(local_fc,puVar16,5);
  puVar16 = (undefined4 *)0x0;
  FUN_0041b310();
  *puVar16 = 0x65646e75;
  puVar16[1] = 0x656e6966;
  *(undefined *)(puVar16 + 2) = 100;
  *(undefined *)((int)puVar16 + 9) = 0;
  FUN_00410980(local_fc,puVar16,9);
  local_134 = CRectangle2::vftable;
  local_12e = 0;
  local_12c = 0;
  local_12a = 0x3ff;
  local_128 = 0x1df;
  local_130 = 0;
  local_124 = 0;
  local_4._0_1_ = 3;
  FUN_0040f5a0();
  local_4 = CONCAT31(local_4._1_3_,2);
  local_24 = 1;
  local_23 = 1;
  local_20 = 0x14;
  puVar16 = (undefined4 *)operator_new(0x44);
  if (puVar16 == (undefined4 *)0x0) {
    puVar16 = (undefined4 *)0x0;
  }
  else {
    *puVar16 = CDib::vftable;
    puVar16[3] = 0;
    puVar16[1] = 0;
    puVar16[2] = 0;
    puVar16[5] = 0;
    puVar16[6] = aSyncRefCounter::vftable;
    puVar16[8] = aCriticalSection::vftable;
    puVar16[9] = 0xffffffff;
    puVar16[10] = 0;
    InitializeCriticalSection((LPCRITICAL_SECTION)(puVar16 + 0xb));
    puVar16[7] = 1;
    *puVar16 = CDibRef::vftable;
    puVar16[6] = CDibRef::vftable;
  }
  local_1c = puVar16;
  FUN_0040ea20(0x400,8);
  memset((void *)local_1c[1],0,0x78000);
  FUN_0040c350();
  ppvVar7 = (void **)FUN_0041b2a0(&local_134,"%s/Simulation.ini");
  local_4._0_1_ = 4;
  if (*ppvVar7 != (void *)0x0) {
    FUN_0041b310();
    pcVar3 = local_140;
    memcpy(local_140,*ppvVar7,(size_t)ppvVar7[1]);
    local_13c = ppvVar7[1];
    *(char *)((int)local_13c + (int)pcVar3) = '\0';
  }
  local_4._0_1_ = 2;
  if (local_134 != (undefined **)0x0) {
    free(local_134);
  }
  pcVar3 = local_140;
  pcVar18 = &DAT_0044d0d5;
  if (local_140 != (char *)0x0) {
    pcVar18 = local_140;
  }
  _File = fopen(pcVar18,"rb");
  pcVar14 = feof_exref;
  if (_File == (FILE *)0x0) {
    pcVar18 = &DAT_0044d0d5;
    if (pcVar3 != (char *)0x0) {
      pcVar18 = pcVar3;
    }
    FUN_0041a1f0("Simulator: Can\'t find simulation file %s",(char)pcVar18);
    (**(code **)(*(int *)(piVar4[0x5c] + 0x18) + 8))();
    local_4._0_1_ = 1;
    if (pcVar3 != (char *)0x0) {
      free(pcVar3);
    }
    local_4 = (uint)local_4._1_3_ << 8;
    FUN_0040c3d0(local_114);
    local_4 = 0xffffffff;
    if (param_1 != (void *)0x0) {
      free(param_1);
    }
  }
  else {
    iStack_148 = 0;
    iVar8 = feof(_File);
    while (iVar8 == 0) {
      iVar8 = 0x40c809;
      piVar17 = piVar4;
      cVar5 = FUN_0040ce30(local_114,_File,piVar4,&iStack_148);
      if (cVar5 == '\0') {
        iVar8 = (*pcVar14)();
        pcVar3 = local_140;
        if (iVar8 != 0) goto LAB_0040c968;
        pcVar18 = &DAT_0044d0d5;
        if (local_140 != (char *)0x0) {
          pcVar18 = local_140;
        }
        FUN_0041a1f0("Simulator: Error in file %s line %d",(char)pcVar18);
        puVar16 = (undefined4 *)FUN_0040e220((int)(piVar4 + 0x5e));
        for (puVar16 = (undefined4 *)*puVar16; puVar16 != (undefined4 *)0x0;
            puVar16 = (undefined4 *)*puVar16) {
          if ((undefined4 *)puVar16[2] != (undefined4 *)0x0) {
            (***(code ***)(undefined4 *)puVar16[2])();
          }
        }
        iVar8 = piVar4[0x5f];
        while (iVar8 != 0) {
          piVar17 = (int *)piVar4[0x5f];
          piVar4[0x5f] = *piVar17;
          operator_delete(piVar17);
          iVar8 = piVar4[0x5f];
        }
        piVar4[0x5e] = 0;
        piVar4[0x5f] = 0;
        piVar4[0x60] = 0;
        local_4._0_1_ = 1;
        if (pcVar3 != (char *)0x0) {
          free(pcVar3);
        }
        local_4 = (uint)local_4._1_3_ << 8;
        FUN_0040c3d0(local_114);
        goto LAB_0040caa9;
      }
      piVar15 = piVar4 + 0x5e;
      if (*piVar15 == 0) {
LAB_0040c83f:
        bVar1 = false;
      }
      else {
        bVar2 = true;
        piVar9 = (int *)FUN_0040e230((int)piVar15);
        if (local_10c != *(int *)(*(int *)(*piVar9 + 8) + 8)) goto LAB_0040c83f;
        bVar1 = true;
      }
      if (bVar2) {
        bVar2 = false;
      }
      if (bVar1) {
        piVar9 = (int *)FUN_0040e230((int)piVar15);
        FUN_00406000((int)piVar15,*(int *)(*piVar9 + 8));
        if (&stack0x00000000 != (undefined *)0x174) {
          if (1 < *piVar15) {
            if ((int *)&stack0xfffffe8c == (int *)piVar4[0x5f]) {
              iVar8 = *(int *)piVar4[0x5f];
              piVar4[0x5f] = iVar8;
              *(undefined4 *)(iVar8 + 4) = 0;
            }
            else if (&stack0xfffffe8c == (undefined *)piVar4[0x60]) {
              puVar16 = *(undefined4 **)((undefined *)piVar4[0x60] + 4);
              piVar4[0x60] = (int)puVar16;
              *puVar16 = 0;
            }
            else {
              *piVar17 = iVar8;
              *(int **)(iVar8 + 4) = piVar17;
            }
          }
          operator_delete(&stack0xfffffe8c);
          *piVar15 = *piVar15 + -1;
          if (*piVar15 == 0) {
            piVar4[0x60] = 0;
            piVar4[0x5f] = 0;
          }
        }
      }
      puVar16 = (undefined4 *)operator_new(0x100);
      local_4._0_1_ = 5;
      puStack_144 = puVar16;
      if (puVar16 == (undefined4 *)0x0) {
        puVar16 = (undefined4 *)0x0;
      }
      else {
        *puVar16 = CSimulationState::vftable;
        FUN_00410260(puVar16 + 6,0,0);
        local_4._0_1_ = 6;
        puVar16[0x3e] = 0;
        FUN_0040c350();
      }
      local_4._0_1_ = 2;
      iVar8 = piVar4[0x60];
      puVar10 = (undefined4 *)operator_new(0xc);
      puVar10[1] = iVar8;
      *puVar10 = 0;
      puVar10[2] = puVar16;
      pcVar14 = feof_exref;
      if ((undefined4 *)piVar4[0x60] == (undefined4 *)0x0) {
        *piVar15 = *piVar15 + 1;
        pcVar14 = feof_exref;
        piVar4[0x5f] = (int)puVar10;
        piVar4[0x60] = (int)puVar10;
      }
      else {
        *(undefined4 *)piVar4[0x60] = puVar10;
        *piVar15 = *piVar15 + 1;
        piVar4[0x60] = (int)puVar10;
      }
LAB_0040c968:
      iVar8 = (*pcVar14)();
      pcVar3 = local_140;
    }
    fclose(_File);
    *piVar4 = local_10c;
    if (local_10c == 0) {
      pcVar18 = &DAT_0044d0d5;
      if (pcVar3 != (char *)0x0) {
        pcVar18 = pcVar3;
      }
      uVar6 = SUB41(pcVar18,0);
      pcVar18 = "Simulator: There is no time progress in simulation %s";
    }
    else {
      if (piVar4[0x5e] != 0) {
        piVar4[0x5d] = -1;
        iVar8 = 0;
        puVar16 = (undefined4 *)FUN_0040e220((int)(piVar4 + 0x5e));
        for (puVar16 = (undefined4 *)*puVar16; puVar16 != (undefined4 *)0x0;
            puVar16 = (undefined4 *)*puVar16) {
          *(int *)(puVar16[2] + 0xfc) = iVar8;
          iVar8 = iVar8 + 1;
        }
        FUN_0041c210();
        DVar11 = timeGetTime();
        piVar4[1] = DVar11;
        puVar12 = &DAT_0044d0d5;
        if (param_1 != (void *)0x0) {
          puVar12 = (undefined1 *)param_1;
        }
        FUN_0041a190("Simulator: Initialize(%s) end",(char)puVar12);
        local_4._0_1_ = 1;
        if (pcVar3 != (char *)0x0) {
          free(pcVar3);
        }
        local_4 = (uint)local_4._1_3_ << 8;
        uVar13 = FUN_0040c3d0(local_114);
        local_4 = 0xffffffff;
        if (param_1 != (void *)0x0) {
          free(param_1);
        }
        ExceptionList = local_c;
        return CONCAT31((int3)((uint)uVar13 >> 8),1);
      }
      pcVar18 = &DAT_0044d0d5;
      if (pcVar3 != (char *)0x0) {
        pcVar18 = pcVar3;
      }
      uVar6 = SUB41(pcVar18,0);
      pcVar18 = "Simulator: Empty simulation file %s";
    }
    FUN_0041a1f0(pcVar18,uVar6);
    local_4._0_1_ = 1;
    if (pcVar3 != (char *)0x0) {
      free(pcVar3);
    }
    local_4 = (uint)local_4._1_3_ << 8;
    FUN_0040c3d0(local_114);
LAB_0040caa9:
    local_4 = 0xffffffff;
    if (param_1 != (void *)0x0) {
      free(param_1);
      ExceptionList = local_c;
      return (uint)param_1 & 0xffffff00;
    }
  }
  ExceptionList = local_c;
  return (uint)param_1 & 0xffffff00;
}



void FUN_0040cbb0(void)

{
  int iVar1;
  DWORD DVar2;
  undefined4 *puVar3;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  iVar1 = DAT_0044c6b0;
  puStack_c = &LAB_00438c70;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 0;
  if (*(char *)(DAT_0044c6b0 + 0x6c) != '\0') {
    DVar2 = timeGetTime();
    if (*(int *)(iVar1 + 0x70) < (int)DVar2) {
      *(int *)(iVar1 + 4) = *(int *)(iVar1 + 4) + (DVar2 - *(int *)(iVar1 + 0x70));
    }
    FUN_0041c150();
    *(undefined *)(iVar1 + 0x6c) = 0;
  }
  FUN_0041c150();
  puVar3 = (undefined4 *)FUN_0040e220(iVar1 + 0x178);
  for (puVar3 = (undefined4 *)*puVar3; puVar3 != (undefined4 *)0x0; puVar3 = (undefined4 *)*puVar3)
  {
    if ((undefined4 *)puVar3[2] != (undefined4 *)0x0) {
      (***(code ***)(undefined4 *)puVar3[2])(1);
    }
  }
  while (puVar3 = *(undefined4 **)(iVar1 + 0x17c), puVar3 != (undefined4 *)0x0) {
    *(undefined4 *)(iVar1 + 0x17c) = *puVar3;
    operator_delete(puVar3);
  }
  *(undefined4 *)(iVar1 + 0x178) = 0;
  *(undefined4 *)(iVar1 + 0x17c) = 0;
  *(undefined4 *)(iVar1 + 0x180) = 0;
  ExceptionList = local_10;
  return;
}



undefined4 Catch_All_0040cc81(void)

{
  return 0x40cc6f;
}



uint FUN_0040cc90(void)

{
  double dVar1;
  int iVar2;
  char cVar3;
  uint uVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_EDX;
  ulonglong uVar5;
  
  iVar2 = DAT_0044c6b0;
  (**(code **)(*(int *)(DAT_0044c6b0 + 0x44) + 0x10))(0xffffffff);
  uVar4 = FUN_0040cdc0(extraout_ECX);
  if ((NAN(*(double *)(iVar2 + 8)) == (*(double *)(iVar2 + 8) == 0.0)) &&
     (dVar1 = *(double *)(iVar2 + 8) * 500.0,
     dVar1 < (double)uVar4 == (NAN(dVar1) || NAN((double)uVar4)))) {
    uVar5 = FUN_00437bc0(extraout_ECX_00,extraout_EDX);
    cVar3 = (**(code **)(*(int *)(iVar2 + 0x1c) + 0x10))((int)uVar5);
    return ~-(uint)(cVar3 != '\0') & uVar4;
  }
  (**(code **)(*(int *)(iVar2 + 0x1c) + 0x10))(500);
  return 0;
}



int * FUN_0040cd20(void)

{
  int iVar1;
  int *piVar2;
  DWORD DVar3;
  int **ppiVar4;
  int *piVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  int iVar6;
  ulonglong uVar7;
  
  piVar5 = DAT_0044c6b0;
  (**(code **)(DAT_0044c6b0[0x11] + 0x10))(0xffffffff);
  DVar3 = timeGetTime();
  if ((int)DVar3 < piVar5[1]) {
    piVar5[1] = DVar3;
  }
  uVar7 = FUN_00437bc0(extraout_ECX,extraout_EDX);
  ppiVar4 = (int **)FUN_0040e220((int)(piVar5 + 0x5e));
  piVar2 = *ppiVar4;
  if (*(int *)(piVar2[2] + 8) <= (int)uVar7) {
    iVar6 = (int)((longlong)((ulonglong)(uint)((int)uVar7 >> 0x1f) << 0x20 | uVar7 & 0xffffffff) %
                 (longlong)*piVar5);
    if (*(int *)(piVar2[2] + 8) <= iVar6) {
      iVar1 = *(int *)(piVar2[2] + 8);
      while (iVar1 <= iVar6) {
        piVar2 = (int *)*piVar2;
        iVar1 = *(int *)(piVar2[2] + 8);
      }
      return *(int **)(piVar2[1] + 8);
    }
    piVar5 = (int *)FUN_0040e230((int)(piVar5 + 0x5e));
    return *(int **)(*piVar5 + 8);
  }
  return piVar5 + 0x1e;
}



int __fastcall FUN_0040cdc0(undefined4 param_1)

{
  int iVar1;
  int *piVar2;
  DWORD DVar3;
  int **ppiVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  int iVar5;
  int *unaff_EBX;
  int *unaff_ESI;
  ulonglong uVar6;
  
  (**(code **)(unaff_ESI[0x11] + 0x10))(0xffffffff,param_1);
  DVar3 = timeGetTime();
  if ((int)DVar3 < unaff_ESI[1]) {
    unaff_ESI[1] = DVar3;
  }
  uVar6 = FUN_00437bc0(extraout_ECX,extraout_EDX);
  iVar5 = (int)((longlong)((ulonglong)(uint)((int)uVar6 >> 0x1f) << 0x20 | uVar6 & 0xffffffff) %
               (longlong)*unaff_ESI);
  ppiVar4 = (int **)FUN_0040e220((int)(unaff_ESI + 0x5e));
  piVar2 = *ppiVar4;
  iVar1 = *(int *)(piVar2[2] + 8);
  while (iVar1 < iVar5) {
    piVar2 = (int *)*piVar2;
    iVar1 = *(int *)(piVar2[2] + 8);
  }
  if (unaff_EBX != (int *)0x0) {
    *unaff_EBX = piVar2[2];
  }
  return *(int *)(piVar2[2] + 8) - iVar5;
}



void __fastcall FUN_0040ce30(int param_1,FILE *param_2,undefined4 param_3,int *param_4)

{
  char cVar1;
  char *pcVar2;
  size_t sVar3;
  int iVar4;
  char *pcVar5;
  char **ppcVar6;
  int iVar7;
  int iVar8;
  char *pcVar9;
  uint uVar10;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  void *this;
  undefined4 *puVar11;
  FILE *_File;
  code *pcVar12;
  char *unaff_EBP;
  int *piVar13;
  float10 fVar14;
  undefined auStack_228 [4];
  char *local_224;
  undefined8 local_220;
  undefined8 local_218;
  void *local_210;
  char *local_20c;
  undefined4 local_208;
  int local_204;
  char *apcStack_200 [8];
  char *local_1e0;
  size_t local_1dc;
  undefined4 local_1d8;
  char *pcStack_1d4;
  double dStack_1d0;
  FILE *local_1c8 [2];
  char *apcStack_1c0 [6];
  char *apcStack_1a8 [3];
  char *apcStack_19c [3];
  char *apcStack_190 [3];
  char *apcStack_184 [3];
  char *apcStack_178 [3];
  char *apcStack_16c [3];
  char *apcStack_160 [3];
  void *apvStack_154 [3];
  char *apcStack_148 [3];
  undefined4 uStack_13c;
  char acStack_138 [8];
  char acStack_130 [32];
  char local_110 [256];
  undefined4 local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a763;
  local_c = ExceptionList;
  local_10 = DAT_0044a01c ^ (uint)auStack_228;
  ExceptionList = &local_c;
  local_218 = (double)CONCAT44(local_218._4_4_,param_3);
  local_210 = (void *)0x0;
  local_208 = 0;
  local_20c = (char *)0x0;
  local_224 = (char *)0x0;
  local_220 = 0.0;
  local_1e0 = (char *)0x0;
  local_1d8 = 0;
  local_1dc = 0;
  local_4 = 2;
  local_204 = param_1;
  local_1c8[0] = param_2;
  memset(local_110,0,0x100);
  fgets(local_110,0x100,param_2);
  pcVar2 = local_110;
  *param_4 = *param_4 + 1;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  sVar3 = (int)pcVar2 - (int)(local_110 + 1);
  FUN_0041b310();
  pcVar2 = local_1e0;
  memcpy(local_1e0,local_110,sVar3);
  pcVar2[sVar3] = '\0';
  _File = local_1c8[0];
  pcVar12 = strstr_exref;
  local_1dc = sVar3;
  while (((((local_110[0] == '#' || (local_110[0] == '\n')) || (local_110[0] == '\r')) ||
          (((iVar4 = (*pcVar12)(), iVar4 != 0 && (-1 < iVar4 - (int)pcVar2)) &&
           ((iVar4 = (*pcVar12)(), iVar4 == 0 || (iVar4 - (int)pcVar2 < 5)))))) &&
         (iVar4 = feof(_File), iVar4 == 0))) {
    memset(local_110,0,0x100);
    fgets(local_110,0x100,_File);
    pcVar5 = local_110;
    if (pcVar5 != pcVar2) {
      do {
        cVar1 = *pcVar5;
        pcVar5 = pcVar5 + 1;
      } while (cVar1 != '\0');
      sVar3 = (int)pcVar5 - (int)(local_110 + 1);
      FUN_0041b310();
      pcVar2 = local_1e0;
      memcpy(local_1e0,local_110,sVar3);
      pcVar2[sVar3] = '\0';
      _File = local_1c8[0];
      pcVar12 = strstr_exref;
      local_1dc = sVar3;
    }
    *param_4 = *param_4 + 1;
  }
  iVar4 = feof(_File);
  if (iVar4 != 0) {
    local_4 = CONCAT31(local_4._1_3_,1);
    pcVar5 = pcVar2;
joined_r0x0040d041:
    if (pcVar5 != (char *)0x0) {
      free(pcVar5);
    }
    goto LAB_0040dcaf;
  }
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,",");
  local_4._0_1_ = 3;
  FUN_0041aa80(extraout_ECX_00,(char *)0x7fffffff,local_110);
  local_4._0_1_ = 4;
  FUN_0041e130(local_1c8,apcStack_200,&pcStack_1d4);
  local_4._0_1_ = 6;
  if (local_1c8[0] != (FILE *)0x0) {
    free(local_1c8[0]);
  }
  local_4._0_1_ = 7;
  if (pcStack_1d4 != (char *)0x0) {
    free(pcStack_1d4);
  }
  ppcVar6 = FUN_0041e230(apcStack_200,&pcStack_1d4);
  local_4._0_1_ = 8;
  if (*ppcVar6 != (char *)0x0) {
    FUN_0041b310();
    pcVar5 = local_224;
    memcpy(local_224,*ppcVar6,(size_t)ppcVar6[1]);
    local_220 = (double)CONCAT44(local_220._4_4_,ppcVar6[1]);
    ppcVar6[1][(int)pcVar5] = '\0';
  }
  pcVar12 = free_exref;
  local_4._0_1_ = 7;
  if (pcStack_1d4 != (char *)0x0) {
    free(pcStack_1d4);
  }
  pcVar5 = local_224;
  if ((int)local_220 == 0) {
LAB_0040d13c:
    local_4._0_1_ = 2;
    FUN_004037f0(apcStack_200);
    local_4._0_1_ = 1;
    if (pcVar2 != (char *)0x0) {
      (*pcVar12)();
    }
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_224 != (char *)0x0) {
      (*pcVar12)();
    }
    goto LAB_0040dcaf;
  }
  pcVar9 = &DAT_0044d0d5;
  if (local_224 != (char *)0x0) {
    pcVar9 = local_224;
  }
  iVar4 = atoi(pcVar9);
  *(int *)(local_204 + 8) = *(int *)(local_204 + 8) + iVar4;
  ppcVar6 = FUN_0041e230(apcStack_200,&pcStack_1d4);
  local_4._0_1_ = 9;
  if (*ppcVar6 != pcVar5) {
    FUN_0041b310();
    pcVar5 = local_224;
    memcpy(local_224,*ppcVar6,(size_t)ppcVar6[1]);
    pcVar12 = free_exref;
    local_220 = (double)CONCAT44(local_220._4_4_,ppcVar6[1]);
    ppcVar6[1][(int)pcVar5] = '\0';
  }
  local_4._0_1_ = 7;
  if (pcStack_1d4 != (char *)0x0) {
    (*pcVar12)();
  }
  if ((int)local_220 == 0) {
    local_4._0_1_ = 2;
    FUN_004037f0(apcStack_200);
    local_4._0_1_ = 1;
    if (pcVar2 != (char *)0x0) {
      (*pcVar12)();
    }
    local_4 = (uint)local_4._1_3_ << 8;
    if (pcVar5 != (char *)0x0) {
      (*pcVar12)();
    }
    goto LAB_0040dcaf;
  }
  if ((int)local_220 != 1) {
    local_4._0_1_ = 2;
    FUN_004037f0(apcStack_200);
    local_4._0_1_ = 1;
    if (pcVar2 != (char *)0x0) {
      (*pcVar12)();
    }
    local_4 = (uint)local_4._1_3_ << 8;
    if (pcVar5 != (char *)0x0) {
      (*pcVar12)();
    }
    goto LAB_0040dcaf;
  }
  ppcVar6 = (char **)FUN_0041ada0(&local_224,&pcStack_1d4);
  cVar1 = **ppcVar6;
  if (pcStack_1d4 != (char *)0x0) {
    free(pcStack_1d4);
  }
  if (cVar1 == 'b') {
    FUN_0041e230(apcStack_200,apcStack_184);
    local_4._0_1_ = 10;
    FUN_00401040(&local_224);
    local_4._0_1_ = 7;
    if (apcStack_184[0] != (char *)0x0) {
      free(apcStack_184[0]);
    }
    pcVar5 = local_224;
    if ((int)local_220 != 0) {
      pcVar9 = &DAT_0044d0d5;
      if (local_224 != (char *)0x0) {
        pcVar9 = local_224;
      }
      uVar10 = atoi(pcVar9);
      if (uVar10 < 2) {
        FUN_0041e230(apcStack_200,apcStack_16c);
        local_4._0_1_ = 0xb;
        FUN_00401040(&local_224);
        pcVar12 = free_exref;
        local_4._0_1_ = 7;
        if (apcStack_16c[0] != (char *)0x0) {
          free(apcStack_16c[0]);
        }
        pcVar5 = local_224;
        if ((int)local_220 == 0) goto LAB_0040d13c;
        pcVar9 = &DAT_0044d0d5;
        if (local_224 != (char *)0x0) {
          pcVar9 = local_224;
        }
        iVar4 = atoi(pcVar9);
        if ((iVar4 == 0) || (iVar4 == 1)) {
          *(uint *)(local_204 + 0xc + uVar10 * 4) = (uint)(iVar4 != 0);
          pcVar12 = free_exref;
LAB_0040dc20:
          local_4._0_1_ = 2;
          FUN_004037f0(apcStack_200);
          local_4._0_1_ = 1;
          if (pcVar2 != (char *)0x0) {
            (*pcVar12)();
          }
          local_4 = (uint)local_4._1_3_ << 8;
          if (pcVar5 != (char *)0x0) {
            (*pcVar12)();
          }
          local_4 = -1;
          if (local_210 != (void *)0x0) {
            (*pcVar12)();
          }
          goto LAB_0040dcaf;
        }
      }
      local_4._0_1_ = 2;
      FUN_004037f0(apcStack_200);
      local_4._0_1_ = 1;
      if (pcVar2 != (char *)0x0) {
        free(pcVar2);
      }
      local_4 = (uint)local_4._1_3_ << 8;
      goto joined_r0x0040d041;
    }
LAB_0040d33b:
    local_4._0_1_ = 2;
    FUN_004037f0(apcStack_200);
    local_4._0_1_ = 1;
    if (pcVar2 != (char *)0x0) {
      free(pcVar2);
    }
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_224 != (char *)0x0) {
      free(local_224);
    }
    goto LAB_0040dcaf;
  }
  if (cVar1 != 'c') {
    local_4._0_1_ = 2;
    FUN_004037f0(apcStack_200);
    local_4._0_1_ = 1;
    if (pcVar2 != (char *)0x0) {
      free(pcVar2);
    }
    local_4 = (uint)local_4._1_3_ << 8;
    if (pcVar5 != (char *)0x0) {
      free(pcVar5);
    }
    goto LAB_0040dcaf;
  }
  FUN_0041e230(apcStack_200,apcStack_190);
  local_4._0_1_ = 0xc;
  FUN_00401040(&local_224);
  local_4._0_1_ = 7;
  if (apcStack_190[0] != (char *)0x0) {
    free(apcStack_190[0]);
  }
  pcVar5 = local_224;
  if ((int)local_220 == 0) goto LAB_0040d33b;
  pcVar9 = "%s/%s";
  FUN_0041b2a0(apvStack_154,"%s/%s");
  local_4._0_1_ = 0xd;
  FUN_00401040(&local_210);
  local_4 = CONCAT31(local_4._1_3_,7);
  if (apvStack_154[0] != (void *)0x0) {
    free(apvStack_154[0]);
  }
  iVar4 = local_204;
  if (*(int *)(local_204 + 0xf8) != 0) {
    (**(code **)(*(int *)(*(int *)(local_204 + 0xf8) + 0x18) + 8))();
  }
  local_218 = (double)CONCAT44(local_218._4_4_,&stack0xfffffdb8);
  FUN_0041aa30((void **)&stack0xfffffdb8);
  iVar7 = FUN_0040dce0(this,pcVar9);
  *(int *)(iVar4 + 0xf8) = iVar7;
  if (iVar7 == 0) {
    local_4._0_1_ = 2;
    FUN_004037f0(apcStack_200);
    local_4._0_1_ = 1;
    if (pcVar2 != (char *)0x0) {
      free(pcVar2);
    }
    local_4 = (uint)local_4._1_3_ << 8;
    if (pcVar5 != (char *)0x0) {
      free(pcVar5);
    }
    local_4 = -1;
    if (local_210 != (void *)0x0) {
      free(local_210);
    }
    goto LAB_0040dcaf;
  }
  FUN_0041e230(apcStack_200,apcStack_160);
  local_4._0_1_ = 0xe;
  FUN_00401040(&local_224);
  local_4 = CONCAT31(local_4._1_3_,7);
  if (apcStack_160[0] != (char *)0x0) {
    free(apcStack_160[0]);
  }
  pcVar5 = local_224;
  if (local_224 == (char *)0x0) {
    pcVar5 = &DAT_0044d0d5;
  }
  local_218 = (double)CONCAT44(local_218._4_4_,&stack0xfffffdb8);
  FUN_0041aa80(pcVar5,(char *)0x7fffffff,pcVar5);
  piVar13 = (int *)(local_204 + 0x18);
  (**(code **)(*(int *)(local_204 + 0x18) + 0x20))();
  FUN_0041e230(&local_20c,apcStack_1c0);
  local_10._0_1_ = 0xf;
  FUN_00401040((void **)&stack0xfffffdd0);
  local_10 = CONCAT31(local_10._1_3_,7);
  if (apcStack_1c0[0] != (char *)0x0) {
    free(apcStack_1c0[0]);
  }
  if (unaff_EBP == (char *)0x0) {
    unaff_EBP = &DAT_0044d0d5;
  }
  puVar11 = &uStack_13c;
  do {
    cVar1 = *unaff_EBP;
    *(char *)puVar11 = cVar1;
    unaff_EBP = unaff_EBP + 1;
    puVar11 = (undefined4 *)((int)puVar11 + 1);
  } while (cVar1 != '\0');
  iVar4 = 0;
  if ((char)uStack_13c != '\0') {
    puVar11 = &uStack_13c;
    cVar1 = (char)uStack_13c;
    do {
      if (cVar1 == '?') {
        iVar4 = iVar4 + 1;
      }
      cVar1 = *(char *)((int)puVar11 + 1);
      puVar11 = (undefined4 *)((int)puVar11 + 1);
    } while (cVar1 != '\0');
  }
  (**(code **)(*piVar13 + 100))(iVar4);
  FUN_0041e230(apcStack_200,(char **)&uStack_13c);
  local_4._0_1_ = 0x10;
  FUN_00401040(&local_224);
  local_4._0_1_ = 7;
  if (uStack_13c != (char *)0x0) {
    free(uStack_13c);
  }
  pcVar5 = local_224;
  if ((int)local_220 == 0) {
LAB_0040d5b5:
    local_4._0_1_ = 2;
    FUN_004037f0(apcStack_200);
    local_4._0_1_ = 1;
    pcVar5 = local_224;
    if (pcVar2 != (char *)0x0) {
      free(pcVar2);
      pcVar5 = local_224;
    }
  }
  else {
    pcVar9 = &DAT_0044d0d5;
    if (local_224 != (char *)0x0) {
      pcVar9 = local_224;
    }
    cVar1 = FUN_0040e0b0(pcVar9,(double *)&local_218);
    if (cVar1 == '\0') {
      local_4._0_1_ = 2;
      FUN_004037f0(apcStack_200);
      local_4._0_1_ = 1;
      if (pcVar2 != (char *)0x0) {
        free(pcVar2);
      }
    }
    else if ((local_218 < 0.0 == (local_218 == 0.0)) && (1.0 < local_218 == (local_218 == 1.0))) {
      (**(code **)(*piVar13 + 0x50))();
      FUN_0041e230(apcStack_200,apcStack_178);
      local_4._0_1_ = 0x11;
      FUN_00401040(&local_224);
      local_4._0_1_ = 7;
      if (apcStack_178[0] != (char *)0x0) {
        free(apcStack_178[0]);
      }
      pcVar5 = local_224;
      if ((int)local_220 == 0) goto LAB_0040d5b5;
      pcVar9 = &DAT_0044d0d5;
      if (local_224 != (char *)0x0) {
        pcVar9 = local_224;
      }
      cVar1 = FUN_0040e0b0(pcVar9,(double *)&local_218);
      if (cVar1 == '\0') {
        local_4._0_1_ = 2;
        FUN_004037f0(apcStack_200);
        local_4._0_1_ = 1;
        if (pcVar2 != (char *)0x0) {
          free(pcVar2);
        }
      }
      else {
        if ((local_218 < 0.0 == (local_218 == 0.0)) && (1.0 < local_218 == (local_218 == 1.0))) {
          (**(code **)(*piVar13 + 0x48))();
          FUN_004111d0();
          iVar4 = 0;
          if (acStack_138[0] == '\0') {
            iVar8 = (int)local_220;
            iVar7 = iVar4;
          }
          else {
            do {
              if (acStack_138[0] != '?') {
                iVar8 = FUN_00411010(iVar4,(int)acStack_138,local_220);
                iVar7 = iVar4;
                break;
              }
              FUN_00410f90(0.0);
              iVar8 = 1;
              iVar7 = iVar4 + 1;
              acStack_138[0] = acStack_138[iVar4 + 1];
              iVar4 = iVar7;
            } while (acStack_138[0] != '\0');
          }
          iVar7 = iVar7 + iVar8;
          pcVar5 = acStack_138;
          do {
            cVar1 = *pcVar5;
            pcVar5 = pcVar5 + 1;
          } while (cVar1 != '\0');
          fVar14 = (float10)(**(code **)(*piVar13 + 0x4c))();
          local_220 = (double)fVar14;
          fVar14 = (float10)(**(code **)(*piVar13 + 0x44))();
          dStack_1d0 = (double)((float10)local_220 - fVar14);
          iVar4 = (**(code **)(*piVar13 + 0x60))();
          local_220 = (double)(int)(pcVar5 + (-iVar4 - (int)(acStack_138 + 1)) + -1);
          if ((int)(pcVar5 + (-iVar4 - (int)(acStack_138 + 1)) + -1) < 0) {
            local_220 = local_220 + 4294967296.0;
          }
          local_220 = dStack_1d0 / local_220;
          fVar14 = (float10)(**(code **)(*piVar13 + 0x4c))();
          local_218 = (double)(fVar14 + (float10)local_218);
          cVar1 = acStack_130[iVar7];
          while (cVar1 != '\0') {
            if (cVar1 == '?') {
              FUN_00410f90(0.0);
              iVar7 = iVar7 + 1;
            }
            else {
              iVar4 = FUN_00411010(iVar7,(int)acStack_130,local_218);
              iVar7 = iVar7 + iVar4;
            }
            cVar1 = acStack_130[iVar7];
          }
          FUN_0041e230(apcStack_200,apcStack_148);
          local_4._0_1_ = 0x12;
          FUN_00401040(&local_224);
          pcVar12 = free_exref;
          local_4._0_1_ = 7;
          if (apcStack_148[0] != (char *)0x0) {
            free(apcStack_148[0]);
          }
          pcVar5 = local_224;
          if ((int)local_220 == 0) {
LAB_0040d8c6:
            local_4._0_1_ = 2;
            FUN_004037f0(apcStack_200);
            local_4._0_1_ = 1;
            pcVar5 = local_224;
            if (pcVar2 != (char *)0x0) {
              free(pcVar2);
              pcVar5 = local_224;
            }
          }
          else {
            pcVar9 = &DAT_0044d0d5;
            if (local_224 != (char *)0x0) {
              pcVar9 = local_224;
            }
            iVar4 = atoi(pcVar9);
            if ((iVar4 == 0) || (iVar4 == 1)) {
              (**(code **)(*piVar13 + 0x28))();
              FUN_0041e230(apcStack_200,apcStack_1a8);
              local_4._0_1_ = 0x13;
              FUN_00401040(&local_224);
              local_4._0_1_ = 7;
              if (apcStack_1a8[0] != (char *)0x0) {
                free(apcStack_1a8[0]);
              }
              if ((int)local_220 != 0) {
                pcVar5 = local_224;
                if (local_224 == (char *)0x0) {
                  pcVar5 = &DAT_0044d0d5;
                }
                local_218 = (double)CONCAT44(local_218._4_4_,&stack0xfffffdb8);
                FUN_0041aa80(pcVar5,(char *)0x7fffffff,pcVar5);
                (**(code **)(*piVar13 + 0x30))();
                FUN_0041e230(apcStack_200,apcStack_19c);
                local_4._0_1_ = 0x14;
                FUN_00401040(&local_224);
                local_4._0_1_ = 7;
                if (apcStack_19c[0] != (char *)0x0) {
                  free(apcStack_19c[0]);
                }
                pcVar5 = local_224;
                if ((int)local_220 != 0) {
                  pcVar9 = &DAT_0044d0d5;
                  if (local_224 != (char *)0x0) {
                    pcVar9 = local_224;
                  }
                  iVar4 = atoi(pcVar9);
                  if (-1 < iVar4) {
                    *(int *)(local_204 + 0xf4) = iVar4;
                    goto LAB_0040dc20;
                  }
                  local_4._0_1_ = 2;
                  FUN_004037f0(apcStack_200);
                  local_4._0_1_ = 1;
                  if (pcVar2 != (char *)0x0) {
                    free(pcVar2);
                  }
                  goto joined_r0x0040da8d;
                }
              }
              goto LAB_0040d8c6;
            }
            local_4._0_1_ = 2;
            FUN_004037f0(apcStack_200);
            local_4._0_1_ = 1;
            if (pcVar2 != (char *)0x0) {
              free(pcVar2);
            }
          }
joined_r0x0040da8d:
          if (pcVar5 != (char *)0x0) {
            local_4 = (uint)local_4._1_3_ << 8;
            free(pcVar5);
          }
          local_4 = -1;
          if (local_210 != (void *)0x0) {
            free(local_210);
          }
          goto LAB_0040dcaf;
        }
        local_4._0_1_ = 2;
        FUN_004037f0(apcStack_200);
        local_4._0_1_ = 1;
        if (pcVar2 != (char *)0x0) {
          free(pcVar2);
        }
      }
    }
    else {
      local_4._0_1_ = 2;
      FUN_004037f0(apcStack_200);
      local_4._0_1_ = 1;
      if (pcVar2 != (char *)0x0) {
        free(pcVar2);
      }
    }
  }
  if (pcVar5 != (char *)0x0) {
    local_4 = (uint)local_4._1_3_ << 8;
    free(pcVar5);
  }
  local_4 = -1;
  if (local_210 != (void *)0x0) {
    free(local_210);
  }
LAB_0040dcaf:
  ExceptionList = local_c;
  ___security_check_cookie_4(local_10 ^ (uint)auStack_228);
  return;
}



int __thiscall FUN_0040dce0(void *this,undefined1 *param_1)

{
  int iVar1;
  byte bVar2;
  bool bVar3;
  char cVar4;
  undefined1 *puVar5;
  void *pvVar6;
  undefined *puVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  char *in_stack_ffffff80;
  undefined4 uVar14;
  undefined *puVar15;
  char *in_stack_ffffff8c;
  int local_50;
  int local_4c;
  undefined **local_48;
  FILE *local_44;
  undefined **local_40;
  undefined *local_3c;
  undefined4 local_38;
  void *local_34;
  int iStack_30;
  undefined4 *local_2c;
  undefined **local_28;
  int local_24;
  undefined4 local_20;
  int local_1c;
  int iStack_18;
  undefined4 local_14;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a668;
  local_c = ExceptionList;
  bVar2 = (byte)DAT_0044a01c ^ (byte)&stack0xffffff9c;
  ExceptionList = &local_c;
  iVar10 = 0;
  local_40 = CDib::vftable;
  local_34 = (void *)0x0;
  local_3c = (undefined *)0x0;
  local_38 = 0;
  local_2c = (undefined4 *)0x0;
  local_28 = CDib::vftable;
  local_1c = 0;
  local_24 = 0;
  local_20 = 0;
  local_14 = 0;
  local_48 = aDiskFile::vftable;
  local_44 = (FILE *)0x0;
  local_4._0_1_ = 3;
  local_4._1_3_ = 0;
  puVar15 = &DAT_0043b40c;
  uVar14 = 0x40dd64;
  FUN_0041aa80(this,(char *)0x7fffffff,"rb");
  local_4._0_1_ = 4;
  puVar5 = &DAT_0044d0d5;
  if (param_1 != (undefined1 *)0x0) {
    puVar5 = param_1;
  }
  FUN_0041aa80(puVar5,(char *)0x7fffffff,puVar5);
  local_4 = CONCAT31(local_4._1_3_,3);
  bVar3 = FUN_0041a810(&local_48,in_stack_ffffff80,uVar14,puVar15,in_stack_ffffff8c);
  if (bVar3) {
    cVar4 = FUN_0040e8f0((int)&local_40);
    if (cVar4 == '\0') {
      fclose(local_44);
      local_44 = (FILE *)0x0;
      puVar5 = &DAT_0044d0d5;
      if (param_1 != (undefined1 *)0x0) {
        puVar5 = param_1;
      }
      FUN_0041a1f0("Error reading file \"%s\"",(char)puVar5);
      local_48 = aDiskFile::vftable;
      if (local_44 != (FILE *)0x0) {
        fclose(local_44);
      }
      local_44 = (FILE *)0x0;
    }
    else {
      fclose(local_44);
      local_44 = (FILE *)0x0;
      if (*(short *)((int)local_34 + 0xe) == 8) {
        FUN_0040e6a0((int)&local_40,(int)&local_28);
LAB_0040df58:
        pvVar6 = operator_new(0x44);
        if (pvVar6 == (void *)0x0) {
          iVar10 = 0;
        }
        else {
          iVar10 = FUN_004053e0();
        }
        FUN_0040ea20(0x400,8);
        iVar8 = *(int *)(local_1c + 8);
        iVar12 = *(int *)(*(int *)(iVar10 + 0xc) + 8);
        if (iVar12 < iVar8) {
          iVar11 = *(int *)(*(int *)(iVar10 + 0xc) + 8);
          iVar9 = 0;
          local_4c = (iVar8 - iVar11) / 2;
          iVar8 = iVar11;
        }
        else {
          iVar9 = (iVar12 - iVar8) / 2;
          local_4c = 0;
        }
        local_50 = *(int *)(local_1c + 4);
        iVar11 = *(int *)(*(int *)(iVar10 + 0xc) + 4);
        if (iVar11 < local_50) {
          iVar1 = *(int *)(*(int *)(iVar10 + 0xc) + 4);
          iVar13 = 0;
          iVar11 = (local_50 - iVar1) / 2;
          local_50 = iVar1;
        }
        else {
          iVar13 = (iVar11 - local_50) / 2;
          iVar11 = 0;
        }
        memset(*(void **)(iVar10 + 4),0,iVar12 * *(int *)(iVar10 + 0x10));
        FUN_0040e820(&local_28,iVar10,iVar13,iVar9,iVar11,local_4c,local_50,iVar8);
        local_48 = aDiskFile::vftable;
        if (local_44 != (FILE *)0x0) {
          fclose(local_44);
        }
        local_44 = (FILE *)0x0;
        local_4._0_1_ = 1;
        FUN_0040e650(&local_28);
        local_4 = (uint)local_4._1_3_ << 8;
        FUN_0040e650(&local_40);
        local_4 = 0xffffffff;
        if (param_1 == (undefined1 *)0x0) {
          ExceptionList = local_c;
          return iVar10;
        }
        free(param_1);
        ExceptionList = local_c;
        return iVar10;
      }
      if (*(short *)((int)local_34 + 0xe) == 0x18) {
        FUN_0040ea20(*(int *)((int)local_34 + 4),8);
        if (0 < *(int *)((int)local_34 + 8)) {
          iVar8 = *(int *)((int)local_34 + 4);
          puVar15 = local_3c;
          iVar12 = local_24;
          do {
            iVar9 = 0;
            puVar7 = puVar15;
            if (0 < iVar8) {
              do {
                *(undefined *)(iVar9 + iVar12) = *puVar7;
                iVar8 = *(int *)((int)local_34 + 4);
                iVar9 = iVar9 + 1;
                puVar7 = puVar7 + 3;
              } while (iVar9 < iVar8);
            }
            puVar15 = puVar15 + iStack_30;
            iVar12 = iVar12 + iStack_18;
            iVar10 = iVar10 + 1;
          } while (iVar10 < *(int *)((int)local_34 + 8));
        }
        goto LAB_0040df58;
      }
      FUN_0041a1f0("Invalid image format. Image Depth must be 8 or 24 bits per pixel",bVar2);
      FUN_0041a7e0(&local_48);
    }
    local_4._0_1_ = 1;
    FUN_0040e650(&local_28);
    local_4 = (uint)local_4._1_3_ << 8;
    FUN_0040e650(&local_40);
  }
  else {
    puVar5 = &DAT_0044d0d5;
    if (param_1 != (undefined1 *)0x0) {
      puVar5 = param_1;
    }
    FUN_0041a1f0("Error reading file \"%s\"",(char)puVar5);
    local_48 = aDiskFile::vftable;
    if (local_44 != (FILE *)0x0) {
      fclose(local_44);
    }
    local_4 = local_4 & 0xffffff00;
    local_44 = (FILE *)0x0;
    local_40 = CDib::vftable;
    if (local_34 != (void *)0x0) {
      operator_delete__(local_34);
    }
    local_34 = (void *)0x0;
    local_3c = (undefined *)0x0;
    local_38 = 0;
    if (local_2c != (undefined4 *)0x0) {
      FUN_0040f1e0();
      if (local_2c != (undefined4 *)0x0) {
        (**(code **)*local_2c)();
      }
      local_2c = (undefined4 *)0x0;
    }
  }
  local_4 = 0xffffffff;
  if (param_1 != (undefined1 *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return 0;
}



void __thiscall FUN_0040e0b0(void *this,double *param_1)

{
  char cVar1;
  double dVar2;
  char *pcVar3;
  char *pcVar4;
  size_t sVar5;
  int iVar6;
  size_t _Count;
  undefined auStack_58 [4];
  int local_54;
  double local_50;
  double *local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)auStack_58;
  local_48 = param_1;
                    // WARNING: Load size is inaccurate
  cVar1 = *this;
  _Count = 0;
  iVar6 = 0;
  sVar5 = 0;
  do {
    if (cVar1 == '\0') {
      local_24 = 0;
      local_20 = 0;
      local_1c = 0;
      local_18 = 0;
      local_14 = 0;
      local_10 = 0;
      local_c = 0;
      local_8 = 0;
      local_44 = 0;
      local_40 = 0;
      local_3c = 0;
      local_38 = 0;
      local_34 = 0;
      local_30 = 0;
      local_2c = 0;
      local_28 = 0;
      pcVar3 = (char *)this;
      do {
        cVar1 = *pcVar3;
        pcVar3 = pcVar3 + 1;
      } while (cVar1 != '\0');
      pcVar3 = pcVar3 + (-_Count - ((int)this + 1)) + -1;
      strncpy((char *)&local_24,(char *)this,_Count);
      strncpy((char *)&local_44,(char *)((int)this + _Count + 1),(size_t)pcVar3);
      pcVar4 = pcVar3;
      if ((int)pcVar3 < 0) {
        pcVar4 = (char *)-(int)pcVar3;
      }
      dVar2 = 10.0;
      local_50 = 1.0;
      while( true ) {
        if (((uint)pcVar4 & 1) != 0) {
          local_50 = local_50 * dVar2;
        }
        pcVar4 = (char *)((uint)pcVar4 >> 1);
        if (pcVar4 == (char *)0x0) break;
        dVar2 = dVar2 * dVar2;
      }
      if ((int)pcVar3 < 0) {
        local_50 = 1.0 / local_50;
      }
      local_54 = atoi((char *)&local_44);
      local_50 = (double)local_54 / local_50;
      local_54 = atoi((char *)&local_24);
      *local_48 = (double)local_54 + local_50;
      ___security_check_cookie_4(local_4 ^ (uint)auStack_58);
      return;
    }
    if ((cVar1 < ':') && ('/' < cVar1)) {
      if (cVar1 == '.') goto LAB_0040e0ff;
    }
    else {
      if (cVar1 != '.') goto LAB_0040e0e4;
LAB_0040e0ff:
      iVar6 = iVar6 + 1;
      _Count = sVar5;
      if (1 < iVar6) {
LAB_0040e0e4:
        ___security_check_cookie_4(local_4 ^ (uint)auStack_58);
        return;
      }
    }
    cVar1 = *(char *)((int)this + sVar5 + 1);
    sVar5 = sVar5 + 1;
  } while( true );
}



void __fastcall FUN_0040e220(int param_1)

{
  undefined4 *in_EAX;
  
  *in_EAX = *(undefined4 *)(param_1 + 4);
  return;
}



void __fastcall FUN_0040e230(int param_1)

{
  undefined4 *in_EAX;
  
  *in_EAX = *(undefined4 *)(param_1 + 8);
  return;
}



void FUN_0040e240(void)

{
  int iVar1;
  void *pvVar2;
  undefined4 *puVar3;
  int *in_EAX;
  DWORD DVar4;
  int *piVar5;
  int **ppiVar6;
  
  DVar4 = GetCurrentThreadId();
  if (in_EAX[4] == DVar4) {
    in_EAX[5] = in_EAX[5] + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(in_EAX + 6));
    in_EAX[5] = 1;
    DVar4 = GetCurrentThreadId();
    in_EAX[4] = DVar4;
  }
  iVar1 = *in_EAX;
  while (0 < iVar1) {
    piVar5 = (int *)FUN_0040e220((int)in_EAX);
    pvVar2 = *(void **)(*piVar5 + 8);
    ppiVar6 = (int **)FUN_0040e220((int)in_EAX);
    piVar5 = *ppiVar6;
    if (1 < *in_EAX) {
      if (piVar5 == (int *)in_EAX[1]) {
        iVar1 = *(int *)in_EAX[1];
        in_EAX[1] = iVar1;
        *(undefined4 *)(iVar1 + 4) = 0;
      }
      else if (piVar5 == (int *)in_EAX[2]) {
        puVar3 = (undefined4 *)((int *)in_EAX[2])[1];
        in_EAX[2] = (int)puVar3;
        *puVar3 = 0;
      }
      else {
        *(int *)piVar5[1] = *piVar5;
        *(int *)(*piVar5 + 4) = piVar5[1];
      }
    }
    operator_delete(piVar5);
    *in_EAX = *in_EAX + -1;
    if (*in_EAX == 0) {
      in_EAX[2] = 0;
      in_EAX[1] = 0;
    }
    operator_delete(pvVar2);
    iVar1 = *in_EAX;
  }
  DVar4 = GetCurrentThreadId();
  if (in_EAX[4] == DVar4) {
    piVar5 = in_EAX + 5;
    *piVar5 = *piVar5 + -1;
    if (*piVar5 == 0) {
      in_EAX[4] = -1;
      LeaveCriticalSection((LPCRITICAL_SECTION)(in_EAX + 6));
    }
  }
  return;
}



void FUN_0040e320(undefined4 *param_1,undefined4 *param_2,undefined4 *param_3,undefined4 *param_4)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  undefined4 *in_EAX;
  DWORD DVar4;
  int *unaff_EDI;
  ulonglong uVar5;
  
  DVar4 = GetCurrentThreadId();
  if (in_EAX[4] == DVar4) {
    in_EAX[5] = in_EAX[5] + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(in_EAX + 6));
    in_EAX[5] = 1;
    DVar4 = GetCurrentThreadId();
    in_EAX[4] = DVar4;
  }
  *param_1 = *in_EAX;
  *unaff_EDI = in_EAX[0xd];
  *param_2 = in_EAX[0xe];
  *param_3 = in_EAX[0xf];
  iVar2 = *unaff_EDI;
  if (0 < iVar2) {
    iVar3 = in_EAX[0x10];
    if ((0 < iVar3) && (iVar2 < iVar3)) {
      if ((float)iVar3 / (float)iVar2 <= 0.0) {
        uVar5 = FUN_00437bc0(iVar3,param_2);
        *param_4 = (int)uVar5;
      }
      else {
        uVar5 = FUN_00437bc0(iVar3,param_2);
        *param_4 = (int)uVar5;
      }
      goto LAB_0040e3ce;
    }
  }
  *param_4 = 0;
LAB_0040e3ce:
  DVar4 = GetCurrentThreadId();
  if (in_EAX[4] == DVar4) {
    piVar1 = in_EAX + 5;
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      in_EAX[4] = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(in_EAX + 6));
    }
  }
  return;
}



void __fastcall FUN_0040e3f0(int *param_1,int *param_2)

{
  void *pvVar1;
  uint uVar2;
  DWORD DVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  int iVar6;
  undefined4 *puVar7;
  int *piVar8;
  int **ppiVar9;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  ulonglong uVar10;
  void *pvStack_1c;
  undefined auStack_18 [8];
  void *pvStack_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_004383a8;
  local_c = ExceptionList;
  uVar2 = DAT_0044a01c ^ (uint)&stack0xffffffd0;
  ExceptionList = &local_c;
  DVar3 = GetCurrentThreadId();
  if (param_2[4] == DVar3) {
    param_2[5] = param_2[5] + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_2 + 6));
    param_2[5] = 1;
    DVar3 = GetCurrentThreadId();
    param_2[4] = DVar3;
  }
  local_4 = 0;
  puVar4 = (undefined4 *)operator_new(0x14);
  uVar5 = (**(code **)(*param_1 + 0x78))(uVar2);
  *puVar4 = uVar5;
  iVar6 = (**(code **)(*param_1 + 0x14))(auStack_18);
  puVar4[1] = (uint)(*(int *)(iVar6 + 4) != 0);
  if (pvStack_1c != (void *)0x0) {
    free(pvStack_1c);
  }
  if ((int)puVar4[1] < 1) {
    puVar4[2] = 0;
    puVar4[3] = 0;
    puVar4[4] = 0;
  }
  else {
    uVar2 = (**(code **)(*param_1 + 0x24))();
    puVar4[2] = uVar2 & 0xff;
    uVar5 = (**(code **)(*param_1 + 0x60))();
    puVar4[3] = uVar5;
    (**(code **)(*param_1 + 0x4c))();
    uVar10 = FUN_00437bc0(extraout_ECX,extraout_EDX);
    puVar4[4] = (int)uVar10;
  }
  param_2[0xd] = param_2[0xd] + puVar4[1];
  param_2[0xe] = param_2[0xe] + puVar4[2];
  param_2[0xf] = param_2[0xf] + puVar4[3];
  param_2[0x10] = param_2[0x10] + puVar4[4];
  iVar6 = param_2[2];
  puVar7 = (undefined4 *)operator_new(0xc);
  puVar7[1] = iVar6;
  *puVar7 = 0;
  puVar7[2] = puVar4;
  if ((undefined4 *)param_2[2] == (undefined4 *)0x0) {
    param_2[1] = (int)puVar7;
  }
  else {
    *(undefined4 *)param_2[2] = puVar7;
  }
  *param_2 = *param_2 + 1;
  param_2[2] = (int)puVar7;
  if (param_2[0xc] < *param_2) {
    piVar8 = (int *)FUN_0040e220((int)param_2);
    pvVar1 = *(void **)(*piVar8 + 8);
    param_2[0xd] = param_2[0xd] - *(int *)((int)pvVar1 + 4);
    param_2[0xe] = param_2[0xe] - *(int *)((int)pvVar1 + 8);
    param_2[0xf] = param_2[0xf] - *(int *)((int)pvVar1 + 0xc);
    param_2[0x10] = param_2[0x10] - *(int *)((int)pvVar1 + 0x10);
    ppiVar9 = (int **)FUN_0040e220((int)param_2);
    FUN_004060d0(*ppiVar9);
    operator_delete(pvVar1);
  }
  DVar3 = GetCurrentThreadId();
  if (param_2[4] == DVar3) {
    piVar8 = param_2 + 5;
    *piVar8 = *piVar8 + -1;
    if (*piVar8 == 0) {
      param_2[4] = -1;
      LeaveCriticalSection((LPCRITICAL_SECTION)(param_2 + 6));
    }
  }
  ExceptionList = pvStack_10;
  return;
}



int __cdecl FUN_0040e5a0(char *param_1)

{
  char *pcVar1;
  char cVar2;
  char *pcVar3;
  int iVar4;
  
  iVar4 = 0;
  pcVar3 = &DAT_0044d0d5;
  if (param_1 != (char *)0x0) {
    pcVar3 = param_1;
  }
  cVar2 = *pcVar3;
  while (cVar2 != '\0') {
    iVar4 = iVar4 * 0x21 + (int)cVar2;
    pcVar1 = pcVar3 + 1;
    pcVar3 = pcVar3 + 1;
    cVar2 = *pcVar1;
  }
  if (param_1 != (char *)0x0) {
    free(param_1);
  }
  return iVar4;
}



undefined4 * __thiscall FUN_0040e5f0(void *this,byte param_1)

{
  *(undefined ***)this = CDib::vftable;
  if (*(void **)((int)this + 0xc) != (void *)0x0) {
    operator_delete__(*(void **)((int)this + 0xc));
  }
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined4 *)((int)this + 4) = 0;
  *(undefined4 *)((int)this + 8) = 0;
  if (*(int *)((int)this + 0x14) != 0) {
    FUN_0040f1e0();
    if (*(undefined4 **)((int)this + 0x14) != (undefined4 *)0x0) {
      (**(code **)**(undefined4 **)((int)this + 0x14))(1);
    }
    *(undefined4 *)((int)this + 0x14) = 0;
  }
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_0040e650(undefined4 *param_1)

{
  *param_1 = CDib::vftable;
  if ((void *)param_1[3] != (void *)0x0) {
    operator_delete__((void *)param_1[3]);
  }
  param_1[3] = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  if (param_1[5] != 0) {
    FUN_0040f1e0();
    if ((undefined4 *)param_1[5] != (undefined4 *)0x0) {
      (***(code ***)(undefined4 *)param_1[5])(1);
    }
    param_1[5] = 0;
  }
  return;
}



void __fastcall FUN_0040e6a0(int param_1,int param_2)

{
  int iVar1;
  undefined4 *puVar2;
  uint uVar3;
  int **ppiVar4;
  void *in_stack_ffffffb4;
  size_t in_stack_ffffffb8;
  undefined4 uVar5;
  void *_Dst;
  void *pvVar6;
  int *local_14;
  int **local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438c48;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  if (*(void **)(param_2 + 0xc) != (void *)0x0) {
    operator_delete__(*(void **)(param_2 + 0xc));
  }
  *(undefined4 *)(param_2 + 0xc) = 0;
  *(undefined4 *)(param_2 + 4) = 0;
  *(undefined4 *)(param_2 + 8) = 0;
  if (*(int *)(param_2 + 0x14) != 0) {
    FUN_0040f1e0();
    if (*(undefined4 **)(param_2 + 0x14) != (undefined4 *)0x0) {
      (**(code **)**(undefined4 **)(param_2 + 0x14))();
    }
    *(undefined4 *)(param_2 + 0x14) = 0;
  }
  FUN_0040ea20(*(int *)(*(int *)(param_1 + 0xc) + 4),
               (uint)*(ushort *)(*(int *)(param_1 + 0xc) + 0xe));
  _Dst = *(void **)(param_2 + 4);
  memcpy(_Dst,*(void **)(param_1 + 4),
         *(int *)(param_2 + 0x10) * *(int *)(*(int *)(param_2 + 0xc) + 8));
  if (*(int *)(param_1 + 0x14) != 0) {
    pvVar6 = (void *)0x40e746;
    puVar2 = (undefined4 *)operator_new(0x1c);
    if (puVar2 == (undefined4 *)0x0) {
      puVar2 = (undefined4 *)0x0;
    }
    else {
      *puVar2 = aMap<class_aString,class_aString>::vftable;
      puVar2[1] = 0;
      puVar2[2] = 0x11;
      puVar2[3] = 0;
      puVar2[4] = 0;
      puVar2[5] = 0;
      puVar2[6] = 10;
    }
    *(undefined4 **)(param_2 + 0x14) = puVar2;
    iVar1 = *(int *)(param_1 + 0x14);
    local_10 = (int **)(iVar1 + 4);
    local_14 = (int *)0x0;
    if (*(int *)(iVar1 + 0xc) != 0) {
      uVar3 = 0;
      if (*(uint *)(iVar1 + 8) != 0) {
        ppiVar4 = (int **)*local_10;
        do {
          local_14 = *ppiVar4;
          if (local_14 != (int *)0x0) break;
          uVar3 = uVar3 + 1;
          ppiVar4 = ppiVar4 + 1;
        } while (uVar3 < *(uint *)(iVar1 + 8));
      }
    }
    while ((local_10 != (int **)0x0 && (local_14 != (int *)0x0))) {
      uVar5 = 0x40e7ce;
      FUN_0040ef80((int *)&local_14);
      local_4 = 0;
      FUN_0040efd0((int *)&local_14);
      local_4 = 0xffffffff;
      FUN_0040ee80(*(int *)(param_2 + 0x14),in_stack_ffffffb4,in_stack_ffffffb8,uVar5,_Dst,pvVar6);
      pvVar6 = (void *)0x40e7fb;
      FUN_0040f020(&local_14);
    }
  }
  ExceptionList = local_c;
  return;
}



uint __thiscall
FUN_0040e820(void *this,int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,
            int param_7)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  uint in_EAX;
  int iVar4;
  void *pvVar5;
  uint uVar6;
  void *_Dst;
  void *_Src;
  
  iVar3 = param_1;
  if (this == (void *)0x0) {
    return in_EAX & 0xffffff00;
  }
  uVar1 = *(ushort *)(*(int *)(param_1 + 0xc) + 0xe);
  iVar2 = *(int *)((int)this + 0x10);
  uVar6 = (uint)*(ushort *)(*(int *)((int)this + 0xc) + 0xe);
  if (uVar1 == uVar6) {
    iVar4 = (uint)uVar1 * param_2;
    _Dst = (void *)(((*(int *)(*(int *)(param_1 + 0xc) + 8) - param_3) + -1) *
                    *(int *)(param_1 + 0x10) + ((int)(iVar4 + (iVar4 >> 0x1f & 7U)) >> 3) +
                   *(int *)(param_1 + 4));
    pvVar5 = (void *)((int)(uVar6 * param_4 + ((int)(uVar6 * param_4) >> 0x1f & 7U)) >> 3);
    _Src = (void *)((int)pvVar5 +
                   *(int *)((int)this + 4) +
                   ((*(int *)(*(int *)((int)this + 0xc) + 8) + -1) * iVar2 - iVar2 * param_5));
    if (0 < param_7) {
      param_1 = param_7;
      do {
        pvVar5 = memcpy(_Dst,_Src,((int)uVar6 >> 3) * param_6);
        _Dst = (void *)((int)_Dst - *(int *)(iVar3 + 0x10));
        _Src = (void *)((int)_Src - iVar2);
        param_1 = param_1 + -1;
      } while (param_1 != 0);
    }
    return CONCAT31((int3)((uint)pvVar5 >> 8),1);
  }
  return (uint)(byte)(uVar1 >> 8) << 8;
}



void __fastcall FUN_0040e8f0(int param_1)

{
  int *unaff_ESI;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined *puStack_20;
  uint uStack_1c;
  undefined local_10 [12];
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)local_10;
  if (*(void **)(param_1 + 0xc) != (void *)0x0) {
    uStack_1c = 0x40e90e;
    operator_delete__(*(void **)(param_1 + 0xc));
  }
  *(undefined4 *)(param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  uStack_1c = 10;
  puStack_20 = local_10;
  uStack_24 = 0x40e937;
  (**(code **)*unaff_ESI)();
  uStack_24 = 0;
  uStack_28 = 0;
  (**(code **)(*unaff_ESI + 8))(0);
  if ((char)uStack_28 == 'B') {
    if (uStack_28._1_1_ == 'M') {
      FUN_0040ed00(unaff_ESI);
      ___security_check_cookie_4(uStack_1c ^ (uint)&uStack_28);
      return;
    }
  }
  else if (((char)uStack_28 == -1) && (uStack_28._1_1_ == -0x28)) {
    FUN_0040ec30();
    ___security_check_cookie_4(uStack_1c ^ (uint)&uStack_28);
    return;
  }
  ___security_check_cookie_4(uStack_1c ^ (uint)&uStack_28);
  return;
}



void __fastcall FUN_0040e9b0(undefined4 param_1,void *param_2,int param_3)

{
  int iVar1;
  int unaff_EBX;
  int iVar2;
  void *_Dst;
  size_t local_4;
  
  iVar1 = *(int *)(unaff_EBX + 0xc);
  local_4 = *(size_t *)(iVar1 + 4);
  iVar2 = *(int *)(iVar1 + 8);
  if (*(short *)(iVar1 + 0xe) == 0x18) {
    local_4 = local_4 * 3;
  }
  _Dst = *(void **)(unaff_EBX + 4);
  memset(_Dst,0,*(int *)(unaff_EBX + 0x10) * iVar2);
  if (0 < iVar2) {
    do {
      memcpy(_Dst,param_2,local_4);
      _Dst = (void *)((int)_Dst + *(int *)(unaff_EBX + 0x10));
      param_2 = (void *)((int)param_2 + param_3);
      iVar2 = iVar2 + -1;
    } while (iVar2 != 0);
  }
  return;
}



void FUN_0040ea20(int param_1,int param_2)

{
  uint uVar1;
  void *pvVar2;
  undefined uVar3;
  uint uVar4;
  int iVar5;
  int unaff_ESI;
  int unaff_EDI;
  
  if (*(void **)(unaff_ESI + 0xc) != (void *)0x0) {
    operator_delete__(*(void **)(unaff_ESI + 0xc));
  }
  uVar1 = (int)(param_1 * param_2 + (param_1 * param_2 >> 0x1f & 7U)) >> 3;
  uVar4 = uVar1 & 0x80000003;
  *(undefined4 *)(unaff_ESI + 0xc) = 0;
  *(undefined4 *)(unaff_ESI + 4) = 0;
  *(undefined4 *)(unaff_ESI + 8) = 0;
  if ((int)uVar4 < 0) {
    uVar4 = (uVar4 - 1 | 0xfffffffc) + 1;
  }
  if (uVar4 != 0) {
    uVar1 = (uVar1 - uVar4) + 4;
  }
  *(uint *)(unaff_ESI + 0x10) = uVar1;
  if (param_2 == 8) {
    pvVar2 = operator_new(uVar1 * unaff_EDI + 0x428);
    *(int *)(unaff_ESI + 8) = (int)pvVar2 + 0x28;
    *(void **)(unaff_ESI + 0xc) = pvVar2;
    iVar5 = 0;
    do {
      uVar3 = (undefined)iVar5;
      *(undefined *)(*(int *)(unaff_ESI + 8) + 2 + iVar5 * 4) = uVar3;
      *(undefined *)(*(int *)(unaff_ESI + 8) + 1 + iVar5 * 4) = uVar3;
      *(undefined *)(*(int *)(unaff_ESI + 8) + iVar5 * 4) = uVar3;
      *(undefined *)(*(int *)(unaff_ESI + 8) + 3 + iVar5 * 4) = 0;
      iVar5 = iVar5 + 1;
    } while (iVar5 < 0x100);
    iVar5 = (int)pvVar2 + 0x428;
  }
  else {
    pvVar2 = operator_new(uVar1 * unaff_EDI + 0x28);
    *(void **)(unaff_ESI + 0xc) = pvVar2;
    *(undefined4 *)(unaff_ESI + 8) = 0;
    iVar5 = (int)pvVar2 + 0x28;
  }
  *(int *)(unaff_ESI + 4) = iVar5;
  *(int *)(*(int *)(unaff_ESI + 0xc) + 8) = unaff_EDI;
  *(int *)(*(int *)(unaff_ESI + 0xc) + 4) = param_1;
  *(int *)(*(int *)(unaff_ESI + 0xc) + 0x14) = *(int *)(unaff_ESI + 0x10) * unaff_EDI;
  *(undefined2 *)(*(int *)(unaff_ESI + 0xc) + 0xc) = 1;
  *(short *)(*(int *)(unaff_ESI + 0xc) + 0xe) = (short)param_2;
  *(undefined4 *)(*(int *)(unaff_ESI + 0xc) + 0x10) = 0;
  *(undefined4 *)(*(int *)(unaff_ESI + 0xc) + 0x18) = 0;
  *(undefined4 *)(*(int *)(unaff_ESI + 0xc) + 0x1c) = 0;
  *(undefined4 *)(*(int *)(unaff_ESI + 0xc) + 0x24) = 0;
  **(undefined4 **)(unaff_ESI + 0xc) = 0x28;
  *(undefined4 *)(*(int *)(unaff_ESI + 0xc) + 0x20) = 0;
  return;
}



void __thiscall FUN_0040eb30(void *this,int param_1,char *param_2,void *param_3,void *param_4)

{
  undefined4 *puVar1;
  void *extraout_ECX;
  void *in_stack_ffffffc4;
  void *in_stack_ffffffc8;
  void *in_stack_ffffffcc;
  void *pvVar2;
  void *pvVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438c20;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  if (*(int *)(param_1 + 0x14) == 0) {
    puVar1 = (undefined4 *)operator_new(0x1c);
    if (puVar1 == (undefined4 *)0x0) {
      puVar1 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = aMap<class_aString,class_aString>::vftable;
      puVar1[1] = 0;
      puVar1[2] = 0x11;
      puVar1[3] = 0;
      puVar1[4] = 0;
      puVar1[5] = 0;
      puVar1[6] = 10;
    }
    *(undefined4 **)(param_1 + 0x14) = puVar1;
    this = extraout_ECX;
  }
  pvVar2 = (void *)0x0;
  pvVar3 = (void *)0x0;
  if (param_3 != (void *)0x0) {
    in_stack_ffffffc4 = (void *)0x0;
    FUN_0041b310();
    in_stack_ffffffc8 = param_3;
    in_stack_ffffffcc = param_4;
    this = in_stack_ffffffc4;
    memcpy(in_stack_ffffffc4,param_3,(size_t)param_4);
    *(undefined *)((int)param_4 + (int)this) = 0;
    pvVar2 = this;
    pvVar3 = param_4;
  }
  local_4._0_1_ = 1;
  FUN_0041aa80(this,(char *)0x7fffffff,param_2);
  local_4 = (uint)local_4._1_3_ << 8;
  FUN_0040ee80(*(int *)(param_1 + 0x14),in_stack_ffffffc4,(size_t)in_stack_ffffffc8,
               in_stack_ffffffcc,pvVar2,pvVar3);
  local_4 = 0xffffffff;
  if (param_3 != (void *)0x0) {
    free(param_3);
  }
  ExceptionList = local_c;
  return;
}



undefined __fastcall FUN_0040ec30(int param_1)

{
  char cVar1;
  int *in_EAX;
  uint uVar2;
  void *pvVar3;
  undefined4 extraout_ECX;
  void *pvStack_38;
  uint uVar4;
  int iStack_30;
  uint uStack_2c;
  uint uStack_28;
  
  uStack_28 = 2;
  uStack_2c = 0;
  iStack_30 = 0;
  (**(code **)(*in_EAX + 8))();
  uVar2 = (**(code **)(*in_EAX + 0xc))();
  pvStack_38 = (void *)0x40ec5b;
  pvVar3 = operator_new(uVar2);
  uVar4 = 0;
  pvStack_38 = (void *)0x0;
  (**(code **)(*in_EAX + 8))(0);
  (**(code **)*in_EAX)(pvVar3,uVar2,1);
  cVar1 = FUN_0040fcc0(pvVar3,uVar2,&uStack_28,(uint *)&stack0xffffffcc,&iStack_30,&uStack_2c,
                       &pvStack_38,(int *)(param_1 + 0x14));
  if (cVar1 == '\0') {
    return 0;
  }
  *(uint *)(param_1 + 0x10) = uVar4;
  FUN_0040ea20(uStack_2c,iStack_30);
  FUN_0040e9b0(extraout_ECX,pvStack_38,*(int *)(param_1 + 0x10));
  operator_delete__(pvVar3);
  operator_delete__(pvStack_38);
  return 1;
}



undefined4 FUN_0040ed00(undefined4 *param_1)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  int unaff_EBX;
  undefined4 *puVar4;
  undefined4 *puVar5;
  int iStack_3c;
  uint local_38;
  undefined auStack_34 [2];
  ushort uStack_32;
  uint uStack_2c;
  undefined4 *puStack_14;
  
  (**(code **)*param_1)(&local_38,0xe,1);
  (**(code **)*param_1)(auStack_34,0x28,1);
  *(uint *)(unaff_EBX + 0x10) = uStack_2c / local_38;
  if (uStack_2c / local_38 == 0) {
    uStack_2c = (uint)(uStack_32 >> 3) * iStack_3c;
    uVar3 = uStack_2c & 0x80000003;
    if ((int)uVar3 < 0) {
      uVar3 = (uVar3 - 1 | 0xfffffffc) + 1;
    }
    if (uVar3 != 0) {
      uStack_2c = (uStack_2c - uVar3) + 4;
    }
    *(uint *)(unaff_EBX + 0x10) = uStack_2c;
    uStack_2c = uStack_2c * local_38;
  }
  puVar1 = (undefined4 *)
           operator_new(*(int *)(unaff_EBX + 0x10) * local_38 + 0x28 +
                        ((uStack_32 != 8) - 1 & 0x400));
  *(undefined4 **)(unaff_EBX + 0xc) = puVar1;
  puVar4 = (undefined4 *)&stack0xffffffc0;
  puVar5 = puVar1;
  for (iVar2 = 10; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar5 = *puVar4;
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 1;
  }
  (**(code **)*puStack_14)
            (puVar1 + 10,
             *(int *)(unaff_EBX + 0x10) * local_38 +
             ((*(short *)(*(int *)(unaff_EBX + 0xc) + 0xe) != 8) - 1 & 0x400),1);
  iVar2 = *(int *)(unaff_EBX + 0xc);
  *(uint *)(unaff_EBX + 4) = ((*(short *)(iVar2 + 0xe) != 8) - 1 & 0x400) + 0x28 + (int)puVar1;
  *(uint *)(unaff_EBX + 8) = (*(short *)(iVar2 + 0xe) != 8) - 1 & (uint)(puVar1 + 10);
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}



undefined4 FUN_0040ee20(int param_1)

{
  int iVar1;
  void *pvVar2;
  int in_EAX;
  undefined4 uVar3;
  int *unaff_ESI;
  void *local_4;
  
  iVar1 = *(int *)(in_EAX + 0xc);
  local_4 = (void *)0x0;
  FUN_0040f780(*(undefined4 *)(in_EAX + 0x10),&local_4,*(int *)(in_EAX + 4),*(int *)(iVar1 + 4),
               *(uint *)(iVar1 + 8),(uint)*(ushort *)(iVar1 + 0xe),param_1,&param_1,
               *(uint *)(in_EAX + 0x14));
  pvVar2 = local_4;
  uVar3 = (**(code **)(*unaff_ESI + 4))(local_4,param_1,1);
  operator_delete__(pvVar2);
  return CONCAT31((int3)((uint)uVar3 >> 8),1);
}



void FUN_0040ee80(int param_1,void *param_2,size_t param_3,undefined4 param_4,void *param_5,
                 void *param_6)

{
  void *_Dst;
  size_t sVar1;
  undefined4 uVar2;
  void *_Dst_00;
  void *pvVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438be8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 1;
  _Dst_00 = (void *)0x0;
  pvVar3 = (void *)0x0;
  if (param_5 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst_00,param_5,(size_t)param_6);
    *(undefined *)((int)param_6 + (int)_Dst_00) = 0;
    pvVar3 = param_6;
  }
  local_4._0_1_ = 2;
  _Dst = (void *)0x0;
  uVar2 = 0;
  sVar1 = 0;
  if (param_2 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_2,param_3);
    *(undefined *)(param_3 + (int)_Dst) = 0;
    sVar1 = param_3;
  }
  local_4._0_1_ = 1;
  FUN_0040f100((int *)(param_1 + 4),_Dst,sVar1,uVar2,_Dst_00,pvVar3);
  local_4 = (uint)local_4._1_3_ << 8;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  local_4 = 0xffffffff;
  if (param_5 != (void *)0x0) {
    free(param_5);
  }
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0040ef80(int *param_1)

{
  int iVar1;
  void *pvVar2;
  void *pvVar3;
  void **in_EAX;
  
  iVar1 = *param_1;
  pvVar2 = *(void **)(iVar1 + 0x14);
  *in_EAX = (void *)0x0;
  in_EAX[2] = (void *)0x0;
  in_EAX[1] = (void *)0x0;
  if (pvVar2 != (void *)0x0) {
    FUN_0041b310();
    pvVar2 = *in_EAX;
    memcpy(pvVar2,*(void **)(iVar1 + 0x14),*(size_t *)(iVar1 + 0x18));
    pvVar3 = *(void **)(iVar1 + 0x18);
    *(undefined *)((int)pvVar3 + (int)pvVar2) = 0;
    in_EAX[1] = pvVar3;
  }
  return;
}



void __fastcall FUN_0040efd0(int *param_1)

{
  int iVar1;
  void *pvVar2;
  void *pvVar3;
  void **in_EAX;
  
  iVar1 = *param_1;
  pvVar2 = *(void **)(iVar1 + 8);
  *in_EAX = (void *)0x0;
  in_EAX[2] = (void *)0x0;
  in_EAX[1] = (void *)0x0;
  if (pvVar2 != (void *)0x0) {
    FUN_0041b310();
    pvVar2 = *in_EAX;
    memcpy(pvVar2,*(void **)(iVar1 + 8),*(size_t *)(iVar1 + 0xc));
    pvVar3 = *(void **)(iVar1 + 0xc);
    *(undefined *)((int)pvVar3 + (int)pvVar2) = 0;
    in_EAX[1] = pvVar3;
  }
  return;
}



void FUN_0040f020(int **param_1)

{
  void *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  void *local_18;
  undefined4 local_14;
  undefined4 local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438bb0;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_18 = (void *)0x0;
  local_10 = 0;
  local_14 = 0;
  local_24 = (void *)0x0;
  local_1c = 0;
  local_20 = 0;
  local_4._0_1_ = 1;
  local_4._1_3_ = 0;
  FUN_0040f270(param_1[1],param_1,&local_24);
  local_4 = (uint)local_4._1_3_ << 8;
  if (local_24 != (void *)0x0) {
    free(local_24);
  }
  local_4 = 0xffffffff;
  if (local_18 != (void *)0x0) {
    free(local_18);
  }
  ExceptionList = local_c;
  return;
}



undefined4 * __thiscall FUN_0040f0d0(void *this,byte param_1)

{
  *(undefined ***)this = aMap<class_aString,class_aString>::vftable;
  FUN_0040f1e0();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void FUN_0040f100(int *param_1,void *param_2,size_t param_3,undefined4 param_4,void *param_5,
                 void *param_6)

{
  void **ppvVar1;
  void *_Dst;
  size_t sVar2;
  void *local_c;
  undefined *puStack_8;
  uint local_4;
  
  puStack_8 = &LAB_00438b80;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 1;
  _Dst = (void *)0x0;
  sVar2 = 0;
  if (param_2 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_2,param_3);
    *(undefined *)(param_3 + (int)_Dst) = 0;
    sVar2 = param_3;
  }
  ppvVar1 = (void **)FUN_0040f320(param_1,_Dst,sVar2);
  if (param_5 != *ppvVar1) {
    FUN_0041b310();
    memcpy(*ppvVar1,param_5,(size_t)param_6);
    ppvVar1[1] = param_6;
    *(undefined *)((int)param_6 + (int)*ppvVar1) = 0;
  }
  local_4 = local_4 & 0xffffff00;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  local_4 = 0xffffffff;
  if (param_5 != (void *)0x0) {
    free(param_5);
  }
  ExceptionList = local_c;
  return;
}



void FUN_0040f1e0(void)

{
  undefined4 *puVar1;
  int *piVar2;
  int *piVar3;
  void *pvVar4;
  void **unaff_EDI;
  
  pvVar4 = (void *)0x0;
  if ((*unaff_EDI != (void *)0x0) && (unaff_EDI[1] != (void *)0x0)) {
    do {
      for (puVar1 = *(undefined4 **)((int)*unaff_EDI + (int)pvVar4 * 4); puVar1 != (undefined4 *)0x0
          ; puVar1 = (undefined4 *)*puVar1) {
        if ((void *)puVar1[5] != (void *)0x0) {
          free((void *)puVar1[5]);
        }
        if ((void *)puVar1[2] != (void *)0x0) {
          free((void *)puVar1[2]);
        }
      }
      pvVar4 = (void *)((int)pvVar4 + 1);
    } while (pvVar4 < unaff_EDI[1]);
  }
  operator_delete__(*unaff_EDI);
  *unaff_EDI = (void *)0x0;
  unaff_EDI[2] = (void *)0x0;
  unaff_EDI[3] = (void *)0x0;
  piVar3 = (int *)unaff_EDI[4];
  if ((int *)unaff_EDI[4] != (int *)0x0) {
    do {
      piVar2 = (int *)*piVar3;
      operator_delete__(piVar3);
      piVar3 = piVar2;
    } while (piVar2 != (int *)0x0);
    unaff_EDI[4] = (void *)0x0;
    return;
  }
  unaff_EDI[4] = (void *)0x0;
  return;
}



void FUN_0040f270(int *param_1,int **param_2,void **param_3)

{
  int **in_EAX;
  int **ppiVar1;
  int *piVar2;
  uint uVar3;
  
  ppiVar1 = (int **)*param_2;
  if (ppiVar1[2] != *in_EAX) {
    FUN_0041b310();
    memcpy(*in_EAX,ppiVar1[2],(size_t)ppiVar1[3]);
    piVar2 = ppiVar1[3];
    in_EAX[1] = piVar2;
    *(undefined *)((int)piVar2 + (int)*in_EAX) = 0;
  }
  if (ppiVar1[5] != (int *)*param_3) {
    FUN_0041b310();
    memcpy(*param_3,ppiVar1[5],(size_t)ppiVar1[6]);
    piVar2 = ppiVar1[6];
    param_3[1] = piVar2;
    *(undefined *)((int)piVar2 + (int)*param_3) = 0;
  }
  piVar2 = *ppiVar1;
  if (piVar2 == (int *)0x0) {
    uVar3 = (int)ppiVar1[1] + 1;
    if (uVar3 < (uint)param_1[1]) {
      ppiVar1 = (int **)(*param_1 + uVar3 * 4);
      do {
        piVar2 = *ppiVar1;
        if (piVar2 != (int *)0x0) break;
        uVar3 = uVar3 + 1;
        ppiVar1 = ppiVar1 + 1;
      } while (uVar3 < (uint)param_1[1]);
    }
  }
  *param_2 = piVar2;
  return;
}



undefined4 * FUN_0040f320(int *param_1,void *param_2,size_t param_3)

{
  void **ppvVar1;
  undefined *puVar2;
  undefined4 *puVar3;
  byte *_Dst;
  size_t sVar4;
  undefined4 uVar5;
  undefined **ppuVar6;
  undefined *local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004397d8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  ppuVar6 = &local_10;
  local_10 = &stack0xffffffcc;
  _Dst = (byte *)0x0;
  uVar5 = 0;
  sVar4 = 0;
  puVar2 = &stack0xffffffcc;
  if (param_2 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_2,param_3);
    _Dst[param_3] = 0;
    sVar4 = param_3;
    puVar2 = local_10;
  }
  local_10 = puVar2;
  puVar3 = FUN_00422080(param_1,_Dst,sVar4,uVar5,(uint *)ppuVar6);
  if (puVar3 == (undefined4 *)0x0) {
    if (*param_1 == 0) {
      FUN_004061a0();
    }
    puVar3 = (undefined4 *)FUN_0040f430();
    ppvVar1 = (void **)(puVar3 + 2);
    puVar3[1] = local_10;
    if (param_2 != *ppvVar1) {
      FUN_0041b310();
      memcpy(*ppvVar1,param_2,param_3);
      puVar3[3] = param_3;
      *(undefined *)(param_3 + (int)*ppvVar1) = 0;
    }
    *puVar3 = *(undefined4 *)(*param_1 + (int)local_10 * 4);
    *(undefined4 **)(*param_1 + (int)local_10 * 4) = puVar3;
  }
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return puVar3 + 5;
}



void FUN_0040f430(void)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int unaff_ESI;
  
  if (*(int *)(unaff_ESI + 0xc) == 0) {
    puVar4 = (undefined4 *)operator_new(*(int *)(unaff_ESI + 0x14) * 0x20 + 4);
    *puVar4 = *(undefined4 *)(unaff_ESI + 0x10);
    *(undefined4 **)(unaff_ESI + 0x10) = puVar4;
    iVar1 = *(int *)(unaff_ESI + 0x14);
    puVar4 = puVar4 + iVar1 * 8 + -7;
    while (iVar1 = iVar1 + -1, -1 < iVar1) {
      *puVar4 = *(undefined4 *)(unaff_ESI + 0xc);
      *(undefined4 **)(unaff_ESI + 0xc) = puVar4;
      puVar4 = puVar4 + -8;
    }
  }
  puVar2 = *(undefined4 **)(unaff_ESI + 0xc);
  uVar3 = *puVar2;
  *(int *)(unaff_ESI + 8) = *(int *)(unaff_ESI + 8) + 1;
  *(undefined4 *)(unaff_ESI + 0xc) = uVar3;
  puVar4 = puVar2 + 2;
  *puVar4 = 0;
  puVar2[3] = 0;
  puVar2[4] = 0;
  if (puVar4 != (undefined4 *)0x0) {
    *puVar4 = 0;
    puVar2[4] = 0;
    puVar2[3] = 0;
  }
  puVar4 = puVar2 + 5;
  *puVar4 = 0;
  puVar2[6] = 0;
  puVar2[7] = 0;
  if (puVar4 != (undefined4 *)0x0) {
    *puVar4 = 0;
    puVar2[7] = 0;
    puVar2[6] = 0;
  }
  return;
}



undefined4 * __thiscall FUN_0040f4c0(void *this,byte param_1)

{
  *(undefined ***)this = CRectangle2::vftable;
  if (*(undefined4 **)((int)this + 0x10) != (undefined4 *)0x0) {
    (**(code **)**(undefined4 **)((int)this + 0x10))(1);
  }
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



undefined4 * __thiscall FUN_0040f4f0(void *this,int param_1)

{
  void *this_00;
  undefined4 *puVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438ccb;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined ***)this = CRectangle2::vftable;
  *(undefined2 *)((int)this + 0xc) = *(undefined2 *)(param_1 + 0xc);
  *(undefined2 *)((int)this + 6) = *(undefined2 *)(param_1 + 6);
  *(undefined2 *)((int)this + 10) = *(undefined2 *)(param_1 + 10);
  *(undefined2 *)((int)this + 8) = *(undefined2 *)(param_1 + 8);
  *(undefined2 *)((int)this + 4) = *(undefined2 *)(param_1 + 4);
  if (*(int *)(param_1 + 0x10) == 0) {
    *(undefined4 *)((int)this + 0x10) = 0;
  }
  else {
    this_00 = operator_new(0x14);
    local_4 = 0;
    if (this_00 == (void *)0x0) {
      *(undefined4 *)((int)this + 0x10) = 0;
    }
    else {
      puVar1 = FUN_0040f4f0(this_00,*(int *)(param_1 + 0x10));
      *(undefined4 **)((int)this + 0x10) = puVar1;
    }
  }
  ExceptionList = local_c;
  return (undefined4 *)this;
}



void FUN_0040f5a0(void)

{
  void *pvVar1;
  undefined4 *puVar2;
  int unaff_ESI;
  int unaff_EDI;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  pvVar1 = ExceptionList;
  local_4 = 0xffffffff;
  puStack_8 = &LAB_0043837b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined2 *)(unaff_EDI + 0xc) = *(undefined2 *)(unaff_ESI + 0xc);
  *(undefined2 *)(unaff_EDI + 6) = *(undefined2 *)(unaff_ESI + 6);
  *(undefined2 *)(unaff_EDI + 10) = *(undefined2 *)(unaff_ESI + 10);
  *(undefined2 *)(unaff_EDI + 8) = *(undefined2 *)(unaff_ESI + 8);
  *(undefined2 *)(unaff_EDI + 4) = *(undefined2 *)(unaff_ESI + 4);
  if (*(int *)(unaff_ESI + 0x10) == 0) {
    *(undefined4 *)(unaff_EDI + 0x10) = 0;
    ExceptionList = pvVar1;
    return;
  }
  pvVar1 = operator_new(0x14);
  local_4 = 0;
  if (pvVar1 != (void *)0x0) {
    puVar2 = FUN_0040f4f0(pvVar1,*(int *)(unaff_ESI + 0x10));
    *(undefined4 **)(unaff_EDI + 0x10) = puVar2;
    ExceptionList = local_c;
    return;
  }
  *(undefined4 *)(unaff_EDI + 0x10) = 0;
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0040f660(undefined4 *param_1)

{
  *param_1 = CRectangle2::vftable;
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (***(code ***)(undefined4 *)param_1[4])(1);
  }
  return;
}



void __fastcall FUN_0040f680(int param_1)

{
  printf("CRectangle2::Dump() BEGIN ...\n");
  printf("Tag   =%d\n",(int)*(short *)(param_1 + 4));
  printf("Left  =%d\n",(int)*(short *)(param_1 + 6));
  printf("Top   =%d\n",(int)*(short *)(param_1 + 8));
  printf("Right =%d\n",(int)*(short *)(param_1 + 10));
  printf("Bottom=%d\n",(int)*(short *)(param_1 + 0xc));
  printf("Size  =%d x %d\n",((int)*(short *)(param_1 + 10) - (int)*(short *)(param_1 + 6)) + 1,
         ((int)*(short *)(param_1 + 0xc) - (int)*(short *)(param_1 + 8)) + 1);
  printf("Center=%d, %d\n",((int)*(short *)(param_1 + 10) + (int)*(short *)(param_1 + 6)) / 2,
         ((int)*(short *)(param_1 + 0xc) + (int)*(short *)(param_1 + 8)) / 2);
  printf("CRectangle2::Dump() END\n\n");
  return;
}



void __fastcall
FUN_0040f780(int param_1,void **param_2,int param_3,int param_4,uint param_5,uint param_6,
            int param_7,int *param_8,uint param_9)

{
  char cVar1;
  void **ppvVar2;
  void *pvVar3;
  int **ppiVar4;
  char *pcVar5;
  uint uVar6;
  byte **ppbVar7;
  int iVar8;
  undefined4 extraout_ECX;
  int iVar9;
  int iVar10;
  byte *pbVar11;
  void *pvVar12;
  byte *pbVar13;
  bool bVar14;
  bool bVar15;
  code ***pppcVar16;
  size_t sVar17;
  int iStack_654;
  int *piStack_650;
  int **ppiStack_64c;
  void *pvStack_648;
  void **local_644;
  int *local_640;
  int local_63c;
  int local_638;
  void *pvStack_634;
  void *apvStack_628 [3];
  void *pvStack_61c;
  void *pvStack_610;
  code *local_604;
  undefined *local_600;
  undefined *local_5fc;
  undefined *local_5f8;
  undefined *local_5f4;
  undefined4 local_5f0;
  undefined4 local_59c;
  undefined4 local_598;
  undefined **local_594;
  undefined4 local_590;
  undefined4 local_58c;
  undefined4 local_588;
  undefined4 local_584;
  code **local_57c;
  code **local_578;
  void **ppvStack_564;
  int iStack_560;
  uint uStack_55c;
  uint uStack_558;
  int iStack_554;
  uint uStack_4ac;
  char acStack_414 [1024];
  uint local_14;
  void *local_c;
  undefined *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_0043a606;
  local_c = ExceptionList;
  local_14 = DAT_0044a01c ^ (uint)&iStack_654;
  ExceptionList = &local_c;
  local_63c = param_3;
  local_57c = &local_604;
  pppcVar16 = &local_57c;
  local_640 = param_8;
  local_604 = FUN_00425be0;
  local_600 = &LAB_00425c80;
  local_5fc = &LAB_00425c20;
  local_5f8 = &LAB_00425cc0;
  local_5f4 = &LAB_00425d70;
  local_59c = 0;
  local_598 = 0;
  local_5f0 = 0;
  local_594 = &PTR_s_Bogus_message_code__d_0043fec8;
  local_590 = 0x7b;
  local_58c = 0;
  local_588 = 0;
  local_584 = 0;
  local_644 = param_2;
  local_638 = param_1;
  FUN_00423550();
  sVar17 = 0;
  ppvVar2 = (void **)(**local_578)();
  pvVar12 = (void *)((param_4 * param_5 * param_6 >> 3) + 0x400);
  ppvStack_564 = ppvVar2;
  pvVar3 = operator_new((uint)pvVar12);
  ppvVar2[5] = pvVar3;
  *ppvVar2 = pvVar3;
  ppvVar2[1] = pvVar12;
  ppvVar2[2] = FUN_0041c770;
  ppvVar2[3] = &LAB_0040f730;
  ppvVar2[4] = FUN_0041c770;
  uStack_55c = param_5;
  uStack_558 = param_6 >> 3;
  iStack_560 = param_4;
  iStack_554 = (param_6 != 8) + 1;
  FUN_00423ab0();
  FUN_00423930(param_7);
  FUN_00425aa0();
  if (param_9 != 0) {
    piStack_650 = (int *)&stack0xfffff98c;
    FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,"SIG");
    ppiVar4 = (int **)FUN_00421e80(param_9,apvStack_628,pppcVar16,sVar17);
    piStack_650 = *ppiVar4;
    ppiStack_64c = (int **)ppiVar4[1];
    if ((ppiStack_64c != (int **)0x0) && (piStack_650 != (int *)0x0)) {
      FUN_0040ef80((int *)&piStack_650);
      uStack_4 = 0;
      FUN_0040efd0((int *)&piStack_650);
      sprintf(acStack_414,"%s=%s");
      if (apvStack_628[0] != (void *)0x0) {
        free(apvStack_628[0]);
      }
      uStack_4 = 0xffffffff;
      if (pvStack_634 != (void *)0x0) {
        free(pvStack_634);
      }
      pcVar5 = acStack_414;
      do {
        cVar1 = *pcVar5;
        pcVar5 = pcVar5 + 1;
      } while (cVar1 != '\0');
      FUN_00423720();
    }
    ppiStack_64c = (int **)(param_9 + 4);
    piStack_650 = (int *)0x0;
    if (*(int *)(param_9 + 0xc) != 0) {
      uVar6 = 0;
      if (*(uint *)(param_9 + 8) != 0) {
        ppiVar4 = (int **)*ppiStack_64c;
        do {
          piStack_650 = *ppiVar4;
          if (piStack_650 != (int *)0x0) break;
          uVar6 = uVar6 + 1;
          ppiVar4 = ppiVar4 + 1;
        } while (uVar6 < *(uint *)(param_9 + 8));
      }
    }
    while ((ppiStack_64c != (int **)0x0 && (piStack_650 != (int *)0x0))) {
      ppbVar7 = (byte **)FUN_0040efd0((int *)&piStack_650);
      pbVar11 = *ppbVar7;
      if (pbVar11 == (byte *)0x0) {
        pbVar11 = &DAT_0044d0d5;
      }
      iVar9 = 4;
      bVar14 = false;
      iVar10 = 0;
      bVar15 = true;
      pbVar13 = &DAT_0043e1b0;
      do {
        if (iVar9 == 0) break;
        iVar9 = iVar9 + -1;
        bVar14 = *pbVar11 < *pbVar13;
        bVar15 = *pbVar11 == *pbVar13;
        pbVar11 = pbVar11 + 1;
        pbVar13 = pbVar13 + 1;
      } while (bVar15);
      if (!bVar15) {
        iVar10 = (1 - (uint)bVar14) - (uint)(bVar14 != 0);
      }
      if (pvStack_634 != (void *)0x0) {
        free(pvStack_634);
      }
      if (iVar10 != 0) {
        FUN_0040ef80((int *)&piStack_650);
        uStack_4 = 1;
        FUN_0040efd0((int *)&piStack_650);
        sprintf(acStack_414,"%s=%s");
        if (pvStack_61c != (void *)0x0) {
          free(pvStack_61c);
        }
        uStack_4 = 0xffffffff;
        if (pvStack_610 != (void *)0x0) {
          free(pvStack_610);
        }
        pcVar5 = acStack_414;
        do {
          cVar1 = *pcVar5;
          pcVar5 = pcVar5 + 1;
        } while (cVar1 != '\0');
        FUN_00423720();
      }
      FUN_0040f020(&piStack_650);
    }
  }
  iVar9 = local_638;
  iStack_654 = (uStack_55c - 1) * local_638 + local_63c;
  if (param_6 == 8) {
    if (uStack_4ac < uStack_55c) {
      do {
        FUN_00425b10();
        iStack_654 = iStack_654 - iVar9;
      } while (uStack_4ac < uStack_55c);
    }
  }
  else {
    pvStack_648 = operator_new(uStack_558 * iStack_560);
    if (uStack_4ac < uStack_55c) {
      do {
        if (param_4 != 0) {
          iVar8 = 0;
          iVar10 = param_4;
          do {
            *(undefined *)(iVar8 + (int)pvStack_648) = *(undefined *)(iVar8 + 2 + iStack_654);
            *(undefined *)(iVar8 + 1 + (int)pvStack_648) = *(undefined *)(iVar8 + 1 + iStack_654);
            *(undefined *)(iVar8 + 2 + (int)pvStack_648) = *(undefined *)(iVar8 + iStack_654);
            iVar8 = iVar8 + 3;
            iVar10 = iVar10 + -1;
          } while (iVar10 != 0);
        }
        FUN_00425b10();
        iStack_654 = iStack_654 - iVar9;
      } while (uStack_4ac < uStack_55c);
    }
    operator_delete__(pvStack_648);
  }
  ppvVar2 = ppvStack_564;
  FUN_004235d0();
  *local_644 = ppvVar2[5];
  *local_640 = (int)*ppvVar2 - (int)ppvVar2[5];
  if (local_578 != (code **)0x0) {
    (*local_578[10])();
  }
  ExceptionList = local_c;
  ___security_check_cookie_4(local_14 ^ (uint)&iStack_654);
  return;
}



void __cdecl
FUN_0040fcc0(undefined4 param_1,undefined4 param_2,uint *param_3,uint *param_4,int *param_5,
            uint *param_6,void **param_7,int *param_8)

{
  int iVar1;
  undefined4 *puVar2;
  char *pcVar3;
  uint uVar4;
  void *pvVar5;
  void *pvVar6;
  undefined4 extraout_ECX;
  char *_Dest;
  size_t sVar7;
  char *_Dest_00;
  char *_Source;
  code **local_e88;
  int local_e6c;
  uint local_e30;
  uint local_e2c;
  int local_e24;
  uint local_e14;
  int *local_d80;
  char local_c14 [1024];
  char local_814 [1024];
  char local_414 [1024];
  uint local_14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_0043a5bb;
  local_10 = ExceptionList;
  local_14 = DAT_0044a01c ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar1 = _setjmp3();
  if (iVar1 == 0) {
    FUN_00423060();
    puVar2 = (undefined4 *)(**local_e88)();
    puVar2[2] = FUN_0041c770;
    puVar2[3] = &LAB_0040f730;
    puVar2[4] = &LAB_0040f740;
    puVar2[5] = &LAB_004258e0;
    puVar2[6] = FUN_0041c770;
    puVar2[7] = param_1;
    puVar2[1] = param_2;
    *puVar2 = param_1;
    FUN_00423300();
    *param_8 = 0;
    if (local_d80 != (int *)0x0) {
      do {
        if (*(char *)(local_d80 + 1) == -2) {
          sVar7 = 0x3ff;
          if ((uint)local_d80[3] < 0x3ff) {
            sVar7 = local_d80[3];
          }
          memcpy(local_414,(void *)local_d80[4],sVar7);
          local_414[sVar7] = '\0';
          pcVar3 = strchr(local_414,0x3d);
          if (pcVar3 != (char *)0x0) {
            _Source = local_414;
            _Dest_00 = local_814;
            *pcVar3 = '\0';
            strncpy(_Dest_00,_Source,0x3ff);
            _Dest = local_c14;
            strncpy(_Dest,pcVar3 + 1,0x3ff);
            if (*param_8 == 0) {
              _Source = (char *)0x40fef1;
              puVar2 = (undefined4 *)operator_new(0x1c);
              if (puVar2 == (undefined4 *)0x0) {
                puVar2 = (undefined4 *)0x0;
              }
              else {
                *puVar2 = aMap<class_aString,class_aString>::vftable;
                puVar2[1] = 0;
                puVar2[2] = 0x11;
                puVar2[3] = 0;
                puVar2[4] = 0;
                puVar2[5] = 0;
                puVar2[6] = 10;
              }
              *param_8 = (int)puVar2;
            }
            pcVar3 = local_c14;
            sVar7 = 0x40ff3a;
            FUN_0041aa80(pcVar3,(char *)0x7fffffff,pcVar3);
            local_8 = 0;
            FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,local_814);
            local_8 = 0xffffffff;
            FUN_0040ee80(*param_8,_Dest,sVar7,pcVar3,_Dest_00,_Source);
          }
        }
        local_d80 = (int *)*local_d80;
      } while (local_d80 != (int *)0x0);
    }
    FUN_00422df0();
    uVar4 = local_e24 * local_e30;
    *param_4 = uVar4;
    if ((uVar4 & 3) != 0) {
      *param_4 = (uVar4 - (uVar4 & 3)) + 4;
    }
    pvVar5 = operator_new(*param_4 * local_e2c);
    *param_7 = pvVar5;
    *param_6 = local_e30;
    *param_3 = local_e2c;
    *param_5 = local_e24 * 8;
    pvVar5 = (void *)((local_e6c + -1) * *param_4 + (int)*param_7);
    if (*param_5 == 8) {
      while (local_e14 < local_e2c) {
        FUN_00422fc0();
      }
    }
    else {
      pvVar6 = operator_new(*param_4);
      while (local_e14 < local_e2c) {
        FUN_00422fc0();
        uVar4 = 0;
        if (local_e30 != 0) {
          iVar1 = 0;
          do {
            *(undefined *)(iVar1 + 2 + (int)pvVar5) = *(undefined *)(iVar1 + (int)pvVar6);
            *(undefined *)(iVar1 + 1 + (int)pvVar5) = *(undefined *)(iVar1 + 1 + (int)pvVar6);
            *(undefined *)(iVar1 + (int)pvVar5) = *(undefined *)(iVar1 + 2 + (int)pvVar6);
            uVar4 = uVar4 + 1;
            iVar1 = iVar1 + 3;
          } while (uVar4 < local_e30);
        }
        pvVar5 = (void *)((int)pvVar5 - *param_4);
      }
      operator_delete__(pvVar6);
    }
    FUN_00423460();
    if (local_e88 != (code **)0x0) {
      (*local_e88[10])();
    }
  }
  else if (local_e88 != (code **)0x0) {
    (*local_e88[10])();
  }
  ExceptionList = local_10;
  ___security_check_cookie_4(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



void __cdecl FUN_00410160(char *param_1,undefined4 param_2,undefined4 param_3,void *param_4)

{
  char *pcVar1;
  undefined4 extraout_ECX;
  undefined auStack_11c [4];
  undefined4 local_118;
  undefined4 local_110 [64];
  uint local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438342;
  local_c = ExceptionList;
  local_10 = DAT_0044a01c ^ (uint)auStack_11c;
  ExceptionList = &local_c;
  local_118 = 0;
  local_4 = 2;
  pcVar1 = &DAT_0044d0d5;
  if (param_1 != (char *)0x0) {
    pcVar1 = param_1;
  }
  FUN_004155c0(pcVar1,local_110,0x100);
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,(char *)local_110);
  local_4._0_1_ = 1;
  local_118 = 1;
  if (param_1 != (char *)0x0) {
    free(param_1);
  }
  local_4 = (uint)local_4._1_3_ << 8;
  if (param_4 != (void *)0x0) {
    free(param_4);
  }
  ExceptionList = local_c;
  ___security_check_cookie_4(local_10 ^ (uint)auStack_11c);
  return;
}



undefined4 * FUN_00410260(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00438b4d;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = aSyncRefCounter::vftable;
  param_1[2] = aCriticalSection::vftable;
  param_1[3] = 0xffffffff;
  param_1[4] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 5));
  param_1[1] = 1;
  *param_1 = CPlateResult::vftable;
  param_1[0xb] = 0;
  param_1[0xd] = 0;
  param_1[0xc] = 0;
  param_1[0xe] = 0;
  param_1[0x10] = 0;
  param_1[0xf] = 0;
  param_1[0x11] = 0;
  param_1[0x13] = 0;
  param_1[0x12] = 0;
  param_1[0x15] = CRectangle2::vftable;
  *(undefined2 *)(param_1 + 0x18) = 0;
  *(undefined2 *)((int)param_1 + 0x5e) = 0;
  *(undefined2 *)(param_1 + 0x17) = 0;
  *(undefined2 *)((int)param_1 + 0x5a) = 0;
  *(undefined2 *)(param_1 + 0x16) = 0;
  param_1[0x19] = 0;
  param_1[0x1a] = 0;
  param_1[0x1c] = 0;
  param_1[0x1b] = 0;
  param_1[0x24] = 0;
  param_1[0x25] = 0;
  param_1[0x26] = 0;
  uStack_4 = 6;
  FUN_00410de0();
  param_1[0x32] = param_2;
  param_1[0x30] = param_3;
  param_1[0x27] = 0xffffffff;
  param_1[0x28] = 0xffffffff;
  param_1[0x29] = 0xffffffff;
  param_1[0x2a] = 0xffffffff;
  param_1[0x2b] = 0xffffffff;
  param_1[0x2c] = 0xffffffff;
  param_1[0x2d] = 0xffffffff;
  param_1[0x2e] = 0xffffffff;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_00410380(void *this,byte param_1)

{
  FUN_004103a0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_004103a0(undefined4 *param_1)

{
  undefined4 *puVar1;
  uint uVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_c = ExceptionList;
  puStack_8 = &LAB_004382f4;
  uVar2 = DAT_0044a01c ^ (uint)&stack0xffffffe8;
  ExceptionList = &local_c;
  *param_1 = CPlateResult::vftable;
  local_4 = 4;
  if ((int)param_1[0x24] < 2) {
    if (param_1[0x24] == 0) goto LAB_00410417;
  }
  else {
    for (puVar1 = *(undefined4 **)param_1[0x25]; puVar1 != (undefined4 *)0x0;
        puVar1 = (undefined4 *)*puVar1) {
      operator_delete((void *)puVar1[1]);
    }
  }
  operator_delete((void *)param_1[0x26]);
LAB_00410417:
  if ((void *)param_1[0x1a] != (void *)0x0) {
    free((void *)param_1[0x1a]);
  }
  local_4._0_1_ = 3;
  param_1[0x15] = CRectangle2::vftable;
  if ((undefined4 *)param_1[0x19] != (undefined4 *)0x0) {
    (***(code ***)(undefined4 *)param_1[0x19])(1,uVar2);
  }
  local_4._0_1_ = 2;
  if ((void *)param_1[0x11] != (void *)0x0) {
    free((void *)param_1[0x11]);
  }
  local_4._0_1_ = 1;
  if ((void *)param_1[0xe] != (void *)0x0) {
    free((void *)param_1[0xe]);
  }
  local_4 = (uint)local_4._1_3_ << 8;
  if ((void *)param_1[0xb] != (void *)0x0) {
    free((void *)param_1[0xb]);
  }
  *param_1 = aSyncRefCounter::vftable;
  param_1[2] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 5));
  ExceptionList = local_c;
  return;
}



int __thiscall FUN_004104b0(int param_1,int param_2)

{
  void **ppvVar1;
  undefined8 uVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *extraout_ECX;
  undefined4 *puVar7;
  
  puVar7 = (undefined4 *)param_1;
  if (param_1 != param_2) {
    if (*(int *)(param_2 + 0x2c) != *(int *)(param_1 + 0x2c)) {
      FUN_0041b310();
      memcpy(*(void **)(param_1 + 0x2c),*(void **)(param_2 + 0x2c),*(size_t *)(param_2 + 0x30));
      iVar3 = *(int *)(param_2 + 0x30);
      *(int *)(param_1 + 0x30) = iVar3;
      *(undefined *)(iVar3 + (int)*(void **)(param_1 + 0x2c)) = 0;
    }
    if (*(int *)(param_2 + 0x38) != *(int *)(param_1 + 0x38)) {
      FUN_0041b310();
      memcpy(*(void **)(param_1 + 0x38),*(void **)(param_2 + 0x38),*(size_t *)(param_2 + 0x3c));
      iVar3 = *(int *)(param_2 + 0x3c);
      *(int *)(param_1 + 0x3c) = iVar3;
      *(undefined *)(iVar3 + (int)*(void **)(param_1 + 0x38)) = 0;
    }
    *(undefined *)(param_1 + 0x50) = *(undefined *)(param_2 + 0x50);
    *(undefined8 *)(param_1 + 0x80) = *(undefined8 *)(param_2 + 0x80);
    ppvVar1 = (void **)(param_1 + 0x68);
    *(undefined8 *)(param_1 + 0x78) = *(undefined8 *)(param_2 + 0x78);
    *(undefined8 *)(param_1 + 0x88) = *(undefined8 *)(param_2 + 0x88);
    if (*(void **)(param_2 + 0x68) != *ppvVar1) {
      FUN_0041b310();
      memcpy(*ppvVar1,*(void **)(param_2 + 0x68),*(size_t *)(param_2 + 0x6c));
      iVar3 = *(int *)(param_2 + 0x6c);
      *(int *)(param_1 + 0x6c) = iVar3;
      *(undefined *)(iVar3 + (int)*ppvVar1) = 0;
    }
    *(undefined4 *)(param_1 + 0xc0) = *(undefined4 *)(param_2 + 0xc0);
    *(undefined4 *)(param_1 + 0xc4) = *(undefined4 *)(param_2 + 0xc4);
    *(undefined4 *)(param_1 + 200) = *(undefined4 *)(param_2 + 200);
    *(undefined4 *)(param_1 + 0xcc) = *(undefined4 *)(param_2 + 0xcc);
    *(undefined4 *)(param_1 + 0xd0) = *(undefined4 *)(param_2 + 0xd0);
    *(undefined4 *)(param_1 + 0xbc) = *(undefined4 *)(param_2 + 0xbc);
    FUN_0040f5a0();
    *(undefined4 *)(param_1 + 0x9c) = *(undefined4 *)(param_2 + 0x9c);
    *(undefined4 *)(param_1 + 0xa0) = *(undefined4 *)(param_2 + 0xa0);
    *(undefined4 *)(param_1 + 0xa4) = *(undefined4 *)(param_2 + 0xa4);
    *(undefined4 *)(param_1 + 0xa8) = *(undefined4 *)(param_2 + 0xa8);
    *(undefined4 *)(param_1 + 0xac) = *(undefined4 *)(param_2 + 0xac);
    *(undefined4 *)(param_1 + 0xb0) = *(undefined4 *)(param_2 + 0xb0);
    *(undefined4 *)(param_1 + 0xb4) = *(undefined4 *)(param_2 + 0xb4);
    *(undefined4 *)(param_1 + 0xb8) = *(undefined4 *)(param_2 + 0xb8);
    if (*(int *)(param_2 + 0x44) != *(int *)(param_1 + 0x44)) {
      FUN_0041b310();
      memcpy(*(void **)(param_1 + 0x44),*(void **)(param_2 + 0x44),*(size_t *)(param_2 + 0x48));
      iVar3 = *(int *)(param_2 + 0x48);
      *(int *)(param_1 + 0x48) = iVar3;
      *(undefined *)(iVar3 + (int)*(void **)(param_1 + 0x44)) = 0;
    }
    *(undefined4 *)(param_1 + 0xd4) = *(undefined4 *)(param_2 + 0xd4);
    iVar3 = *(int *)(param_1 + 0x94);
    while (iVar3 != 0) {
      puVar7 = *(undefined4 **)(param_1 + 0x94);
      *(undefined4 *)(param_1 + 0x94) = *puVar7;
      operator_delete(puVar7);
      iVar3 = *(int *)(param_1 + 0x94);
    }
    *(undefined4 *)(param_1 + 0x90) = 0;
    *(undefined4 *)(param_1 + 0x94) = 0;
    *(undefined4 *)(param_1 + 0x98) = 0;
    puVar5 = (undefined4 *)FUN_0040e220(param_2 + 0x90);
    puVar7 = extraout_ECX;
    for (puVar5 = (undefined4 *)*puVar5; puVar5 != (undefined4 *)0x0; puVar5 = (undefined4 *)*puVar5
        ) {
      uVar2 = *(undefined8 *)(puVar5 + 2);
      uVar4 = *(undefined4 *)(param_1 + 0x98);
      puVar6 = (undefined4 *)operator_new(0x10);
      *(undefined8 *)(puVar6 + 2) = uVar2;
      puVar6[1] = uVar4;
      *puVar6 = 0;
      puVar7 = *(undefined4 **)(param_1 + 0x98);
      if (puVar7 == (undefined4 *)0x0) {
        *(undefined4 **)(param_1 + 0x94) = puVar6;
      }
      else {
        *puVar7 = puVar6;
      }
      *(int *)(param_1 + 0x90) = *(int *)(param_1 + 0x90) + 1;
      *(undefined4 **)(param_1 + 0x98) = puVar6;
    }
  }
  return (int)puVar7;
}



void ** __thiscall FUN_00410750(void *this,void **param_1)

{
  int iVar1;
  void *_Dst;
  void *pvVar2;
  
  iVar1 = *(int *)((int)this + 0x2c);
  *param_1 = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
  if (iVar1 != 0) {
    FUN_0041b310();
    _Dst = *param_1;
    memcpy(_Dst,*(void **)((int)this + 0x2c),*(size_t *)((int)this + 0x30));
    pvVar2 = *(void **)((int)this + 0x30);
    *(undefined *)((int)pvVar2 + (int)_Dst) = 0;
    param_1[1] = pvVar2;
  }
  return param_1;
}



void __thiscall FUN_004107a0(void *this,void *param_1,size_t param_2)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438ad8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  if (param_1 != *(void **)((int)this + 0x2c)) {
    FUN_0041b310();
    memcpy(*(void **)((int)this + 0x2c),param_1,param_2);
    *(size_t *)((int)this + 0x30) = param_2;
    *(undefined *)(param_2 + (int)*(void **)((int)this + 0x2c)) = 0;
  }
  local_4 = 0xffffffff;
  if (param_1 != (void *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return;
}



void ** __thiscall FUN_00410830(void *this,void **param_1)

{
  int iVar1;
  void *_Dst;
  void *pvVar2;
  
  iVar1 = *(int *)((int)this + 0x38);
  *param_1 = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
  if (iVar1 != 0) {
    FUN_0041b310();
    _Dst = *param_1;
    memcpy(_Dst,*(void **)((int)this + 0x38),*(size_t *)((int)this + 0x3c));
    pvVar2 = *(void **)((int)this + 0x3c);
    *(undefined *)((int)pvVar2 + (int)_Dst) = 0;
    param_1[1] = pvVar2;
  }
  return param_1;
}



void __thiscall FUN_00410880(void *this,void *param_1,size_t param_2)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438ad8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  if (param_1 != *(void **)((int)this + 0x38)) {
    FUN_0041b310();
    memcpy(*(void **)((int)this + 0x38),param_1,param_2);
    *(size_t *)((int)this + 0x3c) = param_2;
    *(undefined *)(param_2 + (int)*(void **)((int)this + 0x38)) = 0;
  }
  local_4 = 0xffffffff;
  if (param_1 != (void *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return;
}



undefined __fastcall FUN_00410910(int param_1)

{
  return *(undefined *)(param_1 + 0x50);
}



void __thiscall FUN_00410920(void *this,undefined param_1)

{
  *(undefined *)((int)this + 0x50) = param_1;
  return;
}



void ** __thiscall FUN_00410930(void *this,void **param_1)

{
  int iVar1;
  void *_Dst;
  void *pvVar2;
  
  iVar1 = *(int *)((int)this + 0x68);
  *param_1 = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
  if (iVar1 != 0) {
    FUN_0041b310();
    _Dst = *param_1;
    memcpy(_Dst,*(void **)((int)this + 0x68),*(size_t *)((int)this + 0x6c));
    pvVar2 = *(void **)((int)this + 0x6c);
    *(undefined *)((int)pvVar2 + (int)_Dst) = 0;
    param_1[1] = pvVar2;
  }
  return param_1;
}



void __thiscall FUN_00410980(void *this,void *param_1,size_t param_2)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438ad8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  if (param_1 != *(void **)((int)this + 0x68)) {
    FUN_0041b310();
    memcpy(*(void **)((int)this + 0x68),param_1,param_2);
    *(size_t *)((int)this + 0x6c) = param_2;
    *(undefined *)(param_2 + (int)*(void **)((int)this + 0x68)) = 0;
  }
  local_4 = 0xffffffff;
  if (param_1 != (void *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return;
}



void * __thiscall FUN_00410a10(void *this,void *param_1)

{
  FUN_0040f4f0(param_1,(int)this + 0x54);
  return param_1;
}



void FUN_00410a30(undefined1 param_1,undefined param_2,undefined param_3,undefined param_4,
                 undefined4 *param_5)

{
  uint uVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438aa8;
  local_c = ExceptionList;
  uVar1 = DAT_0044a01c ^ (uint)&stack0xffffffec;
  ExceptionList = &local_c;
  local_4 = 0;
  FUN_0040f5a0();
  local_4 = 0xffffffff;
  if (param_5 != (undefined4 *)0x0) {
    (**(code **)*param_5)(1,uVar1);
  }
  ExceptionList = local_c;
  return;
}



void ** __thiscall FUN_00410aa0(void *this,void **param_1)

{
  int iVar1;
  void *_Dst;
  void *pvVar2;
  
  iVar1 = *(int *)((int)this + 0x44);
  *param_1 = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
  if (iVar1 != 0) {
    FUN_0041b310();
    _Dst = *param_1;
    memcpy(_Dst,*(void **)((int)this + 0x44),*(size_t *)((int)this + 0x48));
    pvVar2 = *(void **)((int)this + 0x48);
    *(undefined *)((int)pvVar2 + (int)_Dst) = 0;
    param_1[1] = pvVar2;
  }
  return param_1;
}



void __thiscall FUN_00410af0(void *this,void *param_1,size_t param_2)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438ad8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  if (param_1 != *(void **)((int)this + 0x44)) {
    FUN_0041b310();
    memcpy(*(void **)((int)this + 0x44),param_1,param_2);
    *(size_t *)((int)this + 0x48) = param_2;
    *(undefined *)(param_2 + (int)*(void **)((int)this + 0x44)) = 0;
  }
  local_4 = 0xffffffff;
  if (param_1 != (void *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return;
}



float10 __fastcall FUN_00410b80(int param_1)

{
  return (float10)*(double *)(param_1 + 0x78);
}



void __thiscall FUN_00410b90(void *this,undefined8 param_1)

{
  *(undefined8 *)((int)this + 0x78) = param_1;
  return;
}



float10 __fastcall FUN_00410ba0(int param_1)

{
  return (float10)*(double *)(param_1 + 0x80);
}



void __thiscall FUN_00410bb0(void *this,undefined8 param_1)

{
  *(undefined8 *)((int)this + 0x80) = param_1;
  return;
}



int __fastcall FUN_00410bc0(int param_1)

{
  return param_1 + 0x90;
}



void __thiscall FUN_00410bd0(void *this,int param_1)

{
  undefined8 uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  
  iVar2 = *(int *)((int)this + 0x94);
  while (iVar2 != 0) {
    puVar4 = *(undefined4 **)((int)this + 0x94);
    *(undefined4 *)((int)this + 0x94) = *puVar4;
    operator_delete(puVar4);
    iVar2 = *(int *)((int)this + 0x94);
  }
  *(undefined4 *)((int)this + 0x90) = 0;
  *(undefined4 *)((int)this + 0x94) = 0;
  *(undefined4 *)((int)this + 0x98) = 0;
  puVar4 = (undefined4 *)FUN_0040e220(param_1);
  for (puVar4 = (undefined4 *)*puVar4; puVar4 != (undefined4 *)0x0; puVar4 = (undefined4 *)*puVar4)
  {
    uVar1 = *(undefined8 *)(puVar4 + 2);
    uVar3 = *(undefined4 *)((int)this + 0x98);
    puVar5 = (undefined4 *)operator_new(0x10);
    *(undefined8 *)(puVar5 + 2) = uVar1;
    puVar5[1] = uVar3;
    *puVar5 = 0;
    if (*(undefined4 **)((int)this + 0x98) == (undefined4 *)0x0) {
      *(undefined4 **)((int)this + 0x94) = puVar5;
    }
    else {
      **(undefined4 **)((int)this + 0x98) = puVar5;
    }
    *(int *)((int)this + 0x90) = *(int *)((int)this + 0x90) + 1;
    *(undefined4 **)((int)this + 0x98) = puVar5;
    *(double *)((int)this + 0x88) = *(double *)((int)this + 0x88) + *(double *)(puVar4 + 2);
  }
  return;
}



float10 __fastcall FUN_00410ca0(int param_1)

{
  if (*(int *)(param_1 + 0x90) == 0) {
    return (float10)0;
  }
  return (float10)*(double *)(param_1 + 0x88) / (float10)*(int *)(param_1 + 0x90);
}



undefined4 __fastcall FUN_00410cc0(int param_1)

{
  return *(undefined4 *)(param_1 + 0xbc);
}



void __thiscall FUN_00410cd0(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 0xbc) = param_1;
  return;
}



undefined4 __fastcall FUN_00410ce0(int param_1)

{
  return *(undefined4 *)(param_1 + 0xc0);
}



void __thiscall FUN_00410cf0(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 0xc0) = param_1;
  return;
}



undefined4 __fastcall FUN_00410d00(int param_1)

{
  return *(undefined4 *)(param_1 + 0xc4);
}



void __thiscall FUN_00410d10(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 0xc4) = param_1;
  return;
}



undefined4 __fastcall FUN_00410d20(int param_1)

{
  return *(undefined4 *)(param_1 + 200);
}



void __thiscall FUN_00410d30(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 200) = param_1;
  return;
}



undefined4 __fastcall FUN_00410d40(int param_1)

{
  return *(undefined4 *)(param_1 + 0xcc);
}



void __thiscall FUN_00410d50(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 0xcc) = param_1;
  return;
}



undefined4 __fastcall FUN_00410d60(int param_1)

{
  return *(undefined4 *)(param_1 + 0xd0);
}



void __thiscall FUN_00410d70(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 0xd0) = param_1;
  return;
}



longlong __fastcall FUN_00410d80(int *param_1)

{
  int iVar1;
  uint uVar2;
  longlong lVar3;
  
  iVar1 = (**(code **)(*param_1 + 0x88))();
  uVar2 = (**(code **)(*param_1 + 0x80))();
  lVar3 = __allmul(uVar2,(int)uVar2 >> 0x1f,1000000,0);
  return lVar3 + iVar1;
}



undefined4 __fastcall FUN_00410dc0(int param_1)

{
  return *(undefined4 *)(param_1 + 0xd4);
}



void __thiscall FUN_00410dd0(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 0xd4) = param_1;
  return;
}



void FUN_00410de0(void)

{
  int *piVar1;
  int iVar2;
  undefined4 *puVar3;
  size_t sVar4;
  int unaff_ESI;
  __time64_t _Var5;
  
  *(undefined4 *)(unaff_ESI + 200) = 0xffffffff;
  *(undefined4 *)(unaff_ESI + 0xc0) = 0xffffffff;
  *(undefined4 *)(unaff_ESI + 0xc4) = 0xffffffff;
  if (DAT_0044d228 != *(void **)(unaff_ESI + 0x2c)) {
    FUN_0041b310();
    memcpy(*(void **)(unaff_ESI + 0x2c),DAT_0044d228,DAT_0044d22c);
    sVar4 = DAT_0044d22c;
    *(size_t *)(unaff_ESI + 0x30) = DAT_0044d22c;
    *(undefined *)(sVar4 + (int)*(void **)(unaff_ESI + 0x2c)) = 0;
  }
  if (DAT_0044d228 != *(void **)(unaff_ESI + 0x38)) {
    FUN_0041b310();
    memcpy(*(void **)(unaff_ESI + 0x38),DAT_0044d228,DAT_0044d22c);
    sVar4 = DAT_0044d22c;
    *(size_t *)(unaff_ESI + 0x3c) = DAT_0044d22c;
    *(undefined *)(sVar4 + (int)*(void **)(unaff_ESI + 0x38)) = 0;
  }
  iVar2 = *(int *)(unaff_ESI + 0x94);
  while (iVar2 != 0) {
    puVar3 = *(undefined4 **)(unaff_ESI + 0x94);
    *(undefined4 *)(unaff_ESI + 0x94) = *puVar3;
    operator_delete(puVar3);
    iVar2 = *(int *)(unaff_ESI + 0x94);
  }
  *(undefined4 *)(unaff_ESI + 0x90) = 0;
  *(undefined4 *)(unaff_ESI + 0x94) = 0;
  *(undefined4 *)(unaff_ESI + 0x98) = 0;
  *(undefined8 *)(unaff_ESI + 0x80) = 0;
  *(undefined8 *)(unaff_ESI + 0x78) = 0;
  *(undefined4 *)(unaff_ESI + 0xbc) = 0;
  *(undefined8 *)(unaff_ESI + 0x88) = 0;
  *(undefined *)(unaff_ESI + 0x50) = 1;
  if (DAT_0044d228 != *(void **)(unaff_ESI + 0x68)) {
    FUN_0041b310();
    memcpy(*(void **)(unaff_ESI + 0x68),DAT_0044d228,DAT_0044d22c);
    sVar4 = DAT_0044d22c;
    *(size_t *)(unaff_ESI + 0x6c) = DAT_0044d22c;
    *(undefined *)(sVar4 + (int)*(void **)(unaff_ESI + 0x68)) = 0;
  }
  *(undefined2 *)(unaff_ESI + 0x5a) = 0;
  *(undefined2 *)(unaff_ESI + 0x5c) = 0;
  *(undefined2 *)(unaff_ESI + 0x5e) = 0;
  *(undefined2 *)(unaff_ESI + 0x60) = 0;
  _Var5 = _time64((__time64_t *)0x0);
  piVar1 = (int *)(unaff_ESI + 0x44);
  *(int *)(unaff_ESI + 0xcc) = (int)_Var5;
  *(undefined4 *)(unaff_ESI + 0xd0) = 0;
  if ((undefined4 *)*piVar1 != &DAT_0043c0ac) {
    FUN_0041b310();
    puVar3 = (undefined4 *)*piVar1;
    *puVar3 = 0x384f5349;
    puVar3[1] = 0x2d393538;
    *(undefined *)(puVar3 + 2) = 0x31;
    *(undefined4 *)(unaff_ESI + 0x48) = 9;
    *(undefined *)(*piVar1 + 9) = 0;
  }
  return;
}



void FUN_00410f90(double param_1)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  int unaff_ESI;
  
  if (*(int *)(unaff_ESI + 0x30) + 1 < *(int *)(unaff_ESI + 0x34)) {
    *(undefined *)(*(int *)(unaff_ESI + 0x2c) + 1 + *(int *)(unaff_ESI + 0x30)) = 0;
  }
  else {
    FUN_0041b310();
  }
  *(undefined *)(*(int *)(unaff_ESI + 0x2c) + *(int *)(unaff_ESI + 0x30)) = 0x3f;
  *(int *)(unaff_ESI + 0x30) = *(int *)(unaff_ESI + 0x30) + 1;
  uVar1 = *(undefined4 *)(unaff_ESI + 0x98);
  puVar2 = (undefined4 *)operator_new(0x10);
  *(double *)(puVar2 + 2) = param_1;
  puVar2[1] = uVar1;
  *puVar2 = 0;
  if (*(undefined4 **)(unaff_ESI + 0x98) == (undefined4 *)0x0) {
    *(undefined4 **)(unaff_ESI + 0x94) = puVar2;
  }
  else {
    **(undefined4 **)(unaff_ESI + 0x98) = puVar2;
  }
  *(int *)(unaff_ESI + 0x90) = *(int *)(unaff_ESI + 0x90) + 1;
  *(undefined4 **)(unaff_ESI + 0x98) = puVar2;
  *(double *)(unaff_ESI + 0x88) = param_1 + *(double *)(unaff_ESI + 0x88);
  return;
}



void __thiscall FUN_00411010(int param_1,int param_2,double param_3)

{
  byte bVar1;
  undefined4 uVar2;
  void **ppvVar3;
  undefined4 *puVar4;
  int unaff_ESI;
  undefined auStack_30 [4];
  undefined4 local_2c;
  void *local_28;
  byte local_1c;
  undefined local_1b;
  undefined local_1a;
  undefined local_19;
  undefined local_18;
  uint local_14;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438298;
  local_c = ExceptionList;
  local_14 = DAT_0044a01c ^ (uint)auStack_30;
  ExceptionList = &local_c;
  bVar1 = *(byte *)(param_2 + param_1);
  local_2c = 1;
  if ((char)bVar1 < '\0') {
    if ((bVar1 & 0xe0) == 0xc0) {
      local_1b = *(undefined *)(param_2 + 1 + param_1);
      local_1a = 0;
      local_2c = 2;
      local_1c = bVar1;
    }
    else if ((bVar1 & 0xf0) == 0xe0) {
      local_1b = *(undefined *)(param_2 + 1 + param_1);
      local_1a = *(undefined *)(param_2 + 2 + param_1);
      local_19 = 0;
      local_2c = 3;
      local_1c = bVar1;
    }
    else if ((bVar1 & 0xf8) == 0xf0) {
      local_1b = *(undefined *)(param_2 + 1 + param_1);
      local_1a = *(undefined *)(param_2 + 2 + param_1);
      local_19 = *(undefined *)(param_2 + 3 + param_1);
      local_18 = 0;
      local_2c = 4;
      local_1c = bVar1;
    }
  }
  else {
    local_1b = 0;
    local_2c = 1;
    local_1c = bVar1;
  }
  ppvVar3 = (void **)FUN_0041aa80(&local_1c,(char *)0x7fffffff,(char *)&local_1c);
  local_4 = 0;
  FUN_0041b310();
  memcpy((void *)(*(int *)(unaff_ESI + 0x2c) + *(int *)(unaff_ESI + 0x30)),*ppvVar3,
         (size_t)ppvVar3[1]);
  *(int *)(unaff_ESI + 0x30) = *(int *)(unaff_ESI + 0x30) + (int)ppvVar3[1];
  *(undefined *)(*(int *)(unaff_ESI + 0x30) + *(int *)(unaff_ESI + 0x2c)) = 0;
  local_4 = 0xffffffff;
  if (local_28 != (void *)0x0) {
    free(local_28);
  }
  uVar2 = *(undefined4 *)(unaff_ESI + 0x98);
  puVar4 = (undefined4 *)operator_new(0x10);
  *(double *)(puVar4 + 2) = param_3;
  puVar4[1] = uVar2;
  *puVar4 = 0;
  if (*(undefined4 **)(unaff_ESI + 0x98) == (undefined4 *)0x0) {
    *(undefined4 **)(unaff_ESI + 0x94) = puVar4;
  }
  else {
    **(undefined4 **)(unaff_ESI + 0x98) = puVar4;
  }
  *(int *)(unaff_ESI + 0x90) = *(int *)(unaff_ESI + 0x90) + 1;
  *(undefined4 **)(unaff_ESI + 0x98) = puVar4;
  *(double *)(unaff_ESI + 0x88) = param_3 + *(double *)(unaff_ESI + 0x88);
  ExceptionList = local_c;
  ___security_check_cookie_4(local_14 ^ (uint)auStack_30);
  return;
}



void FUN_004111d0(void)

{
  int iVar1;
  undefined4 *puVar2;
  int unaff_ESI;
  
  *(undefined4 *)(unaff_ESI + 0x30) = 0;
  if (*(undefined **)(unaff_ESI + 0x2c) != (undefined *)0x0) {
    **(undefined **)(unaff_ESI + 0x2c) = 0;
  }
  iVar1 = *(int *)(unaff_ESI + 0x94);
  while (iVar1 != 0) {
    puVar2 = *(undefined4 **)(unaff_ESI + 0x94);
    *(undefined4 *)(unaff_ESI + 0x94) = *puVar2;
    operator_delete(puVar2);
    iVar1 = *(int *)(unaff_ESI + 0x94);
  }
  *(undefined4 *)(unaff_ESI + 0x90) = 0;
  *(undefined4 *)(unaff_ESI + 0x94) = 0;
  *(undefined4 *)(unaff_ESI + 0x98) = 0;
  *(undefined8 *)(unaff_ESI + 0x88) = 0;
  return;
}



void __thiscall
FUN_00411230(void *this,undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8)

{
  *(undefined4 *)((int)this + 0x9c) = param_1;
  *(undefined4 *)((int)this + 0xa0) = param_2;
  *(undefined4 *)((int)this + 0xa4) = param_3;
  *(undefined4 *)((int)this + 0xa8) = param_4;
  *(undefined4 *)((int)this + 0xac) = param_5;
  *(undefined4 *)((int)this + 0xb0) = param_6;
  *(undefined4 *)((int)this + 0xb4) = param_7;
  *(undefined4 *)((int)this + 0xb8) = param_8;
  return;
}



uint __thiscall FUN_00411290(void *this,uint param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_1 < 4) {
    *param_2 = *(undefined4 *)((int)this + param_1 * 8 + 0x9c);
    uVar1 = *(undefined4 *)((int)this + param_1 * 8 + 0xa0);
    param_2[1] = uVar1;
    return CONCAT31((int3)((uint)uVar1 >> 8),1);
  }
  return param_1 & 0xffffff00;
}



void __thiscall FUN_004112c0(void *this,int param_1)

{
  char cVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  char *pcVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar6;
  undefined4 extraout_ECX_02;
  int iVar7;
  char *pcVar8;
  undefined4 uVar9;
  void *pvVar10;
  int iVar11;
  int *piVar12;
  int *piVar13;
  undefined4 *puVar14;
  uint uVar15;
  undefined8 uVar16;
  ulonglong uVar17;
  undefined local_194 [4];
  undefined4 local_190 [32];
  int local_110 [33];
  char local_8c [32];
  char acStack_6c [32];
  char local_4c [32];
  char acStack_2c [32];
  uint local_c;
  
  local_c = DAT_0044a01c ^ (uint)local_194;
  if (*(int *)(param_1 + 0x30) == 0) {
    if (*(int *)((int)this + 0x30) != 0) goto LAB_004114c0;
  }
  else if (*(int *)((int)this + 0x30) == 0) goto LAB_004114c0;
  pvVar10 = (void *)param_1;
  if (-1 < *(int *)((int)this + 0x30) - *(int *)(param_1 + 0x30)) {
    pvVar10 = this;
    this = (void *)param_1;
  }
  pcVar5 = *(char **)((int)this + 0x2c);
  if (pcVar5 == (char *)0x0) {
    pcVar5 = &DAT_0044d0d5;
  }
  pcVar8 = local_8c;
  do {
    cVar1 = *pcVar5;
    *pcVar8 = cVar1;
    pcVar5 = pcVar5 + 1;
    pcVar8 = pcVar8 + 1;
  } while (cVar1 != '\0');
  pcVar5 = *(char **)((int)pvVar10 + 0x2c);
  if (pcVar5 == (char *)0x0) {
    pcVar5 = &DAT_0044d0d5;
  }
  pcVar8 = local_4c;
  do {
    cVar1 = *pcVar5;
    *pcVar8 = cVar1;
    pcVar5 = pcVar5 + 1;
    pcVar8 = pcVar8 + 1;
  } while (cVar1 != '\0');
  uVar16 = FUN_0040e220((int)this + 0x90);
  uVar9 = (undefined4)((ulonglong)uVar16 >> 0x20);
  piVar12 = *(int **)uVar16;
  if (piVar12 != (int *)0x0) {
    piVar13 = local_110;
    uVar6 = extraout_ECX;
    do {
      uVar17 = FUN_00437bc0(uVar6,uVar9);
      uVar9 = (undefined4)(uVar17 >> 0x20);
      piVar12 = (int *)*piVar12;
      *piVar13 = (int)uVar17;
      piVar13 = piVar13 + 1;
      uVar6 = extraout_ECX_00;
    } while (piVar12 != (int *)0x0);
  }
  uVar16 = FUN_0040e220((int)pvVar10 + 0x90);
  uVar9 = (undefined4)((ulonglong)uVar16 >> 0x20);
  piVar12 = *(int **)uVar16;
  if (piVar12 != (int *)0x0) {
    puVar14 = local_190;
    uVar6 = extraout_ECX_01;
    do {
      uVar17 = FUN_00437bc0(uVar6,uVar9);
      uVar9 = (undefined4)(uVar17 >> 0x20);
      piVar12 = (int *)*piVar12;
      *puVar14 = (int)uVar17;
      puVar14 = puVar14 + 1;
      uVar6 = extraout_ECX_02;
    } while (piVar12 != (int *)0x0);
  }
  pcVar5 = local_8c;
  do {
    cVar1 = *pcVar5;
    pcVar5 = pcVar5 + 1;
  } while (cVar1 != '\0');
  iVar2 = (int)pcVar5 - (int)(local_8c + 1);
  iVar11 = 1 << ((byte)iVar2 & 0x1f);
  uVar15 = 0;
  if (0 < iVar11) {
    do {
      iVar3 = 0;
      do {
        pcVar5 = local_8c + iVar3;
        acStack_6c[iVar3] = *pcVar5;
        iVar3 = iVar3 + 1;
      } while (*pcVar5 != '\0');
      iVar3 = 0;
      iVar7 = 0;
      if (iVar2 < 1) {
LAB_00411436:
        iVar3 = 0;
        do {
          pcVar5 = local_8c + iVar3;
          acStack_2c[iVar3] = *pcVar5;
          iVar3 = iVar3 + 1;
        } while (*pcVar5 != '\0');
        iVar3 = 0;
        do {
          pcVar5 = acStack_6c + iVar3;
          local_8c[iVar3] = *pcVar5;
          iVar3 = iVar3 + 1;
        } while (*pcVar5 != '\0');
        uVar4 = FUN_00411500(local_8c,local_110,(int)local_190);
        if ((char)uVar4 != '\0') {
          ___security_check_cookie_4(local_c ^ (uint)local_194);
          return;
        }
        iVar3 = 0;
        do {
          pcVar5 = acStack_2c + iVar3;
          local_8c[iVar3] = *pcVar5;
          iVar3 = iVar3 + 1;
        } while (*pcVar5 != '\0');
      }
      else {
        do {
          if ((uVar15 & 1 << ((byte)iVar7 & 0x1f)) != 0) {
            acStack_6c[iVar7] = '#';
            iVar3 = iVar3 + 1;
          }
          iVar7 = iVar7 + 1;
        } while (iVar7 < iVar2);
        if (iVar3 < 3) goto LAB_00411436;
      }
      uVar15 = uVar15 + 1;
    } while ((int)uVar15 < iVar11);
  }
LAB_004114c0:
  ___security_check_cookie_4(local_c ^ (uint)local_194);
  return;
}



uint FUN_00411500(char *param_1,int *param_2,int param_3)

{
  char cVar1;
  int iVar2;
  double dVar3;
  double dVar4;
  double dVar5;
  double dVar6;
  double dVar7;
  char *in_EAX;
  char *pcVar8;
  int iVar9;
  int iVar10;
  uint uVar11;
  undefined2 uVar12;
  int iVar13;
  undefined4 *puVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  int iVar19;
  ushort uVar20;
  int local_1a8;
  int local_1a0;
  int local_198;
  int local_194;
  int local_190;
  int local_188;
  undefined4 local_180 [5];
  undefined4 local_16c;
  undefined4 local_168;
  undefined4 local_164;
  undefined4 local_160;
  undefined4 local_15c;
  undefined4 local_158;
  undefined4 local_154;
  undefined4 local_150;
  undefined4 local_14c;
  undefined4 local_148;
  undefined4 local_144;
  undefined4 local_140;
  undefined4 local_13c;
  undefined4 local_138;
  undefined4 local_134;
  undefined4 local_130;
  undefined4 local_12c;
  undefined4 local_128;
  undefined4 local_124;
  undefined4 local_120;
  undefined4 local_11c;
  undefined4 local_118;
  undefined4 local_114;
  undefined4 local_110;
  undefined4 local_10c;
  undefined4 local_108;
  int local_104 [5];
  undefined4 local_f0;
  undefined4 local_ec;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined4 local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 local_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined4 local_98;
  undefined4 local_94;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  int local_80 [32];
  
  iVar18 = -1;
  pcVar8 = param_1;
  do {
    cVar1 = *pcVar8;
    pcVar8 = pcVar8 + 1;
  } while (cVar1 != '\0');
  iVar9 = (int)pcVar8 - (int)(param_1 + 1);
  pcVar8 = in_EAX;
  do {
    cVar1 = *pcVar8;
    pcVar8 = pcVar8 + 1;
  } while (cVar1 != '\0');
  iVar10 = (int)pcVar8 - (int)(in_EAX + 1);
  memset(local_80,-1,0x80);
  iVar15 = 0;
  if (0 < iVar9) {
    do {
      iVar19 = iVar18;
      if (param_1[iVar15] != '#') {
        do {
          iVar19 = iVar19 + 1;
          if (iVar10 <= iVar19) goto LAB_0041158e;
        } while (param_1[iVar15] != in_EAX[iVar19]);
        local_80[iVar15] = iVar19;
        iVar18 = iVar19;
LAB_0041158e:
        if (iVar19 == iVar10) {
          iVar18 = iVar18 + 1;
        }
      }
      iVar15 = iVar15 + 1;
    } while (iVar15 < iVar9);
  }
  dVar3 = 0.0;
  iVar19 = 0;
  iVar18 = 0;
  local_198 = 0;
  local_194 = 0;
  local_1a0 = 0;
  local_190 = 0;
  local_188 = 0;
  local_104[1] = 0;
  local_104[2] = 0;
  local_104[3] = 0;
  local_104[4] = 0;
  local_f0 = 0;
  local_ec = 0;
  local_e8 = 0;
  local_e4 = 0;
  local_e0 = 0;
  local_dc = 0;
  local_d8 = 0;
  local_d4 = 0;
  local_d0 = 0;
  local_cc = 0;
  local_c8 = 0;
  local_c4 = 0;
  local_c0 = 0;
  local_bc = 0;
  local_b8 = 0;
  local_b4 = 0;
  local_b0 = 0;
  local_ac = 0;
  local_a8 = 0;
  local_a4 = 0;
  local_a0 = 0;
  local_9c = 0;
  local_98 = 0;
  local_94 = 0;
  local_90 = 0;
  local_8c = 0;
  local_88 = 0;
  local_84 = 0;
  local_180[0] = 0;
  local_180[1] = 0;
  local_180[2] = 0;
  local_180[3] = 0;
  local_180[4] = 0;
  local_16c = 0;
  local_168 = 0;
  local_164 = 0;
  local_160 = 0;
  local_15c = 0;
  local_158 = 0;
  local_154 = 0;
  local_150 = 0;
  local_14c = 0;
  local_148 = 0;
  local_144 = 0;
  local_140 = 0;
  local_13c = 0;
  local_138 = 0;
  local_134 = 0;
  local_130 = 0;
  local_12c = 0;
  local_128 = 0;
  local_124 = 0;
  local_120 = 0;
  local_11c = 0;
  local_118 = 0;
  local_114 = 0;
  local_110 = 0;
  local_10c = 0;
  local_108 = 0;
  local_104[0] = 0;
  local_1a8 = 0;
  iVar15 = 0;
  dVar4 = dVar3;
  dVar5 = dVar3;
  dVar6 = dVar3;
  dVar7 = dVar3;
  if (0 < iVar9) {
    iVar2 = -(int)param_2;
    iVar17 = (int)local_104 + iVar2 + 4;
    iVar16 = (int)local_80 - (int)param_2;
    do {
      if (*(int *)(iVar16 + (int)param_2) == -1) {
        iVar15 = *(int *)(iVar16 + (int)param_2);
        iVar13 = local_1a8;
        while ((iVar15 == -1 && (iVar13 < iVar9))) {
          iVar13 = iVar13 + 1;
          iVar15 = local_80[iVar13];
        }
        if (iVar13 == iVar9) {
          iVar15 = local_1a8 + iVar19;
          if (iVar15 < iVar10) {
            local_1a0 = local_1a0 + 1;
            local_180[iVar15] = 5;
            iVar15 = *(int *)(param_3 + iVar15 * 4);
            iVar13 = *param_2;
            *(undefined4 *)((int)param_2 + iVar17) = 5;
            if (iVar13 < iVar15) {
              iVar18 = iVar18 + 1;
              dVar4 = (double)iVar13 + dVar4;
            }
            else {
              iVar18 = iVar18 + 1;
              dVar4 = (double)iVar15 + dVar4;
            }
          }
          else {
LAB_0041182b:
            iVar15 = *param_2;
            local_198 = local_198 + 1;
            *(undefined4 *)((int)param_2 + iVar17) = 4;
            iVar19 = iVar19 + -1;
            dVar6 = (double)iVar15 + dVar6;
          }
        }
        else if (local_80[iVar13] - iVar13 < iVar19) {
          if ((local_1a8 == 0) || (*(int *)((int)param_2 + (int)local_104 + iVar2) == 4))
          goto LAB_0041182b;
          local_190 = local_190 + 1;
          dVar3 = dVar3 + (double)*param_2;
          *(undefined4 *)((int)param_2 + iVar17) = 3;
          iVar19 = iVar19 + -1;
        }
        else {
          local_1a0 = local_1a0 + 1;
          local_180[local_1a8 + iVar19] = 5;
          iVar15 = *(int *)((local_1a8 + iVar19) * 4 + param_3);
          iVar13 = *param_2;
          *(undefined4 *)((int)param_2 + iVar17) = 5;
          if (iVar13 < iVar15) {
            dVar4 = (double)iVar13 + dVar4;
          }
          else {
            dVar4 = (double)iVar15 + dVar4;
          }
        }
      }
      else {
        iVar15 = *(int *)(iVar16 + (int)param_2) - local_1a8;
        iVar18 = iVar19;
        if ((iVar19 != iVar15) && (iVar18 = iVar15, iVar19 < iVar15)) {
          iVar15 = local_1a8 + iVar19;
          puVar14 = local_180 + iVar15;
          iVar19 = (*(int *)(iVar16 + (int)param_2) - local_1a8) - iVar19;
          do {
            if ((iVar15 == 0) || (puVar14[-1] == 2)) {
              iVar13 = *(int *)((param_3 - (int)local_180) + (int)puVar14);
              local_194 = local_194 + 1;
              *puVar14 = 2;
              dVar5 = (double)iVar13 + dVar5;
            }
            else {
              iVar13 = *(int *)((param_3 - (int)local_180) + (int)puVar14);
              local_188 = local_188 + 1;
              *puVar14 = 1;
              dVar7 = (double)iVar13 + dVar7;
            }
            puVar14 = puVar14 + 1;
            iVar15 = iVar15 + 1;
            iVar19 = iVar19 + -1;
          } while (iVar19 != 0);
        }
        iVar19 = iVar18;
        iVar18 = *(int *)(iVar16 + (int)param_2);
      }
      local_1a8 = local_1a8 + 1;
      param_2 = param_2 + 1;
      iVar15 = local_194;
    } while (local_1a8 < iVar9);
  }
  if (iVar18 < iVar10 + -1) {
    iVar9 = (iVar10 + -1) - iVar18;
    iVar18 = param_3 + iVar18 * 4;
    iVar15 = iVar15 + iVar9;
    do {
      iVar10 = *(int *)(iVar18 + 4);
      iVar18 = iVar18 + 4;
      iVar9 = iVar9 + -1;
      *(undefined4 *)((int)local_180 + (iVar18 - param_3)) = 2;
      dVar5 = (double)iVar10 + dVar5;
    } while (iVar9 != 0);
  }
  uVar11 = local_198 + iVar15 + local_1a0 + local_190 + local_188;
  if ((int)uVar11 < 4) {
    uVar12 = (undefined2)(uVar11 >> 0x10);
    if (900.0 < dVar7 != NAN(dVar7)) {
      return CONCAT22(uVar12,(ushort)(900.0 < dVar7) << 8 | (ushort)NAN(dVar7) << 10 |
                             (ushort)(dVar7 == 900.0) << 0xe);
    }
    uVar20 = (ushort)(dVar3 < 900.0) << 8 | (ushort)NAN(dVar3) << 10 |
             (ushort)(dVar3 == 900.0) << 0xe;
    if (((dVar3 >= 900.0 && dVar3 != 900.0) ||
        (uVar20 = (ushort)(999.0 < dVar4) << 8 | (ushort)NAN(dVar4) << 10 |
                  (ushort)(dVar4 == 999.0) << 0xe, 999.0 < dVar4 != NAN(dVar4))) ||
       (uVar20 = (ushort)(dVar5 < 999.0) << 8 | (ushort)NAN(dVar5) << 10 |
                 (ushort)(dVar5 == 999.0) << 0xe, 999.0 < dVar5)) {
      return CONCAT22(uVar12,uVar20);
    }
    uVar11 = CONCAT22(uVar12,(ushort)(dVar6 < 999.0) << 8 | (ushort)NAN(dVar6) << 10 |
                             (ushort)(dVar6 == 999.0) << 0xe);
    if (dVar6 <= 999.0) {
      return CONCAT31((int3)(uVar11 >> 8),1);
    }
  }
  return uVar11 & 0xffffff00;
}



void FUN_00411a00(void)

{
  undefined4 *puVar1;
  int *unaff_EDI;
  
  if (*unaff_EDI < 2) {
    if (*unaff_EDI != 0) {
      operator_delete((void *)unaff_EDI[2]);
    }
    return;
  }
  for (puVar1 = *(undefined4 **)unaff_EDI[1]; puVar1 != (undefined4 *)0x0;
      puVar1 = (undefined4 *)*puVar1) {
    operator_delete((void *)puVar1[1]);
  }
  operator_delete((void *)unaff_EDI[2]);
  return;
}



void FUN_00411a40(void)

{
  void *_Dst;
  uint uVar1;
  byte bVar2;
  uint uVar3;
  uint unaff_EBX;
  undefined4 *unaff_ESI;
  byte *unaff_EDI;
  
  *unaff_ESI = CMsg::vftable;
  _Dst = operator_new(unaff_EBX);
  unaff_ESI[1] = _Dst;
  memcpy(_Dst,unaff_EDI,unaff_EBX);
  uVar1 = 1;
  unaff_ESI[2] = unaff_EBX;
  *(undefined *)((int)unaff_ESI + 0xe) = 1;
  *(undefined *)((int)unaff_ESI + 0xf) = 1;
  bVar2 = *unaff_EDI;
  if (1 < unaff_EBX - 2) {
    do {
      bVar2 = bVar2 ^ unaff_EDI[uVar1];
      uVar1 = uVar1 + 1;
    } while (uVar1 < unaff_EBX - 2);
  }
  if (bVar2 != unaff_EDI[unaff_EBX - 2]) {
    *(undefined *)((int)unaff_ESI + 0xf) = 0;
  }
  if (*unaff_EDI != 2) {
    *(undefined *)((int)unaff_ESI + 0xe) = 0;
  }
  if (unaff_EDI[unaff_EBX - 1] != 3) {
    *(undefined *)((int)unaff_ESI + 0xe) = 0;
  }
  *(undefined *)(unaff_ESI + 3) = 0;
  *(undefined *)((int)unaff_ESI + 0xd) = 1;
  uVar1 = (uint)*(ushort *)(unaff_ESI[1] + 9);
  uVar3 = (uint)*(ushort *)(unaff_ESI[1] + 0xb);
  if (((int)uVar3 <= (int)(&DAT_0044cab8)[uVar1]) &&
     (*(int *)(&DAT_0044c6b8 + uVar1 * 4) <= (int)uVar3)) {
    *(undefined *)(unaff_ESI + 4) = 1;
    return;
  }
  *(undefined *)(unaff_ESI + 4) = 0;
  return;
}



void __fastcall FUN_00411ad0(undefined4 *param_1)

{
  void *pvVar1;
  
  pvVar1 = (void *)param_1[1];
  *param_1 = CMsg::vftable;
  if (pvVar1 != (void *)0x0) {
    if (*(char *)((int)param_1 + 0xd) != '\0') {
      operator_delete__(pvVar1);
      param_1[1] = 0;
      return;
    }
    operator_delete(pvVar1);
    param_1[1] = 0;
  }
  return;
}



void FUN_00411b10(void)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  DAT_0044b520 = 1;
  memset(&DAT_0044cab8,0,0x400);
  memset(&DAT_0044c6b8,0,0x400);
  iVar4 = 0;
  if (DAT_0044abf0 != -1) {
    iVar2 = 0;
    iVar3 = DAT_0044abf0;
    do {
      uVar1 = *(undefined4 *)((int)&DAT_0044af00 + iVar2);
      iVar4 = iVar4 + 1;
      *(undefined4 *)(&DAT_0044c6b8 + iVar3 * 4) = *(undefined4 *)((int)&DAT_0044b210 + iVar2);
      iVar2 = iVar4 * 4;
      (&DAT_0044cab8)[iVar3] = uVar1;
      iVar3 = (&DAT_0044abf0)[iVar4];
    } while (iVar3 != -1);
  }
  return;
}



bool __thiscall FUN_00411b90(void *this,SOCKET param_1,int param_2,u_short param_3)

{
  int iVar1;
  
  iVar1 = FUN_004161d0(*(uint *)((int)this + 8),*(undefined4 **)((int)this + 4),param_1,
                       *(undefined4 *)(param_2 + 0x10),param_3);
  return iVar1 != 0;
}



undefined4 * __fastcall FUN_00411bc0(int param_1,int param_2)

{
  int iVar1;
  undefined4 *puVar2;
  void *pvVar3;
  bool bVar4;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438a83;
  local_c = ExceptionList;
  if (param_1 < 0x11) {
    return (undefined4 *)0x0;
  }
  ExceptionList = &local_c;
  switch(*(undefined2 *)(param_2 + 9)) {
  case 0:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = CInputChangedMsgE::vftable;
    goto LAB_00411c37;
  case 1:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 1;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = CCarMovementMsgE::vftable;
    goto LAB_00411c81;
  case 2:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 2;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    iVar1 = puVar2[2];
    *puVar2 = CLicenseInfoMsgE::vftable;
    if (iVar1 == 0x7c) {
      ExceptionList = local_c;
      return puVar2;
    }
    if (iVar1 == 0x80) {
      ExceptionList = local_c;
      return puVar2;
    }
    if (iVar1 != 0xbc) {
      *(undefined *)((int)puVar2 + 0xe) = 0;
      ExceptionList = local_c;
      return puVar2;
    }
    ExceptionList = local_c;
    return puVar2;
  case 3:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 3;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = CNotificationMsgE::vftable;
    goto LAB_00411d31;
  case 0x40:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 4;
    if (puVar2 != (undefined4 *)0x0) {
      FUN_00411a40();
      *puVar2 = CVersionMsgQ::vftable;
      if (puVar2[2] != 0x13) {
        *(undefined *)((int)puVar2 + 0xe) = 0;
        ExceptionList = local_c;
        return puVar2;
      }
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x41:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 5;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = CShutdownMsgQ::vftable;
LAB_00411d31:
    if (puVar2[2] != 0x14) {
      *(undefined *)((int)puVar2 + 0xe) = 0;
      ExceptionList = local_c;
      return puVar2;
    }
    ExceptionList = local_c;
    return puVar2;
  case 0x42:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 6;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = COutputMsgQ::vftable;
LAB_00411c81:
    bVar4 = puVar2[2] == 0x18;
    goto LAB_00411c85;
  case 0x43:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 7;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x17;
    *puVar2 = CTriggerMsgQ::vftable;
    goto LAB_00411c85;
  case 0x44:
    pvVar3 = operator_new(0x14);
    local_4 = 8;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_004151e0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x45:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 9;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x13;
    *puVar2 = CInputValuesMsgQ::vftable;
    goto LAB_00411c85;
  case 0x46:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 10;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x14;
    *puVar2 = CActivateMsgQ::vftable;
    goto LAB_00411c85;
  case 0x47:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0xb;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x17;
    *puVar2 = CPictureMsgQ::vftable;
    goto LAB_00411c85;
  case 0x48:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0xc;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x17;
    *puVar2 = CCurrentFrameMsgQ::vftable;
    goto LAB_00411c85;
  case 0x49:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0xd;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x17;
    *puVar2 = CFocusControlMsgQ::vftable;
    goto LAB_00411c85;
  case 0x4a:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x18;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x1b;
    *puVar2 = CAdjustLensMsgQ::vftable;
    goto LAB_00411c3b;
  case 0x4b:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x19;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x1b;
    *puVar2 = CAutoAdjustLensMsgQ::vftable;
    goto LAB_00411c3b;
  case 0x4c:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x1c;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x14;
    *puVar2 = CSetLocalCentralSystemHostStatusMsgQ::vftable;
    goto LAB_00411c3b;
  case 0x4d:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x1b;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x1d;
    *puVar2 = CLiveImageParametersMsgQ::vftable;
    goto LAB_00411c3b;
  case 0x4e:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x13;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x13;
    *puVar2 = CLoadWhiteListMsgQ::vftable;
    goto LAB_00411c85;
  case 0x4f:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x14;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x17;
    *puVar2 = CRecognitionStatisticsMsgQ::vftable;
    goto LAB_00411c85;
  case 0x60:
    pvVar3 = operator_new(0x14);
    local_4 = 0x1e;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414f80();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x61:
    pvVar3 = operator_new(0x14);
    local_4 = 0x1f;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414d40();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x62:
    pvVar3 = operator_new(0x14);
    local_4 = 0x20;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00415120();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 99:
    pvVar3 = operator_new(0x14);
    local_4 = 0x21;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00415160();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 100:
    pvVar3 = operator_new(0x14);
    local_4 = 0x22;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_004154b0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x65:
    pvVar3 = operator_new(0x14);
    local_4 = 0x23;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414d00();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x66:
    pvVar3 = operator_new(0x14);
    local_4 = 0x26;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414f00();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x67:
    pvVar3 = operator_new(0x14);
    local_4 = 0x27;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_004154f0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x68:
    pvVar3 = operator_new(0x14);
    local_4 = 0x28;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_004152b0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x69:
    pvVar3 = operator_new(0x14);
    local_4 = 0x29;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_004152f0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x6a:
    pvVar3 = operator_new(0x14);
    local_4 = 0x2a;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414dc0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x6b:
    pvVar3 = operator_new(0x14);
    local_4 = 0x2b;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_004151a0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x6c:
    pvVar3 = operator_new(0x14);
    local_4 = 0x2c;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414f40();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x6d:
    pvVar3 = operator_new(0x14);
    local_4 = 0x2e;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00415470();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x6e:
    pvVar3 = operator_new(0x14);
    local_4 = 0x2f;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414e00();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x6f:
    pvVar3 = operator_new(0x14);
    local_4 = 0x30;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414fc0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x70:
    pvVar3 = operator_new(0x14);
    local_4 = 0x31;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00415050();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x71:
    pvVar3 = operator_new(0x14);
    local_4 = 0x24;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414e80();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x72:
    pvVar3 = operator_new(0x14);
    local_4 = 0x1d;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_004153b0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x73:
    pvVar3 = operator_new(0x14);
    local_4 = 0x25;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414e40();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x74:
    pvVar3 = operator_new(0x14);
    local_4 = 0x2d;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_004153f0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x75:
    pvVar3 = operator_new(0x14);
    local_4 = 0x33;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_004150e0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x76:
    pvVar3 = operator_new(0x14);
    local_4 = 0x32;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00415330();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0x80:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0xe;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x56;
    *puVar2 = CVersionMsgR::vftable;
    *(undefined *)(puVar2 + 3) = 1;
    goto LAB_00411c85;
  case 0x84:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0xf;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = CStatusMsgR::vftable;
    *(undefined *)(puVar2 + 3) = 1;
    if (puVar2[2] == 0x16) {
      ExceptionList = local_c;
      return puVar2;
    }
    bVar4 = puVar2[2] == 0x19;
    goto LAB_00411c85;
  case 0x85:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x10;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x17;
    *puVar2 = CInputValuesMsgR::vftable;
    *(undefined *)(puVar2 + 3) = 1;
    goto LAB_00411c85;
  case 0x87:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x11;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = CPictureMsgR::vftable;
    *(undefined *)(puVar2 + 3) = 1;
    if ((int)puVar2[2] < 0xfe08) {
      ExceptionList = local_c;
      return puVar2;
    }
    goto LAB_00411c87;
  case 0x88:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x12;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = CCurrentFrameMsgR::vftable;
    *(undefined *)(puVar2 + 3) = 1;
    if ((int)puVar2[2] < 0xfe00) {
      ExceptionList = local_c;
      return puVar2;
    }
    goto LAB_00411c87;
  case 0x89:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x1a;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = CAutoAdjustLensMsgR::vftable;
    *(undefined *)(puVar2 + 3) = 1;
    if ((int)puVar2[2] < 0x18) {
      ExceptionList = local_c;
      return puVar2;
    }
    goto LAB_00411c3d;
  case 0x8f:
    puVar2 = (undefined4 *)operator_new(0x2c);
    local_4 = 0x15;
    if (puVar2 != (undefined4 *)0x0) {
      puVar2 = FUN_00413290(puVar2);
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0xa1:
    pvVar3 = operator_new(0x14);
    local_4 = 0x34;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414ec0();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0xa7:
    pvVar3 = operator_new(0x14);
    local_4 = 0x35;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00415000();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0xad:
    pvVar3 = operator_new(0x14);
    local_4 = 0x36;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00414d80();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0xae:
    pvVar3 = operator_new(0x14);
    local_4 = 0x37;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00415430();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0xaf:
    pvVar3 = operator_new(0x14);
    local_4 = 0x38;
    if (pvVar3 != (void *)0x0) {
      puVar2 = (undefined4 *)FUN_00415370();
      ExceptionList = local_c;
      return puVar2;
    }
    break;
  case 0xc0:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x16;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    bVar4 = puVar2[2] == 0x13;
    *puVar2 = CAckMsg::vftable;
    *(undefined *)(puVar2 + 3) = 1;
LAB_00411c85:
    if (bVar4) {
      ExceptionList = local_c;
      return puVar2;
    }
LAB_00411c87:
    *(undefined *)((int)puVar2 + 0xe) = 0;
    ExceptionList = local_c;
    return puVar2;
  case 0xc1:
    puVar2 = (undefined4 *)operator_new(0x14);
    local_4 = 0x17;
    if (puVar2 == (undefined4 *)0x0) {
      ExceptionList = local_c;
      return (undefined4 *)0x0;
    }
    FUN_00411a40();
    *puVar2 = CNakMsg::vftable;
    *(undefined *)(puVar2 + 3) = 1;
LAB_00411c37:
    bVar4 = puVar2[2] == 0x15;
LAB_00411c3b:
    if (bVar4) {
      ExceptionList = local_c;
      return puVar2;
    }
LAB_00411c3d:
    *(undefined *)((int)puVar2 + 0xe) = 0;
    ExceptionList = local_c;
    return puVar2;
  }
  ExceptionList = local_c;
  return (undefined4 *)0x0;
}



uint __fastcall FUN_00412a60(int param_1)

{
  ushort uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar3 = (uint)*(ushort *)(*(int *)(param_1 + 4) + 9);
  uVar2 = uVar3 * 4;
  if ((&DAT_0044cab8)[uVar3] == *(int *)(&DAT_0044c6b8 + uVar2)) {
    return uVar2 & 0xffffff00;
  }
  uVar1 = *(ushort *)(*(int *)(param_1 + 4) + 9);
  (&DAT_0044cab8)[uVar1] = (&DAT_0044cab8)[uVar1] + -1;
  return CONCAT31((uint3)(byte)(uVar1 >> 8),1);
}



void __fastcall FUN_00412a90(undefined4 param_1)

{
  undefined4 in_EAX;
  
  switch(in_EAX) {
  case 0:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"INPUT_CHANGED");
    return;
  case 1:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"CAR_MOVEMENT");
    return;
  case 2:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"LICENSE_INFO");
    return;
  case 3:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"NOTIFICATION");
    return;
  default:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"Unknown");
    return;
  case 0x40:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"VERSION_QUERY");
    return;
  case 0x41:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SHUTDOWN_QUERY");
    return;
  case 0x42:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"OUTPUT_QUERY");
    return;
  case 0x43:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"TRIGGER_QUERY");
    return;
  case 0x44:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"STATUS_QUERY");
    return;
  case 0x45:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"INPUT_QUERY");
    return;
  case 0x46:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"ACTIVATE_QUERY");
    return;
  case 0x47:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"PICTURE_QUERY");
    return;
  case 0x48:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"CURRENTFRAME_QUERY");
    return;
  case 0x49:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"FOCUSCONTROL_QUERY");
    return;
  case 0x4a:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"ADJUST_LENS_QUERY");
    return;
  case 0x4b:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"AUTOADJUST_LENS_QUERY");
    return;
  case 0x4c:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SET_LOCAL_CENTRAL_SYSTEM_HOST_STATUS");
    return;
  case 0x4d:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"LIVE_IMAGE_PARAMETERS_QUERY");
    return;
  case 0x4e:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"LOAD_WHITELIST_QUERY");
    return;
  case 0x4f:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_RECOGNITION_STATISTICS_QUERY");
    return;
  case 0x60:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_PING_QUERY");
    return;
  case 0x61:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_LOGIN_QUERY");
    return;
  case 0x62:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_LOGOUT_QUERY");
    return;
  case 99:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_PASSWORD_QUERY");
    return;
  case 100:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_SYNC_TIME_QUERY");
    return;
  case 0x65:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_SET_TIME_QUERY");
    return;
  case 0x66:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_EXPORT_LOG_QUERY");
    return;
  case 0x67:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_SYSTEM_INFO_QUERY");
    return;
  case 0x68:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_EXPORT_STATUS_QUERY");
    return;
  case 0x69:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_IMPORT_CONFIGURATION_QUERY");
    return;
  case 0x6a:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_EXPORT_CONFIGURATION_QUERY");
    return;
  case 0x6b:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_APPLY_CHANGES_QUERY");
    return;
  case 0x6c:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_DISCARD_CHANGES_QUERY");
    return;
  case 0x6d:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_GET_ENTRIES_COUNT_QUERY");
    return;
  case 0x6e:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_GET_ENTRY_QUERY");
    return;
  case 0x70:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_RESTORE_ENTRY_QUERY");
    return;
  case 0x71:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_RESTORE_FIRMWARE_QUERY");
    return;
  case 0x72:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_UPDATE_FIRMWARE_QUERY");
    return;
  case 0x73:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_FORMAT_RW_PARTITION_QUERY");
    return;
  case 0x74:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_RESTART_QUERY");
    return;
  case 0x75:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_GET_LANGUAGE_QUERY");
    return;
  case 0x76:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_SET_LANGUAGE_QUERY");
    return;
  case 0x80:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"VERSION_RESPONSE");
    return;
  case 0x84:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"STATUS_RESPONSE");
    return;
  case 0x85:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"INPUT_RESPONSE");
    return;
  case 0x87:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"PICTURE_RESPONSE");
    return;
  case 0x88:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"CURRENTFRAME_RESPONSE");
    return;
  case 0x89:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"AUTOADJUST_LENS_RESPONSE");
    return;
  case 0x8f:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_RECOGNITION_STATISTICS_RESPONSE");
    return;
  case 0xa1:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_LOGIN_RESPONSE");
    return;
  case 0xa7:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_SYSTEM_INFO_RESPONSE");
    return;
  case 0xad:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_GET_ENTRIES_COUNT_RESPONSE");
    return;
  case 0xae:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_GET_ENTRY_RESPONSE");
    return;
  case 0xaf:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"SA_MT_CNF_GET_LANGUAGE_RESPONSE");
    return;
  case 0xc0:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"ACK");
    return;
  case 0xc1:
    FUN_0041aa80(param_1,(char *)0x7fffffff,"NAK");
    return;
  }
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_00413110(void)

{
  int iVar1;
  DWORD DVar2;
  
  DVar2 = GetCurrentThreadId();
  if (DAT_0044b564 == DVar2) {
    _DAT_0044b568 = _DAT_0044b568 + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b56c);
    _DAT_0044b568 = 1;
    DAT_0044b564 = GetCurrentThreadId();
  }
  iVar1 = DAT_0044b520;
  DAT_0044b520 = DAT_0044b520 + 2;
  DVar2 = GetCurrentThreadId();
  if ((DAT_0044b564 == DVar2) && (_DAT_0044b568 = _DAT_0044b568 + -1, _DAT_0044b568 == 0)) {
    DAT_0044b564 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b56c);
  }
  return iVar1;
}



undefined4 *
FUN_00413190(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined param_4)

{
  byte *pbVar1;
  undefined *puVar2;
  byte *pbVar3;
  byte bVar4;
  int iVar5;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438148;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CNakMsg::vftable;
  *(undefined *)(param_1 + 3) = 1;
  puVar2 = (undefined *)operator_new(0x15);
  param_1[1] = puVar2;
  param_1[2] = 0x15;
  *puVar2 = 2;
  *(undefined4 *)(param_1[1] + 1) = param_3;
  *(undefined4 *)(param_1[1] + 5) = 0x15;
  *(undefined2 *)(param_1[1] + 9) = 0xc1;
  if ((DAT_0044c6b4 < 0) || (iVar5 = DAT_0044c6b4, DAT_0044cdbc <= DAT_0044c6b4)) {
    iVar5 = DAT_0044cdbc;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar5;
  *(undefined4 *)(param_1[1] + 0xd) = param_2;
  *(undefined *)(param_1[1] + 0x11) = param_4;
  *(undefined *)(param_1[1] + 0x12) = 0;
  *(undefined *)(param_1[1] + 0x14) = 3;
  pbVar1 = (byte *)param_1[1];
  bVar4 = *pbVar1;
  iVar5 = 3;
  pbVar3 = pbVar1 + 5;
  do {
    bVar4 = bVar4 ^ pbVar3[-4] ^ pbVar3[-3] ^ pbVar3[-2] ^ pbVar3[-1] ^ pbVar3[1] ^ *pbVar3;
    iVar5 = iVar5 + -1;
    pbVar3 = pbVar3 + 6;
  } while (iVar5 != 0);
  pbVar1[0x13] = bVar4;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * FUN_00413290(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438118;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_00411a40();
  local_4 = 0;
  *param_1 = CRecognitionStatisticsMsgR::vftable;
  FUN_0041ce60(param_1 + 5);
  *(undefined *)(param_1 + 3) = 1;
  if (param_1[2] != 0x27) {
    *(undefined *)((int)param_1 + 0xe) = 0;
  }
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_00413300(void *this,byte param_1)

{
  FUN_004134d0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



undefined4 *
FUN_00413320(undefined4 *param_1,void *param_2,size_t param_3,undefined4 param_4,undefined4 param_5,
            undefined4 param_6,undefined4 param_7,undefined4 param_8,undefined4 param_9,
            undefined4 param_10,undefined4 param_11,undefined4 param_12)

{
  byte *pbVar1;
  void *pvVar2;
  byte *pbVar3;
  byte bVar4;
  int iVar5;
  char *_Dst;
  size_t sVar6;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004387eb;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)(param_1 + 3) = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4._0_1_ = 1;
  local_4._1_3_ = 0;
  *param_1 = CRecognitionStatisticsMsgR::vftable;
  FUN_0041ce60(param_1 + 5);
  local_4 = CONCAT31(local_4._1_3_,2);
  *(undefined *)(param_1 + 3) = 1;
  pvVar2 = operator_new(0x27);
  param_1[1] = pvVar2;
  param_1[2] = 0x27;
  _Dst = (char *)0x0;
  sVar6 = 0;
  if (param_2 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_2,param_3);
    _Dst[param_3] = '\0';
    sVar6 = param_3;
  }
  FUN_0041cf50(param_1 + 5,_Dst,sVar6);
  param_1[10] = param_5;
  *(undefined *)param_1[1] = 2;
  *(undefined4 *)(param_1[1] + 1) = param_7;
  *(undefined4 *)(param_1[1] + 5) = 0x27;
  *(undefined2 *)(param_1[1] + 9) = 0x8f;
  if ((DAT_0044c6b4 < 0) || (iVar5 = DAT_0044c6b4, DAT_0044ccf4 <= DAT_0044c6b4)) {
    iVar5 = DAT_0044ccf4;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar5;
  *(undefined4 *)(param_1[1] + 0xd) = param_6;
  *(undefined4 *)(param_1[1] + 0x11) = param_8;
  *(undefined4 *)(param_1[1] + 0x15) = param_9;
  *(undefined4 *)(param_1[1] + 0x19) = param_10;
  *(undefined4 *)(param_1[1] + 0x1d) = param_11;
  *(undefined4 *)(param_1[1] + 0x21) = param_12;
  *(undefined *)(param_1[1] + 0x26) = 3;
  pbVar1 = (byte *)param_1[1];
  bVar4 = *pbVar1;
  iVar5 = 6;
  pbVar3 = pbVar1 + 5;
  do {
    bVar4 = pbVar3[-4] ^ pbVar3[-3] ^ pbVar3[-2] ^ pbVar3[-1] ^ pbVar3[1] ^ bVar4 ^ *pbVar3;
    iVar5 = iVar5 + -1;
    pbVar3 = pbVar3 + 6;
  } while (iVar5 != 0);
  local_4 = 0xffffffff;
  pbVar1[0x25] = bVar4;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return param_1;
}



void __fastcall FUN_004134d0(undefined4 *param_1)

{
  void *pvVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438268;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = CRecognitionStatisticsMsgR::vftable;
  local_4 = 0;
  param_1[5] = aIpAddr::vftable;
  if ((void *)param_1[6] != (void *)0x0) {
    free((void *)param_1[6]);
  }
  pvVar1 = (void *)param_1[1];
  *param_1 = CMsg::vftable;
  if (pvVar1 != (void *)0x0) {
    if (*(char *)((int)param_1 + 0xd) == '\0') {
      operator_delete(pvVar1);
    }
    else {
      operator_delete__(pvVar1);
    }
    param_1[1] = 0;
  }
  ExceptionList = local_c;
  return;
}



undefined4 * __thiscall
FUN_00413560(void *this,undefined4 *param_1,int param_2,undefined4 param_3,undefined param_4,
            undefined param_5,undefined param_6)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  undefined *puVar4;
  uint uVar5;
  byte bVar6;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438148;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CStatusMsgR::vftable;
  *(undefined *)(param_1 + 3) = 1;
  if (param_2 == 1) {
    puVar4 = (undefined *)operator_new(0x19);
    param_1[1] = puVar4;
    param_1[2] = 0x19;
    *puVar4 = 2;
    *(void **)(param_1[1] + 1) = this;
    *(undefined4 *)(param_1[1] + 5) = 0x19;
    *(undefined2 *)(param_1[1] + 9) = 0x84;
    *(undefined2 *)(param_1[1] + 0xb) = 1;
    *(undefined4 *)(param_1[1] + 0xd) = param_3;
    *(undefined *)(param_1[1] + 0x11) = param_4;
    *(undefined *)(param_1[1] + 0x12) = param_5;
    *(undefined *)(param_1[1] + 0x13) = param_6;
    *(undefined *)(param_1[1] + 0x14) = 1;
    *(undefined2 *)(param_1[1] + 0x15) = 0x23;
    *(undefined *)(param_1[1] + 0x18) = 3;
    pbVar3 = (byte *)param_1[1];
    bVar6 = *pbVar3;
    uVar5 = 1;
    do {
      iVar2 = uVar5 + 1;
      pbVar1 = pbVar3 + uVar5;
      uVar5 = uVar5 + 2;
      bVar6 = bVar6 ^ pbVar3[iVar2] ^ *pbVar1;
    } while (uVar5 < 0x17);
    pbVar3[0x17] = bVar6;
  }
  else {
    puVar4 = (undefined *)operator_new(0x16);
    param_1[1] = puVar4;
    param_1[2] = 0x16;
    *puVar4 = 2;
    *(void **)(param_1[1] + 1) = this;
    *(undefined4 *)(param_1[1] + 5) = 0x16;
    *(undefined2 *)(param_1[1] + 9) = 0x84;
    *(undefined2 *)(param_1[1] + 0xb) = (undefined2)param_2;
    *(undefined4 *)(param_1[1] + 0xd) = param_3;
    *(undefined *)(param_1[1] + 0x11) = param_4;
    *(undefined *)(param_1[1] + 0x12) = param_5;
    *(undefined *)(param_1[1] + 0x13) = param_6;
    *(undefined *)(param_1[1] + 0x15) = 3;
    pbVar3 = (byte *)param_1[1];
    bVar6 = *pbVar3;
    uVar5 = 1;
    do {
      bVar6 = bVar6 ^ pbVar3[uVar5];
      uVar5 = uVar5 + 1;
    } while (uVar5 < 0x14);
    pbVar3[0x14] = bVar6;
  }
  ExceptionList = local_c;
  return param_1;
}



undefined4 * FUN_004136e0(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  byte *pbVar1;
  undefined *puVar2;
  byte *pbVar3;
  byte bVar4;
  int iVar5;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438148;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CAckMsg::vftable;
  *(undefined *)(param_1 + 3) = 1;
  puVar2 = (undefined *)operator_new(0x13);
  param_1[1] = puVar2;
  param_1[2] = 0x13;
  *puVar2 = 2;
  *(undefined4 *)(param_1[1] + 1) = param_3;
  *(undefined4 *)(param_1[1] + 5) = 0x13;
  *(undefined2 *)(param_1[1] + 9) = 0xc0;
  if ((DAT_0044c6b4 < 0) || (iVar5 = DAT_0044c6b4, DAT_0044cdb8 <= DAT_0044c6b4)) {
    iVar5 = DAT_0044cdb8;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar5;
  *(undefined4 *)(param_1[1] + 0xd) = param_2;
  *(undefined *)(param_1[1] + 0x12) = 3;
  pbVar1 = (byte *)param_1[1];
  bVar4 = *pbVar1;
  iVar5 = 4;
  pbVar3 = pbVar1 + 3;
  do {
    bVar4 = bVar4 ^ pbVar3[-2] ^ pbVar3[-1] ^ pbVar3[1] ^ *pbVar3;
    iVar5 = iVar5 + -1;
    pbVar3 = pbVar3 + 4;
  } while (iVar5 != 0);
  pbVar1[0x11] = bVar4;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_004137d0(void *this,undefined4 *param_1,undefined4 param_2)

{
  char cVar1;
  undefined uVar2;
  uint uVar3;
  undefined *puVar4;
  int iVar5;
  undefined4 uVar6;
  char **ppcVar7;
  undefined4 *puVar8;
  byte *pbVar9;
  byte **ppbVar10;
  byte bVar11;
  char *pcVar12;
  byte *pbVar13;
  char *pcVar14;
  void *unaff_EBX;
  void *unaff_EBP;
  undefined2 in_FPUControlWord;
  void *pvStack_30;
  void *pvStack_2c;
  void *pvStack_28;
  void *pvStack_24;
  void *pvStack_20;
  void *pvStack_1c;
  undefined auStack_18 [4];
  undefined uStack_14;
  undefined uStack_10;
  undefined4 local_c;
  undefined4 uStack_8;
  undefined4 local_4;
  
  uStack_8 = &LAB_00438238;
  local_c = ExceptionList;
  uVar3 = DAT_0044a01c ^ (uint)&stack0xffffffc0;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)(param_1 + 3) = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CLicenseInfoMsgE::vftable;
  iVar5 = DAT_0044cac0;
  if ((-1 < DAT_0044c6b4) && (DAT_0044c6b4 < DAT_0044cac0)) {
    iVar5 = DAT_0044c6b4;
  }
  if (iVar5 == 2) {
    puVar4 = (undefined *)operator_new(0xbc);
    param_1[1] = puVar4;
    param_1[2] = 0xbc;
    *puVar4 = 2;
    *(undefined4 *)(param_1[1] + 1) = param_2;
    *(undefined4 *)(param_1[1] + 5) = 0xbc;
    *(undefined2 *)(param_1[1] + 9) = 2;
    *(undefined2 *)(param_1[1] + 0xb) = 2;
    iVar5 = FUN_00413110();
    *(int *)(param_1[1] + 0xd) = iVar5;
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x78))();
    *(undefined4 *)(param_1[1] + 0x11) = uVar6;
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x80))();
    *(undefined4 *)(param_1[1] + 0x19) = uVar6;
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x88))();
    *(undefined4 *)(param_1[1] + 0x1d) = uVar6;
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x9a) = 0;
    *(undefined4 *)(iVar5 + 0x9e) = 0;
    *(undefined4 *)(iVar5 + 0xa2) = 0;
    *(undefined4 *)(iVar5 + 0xa6) = 0;
    *(undefined4 *)(iVar5 + 0xaa) = 0;
    *(undefined4 *)(iVar5 + 0xae) = 0;
    *(undefined4 *)(iVar5 + 0xb2) = 0;
    *(undefined4 *)(iVar5 + 0xb6) = 0;
                    // WARNING: Load size is inaccurate
    ppcVar7 = (char **)(**(code **)(*this + 0x2c))(&pvStack_24);
    pcVar14 = &DAT_0044d0d5;
    if (*ppcVar7 != (char *)0x0) {
      pcVar14 = *ppcVar7;
    }
    pcVar12 = (char *)(param_1[1] + 0x9a);
    do {
      cVar1 = *pcVar14;
      *pcVar12 = cVar1;
      pcVar14 = pcVar14 + 1;
      pcVar12 = pcVar12 + 1;
    } while (cVar1 != '\0');
    if (pvStack_28 != (void *)0x0) {
      free(pvStack_28);
    }
                    // WARNING: Load size is inaccurate
    uVar2 = (**(code **)(*this + 0x24))();
    *(undefined *)(param_1[1] + 0x71) = uVar2;
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x21) = 0;
    *(undefined4 *)(iVar5 + 0x25) = 0;
    *(undefined4 *)(iVar5 + 0x29) = 0;
    *(undefined4 *)(iVar5 + 0x2d) = 0;
    *(undefined4 *)(iVar5 + 0x31) = 0;
    *(undefined4 *)(iVar5 + 0x35) = 0;
    *(undefined4 *)(iVar5 + 0x39) = 0;
    *(undefined4 *)(iVar5 + 0x3d) = 0;
    *(undefined4 *)(iVar5 + 0x41) = 0;
    *(undefined4 *)(iVar5 + 0x45) = 0;
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x72) = 0;
    *(undefined4 *)(iVar5 + 0x76) = 0;
    *(undefined4 *)(iVar5 + 0x7a) = 0;
    *(undefined4 *)(iVar5 + 0x7e) = 0;
    *(undefined4 *)(iVar5 + 0x82) = 0;
    *(undefined4 *)(iVar5 + 0x86) = 0;
    *(undefined4 *)(iVar5 + 0x8a) = 0;
    *(undefined4 *)(iVar5 + 0x8e) = 0;
    *(undefined4 *)(iVar5 + 0x92) = 0;
    *(undefined4 *)(iVar5 + 0x96) = 0;
                    // WARNING: Load size is inaccurate
    (**(code **)(*this + 0x3c))(&pvStack_1c);
    local_c = (void *)CONCAT31(local_c._1_3_,1);
                    // WARNING: Load size is inaccurate
    ppcVar7 = (char **)(**(code **)(*this + 0x14))(&pvStack_2c);
    uStack_10 = 2;
    pcVar14 = *ppcVar7;
    if (pcVar14 == (char *)0x0) {
      pcVar14 = &DAT_0044d0d5;
    }
    FUN_004155c0(pcVar14,(undefined4 *)(param_1[1] + 0x21),0x28);
    uStack_10 = 1;
    if (pvStack_30 != (void *)0x0) {
      free(pvStack_30);
    }
    uStack_10 = 0;
    if (pvStack_24 != (void *)0x0) {
      free(pvStack_24);
    }
                    // WARNING: Load size is inaccurate
    (**(code **)(*this + 0x3c))(&pvStack_30);
    uStack_14 = 3;
                    // WARNING: Load size is inaccurate
    ppcVar7 = (char **)(**(code **)(*this + 0x1c))(&pvStack_28);
    auStack_18[0] = 4;
    pcVar14 = *ppcVar7;
    if (pcVar14 == (char *)0x0) {
      pcVar14 = &DAT_0044d0d5;
    }
    FUN_004155c0(pcVar14,(undefined4 *)(param_1[1] + 0x72),0x28);
    auStack_18[0] = 3;
    if (pvStack_2c != (void *)0x0) {
      free(pvStack_2c);
    }
    auStack_18[0] = 0;
    if (unaff_EBP != (void *)0x0) {
      free(unaff_EBP);
    }
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x49) = 0;
    *(undefined4 *)(iVar5 + 0x4d) = 0;
    *(undefined4 *)(iVar5 + 0x51) = 0;
    *(undefined4 *)(iVar5 + 0x55) = 0;
    *(undefined4 *)(iVar5 + 0x59) = 0;
    *(undefined4 *)(iVar5 + 0x5d) = 0;
    *(undefined4 *)(iVar5 + 0x61) = 0;
    *(undefined4 *)(iVar5 + 0x65) = 0;
    *(undefined4 *)(iVar5 + 0x69) = 0;
    *(undefined4 *)(iVar5 + 0x6d) = 0;
                    // WARNING: Load size is inaccurate
    iVar5 = (**(code **)(*this + 0x54))();
    puVar8 = (undefined4 *)FUN_0040e220(iVar5);
    iVar5 = 0;
    for (puVar8 = (undefined4 *)*puVar8; puVar8 != (undefined4 *)0x0; puVar8 = (undefined4 *)*puVar8
        ) {
      uVar3 = (uint)local_c >> 0x10;
      local_c = (void *)CONCAT22((short)uVar3,in_FPUControlWord);
      *(char *)(iVar5 + 0x49 + param_1[1]) = (char)(int)ROUND(*(double *)(puVar8 + 2) * 100.0 + 0.5)
      ;
      iVar5 = iVar5 + 1;
    }
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x68))();
    *(undefined4 *)(param_1[1] + 0x15) = uVar6;
    *(undefined *)(param_1[1] + 0xbb) = 3;
    pbVar13 = (byte *)param_1[1];
    bVar11 = *pbVar13;
    iVar5 = 0x25;
    pbVar9 = pbVar13 + 4;
    do {
      bVar11 = bVar11 ^ pbVar9[-3] ^ pbVar9[-2] ^ pbVar9[-1] ^ pbVar9[1] ^ *pbVar9;
      iVar5 = iVar5 + -1;
      pbVar9 = pbVar9 + 5;
    } while (iVar5 != 0);
    pbVar13[0xba] = bVar11;
  }
  else if (iVar5 == 1) {
    puVar4 = (undefined *)operator_new(0x80);
    param_1[1] = puVar4;
    param_1[2] = 0x80;
    *puVar4 = 2;
    *(undefined4 *)(param_1[1] + 1) = param_2;
    *(undefined4 *)(param_1[1] + 5) = 0x80;
    *(undefined2 *)(param_1[1] + 9) = 2;
    *(undefined2 *)(param_1[1] + 0xb) = 1;
    iVar5 = FUN_00413110();
    *(int *)(param_1[1] + 0xd) = iVar5;
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x78))();
    *(undefined4 *)(param_1[1] + 0x11) = uVar6;
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x80))();
    *(undefined4 *)(param_1[1] + 0x19) = uVar6;
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x88))();
    *(undefined4 *)(param_1[1] + 0x1d) = uVar6;
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x5e) = 0;
    *(undefined4 *)(iVar5 + 0x62) = 0;
    *(undefined4 *)(iVar5 + 0x66) = 0;
    *(undefined4 *)(iVar5 + 0x6a) = 0;
    *(undefined4 *)(iVar5 + 0x6e) = 0;
    *(undefined4 *)(iVar5 + 0x72) = 0;
    *(undefined4 *)(iVar5 + 0x76) = 0;
    *(undefined4 *)(iVar5 + 0x7a) = 0;
                    // WARNING: Load size is inaccurate
    ppcVar7 = (char **)(**(code **)(*this + 0x2c))(auStack_18);
    pcVar14 = &DAT_0044d0d5;
    if (*ppcVar7 != (char *)0x0) {
      pcVar14 = *ppcVar7;
    }
    pcVar12 = (char *)(param_1[1] + 0x5e);
    do {
      cVar1 = *pcVar14;
      *pcVar12 = cVar1;
      pcVar14 = pcVar14 + 1;
      pcVar12 = pcVar12 + 1;
    } while (cVar1 != '\0');
    if (pvStack_1c != (void *)0x0) {
      free(pvStack_1c);
    }
                    // WARNING: Load size is inaccurate
    uVar2 = (**(code **)(*this + 0x24))();
    *(undefined *)(param_1[1] + 0x49) = uVar2;
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x21) = 0;
    *(undefined4 *)(iVar5 + 0x25) = 0;
    *(undefined4 *)(iVar5 + 0x29) = 0;
    *(undefined4 *)(iVar5 + 0x2d) = 0;
    *(undefined4 *)(iVar5 + 0x31) = 0;
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x4a) = 0;
    *(undefined4 *)(iVar5 + 0x4e) = 0;
    *(undefined4 *)(iVar5 + 0x52) = 0;
    *(undefined4 *)(iVar5 + 0x56) = 0;
    *(undefined4 *)(iVar5 + 0x5a) = 0;
    ppbVar10 = (byte **)FUN_0041aa80(0,(char *)0x7fffffff,(char *)&DAT_0043b7b8);
    uStack_8 = (undefined *)CONCAT31(uStack_8._1_3_,5);
                    // WARNING: Load size is inaccurate
    (**(code **)(*this + 0x3c))(&pvStack_1c);
    pbVar13 = *ppbVar10;
    if (pbVar13 == (byte *)0x0) {
      pbVar13 = &DAT_0044d0d5;
    }
    iVar5 = FUN_0041ab00(pbVar13);
    if (pvStack_20 != (void *)0x0) {
      free(pvStack_20);
    }
    local_c = (void *)((uint)local_c & 0xffffff00);
    if (pvStack_2c != (void *)0x0) {
      free(pvStack_2c);
    }
    if (iVar5 == 0) {
                    // WARNING: Load size is inaccurate
      (**(code **)(*this + 0x14))(&pvStack_20);
      uStack_10 = 6;
      FUN_004156f0((undefined *)(param_1[1] + 0x21));
      uStack_10 = 0;
      if (pvStack_24 != (void *)0x0) {
        free(pvStack_24);
      }
                    // WARNING: Load size is inaccurate
      (**(code **)(*this + 0x1c))(&pvStack_24);
      uStack_14 = 7;
      FUN_004156f0((undefined *)(param_1[1] + 0x4a));
      unaff_EBX = pvStack_28;
    }
    else {
                    // WARNING: Load size is inaccurate
      (**(code **)(*this + 0x3c))(&pvStack_2c);
      uStack_10 = 8;
                    // WARNING: Load size is inaccurate
      ppcVar7 = (char **)(**(code **)(*this + 0x14))(&pvStack_24);
      uStack_14 = 9;
      pcVar14 = *ppcVar7;
      if (pcVar14 == (char *)0x0) {
        pcVar14 = &DAT_0044d0d5;
      }
      FUN_004158f0(&DAT_0043c0ac,pcVar14,(void *)(param_1[1] + 0x21),0x14);
      uStack_14 = 8;
      if (pvStack_28 != (void *)0x0) {
        free(pvStack_28);
      }
      uStack_14 = 0;
      if (unaff_EBX != (void *)0x0) {
        free(unaff_EBX);
      }
                    // WARNING: Load size is inaccurate
      (**(code **)(*this + 0x3c))(&stack0xffffffcc);
      auStack_18[0] = 10;
                    // WARNING: Load size is inaccurate
      ppcVar7 = (char **)(**(code **)(*this + 0x1c))(&pvStack_2c);
      uStack_14 = 0xb;
      pcVar14 = *ppcVar7;
      if (pcVar14 == (char *)0x0) {
        pcVar14 = &DAT_0044d0d5;
      }
      FUN_004158f0(&DAT_0043c0ac,pcVar14,(void *)(param_1[1] + 0x4a),0x14);
      uStack_14 = 10;
      if (pvStack_28 != (void *)0x0) {
        free(pvStack_28);
      }
    }
    uStack_14 = 0;
    if (unaff_EBX != (void *)0x0) {
      free(unaff_EBX);
    }
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x35) = 0;
    *(undefined4 *)(iVar5 + 0x39) = 0;
    *(undefined4 *)(iVar5 + 0x3d) = 0;
    *(undefined4 *)(iVar5 + 0x41) = 0;
    *(undefined4 *)(iVar5 + 0x45) = 0;
                    // WARNING: Load size is inaccurate
    iVar5 = (**(code **)(*this + 0x54))();
    puVar8 = (undefined4 *)FUN_0040e220(iVar5);
    iVar5 = 0;
    for (puVar8 = (undefined4 *)*puVar8; puVar8 != (undefined4 *)0x0; puVar8 = (undefined4 *)*puVar8
        ) {
      uStack_8._2_2_ = (undefined2)((uint)uStack_8 >> 0x10);
      uStack_8 = (undefined *)CONCAT22(uStack_8._2_2_,in_FPUControlWord);
      iVar5 = iVar5 + 1;
      *(char *)(param_1[1] + 0x34 + iVar5) = (char)(int)ROUND(*(double *)(puVar8 + 2) * 100.0);
    }
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x68))();
    *(undefined4 *)(param_1[1] + 0x15) = uVar6;
    *(undefined *)(param_1[1] + 0x7f) = 3;
    pbVar13 = (byte *)param_1[1];
    bVar11 = *pbVar13;
    iVar5 = 0x19;
    pbVar9 = pbVar13 + 4;
    do {
      bVar11 = pbVar9[-3] ^ pbVar9[-2] ^ pbVar9[-1] ^ pbVar9[1] ^ bVar11 ^ *pbVar9;
      iVar5 = iVar5 + -1;
      pbVar9 = pbVar9 + 5;
    } while (iVar5 != 0);
    pbVar13[0x7e] = bVar11;
  }
  else {
    puVar4 = (undefined *)operator_new(0x7c);
    param_1[1] = puVar4;
    param_1[2] = 0x7c;
    *puVar4 = 2;
    *(undefined4 *)(param_1[1] + 1) = param_2;
    *(undefined4 *)(param_1[1] + 5) = 0x7c;
    *(undefined2 *)(param_1[1] + 9) = 2;
    *(short *)(param_1[1] + 0xb) = (short)iVar5;
    iVar5 = FUN_00413110();
    *(int *)(param_1[1] + 0xd) = iVar5;
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x78))(uVar3);
    *(undefined4 *)(param_1[1] + 0x11) = uVar6;
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x80))();
    *(undefined4 *)(param_1[1] + 0x19) = uVar6;
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x5a) = 0;
    *(undefined4 *)(iVar5 + 0x5e) = 0;
    *(undefined4 *)(iVar5 + 0x62) = 0;
    *(undefined4 *)(iVar5 + 0x66) = 0;
    *(undefined4 *)(iVar5 + 0x6a) = 0;
    *(undefined4 *)(iVar5 + 0x6e) = 0;
    *(undefined4 *)(iVar5 + 0x72) = 0;
    *(undefined4 *)(iVar5 + 0x76) = 0;
                    // WARNING: Load size is inaccurate
    ppcVar7 = (char **)(**(code **)(*this + 0x2c))(auStack_18);
    pcVar14 = &DAT_0044d0d5;
    if (*ppcVar7 != (char *)0x0) {
      pcVar14 = *ppcVar7;
    }
    pcVar12 = (char *)(param_1[1] + 0x5a);
    do {
      cVar1 = *pcVar14;
      *pcVar12 = cVar1;
      pcVar14 = pcVar14 + 1;
      pcVar12 = pcVar12 + 1;
    } while (cVar1 != '\0');
    if (pvStack_1c != (void *)0x0) {
      free(pvStack_1c);
    }
                    // WARNING: Load size is inaccurate
    uVar2 = (**(code **)(*this + 0x24))();
    *(undefined *)(param_1[1] + 0x45) = uVar2;
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x1d) = 0;
    *(undefined4 *)(iVar5 + 0x21) = 0;
    *(undefined4 *)(iVar5 + 0x25) = 0;
    *(undefined4 *)(iVar5 + 0x29) = 0;
    *(undefined4 *)(iVar5 + 0x2d) = 0;
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x46) = 0;
    *(undefined4 *)(iVar5 + 0x4a) = 0;
    *(undefined4 *)(iVar5 + 0x4e) = 0;
    *(undefined4 *)(iVar5 + 0x52) = 0;
    *(undefined4 *)(iVar5 + 0x56) = 0;
    ppbVar10 = (byte **)FUN_0041aa80(0,(char *)0x7fffffff,(char *)&DAT_0043b7b8);
    uStack_8 = (undefined *)CONCAT31(uStack_8._1_3_,0xc);
                    // WARNING: Load size is inaccurate
    (**(code **)(*this + 0x3c))(&pvStack_1c);
    pbVar13 = *ppbVar10;
    if (pbVar13 == (byte *)0x0) {
      pbVar13 = &DAT_0044d0d5;
    }
    iVar5 = FUN_0041ab00(pbVar13);
    if (pvStack_20 != (void *)0x0) {
      free(pvStack_20);
    }
    local_c = (void *)((uint)local_c & 0xffffff00);
    if (pvStack_2c != (void *)0x0) {
      free(pvStack_2c);
    }
    if (iVar5 == 0) {
                    // WARNING: Load size is inaccurate
      (**(code **)(*this + 0x14))(&pvStack_20);
      uStack_10 = 0xd;
      FUN_004156f0((undefined *)(param_1[1] + 0x1d));
      uStack_10 = 0;
      if (pvStack_24 != (void *)0x0) {
        free(pvStack_24);
      }
                    // WARNING: Load size is inaccurate
      (**(code **)(*this + 0x1c))(&pvStack_24);
      uStack_14 = 0xe;
      FUN_004156f0((undefined *)(param_1[1] + 0x46));
      unaff_EBX = pvStack_28;
    }
    else {
                    // WARNING: Load size is inaccurate
      (**(code **)(*this + 0x3c))(&pvStack_2c);
      uStack_10 = 0xf;
                    // WARNING: Load size is inaccurate
      ppcVar7 = (char **)(**(code **)(*this + 0x14))(&pvStack_24);
      uStack_14 = 0x10;
      pcVar14 = *ppcVar7;
      if (pcVar14 == (char *)0x0) {
        pcVar14 = &DAT_0044d0d5;
      }
      FUN_004158f0(&DAT_0043c0ac,pcVar14,(void *)(param_1[1] + 0x1d),0x14);
      uStack_14 = 0xf;
      if (pvStack_28 != (void *)0x0) {
        free(pvStack_28);
      }
      uStack_14 = 0;
      if (unaff_EBX != (void *)0x0) {
        free(unaff_EBX);
      }
                    // WARNING: Load size is inaccurate
      (**(code **)(*this + 0x3c))(&stack0xffffffcc);
      auStack_18[0] = 0x11;
                    // WARNING: Load size is inaccurate
      ppcVar7 = (char **)(**(code **)(*this + 0x1c))(&pvStack_2c);
      uStack_14 = 0x12;
      pcVar14 = *ppcVar7;
      if (pcVar14 == (char *)0x0) {
        pcVar14 = &DAT_0044d0d5;
      }
      FUN_004158f0(&DAT_0043c0ac,pcVar14,(void *)(param_1[1] + 0x46),0x14);
      uStack_14 = 0x11;
      if (pvStack_28 != (void *)0x0) {
        free(pvStack_28);
      }
    }
    uStack_14 = 0;
    if (unaff_EBX != (void *)0x0) {
      free(unaff_EBX);
    }
    iVar5 = param_1[1];
    *(undefined4 *)(iVar5 + 0x31) = 0;
    *(undefined4 *)(iVar5 + 0x35) = 0;
    *(undefined4 *)(iVar5 + 0x39) = 0;
    *(undefined4 *)(iVar5 + 0x3d) = 0;
    *(undefined4 *)(iVar5 + 0x41) = 0;
                    // WARNING: Load size is inaccurate
    iVar5 = (**(code **)(*this + 0x54))();
    puVar8 = (undefined4 *)FUN_0040e220(iVar5);
    iVar5 = 0;
    for (puVar8 = (undefined4 *)*puVar8; puVar8 != (undefined4 *)0x0; puVar8 = (undefined4 *)*puVar8
        ) {
      uStack_8._2_2_ = (undefined2)((uint)uStack_8 >> 0x10);
      uStack_8 = (undefined *)CONCAT22(uStack_8._2_2_,in_FPUControlWord);
      iVar5 = iVar5 + 1;
      *(char *)(param_1[1] + 0x30 + iVar5) = (char)(int)ROUND(*(double *)(puVar8 + 2) * 100.0);
    }
                    // WARNING: Load size is inaccurate
    uVar6 = (**(code **)(*this + 0x68))();
    *(undefined4 *)(param_1[1] + 0x15) = uVar6;
    *(undefined *)(param_1[1] + 0x7b) = 3;
    pbVar13 = (byte *)param_1[1];
    bVar11 = *pbVar13;
    uVar3 = 1;
    do {
      bVar11 = bVar11 ^ pbVar13[uVar3];
      uVar3 = uVar3 + 1;
    } while (uVar3 < 0x7a);
    pbVar13[0x7a] = bVar11;
  }
  ExceptionList = pvStack_20;
  return param_1;
}



undefined4 __fastcall FUN_004142c0(int param_1)

{
  byte *pbVar1;
  undefined4 uVar2;
  byte bVar3;
  uint uVar4;
  byte *pbVar5;
  undefined3 uVar7;
  uint uVar6;
  int iVar8;
  byte *pbVar9;
  undefined4 *puVar10;
  undefined4 *puVar11;
  
  uVar4 = (uint)*(ushort *)(*(int *)(param_1 + 4) + 9);
  uVar6 = uVar4 * 4;
  if ((&DAT_0044cab8)[uVar4] == *(int *)(&DAT_0044c6b8 + uVar6)) {
    return uVar6 & 0xffffff00;
  }
  (&DAT_0044cab8)[*(ushort *)(*(int *)(param_1 + 4) + 9)] =
       (&DAT_0044cab8)[*(ushort *)(*(int *)(param_1 + 4) + 9)] + -1;
  if (((int)DAT_0044c6b4 < 0) || (uVar6 = DAT_0044c6b4, (int)DAT_0044cac0 <= (int)DAT_0044c6b4)) {
    uVar6 = DAT_0044cac0;
  }
  if (uVar6 == 1) {
    pbVar1 = *(byte **)(param_1 + 4);
    pbVar5 = (byte *)operator_new(0x80);
    *(undefined4 *)(param_1 + 8) = 0x80;
    *pbVar5 = *pbVar1;
    *(undefined4 *)(pbVar5 + 1) = *(undefined4 *)(pbVar1 + 1);
    *(undefined4 *)(pbVar5 + 5) = 0x80;
    *(undefined2 *)(pbVar5 + 9) = *(undefined2 *)(pbVar1 + 9);
    *(undefined2 *)(pbVar5 + 0xb) = 1;
    *(undefined4 *)(pbVar5 + 0xd) = *(undefined4 *)(pbVar1 + 0xd);
    *(undefined4 *)(pbVar5 + 0x11) = *(undefined4 *)(pbVar1 + 0x11);
    *(undefined4 *)(pbVar5 + 0x19) = *(undefined4 *)(pbVar1 + 0x19);
    *(undefined4 *)(pbVar5 + 0x1d) = *(undefined4 *)(pbVar1 + 0x1d);
    puVar10 = (undefined4 *)(pbVar1 + 0x9a);
    puVar11 = (undefined4 *)(pbVar5 + 0x5e);
    for (iVar8 = 8; iVar8 != 0; iVar8 = iVar8 + -1) {
      *puVar11 = *puVar10;
      puVar10 = puVar10 + 1;
      puVar11 = puVar11 + 1;
    }
    FUN_004158f0(&DAT_0043c0ac,(char *)(pbVar1 + 0x21),pbVar5 + 0x21,0x14);
    pbVar5[0x49] = pbVar1[0x71];
    FUN_004158f0(&DAT_0043c0ac,(char *)(pbVar1 + 0x72),pbVar5 + 0x4a,0x14);
    *(undefined4 *)(pbVar5 + 0x35) = *(undefined4 *)(pbVar1 + 0x49);
    *(undefined4 *)(pbVar5 + 0x39) = *(undefined4 *)(pbVar1 + 0x4d);
    *(undefined4 *)(pbVar5 + 0x3d) = *(undefined4 *)(pbVar1 + 0x51);
    *(undefined4 *)(pbVar5 + 0x41) = *(undefined4 *)(pbVar1 + 0x55);
    *(undefined4 *)(pbVar5 + 0x45) = *(undefined4 *)(pbVar1 + 0x59);
    *(undefined4 *)(pbVar5 + 0x15) = *(undefined4 *)(pbVar1 + 0x15);
    pbVar5[0x7f] = pbVar1[0xbb];
    bVar3 = *pbVar5;
    uVar7 = 0;
    iVar8 = 0x19;
    pbVar9 = pbVar5 + 4;
    do {
      bVar3 = bVar3 ^ pbVar9[-3] ^ pbVar9[-2] ^ pbVar9[-1] ^ pbVar9[1] ^ *pbVar9;
      iVar8 = iVar8 + -1;
      pbVar9 = pbVar9 + 5;
    } while (iVar8 != 0);
    pbVar5[0x7e] = bVar3;
    operator_delete(pbVar1);
    *(byte **)(param_1 + 4) = pbVar5;
    return CONCAT31(uVar7,1);
  }
  if (uVar6 == 0) {
    pbVar1 = *(byte **)(param_1 + 4);
    pbVar5 = (byte *)operator_new(0x7c);
    *(undefined4 *)(param_1 + 8) = 0x7c;
    *pbVar5 = *pbVar1;
    uVar2 = *(undefined4 *)(pbVar1 + 1);
    *(undefined4 *)(pbVar5 + 5) = 0x7c;
    *(undefined4 *)(pbVar5 + 1) = uVar2;
    *(undefined2 *)(pbVar5 + 9) = *(undefined2 *)(pbVar1 + 9);
    *(undefined2 *)(pbVar5 + 0xb) = 0;
    *(undefined4 *)(pbVar5 + 0xd) = *(undefined4 *)(pbVar1 + 0xd);
    *(undefined4 *)(pbVar5 + 0x11) = *(undefined4 *)(pbVar1 + 0x11);
    *(undefined4 *)(pbVar5 + 0x19) = *(undefined4 *)(pbVar1 + 0x19);
    puVar10 = (undefined4 *)(pbVar1 + 0x5e);
    puVar11 = (undefined4 *)(pbVar5 + 0x5a);
    for (iVar8 = 8; iVar8 != 0; iVar8 = iVar8 + -1) {
      *puVar11 = *puVar10;
      puVar10 = puVar10 + 1;
      puVar11 = puVar11 + 1;
    }
    *(undefined4 *)(pbVar5 + 0x1d) = *(undefined4 *)(pbVar1 + 0x21);
    *(undefined4 *)(pbVar5 + 0x21) = *(undefined4 *)(pbVar1 + 0x25);
    *(undefined4 *)(pbVar5 + 0x25) = *(undefined4 *)(pbVar1 + 0x29);
    *(undefined4 *)(pbVar5 + 0x29) = *(undefined4 *)(pbVar1 + 0x2d);
    *(undefined4 *)(pbVar5 + 0x2d) = *(undefined4 *)(pbVar1 + 0x31);
    pbVar5[0x45] = pbVar1[0x49];
    *(undefined4 *)(pbVar5 + 0x46) = *(undefined4 *)(pbVar1 + 0x4a);
    *(undefined4 *)(pbVar5 + 0x4a) = *(undefined4 *)(pbVar1 + 0x4e);
    *(undefined4 *)(pbVar5 + 0x4e) = *(undefined4 *)(pbVar1 + 0x52);
    *(undefined4 *)(pbVar5 + 0x52) = *(undefined4 *)(pbVar1 + 0x56);
    *(undefined4 *)(pbVar5 + 0x56) = *(undefined4 *)(pbVar1 + 0x5a);
    *(undefined4 *)(pbVar5 + 0x31) = *(undefined4 *)(pbVar1 + 0x35);
    *(undefined4 *)(pbVar5 + 0x35) = *(undefined4 *)(pbVar1 + 0x39);
    *(undefined4 *)(pbVar5 + 0x39) = *(undefined4 *)(pbVar1 + 0x3d);
    *(undefined4 *)(pbVar5 + 0x3d) = *(undefined4 *)(pbVar1 + 0x41);
    *(undefined4 *)(pbVar5 + 0x41) = *(undefined4 *)(pbVar1 + 0x45);
    bVar3 = *pbVar5;
    *(undefined4 *)(pbVar5 + 0x15) = *(undefined4 *)(pbVar1 + 0x15);
    pbVar5[0x7b] = pbVar1[0x7f];
    uVar6 = 1;
    do {
      bVar3 = bVar3 ^ pbVar5[uVar6];
      uVar6 = uVar6 + 1;
    } while (uVar6 < 0x7a);
    pbVar5[0x7a] = bVar3;
    operator_delete(pbVar1);
    *(byte **)(param_1 + 4) = pbVar5;
    return CONCAT31((int3)(uVar6 >> 8),1);
  }
  return uVar6 & 0xffffff00;
}



undefined4 *
FUN_00414520(undefined4 *param_1,undefined4 param_2,undefined4 param_3,char *param_4,
            undefined4 param_5,undefined4 param_6,undefined param_7,undefined param_8,
            undefined param_9)

{
  char cVar1;
  byte *pbVar2;
  undefined *puVar3;
  int iVar4;
  uint uVar5;
  byte bVar6;
  char *pcVar7;
  char *pcVar8;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438180;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 1;
  *param_1 = CVersionMsgR::vftable;
  *(undefined *)(param_1 + 3) = 1;
  puVar3 = (undefined *)operator_new(0x56);
  param_1[1] = puVar3;
  param_1[2] = 0x56;
  *puVar3 = 2;
  *(undefined4 *)(param_1[1] + 1) = param_3;
  *(undefined4 *)(param_1[1] + 5) = 0x56;
  *(undefined2 *)(param_1[1] + 9) = 0x80;
  if ((DAT_0044c6b4 < 0) || (iVar4 = DAT_0044c6b4, DAT_0044ccb8 <= DAT_0044c6b4)) {
    iVar4 = DAT_0044ccb8;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar4;
  *(undefined4 *)(param_1[1] + 0xd) = param_2;
  memset((void *)(param_1[1] + 0x11),0,0x40);
  pcVar8 = &DAT_0044d0d5;
  if (param_4 != (char *)0x0) {
    pcVar8 = param_4;
  }
  pcVar7 = (char *)(param_1[1] + 0x11);
  do {
    cVar1 = *pcVar8;
    *pcVar7 = cVar1;
    pcVar8 = pcVar8 + 1;
    pcVar7 = pcVar7 + 1;
  } while (cVar1 != '\0');
  *(undefined *)(param_1[1] + 0x51) = param_7;
  *(undefined *)(param_1[1] + 0x52) = param_8;
  *(undefined *)(param_1[1] + 0x53) = param_9;
  *(undefined *)(param_1[1] + 0x55) = 3;
  pbVar2 = (byte *)param_1[1];
  bVar6 = *pbVar2;
  uVar5 = 1;
  do {
    bVar6 = bVar6 ^ pbVar2[uVar5];
    uVar5 = uVar5 + 1;
  } while (uVar5 < 0x54);
  pbVar2[0x54] = bVar6;
  local_4 = 0xffffffff;
  if (param_4 != (char *)0x0) {
    free(param_4);
  }
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall
FUN_00414680(void *this,undefined4 *param_1,undefined4 param_2,undefined4 param_3,void *param_4)

{
  uint uVar1;
  byte *pbVar2;
  undefined *puVar3;
  uint uVar4;
  byte bVar5;
  int iVar6;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438148;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CCurrentFrameMsgR::vftable;
  *(undefined *)(param_1 + 3) = 1;
  puVar3 = (undefined *)operator_new(0xfdff);
  param_1[1] = puVar3;
  param_1[2] = 0xfdff;
  *puVar3 = 2;
  *(undefined4 *)(param_1[1] + 1) = param_3;
  *(undefined2 *)(param_1[1] + 9) = 0x88;
  if ((DAT_0044c6b4 < 0) || (iVar6 = DAT_0044c6b4, DAT_0044ccd8 <= DAT_0044c6b4)) {
    iVar6 = DAT_0044ccd8;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar6;
  *(undefined4 *)(param_1[1] + 0xd) = param_2;
  if ((int)this < 1) {
    *(undefined4 *)(param_1[1] + 0x11) = 0;
  }
  else {
    *(void **)(param_1[1] + 0x11) = this;
    memcpy((void *)(param_1[1] + 0x15),param_4,(size_t)this);
  }
  iVar6 = *(int *)(param_1[1] + 0x11) + 0x17;
  param_1[2] = iVar6;
  *(int *)(param_1[1] + 5) = iVar6;
  *(undefined *)(param_1[1] + -1 + param_1[2]) = 3;
  pbVar2 = (byte *)param_1[1];
  bVar5 = *pbVar2;
  uVar4 = 1;
  uVar1 = param_1[2] - 2;
  if (1 < uVar1) {
    do {
      bVar5 = bVar5 ^ pbVar2[uVar4];
      uVar4 = uVar4 + 1;
    } while (uVar4 < uVar1);
  }
  pbVar2[param_1[2] + -2] = bVar5;
  ExceptionList = local_c;
  return param_1;
}



undefined4 *
FUN_004147a0(undefined4 *param_1,undefined4 param_2,undefined param_3,undefined param_4)

{
  byte *pbVar1;
  undefined *puVar2;
  int iVar3;
  byte *pbVar4;
  byte bVar5;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438148;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)(param_1 + 3) = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CInputChangedMsgE::vftable;
  puVar2 = (undefined *)operator_new(0x15);
  param_1[1] = puVar2;
  param_1[2] = 0x15;
  *puVar2 = 2;
  *(undefined4 *)(param_1[1] + 1) = param_2;
  *(undefined4 *)(param_1[1] + 5) = 0x15;
  *(undefined2 *)(param_1[1] + 9) = 0;
  if ((DAT_0044c6b4 < 0) || (iVar3 = DAT_0044c6b4, DAT_0044cab8 <= DAT_0044c6b4)) {
    iVar3 = DAT_0044cab8;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar3;
  iVar3 = FUN_00413110();
  *(int *)(param_1[1] + 0xd) = iVar3;
  *(undefined *)(param_1[1] + 0x11) = param_3;
  *(undefined *)(param_1[1] + 0x12) = param_4;
  *(undefined *)(param_1[1] + 0x14) = 3;
  pbVar1 = (byte *)param_1[1];
  bVar5 = *pbVar1;
  iVar3 = 3;
  pbVar4 = pbVar1 + 5;
  do {
    bVar5 = pbVar4[-4] ^ pbVar4[-3] ^ pbVar4[-2] ^ pbVar4[-1] ^ pbVar4[1] ^ bVar5 ^ *pbVar4;
    iVar3 = iVar3 + -1;
    pbVar4 = pbVar4 + 6;
  } while (iVar3 != 0);
  pbVar1[0x13] = bVar5;
  ExceptionList = local_c;
  return param_1;
}



undefined4 *
FUN_004148b0(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined param_4)

{
  byte *pbVar1;
  undefined *puVar2;
  int iVar3;
  byte *pbVar4;
  byte bVar5;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438148;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)(param_1 + 3) = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CCarMovementMsgE::vftable;
  puVar2 = (undefined *)operator_new(0x18);
  param_1[1] = puVar2;
  param_1[2] = 0x18;
  *puVar2 = 2;
  *(undefined4 *)(param_1[1] + 1) = param_2;
  *(undefined4 *)(param_1[1] + 5) = 0x18;
  *(undefined2 *)(param_1[1] + 9) = 1;
  if ((DAT_0044c6b4 < 0) || (iVar3 = DAT_0044c6b4, DAT_0044cabc <= DAT_0044c6b4)) {
    iVar3 = DAT_0044cabc;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar3;
  iVar3 = FUN_00413110();
  *(int *)(param_1[1] + 0xd) = iVar3;
  *(undefined4 *)(param_1[1] + 0x11) = param_3;
  *(undefined *)(param_1[1] + 0x15) = param_4;
  *(undefined *)(param_1[1] + 0x17) = 3;
  pbVar1 = (byte *)param_1[1];
  bVar5 = *pbVar1;
  iVar3 = 7;
  pbVar4 = pbVar1 + 2;
  do {
    bVar5 = pbVar4[-1] ^ pbVar4[1] ^ bVar5 ^ *pbVar4;
    iVar3 = iVar3 + -1;
    pbVar4 = pbVar4 + 3;
  } while (iVar3 != 0);
  pbVar1[0x16] = bVar5;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * FUN_004149b0(undefined4 *param_1,undefined4 param_2,undefined param_3)

{
  byte *pbVar1;
  undefined *puVar2;
  int iVar3;
  uint uVar4;
  byte bVar5;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438118;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)(param_1 + 3) = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CNotificationMsgE::vftable;
  puVar2 = (undefined *)operator_new(0x14);
  param_1[1] = puVar2;
  param_1[2] = 0x14;
  *puVar2 = 2;
  *(undefined4 *)(param_1[1] + 1) = param_2;
  *(undefined4 *)(param_1[1] + 5) = 0x14;
  *(undefined2 *)(param_1[1] + 9) = 3;
  if ((DAT_0044c6b4 < 0) || (iVar3 = DAT_0044c6b4, DAT_0044cac4 <= DAT_0044c6b4)) {
    iVar3 = DAT_0044cac4;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar3;
  iVar3 = FUN_00413110();
  *(int *)(param_1[1] + 0xd) = iVar3;
  *(undefined *)(param_1[1] + 0x11) = param_3;
  *(undefined *)(param_1[1] + 0x13) = 3;
  pbVar1 = (byte *)param_1[1];
  bVar5 = *pbVar1;
  uVar4 = 1;
  do {
    bVar5 = bVar5 ^ pbVar1[uVar4];
    uVar4 = uVar4 + 1;
  } while (uVar4 < 0x12);
  pbVar1[0x12] = bVar5;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall
FUN_00414aa0(void *this,undefined4 *param_1,undefined4 param_2,undefined4 param_3,void *param_4,
            size_t param_5)

{
  uint uVar1;
  byte *pbVar2;
  undefined *puVar3;
  uint uVar4;
  byte bVar5;
  int iVar6;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438148;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CPictureMsgR::vftable;
  *(undefined *)(param_1 + 3) = 1;
  puVar3 = (undefined *)operator_new(0xfe07);
  param_1[1] = puVar3;
  param_1[2] = 0xfe07;
  *puVar3 = 2;
  *(undefined4 *)(param_1[1] + 1) = param_3;
  *(undefined2 *)(param_1[1] + 9) = 0x87;
  if ((DAT_0044c6b4 < 0) || (iVar6 = DAT_0044c6b4, DAT_0044ccd4 <= DAT_0044c6b4)) {
    iVar6 = DAT_0044ccd4;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar6;
  *(undefined4 *)(param_1[1] + 0xd) = param_2;
  *(undefined2 *)(param_1[1] + 0x15) = *(undefined2 *)((int)this + 0xc);
  *(undefined2 *)(param_1[1] + 0x13) = *(undefined2 *)((int)this + 6);
  *(undefined2 *)(param_1[1] + 0x17) = *(undefined2 *)((int)this + 10);
  *(undefined2 *)(param_1[1] + 0x11) = *(undefined2 *)((int)this + 8);
  if ((param_4 == (void *)0x0) || (param_5 == 0)) {
    *(undefined4 *)(param_1[1] + 0x19) = 0;
  }
  else {
    if (65000 < param_5) {
      param_5 = 65000;
    }
    *(size_t *)(param_1[1] + 0x19) = param_5;
    memcpy((void *)(param_1[1] + 0x1d),param_4,param_5);
  }
  iVar6 = *(int *)(param_1[1] + 0x19) + 0x1f;
  param_1[2] = iVar6;
  *(int *)(param_1[1] + 5) = iVar6;
  *(undefined *)(param_1[1] + -1 + param_1[2]) = 3;
  pbVar2 = (byte *)param_1[1];
  bVar5 = *pbVar2;
  uVar4 = 1;
  uVar1 = param_1[2] - 2;
  if (1 < uVar1) {
    do {
      bVar5 = bVar5 ^ pbVar2[uVar4];
      uVar4 = uVar4 + 1;
    } while (uVar4 < uVar1);
  }
  pbVar2[param_1[2] + -2] = bVar5;
  ExceptionList = local_c;
  return param_1;
}



undefined4 *
FUN_00414c00(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  byte *pbVar1;
  undefined *puVar2;
  byte *pbVar3;
  byte bVar4;
  int iVar5;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438148;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined *)((int)param_1 + 0xe) = 1;
  *(undefined *)((int)param_1 + 0xf) = 1;
  *(undefined *)(param_1 + 4) = 1;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined *)((int)param_1 + 0xd) = 0;
  local_4 = 0;
  *param_1 = CInputValuesMsgR::vftable;
  *(undefined *)(param_1 + 3) = 1;
  puVar2 = (undefined *)operator_new(0x17);
  param_1[1] = puVar2;
  param_1[2] = 0x17;
  *puVar2 = 2;
  *(undefined4 *)(param_1[1] + 1) = param_3;
  *(undefined4 *)(param_1[1] + 5) = 0x17;
  *(undefined2 *)(param_1[1] + 9) = 0x85;
  if ((DAT_0044c6b4 < 0) || (iVar5 = DAT_0044c6b4, DAT_0044cccc <= DAT_0044c6b4)) {
    iVar5 = DAT_0044cccc;
  }
  *(short *)(param_1[1] + 0xb) = (short)iVar5;
  *(undefined4 *)(param_1[1] + 0xd) = param_2;
  *(undefined4 *)(param_1[1] + 0x11) = param_4;
  *(undefined *)(param_1[1] + 0x16) = 3;
  pbVar1 = (byte *)param_1[1];
  bVar4 = *pbVar1;
  iVar5 = 4;
  pbVar3 = pbVar1 + 4;
  do {
    bVar4 = bVar4 ^ pbVar3[-3] ^ pbVar3[-2] ^ pbVar3[-1] ^ pbVar3[1] ^ *pbVar3;
    iVar5 = iVar5 + -1;
    pbVar3 = pbVar3 + 5;
  } while (iVar5 != 0);
  pbVar1[0x15] = bVar4;
  ExceptionList = local_c;
  return param_1;
}



void FUN_00414d00(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigSetTimeMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x1b)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414d40(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigLoginMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x57)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414d80(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigGetEntriesCountMsgR::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414dc0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigExportConfigurationMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x57)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414e00(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigGetEntryMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x5b)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414e40(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigFormatRWPartitionMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414e80(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigRestoreFirmwareMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414ec0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigLoginMsgR::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414f00(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigExportLogMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x58)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414f40(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigDiscardChangesMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414f80(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigPingMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00414fc0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigSetEntryMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x97)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00415000(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigSystemInformationMsgR::vftable;
  if (((*(short *)(in_EAX[1] + 0xb) != 0) || (in_EAX[2] != 0x7f)) &&
     ((*(short *)(in_EAX[1] + 0xb) != 1 || (in_EAX[2] != 0x82)))) {
    *(undefined *)((int)in_EAX + 0xe) = 0;
    return;
  }
  *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
  return;
}



void FUN_00415050(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigRestoreEntryMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x57)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



undefined4 * __thiscall FUN_00415090(void *this,byte param_1)

{
  void *pvVar1;
  
  pvVar1 = *(void **)((int)this + 4);
  *(undefined ***)this = CMsg::vftable;
  if (pvVar1 != (void *)0x0) {
    if (*(char *)((int)this + 0xd) == '\0') {
      operator_delete(pvVar1);
    }
    else {
      operator_delete__(pvVar1);
    }
    *(undefined4 *)((int)this + 4) = 0;
  }
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void FUN_004150e0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigGetLanguageMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00415120(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigLogoutMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00415160(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigPasswordChangeMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x57)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_004151a0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigApplyChangesMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_004151e0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CStatusMsgQ::vftable;
  if (((*(short *)(in_EAX[1] + 0xb) != 0) || (in_EAX[2] != 0x13)) &&
     ((*(short *)(in_EAX[1] + 0xb) != 1 || (in_EAX[2] != 0x13)))) {
    *(undefined *)((int)in_EAX + 0xe) = 0;
    return;
  }
  *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
  return;
}



uint __fastcall FUN_00415230(int param_1)

{
  byte *pbVar1;
  uint uVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte bVar6;
  int iVar7;
  
  uVar3 = (uint)*(ushort *)(*(int *)(param_1 + 4) + 9);
  uVar2 = uVar3 * 4;
  if ((&DAT_0044cab8)[uVar3] != *(int *)(&DAT_0044c6b8 + uVar2)) {
    (&DAT_0044cab8)[*(ushort *)(*(int *)(param_1 + 4) + 9)] =
         (&DAT_0044cab8)[*(ushort *)(*(int *)(param_1 + 4) + 9)] + -1;
    if ((DAT_0044c6b4 < 0) || (iVar7 = DAT_0044c6b4, DAT_0044cbc8 <= DAT_0044c6b4)) {
      iVar7 = DAT_0044cbc8;
    }
    *(short *)(*(int *)(param_1 + 4) + 0xb) = (short)iVar7;
    pbVar1 = *(byte **)(param_1 + 4);
    bVar6 = *pbVar1;
    iVar7 = 4;
    pbVar4 = pbVar1 + 3;
    do {
      pbVar5 = pbVar4 + 4;
      bVar6 = pbVar4[-2] ^ pbVar4[-1] ^ pbVar4[1] ^ bVar6 ^ *pbVar4;
      iVar7 = iVar7 + -1;
      pbVar4 = pbVar5;
    } while (iVar7 != 0);
    pbVar1[0x11] = bVar6;
    return CONCAT31((int3)((uint)pbVar5 >> 8),1);
  }
  return uVar2 & 0xffffff00;
}



void FUN_004152b0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigExportStatusMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x57)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_004152f0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigImportConfigurationMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x57)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00415330(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigSetLanguageMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x1f)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00415370(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigGetLanguageMsgR::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x1b)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_004153b0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigUpdateFirmwareMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x57)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_004153f0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigRestartMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00415430(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigGetEntryMsgR::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x493)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_00415470(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigGetEntriesCountMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_004154b0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigSyncTimeMsgQ::vftable;
  if ((*(short *)(in_EAX[1] + 0xb) == 0) && (in_EAX[2] == 0x17)) {
    *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
    return;
  }
  *(undefined *)((int)in_EAX + 0xe) = 0;
  return;
}



void FUN_004154f0(void)

{
  undefined4 *in_EAX;
  
  FUN_00411a40();
  *in_EAX = CConfigSystemInformationMsgQ::vftable;
  if (((*(short *)(in_EAX[1] + 0xb) != 0) || (in_EAX[2] != 0x17)) &&
     ((*(short *)(in_EAX[1] + 0xb) != 1 || (in_EAX[2] != 0x17)))) {
    *(undefined *)((int)in_EAX + 0xe) = 0;
    return;
  }
  *(byte *)((int)in_EAX + 0xe) = *(byte *)((int)in_EAX + 0xe) & 1;
  return;
}



uint __fastcall FUN_00415540(int param_1)

{
  byte *pbVar1;
  uint uVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte bVar6;
  int iVar7;
  
  uVar3 = (uint)*(ushort *)(*(int *)(param_1 + 4) + 9);
  uVar2 = uVar3 * 4;
  if ((&DAT_0044cab8)[uVar3] != *(int *)(&DAT_0044c6b8 + uVar2)) {
    (&DAT_0044cab8)[*(ushort *)(*(int *)(param_1 + 4) + 9)] =
         (&DAT_0044cab8)[*(ushort *)(*(int *)(param_1 + 4) + 9)] + -1;
    if ((DAT_0044c6b4 < 0) || (iVar7 = DAT_0044c6b4, DAT_0044cc54 <= DAT_0044c6b4)) {
      iVar7 = DAT_0044cc54;
    }
    *(short *)(*(int *)(param_1 + 4) + 0xb) = (short)iVar7;
    pbVar1 = *(byte **)(param_1 + 4);
    bVar6 = *pbVar1;
    iVar7 = 4;
    pbVar4 = pbVar1 + 4;
    do {
      pbVar5 = pbVar4 + 5;
      bVar6 = pbVar4[-3] ^ pbVar4[-2] ^ pbVar4[-1] ^ pbVar4[1] ^ bVar6 ^ *pbVar4;
      iVar7 = iVar7 + -1;
      pbVar4 = pbVar5;
    } while (iVar7 != 0);
    pbVar1[0x15] = bVar6;
    return CONCAT31((int3)((uint)pbVar5 >> 8),1);
  }
  return uVar2 & 0xffffff00;
}



uint __cdecl FUN_004155c0(char *param_1,undefined4 *param_2,uint param_3)

{
  char cVar1;
  char *in_EAX;
  undefined4 *_Memory;
  uint uVar2;
  char *pcVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  int iVar7;
  char *pcVar8;
  bool bVar9;
  int local_4;
  
  *(undefined *)param_2 = 0;
  _Memory = (undefined4 *)FUN_00416410((char *)&DAT_0043b7b8);
  if (_Memory != (undefined4 *)0xffffffff) {
    memset(param_2,0,param_3);
    pcVar3 = param_1;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    local_4 = (int)pcVar3 - (int)(param_1 + 1);
    iVar4 = (*(code *)_Memory[2])(*_Memory,&param_1,&local_4,&param_2,&param_3);
    piVar5 = (int *)(*(code *)_Memory[3])();
    piVar6 = _errno();
    *piVar6 = *piVar5;
    (*(code *)_Memory[1])(*_Memory);
    piVar5 = (int *)(*(code *)_Memory[3])();
    iVar7 = *piVar5;
    free(_Memory);
    piVar5 = _errno();
    *piVar5 = iVar7;
    return (uint)(iVar4 != -1);
  }
  iVar7 = 7;
  bVar9 = true;
  pcVar3 = in_EAX;
  pcVar8 = "CP1098";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar9 = *pcVar3 == *pcVar8;
    pcVar3 = pcVar3 + 1;
    pcVar8 = pcVar8 + 1;
  } while (bVar9);
  if (bVar9) {
    uVar2 = FUN_00415cf0(param_2,param_3);
    return uVar2;
  }
  iVar7 = 4;
  bVar9 = true;
  pcVar3 = "864";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar9 = *in_EAX == *pcVar3;
    in_EAX = in_EAX + 1;
    pcVar3 = pcVar3 + 1;
  } while (bVar9);
  if (bVar9) {
    uVar2 = FUN_004159b0(param_2,param_3);
    return uVar2;
  }
  return 0;
}



undefined4 __cdecl FUN_004156f0(undefined *param_1)

{
  byte bVar1;
  byte *in_EAX;
  undefined4 *_Memory;
  int iVar2;
  int *piVar3;
  int *piVar4;
  undefined *local_10;
  byte *local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  _Memory = (undefined4 *)FUN_00416410((char *)&DAT_0043c0ac);
  if (_Memory == (undefined4 *)0xffffffff) {
    return 0;
  }
  bVar1 = *in_EAX;
  local_c = in_EAX;
  local_10 = param_1;
  do {
    if (bVar1 == 0) {
      *local_10 = 0;
      (*(code *)_Memory[1])(*_Memory);
      piVar3 = (int *)(*(code *)_Memory[3])();
      iVar2 = *piVar3;
      free(_Memory);
      piVar3 = _errno();
      *piVar3 = iVar2;
      return 1;
    }
    local_4 = 1;
    bVar1 = *local_c;
    if ((char)bVar1 < '\0') {
      if ((bVar1 & 0xe0) == 0xc0) {
        local_8 = 2;
        iVar2 = (*(code *)_Memory[2])(*_Memory,&local_c,&local_8,&local_10,&local_4);
        piVar3 = (int *)(*(code *)_Memory[3])();
        piVar4 = _errno();
        *piVar4 = *piVar3;
        if (iVar2 == -1) {
          *local_10 = 0x6f;
          local_c = local_c + 2;
          goto LAB_004158a1;
        }
      }
      else if ((bVar1 & 0xf0) == 0xe0) {
        local_8 = 3;
        iVar2 = (*(code *)_Memory[2])(*_Memory,&local_c,&local_8,&local_10,&local_4);
        piVar3 = (int *)(*(code *)_Memory[3])();
        piVar4 = _errno();
        *piVar4 = *piVar3;
        if (iVar2 == -1) {
          *local_10 = 0x6f;
          local_c = local_c + 3;
LAB_004158a1:
          local_10 = local_10 + 1;
        }
      }
      else {
        if ((bVar1 & 0xf8) != 0xf0) {
          return 0;
        }
        local_8 = 4;
        iVar2 = (*(code *)_Memory[2])(*_Memory,&local_c,&local_8,&local_10,&local_4);
        piVar3 = (int *)(*(code *)_Memory[3])();
        piVar4 = _errno();
        *piVar4 = *piVar3;
        if (iVar2 == -1) {
          *local_10 = 0x6f;
          local_c = local_c + 4;
          goto LAB_004158a1;
        }
      }
    }
    else {
      local_8 = 1;
      iVar2 = (*(code *)_Memory[2])(*_Memory,&local_c,&local_8,&local_10,&local_4);
      piVar3 = (int *)(*(code *)_Memory[3])();
      piVar4 = _errno();
      *piVar4 = *piVar3;
      if (iVar2 == -1) {
        *local_10 = 0x6f;
        local_c = local_c + 1;
        local_10 = local_10 + 1;
      }
    }
    bVar1 = *local_c;
  } while( true );
}



uint __thiscall FUN_004158f0(void *this,char *param_1,void *param_2,size_t param_3)

{
  char cVar1;
  int iVar2;
  undefined4 *_Memory;
  char *pcVar3;
  uint uVar4;
  int *piVar5;
  int *piVar6;
  int local_4;
  
  _Memory = (undefined4 *)FUN_00416410((char *)this);
  if (_Memory == (undefined4 *)0xffffffff) {
    return 0;
  }
  memset(param_2,0,param_3);
  pcVar3 = param_1;
  do {
    cVar1 = *pcVar3;
    pcVar3 = pcVar3 + 1;
  } while (cVar1 != '\0');
  local_4 = (int)pcVar3 - (int)(param_1 + 1);
  uVar4 = (*(code *)_Memory[2])(*_Memory,&param_1,&local_4,&param_2,&param_3);
  piVar5 = (int *)(*(code *)_Memory[3])();
  piVar6 = _errno();
  *piVar6 = *piVar5;
  (*(code *)_Memory[1])(*_Memory);
  piVar5 = (int *)(*(code *)_Memory[3])();
  iVar2 = *piVar5;
  free(_Memory);
  piVar5 = _errno();
  *piVar5 = iVar2;
  return -(uint)(uVar4 != 0xffffffff) & uVar4;
}



undefined4 __cdecl FUN_004159b0(undefined4 *param_1,uint param_2)

{
  byte bVar1;
  byte *in_EAX;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  byte *pbVar5;
  
  iVar4 = 0;
  if (*in_EAX != 0) {
    uVar3 = 3;
    puVar2 = param_1;
    do {
      if (param_2 < uVar3) {
switchD_00415a1b_caseD_aa:
        return 0;
      }
      if (*in_EAX < 0x80) {
        pbVar5 = in_EAX;
        do {
          bVar1 = *pbVar5;
          pbVar5[(int)puVar2 - (int)in_EAX] = bVar1;
          pbVar5 = pbVar5 + 1;
        } while (bVar1 != 0);
        iVar4 = iVar4 + 1;
        uVar3 = uVar3 + 1;
        puVar2 = (undefined4 *)((int)puVar2 + 1);
        goto LAB_00415bfb;
      }
      switch(*in_EAX) {
      case 0xa8:
        *puVar2 = 0x8ebaef;
        break;
      case 0xa9:
        *puVar2 = 0x8fbaef;
        break;
      default:
        goto switchD_00415a1b_caseD_aa;
      case 0xae:
        *puVar2 = 0xa1baef;
        break;
      case 0xb0:
        *(undefined2 *)puVar2 = 0xa0d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xb1:
        *(undefined2 *)puVar2 = 0xa1d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xb2:
        *(undefined2 *)puVar2 = 0xa2d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xb3:
        *(undefined2 *)puVar2 = 0xa3d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xb4:
        *(undefined2 *)puVar2 = 0xa4d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xb5:
        *(undefined2 *)puVar2 = 0xa5d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xb6:
        *(undefined2 *)puVar2 = 0xa6d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xb7:
        *(undefined2 *)puVar2 = 0xa7d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xb8:
        *(undefined2 *)puVar2 = 0xa8d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xb9:
        *(undefined2 *)puVar2 = 0xa9d9;
        *(undefined *)((int)puVar2 + 2) = 0;
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
        goto LAB_00415bfb;
      case 0xcf:
        *puVar2 = 0xa9baef;
        break;
      case 0xd1:
        *puVar2 = 0xadbaef;
        break;
      case 0xd3:
        *puVar2 = 0xb3baef;
        break;
      case 0xd5:
        *puVar2 = 0xbbbaef;
        break;
      case 0xd7:
        *puVar2 = 0x81bbef;
        break;
      case 0xdf:
        *puVar2 = 0x89bbef;
        break;
      case 0xe7:
        *puVar2 = 0xabbbef;
        break;
      case 0xe8:
        *puVar2 = 0xadbbef;
        break;
      case 0xe9:
        *puVar2 = 0xafbbef;
        break;
      case 0xef:
        *puVar2 = 0xa1bbef;
        break;
      case 0xf2:
        *puVar2 = 0xa5bbef;
        break;
      case 0xf8:
        *puVar2 = 0x95bbef;
        break;
      case 0xfb:
        *puVar2 = 0x9dbbef;
        break;
      case 0xfc:
        *puVar2 = 0x99bbef;
      }
      iVar4 = iVar4 + 3;
      uVar3 = uVar3 + 3;
      puVar2 = (undefined4 *)((int)puVar2 + 3);
LAB_00415bfb:
      in_EAX = in_EAX + 1;
    } while (*in_EAX != 0);
  }
  *(undefined *)(iVar4 + (int)param_1) = 0;
  return 1;
}



undefined4 __cdecl FUN_00415cf0(undefined4 *param_1,uint param_2)

{
  byte bVar1;
  byte *in_EAX;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  byte *pbVar5;
  
  iVar4 = 0;
  if (*in_EAX != 0) {
    uVar3 = 3;
    puVar2 = param_1;
    do {
      if (param_2 < uVar3) {
switchD_00415d5b_caseD_93:
        return 0;
      }
      if (*in_EAX < 0x80) {
        pbVar5 = in_EAX;
        do {
          bVar1 = *pbVar5;
          pbVar5[(int)puVar2 - (int)in_EAX] = bVar1;
          pbVar5 = pbVar5 + 1;
        } while (bVar1 != 0);
        iVar4 = iVar4 + 1;
        uVar3 = uVar3 + 1;
        puVar2 = (undefined4 *)((int)puVar2 + 1);
        goto LAB_00415f43;
      }
      switch(*in_EAX) {
      case 0x92:
        *puVar2 = 0x8fbaef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      default:
        goto switchD_00415d5b_caseD_93;
      case 0x96:
        *(undefined2 *)puVar2 = 0xaad8;
        goto LAB_00415f37;
      case 0x9a:
        *puVar2 = 0x9dbaef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xa3:
        *puVar2 = 0xa9baef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xa8:
        *puVar2 = 0xb1baef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xac:
        *puVar2 = 0xb9baef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xb7:
        *puVar2 = 0x81bbef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xd3:
        *puVar2 = 0x89bbef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xdd:
        *(undefined2 *)puVar2 = 0x82d9;
        goto LAB_00415f37;
      case 0xe4:
        *puVar2 = 0x9dbbef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xe6:
        *puVar2 = 0xa1bbef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xe8:
        *(undefined2 *)puVar2 = 0x86d9;
        goto LAB_00415f37;
      case 0xea:
        *puVar2 = 0xadbbef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xec:
        *puVar2 = 0xabbbef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xef:
        *puVar2 = 0xbcafef;
        iVar4 = iVar4 + 3;
        uVar3 = uVar3 + 3;
        puVar2 = (undefined4 *)((int)puVar2 + 3);
        break;
      case 0xf5:
        *(undefined2 *)puVar2 = 0xb1db;
        goto LAB_00415f37;
      case 0xf6:
        *(undefined2 *)puVar2 = 0xb2db;
        goto LAB_00415f37;
      case 0xf7:
        *(undefined2 *)puVar2 = 0xb3db;
        goto LAB_00415f37;
      case 0xf8:
        *(undefined2 *)puVar2 = 0xb4db;
        goto LAB_00415f37;
      case 0xf9:
        *(undefined2 *)puVar2 = 0xb5db;
        goto LAB_00415f37;
      case 0xfa:
        *(undefined2 *)puVar2 = 0xb6db;
        goto LAB_00415f37;
      case 0xfb:
        *(undefined2 *)puVar2 = 0xb7db;
        goto LAB_00415f37;
      case 0xfc:
        *(undefined2 *)puVar2 = 0xb8db;
        goto LAB_00415f37;
      case 0xfd:
        *(undefined2 *)puVar2 = 0xb9db;
LAB_00415f37:
        iVar4 = iVar4 + 2;
        uVar3 = uVar3 + 2;
        *(undefined *)((int)puVar2 + 2) = 0;
        puVar2 = (undefined4 *)((int)puVar2 + 2);
      }
LAB_00415f43:
      in_EAX = in_EAX + 1;
    } while (*in_EAX != 0);
  }
  *(undefined *)(iVar4 + (int)param_1) = 0;
  return 1;
}



void FUN_00416040(void)

{
  int iVar1;
  uint unaff_EBX;
  void *unaff_ESI;
  undefined auStack_1a0 [4];
  WSADATA local_19c;
  uint local_8;
  
  local_8 = DAT_0044a01c ^ (uint)auStack_1a0;
  iVar1 = WSAStartup(2,&local_19c);
  if (iVar1 != 0) {
LAB_00416066:
    ___security_check_cookie_4(local_8 ^ (uint)auStack_1a0);
    return;
  }
  if ((unaff_ESI == (void *)0x0) || (unaff_EBX == 0)) {
    DAT_0044ceb8 = 0;
  }
  else {
    DAT_0044d0d8 = malloc(0x10000);
    DAT_0044d0dc = malloc(0x10000);
    iVar1 = FUN_00417ad0(unaff_ESI,unaff_EBX);
    if (iVar1 == 0) goto LAB_00416066;
    DAT_0044ceb8 = 1;
  }
  ___security_check_cookie_4(local_8 ^ (uint)auStack_1a0);
  return;
}



undefined4 FUN_004160f0(void)

{
  WSACleanup();
  if (DAT_0044d0d8 != 0) {
    free((void *)DAT_0044d0d8);
    DAT_0044d0d8 = 0;
  }
  if (DAT_0044d0dc != 0) {
    free((void *)DAT_0044d0dc);
    DAT_0044d0dc = 0;
  }
  if ((DAT_0044ceb8 != 0) && (DAT_0044d250 != 0)) {
    DAT_0044d250 = 0;
  }
  return 1;
}



void __cdecl FUN_00416160(SOCKET param_1,u_short param_2)

{
  u_short uVar1;
  undefined auStack_1c [4];
  sockaddr local_18;
  uint local_8;
  
  local_8 = DAT_0044a01c ^ (uint)auStack_1c;
  local_18.sa_data[2] = '\0';
  local_18.sa_data[3] = '\0';
  local_18.sa_data[4] = '\0';
  local_18.sa_data[5] = '\0';
  local_18.sa_data[6] = '\0';
  local_18.sa_data[7] = '\0';
  local_18.sa_data[8] = '\0';
  local_18.sa_data[9] = '\0';
  local_18.sa_data[10] = '\0';
  local_18.sa_data[0xb] = '\0';
  local_18.sa_data[0xc] = '\0';
  local_18.sa_data[0xd] = '\0';
  local_18.sa_family = 2;
  local_18.sa_data[0] = '\0';
  local_18.sa_data[1] = '\0';
  uVar1 = htons(param_2);
  local_18.sa_data._0_2_ = uVar1;
  local_18.sa_data[2] = '\0';
  local_18.sa_data[3] = '\0';
  local_18.sa_data[4] = '\0';
  local_18.sa_data[5] = '\0';
  bind(param_1,&local_18,0x10);
  ___security_check_cookie_4(local_8 ^ (uint)auStack_1c);
  return;
}



void __fastcall
FUN_004161d0(uint param_1,undefined4 *param_2,SOCKET param_3,undefined4 param_4,u_short param_5)

{
  u_short uVar1;
  undefined auStack_18 [4];
  sockaddr local_14;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)auStack_18;
  if (DAT_0044ceb8 != 0) {
    param_1 = FUN_00417bf0(param_2,param_1);
    param_2 = DAT_0044d0d8;
  }
  local_14.sa_data[2] = '\0';
  local_14.sa_data[3] = '\0';
  local_14.sa_data[4] = '\0';
  local_14.sa_data[5] = '\0';
  local_14.sa_data[6] = '\0';
  local_14.sa_data[7] = '\0';
  local_14.sa_data[8] = '\0';
  local_14.sa_data[9] = '\0';
  local_14.sa_data[10] = '\0';
  local_14.sa_data[0xb] = '\0';
  local_14.sa_data[0xc] = '\0';
  local_14.sa_data[0xd] = '\0';
  local_14.sa_family = 2;
  local_14.sa_data[0] = '\0';
  local_14.sa_data[1] = '\0';
  uVar1 = htons(param_5);
  local_14.sa_data._0_2_ = uVar1;
  local_14.sa_data._2_4_ = param_4;
  sendto(param_3,(char *)param_2,param_1,0,&local_14,0x10);
  ___security_check_cookie_4(local_4 ^ (uint)auStack_18);
  return;
}



void __thiscall FUN_00416260(void *this,undefined4 *param_1)

{
  timeval *timeout;
  int iVar1;
  uint uVar2;
  size_t sVar3;
  char *unaff_EBX;
  SOCKET unaff_ESI;
  size_t *unaff_EDI;
  int local_12c;
  timeval local_128;
  u_int local_120;
  sockaddr sStack_14;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_12c;
  local_120 = 1;
  if (this == (void *)0x0) {
    timeout = (timeval *)0x0;
  }
  else {
    local_128.tv_sec = (uint)this / 1000;
    local_128.tv_usec = ((uint)this % 1000) * 1000;
    timeout = &local_128;
  }
  local_12c = 0x10;
  iVar1 = select(unaff_ESI + 1,(fd_set *)&local_120,(fd_set *)0x0,(fd_set *)0x0,timeout);
  if (iVar1 == 0) {
    ___security_check_cookie_4(local_4 ^ (uint)&local_12c);
    return;
  }
  if (DAT_0044ceb8 == 0) {
    sVar3 = recvfrom(unaff_ESI,unaff_EBX,0xfe07,0,&sStack_14,&local_12c);
    *unaff_EDI = sVar3;
  }
  else {
    iVar1 = recvfrom(unaff_ESI,DAT_0044d0d8,0xfe2a,0,&sStack_14,&local_12c);
    uVar2 = FUN_00417d00(iVar1);
    *unaff_EDI = uVar2;
    if (0xfe07 < uVar2) {
      *unaff_EDI = 0xfe07;
    }
    memcpy(unaff_EBX,DAT_0044d0dc,*unaff_EDI);
  }
  if (param_1 != (undefined4 *)0x0) {
    *param_1 = sStack_14.sa_data._2_4_;
  }
  ___security_check_cookie_4(local_4 ^ (uint)&local_12c);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_00416390(void)

{
  HMODULE hModule;
  
  if (DAT_0044cec0 != (FARPROC)0x0) {
    return 1;
  }
  hModule = LoadLibraryA("mlang.dll");
  if (hModule == (HMODULE)0x0) {
    return 0;
  }
  DAT_0044cec0 = GetProcAddress(hModule,"ConvertINetString");
  DAT_0044ced0 = GetProcAddress(hModule,"ConvertINetMultiByteToUnicode");
  DAT_0044cec4 = GetProcAddress(hModule,"ConvertINetUnicodeToMultiByte");
  _DAT_0044cec8 = GetProcAddress(hModule,"IsConvertINetStringAvailable");
  _DAT_0044cecc = GetProcAddress(hModule,"LcidToRfc1766A");
  _DAT_0044cebc = GetProcAddress(hModule,"Rfc1766ToLcidA");
  return 1;
}



void * __cdecl FUN_00416410(char *param_1)

{
  void *_Memory;
  int *piVar1;
  int iVar2;
  
  _Memory = calloc(1,0x50);
  if (_Memory == (void *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0xc;
    return (void *)0xffffffff;
  }
  iVar2 = FUN_00416470((int)_Memory,param_1);
  if (iVar2 != 0) {
    return _Memory;
  }
  free(_Memory);
  piVar1 = _errno();
  *piVar1 = 0x16;
  return (void *)0xffffffff;
}



undefined4 __cdecl FUN_00416470(int param_1,char *param_2)

{
  code *pcVar1;
  char *in_EAX;
  int *piVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  
  piVar2 = (int *)FUN_00416800(in_EAX);
  piVar5 = (int *)(param_1 + 0x10);
  for (iVar3 = 8; iVar3 != 0; iVar3 = iVar3 + -1) {
    *piVar5 = *piVar2;
    piVar2 = piVar2 + 1;
    piVar5 = piVar5 + 1;
  }
  piVar2 = (int *)FUN_00416800(param_2);
  iVar3 = *(int *)(param_1 + 0x10);
  piVar5 = (int *)(param_1 + 0x30);
  for (iVar4 = 8; pcVar1 = _errno_exref, iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar5 = *piVar2;
    piVar2 = piVar2 + 1;
    piVar5 = piVar5 + 1;
  }
  if ((iVar3 != -1) && (*(int *)(param_1 + 0x30) != -1)) {
    *(undefined **)(param_1 + 4) = &LAB_004164f0;
    *(code **)(param_1 + 8) = FUN_00416500;
    *(code **)(param_1 + 0xc) = pcVar1;
    *(int *)param_1 = param_1;
    return 1;
  }
  return 0;
}



void __cdecl FUN_00416500(int param_1,int *param_2,int *param_3,int *param_4,int *param_5)

{
  int *piVar1;
  uint *puVar2;
  int *piVar3;
  uint *puVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined4 extraout_ECX;
  uint uVar8;
  uint uVar9;
  int local_3c;
  int *local_38;
  int *local_34;
  int *local_30;
  undefined4 local_2c;
  int *local_28;
  ushort local_24;
  ushort uStack_22;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_3c;
  local_34 = param_2;
  local_38 = param_3;
  local_28 = param_4;
  local_30 = param_5;
  if ((param_2 == (int *)0x0) || (*param_2 == 0)) {
    if ((param_4 != (int *)0x0) && ((*param_4 != 0 && (*(code **)(param_1 + 0x44) != (code *)0x0))))
    {
      iVar5 = (**(code **)(param_1 + 0x44))(param_1 + 0x30,*param_4,*param_5);
      if (iVar5 == -1) goto LAB_00416764;
      *param_4 = *param_4 + iVar5;
      *param_5 = *param_5 - iVar5;
    }
    uVar9 = *(uint *)(param_1 + 0x10);
    if ((((((uVar9 == 0x4b0) || (uVar9 == 0x4b1)) || (uVar9 == 12000)) ||
         ((uVar9 == 0x2ee1 || (uVar9 == 65000)))) || (uVar9 == 0xfde9)) &&
       ((*(byte *)(param_1 + 0x28) & 2) != 0)) {
      *(uint *)(param_1 + 0x10) = uVar9 ^ 1;
    }
    *(undefined4 *)(param_1 + 0x28) = 0;
    *(undefined4 *)(param_1 + 0x48) = 0;
  }
  else if (*param_3 != 0) {
    while( true ) {
      local_2c = *(undefined4 *)(param_1 + 0x28);
      local_3c = 0x10;
      iVar5 = (**(code **)(param_1 + 0x18))
                        ((int *)(param_1 + 0x10),*param_2,*local_38,&local_24,&local_3c);
      if (iVar5 == -1) break;
      iVar7 = *(int *)(param_1 + 0x10);
      if ((((iVar7 == 0x4b0) || (iVar7 == 0x4b1)) ||
          ((iVar7 == 12000 || (((iVar7 == 0x2ee1 || (iVar7 == 65000)) || (iVar7 == 0xfde9)))))) &&
         ((*(byte *)(param_1 + 0x28) & 1) == 0)) {
        FUN_00416cf0(extraout_ECX,(short *)&local_24,&local_3c);
        *(uint *)(param_1 + 0x28) = *(uint *)(param_1 + 0x28) | 1;
      }
      if (local_3c == 0) {
        *param_2 = *param_2 + iVar5;
        *local_38 = *local_38 - iVar5;
      }
      else {
        piVar3 = *(int **)(param_1 + 0x2c);
        uVar9 = (uint)uStack_22;
        if (piVar3 != (int *)0x0) {
          uVar8 = (uint)local_24;
          if ((ushort)(local_24 + 0x2800) < 0x400) {
            uVar8 = ((uVar8 & 0x3ff) + 0x40) * 0x400 + (uVar9 & 0x3ff);
          }
          iVar6 = 0;
          iVar7 = *piVar3;
          piVar1 = piVar3;
          while (iVar7 != 0) {
            if (((*(byte *)(piVar1 + 2) & 1) != 0) && (piVar1[1] == uVar8)) {
              FUN_00416bd0(&local_24,&local_3c);
              uVar9 = (uint)uStack_22;
              break;
            }
            iVar6 = iVar6 + 1;
            piVar1 = piVar3 + iVar6 * 3;
            iVar7 = piVar3[iVar6 * 3];
          }
        }
        piVar1 = local_28;
        piVar3 = local_30;
        puVar4 = *(uint **)(param_1 + 0x4c);
        if (puVar4 != (uint *)0x0) {
          uVar8 = (uint)local_24;
          if ((ushort)(local_24 + 0x2800) < 0x400) {
            uVar8 = ((uVar8 & 0x3ff) + 0x40) * 0x400 + (uVar9 & 0x3ff);
          }
          iVar7 = 0;
          uVar9 = *puVar4;
          puVar2 = puVar4;
          while (uVar9 != 0) {
            if (((*(byte *)(puVar2 + 2) & 2) != 0) && (*puVar2 == uVar8)) {
              uVar9 = puVar4[iVar7 * 3 + 1];
              if (uVar9 < 0x10000) {
                local_24 = (ushort)uVar9;
                local_3c = 1;
              }
              else {
                local_24 = (ushort)(uVar9 - 0x10000 >> 10) & 0x3ff | 0xd800;
                uStack_22 = (ushort)(uVar9 - 0x10000) & 0x3ff | 0xdc00;
                local_3c = 2;
              }
              break;
            }
            iVar7 = iVar7 + 1;
            puVar2 = puVar4 + iVar7 * 3;
            uVar9 = puVar4[iVar7 * 3];
          }
        }
        iVar7 = (**(code **)(param_1 + 0x3c))(param_1 + 0x30,&local_24,local_3c,*local_28,*local_30)
        ;
        if (iVar7 == -1) {
          *(undefined4 *)(param_1 + 0x28) = local_2c;
          break;
        }
        *local_34 = *local_34 + iVar5;
        *piVar1 = *piVar1 + iVar7;
        *local_38 = *local_38 - iVar5;
        *piVar3 = *piVar3 - iVar7;
        param_2 = local_34;
      }
      if (*local_38 == 0) {
        ___security_check_cookie_4(local_4 ^ (uint)&local_3c);
        return;
      }
    }
LAB_00416764:
    ___security_check_cookie_4(local_4 ^ (uint)&local_3c);
    return;
  }
  ___security_check_cookie_4(local_4 ^ (uint)&local_3c);
  return;
}



void __cdecl FUN_00416800(char *param_1)

{
  char *_Str1;
  char *pcVar1;
  int iVar2;
  UINT UVar3;
  BOOL BVar4;
  UINT *unaff_ESI;
  uint local_1a8;
  int local_1a4;
  _cpinfoexA _Stack_1a0;
  char local_84 [127];
  undefined uStack_5;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_1a8;
  local_1a4 = 1;
  local_1a8 = 0;
  strncpy(local_84,param_1,0x80);
  uStack_5 = 0;
  pcVar1 = FUN_00416d60();
  while (pcVar1 != (char *)0x0) {
    _Str1 = pcVar1 + 2;
    iVar2 = _stricmp(_Str1,"nocompat");
    if (iVar2 == 0) {
      local_1a4 = 0;
    }
    else {
      iVar2 = _stricmp(_Str1,"translit");
      if (iVar2 == 0) {
        local_1a8 = local_1a8 | 2;
      }
      else {
        iVar2 = _stricmp(_Str1,"ignore");
        if (iVar2 == 0) {
          local_1a8 = local_1a8 | 4;
        }
      }
    }
    *pcVar1 = '\0';
    pcVar1 = FUN_00416d60();
  }
  unaff_ESI[6] = 0;
  unaff_ESI[1] = local_1a8;
  unaff_ESI[4] = 0;
  unaff_ESI[5] = 0;
  unaff_ESI[7] = 0;
  UVar3 = FUN_00416af0();
  *unaff_ESI = UVar3;
  if ((UVar3 == 0x4b0) || (UVar3 == 0x4b1)) {
    unaff_ESI[2] = (UINT)FUN_00417240;
    unaff_ESI[3] = (UINT)FUN_00417330;
    iVar2 = _stricmp(local_84,"UTF-16");
    if ((iVar2 != 0) && (iVar2 = _stricmp(local_84,"UTF16"), iVar2 != 0)) {
      pcVar1 = "UCS-2";
LAB_00416a62:
      iVar2 = _stricmp(local_84,pcVar1);
      if (iVar2 != 0) goto LAB_00416a77;
    }
LAB_00416a73:
    unaff_ESI[1] = unaff_ESI[1] | 1;
  }
  else {
    if ((UVar3 == 12000) || (UVar3 == 0x2ee1)) {
      unaff_ESI[2] = (UINT)&LAB_004173f0;
      unaff_ESI[3] = (UINT)&LAB_004174a0;
      iVar2 = _stricmp(local_84,"UTF-32");
      if (iVar2 != 0) {
        pcVar1 = "UTF32";
        goto LAB_00416a62;
      }
      goto LAB_00416a73;
    }
    if (UVar3 == 0xfde9) {
      unaff_ESI[2] = (UINT)&LAB_00416fd0;
      unaff_ESI[3] = (UINT)&LAB_00417030;
      unaff_ESI[4] = (UINT)&LAB_00416eb0;
    }
    else if ((((UVar3 == 0xc42c) || (UVar3 == 0xc42d)) || (UVar3 == 0xc42e)) &&
            (iVar2 = FUN_00416390(), iVar2 != 0)) {
      unaff_ESI[2] = (UINT)FUN_00417550;
      unaff_ESI[3] = (UINT)FUN_004177f0;
      unaff_ESI[5] = (UINT)&LAB_00417a50;
    }
    else if ((*unaff_ESI == 0xcadc) && (iVar2 = FUN_00416390(), iVar2 != 0)) {
      unaff_ESI[2] = (UINT)&LAB_004170f0;
      unaff_ESI[3] = (UINT)FUN_00417160;
      unaff_ESI[4] = (UINT)&LAB_00416f40;
    }
    else {
      BVar4 = IsValidCodePage(*unaff_ESI);
      if ((BVar4 == 0) || (BVar4 = GetCPInfoExA(*unaff_ESI,0,&_Stack_1a0), BVar4 == 0)) {
        *unaff_ESI = 0xffffffff;
      }
      else {
        unaff_ESI[2] = (UINT)&LAB_00416fd0;
        unaff_ESI[3] = (UINT)&LAB_00417030;
        if (_Stack_1a0.MaxCharSize == 1) {
          unaff_ESI[4] = (UINT)&LAB_00416dd0;
        }
        else if (_Stack_1a0.MaxCharSize == 2) {
          unaff_ESI[4] = (UINT)&LAB_00416de0;
        }
        else {
          unaff_ESI[4] = (UINT)&LAB_00416e20;
        }
      }
    }
  }
LAB_00416a77:
  if (local_1a4 != 0) {
    UVar3 = *unaff_ESI;
    if ((int)UVar3 < 0xc42f) {
      if (((int)UVar3 < 0xc42c) && (UVar3 != 0x3a4)) {
        if (UVar3 == 0x51c4) {
          unaff_ESI[7] = (UINT)&DAT_0044ab00;
          ___security_check_cookie_4(local_4 ^ (uint)&local_1a8);
          return;
        }
        goto LAB_00416acc;
      }
    }
    else if (UVar3 != 0xcadc) goto LAB_00416acc;
    unaff_ESI[7] = (UINT)&DAT_0044aa88;
  }
LAB_00416acc:
  ___security_check_cookie_4(local_4 ^ (uint)&local_1a8);
  return;
}



int FUN_00416af0(void)

{
  char *in_EAX;
  undefined **ppuVar1;
  int iVar2;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  bool bVar6;
  
  if (*in_EAX == '\0') {
LAB_00416bba:
                    // WARNING: Could not recover jumptable at 0x00416bbd. Too many branches
                    // WARNING: Treating indirect jump as call
    iVar3 = GetACP();
    return iVar3;
  }
  iVar3 = 5;
  bVar6 = true;
  pcVar4 = in_EAX;
  pcVar5 = "char";
  do {
    if (iVar3 == 0) break;
    iVar3 = iVar3 + -1;
    bVar6 = *pcVar4 == *pcVar5;
    pcVar4 = pcVar4 + 1;
    pcVar5 = pcVar5 + 1;
  } while (bVar6);
  if (bVar6) goto LAB_00416bba;
  iVar3 = 8;
  bVar6 = true;
  pcVar4 = in_EAX;
  pcVar5 = "wchar_t";
  do {
    if (iVar3 == 0) break;
    iVar3 = iVar3 + -1;
    bVar6 = *pcVar4 == *pcVar5;
    pcVar4 = pcVar4 + 1;
    pcVar5 = pcVar5 + 1;
  } while (bVar6);
  if (bVar6) {
    return 0x4b0;
  }
  iVar3 = _strnicmp(in_EAX,"cp",2);
  if (iVar3 != 0) {
    if (('/' < *in_EAX) && (*in_EAX < ':')) goto LAB_00416b49;
    iVar3 = _strnicmp(in_EAX,"xx",2);
    if (iVar3 != 0) {
      iVar3 = 0;
      if (PTR_s_CP65001_0044a08c != (undefined *)0x0) {
        ppuVar1 = &PTR_s_CP65001_0044a08c;
        do {
          iVar2 = _stricmp(in_EAX,*ppuVar1);
          if (iVar2 == 0) {
            return (&DAT_0044a088)[iVar3 * 2];
          }
          iVar3 = iVar3 + 1;
          ppuVar1 = &PTR_s_CP65001_0044a08c + iVar3 * 2;
        } while ((&PTR_s_CP65001_0044a08c)[iVar3 * 2] != (undefined *)0x0);
      }
      return -1;
    }
  }
  in_EAX = in_EAX + 2;
LAB_00416b49:
  iVar3 = atoi(in_EAX);
  return iVar3;
}



void __fastcall FUN_00416bd0(ushort *param_1,undefined4 *param_2)

{
  uint in_EAX;
  
  if (in_EAX < 0x10000) {
    *param_1 = (ushort)in_EAX;
    *param_2 = 1;
    return;
  }
  *param_1 = (ushort)(in_EAX - 0x10000 >> 10) & 0x3ff | 0xd800;
  param_1[1] = (ushort)(in_EAX - 0x10000) & 0x3ff | 0xdc00;
  *param_2 = 2;
  return;
}



undefined4 FUN_00416c20(void)

{
  int in_EAX;
  
  if (((((((in_EAX != 0xc42c) && (in_EAX != 0xc42d)) && (in_EAX != 0xc42e)) &&
        ((in_EAX != 0xc431 && (in_EAX != 0xc433)))) &&
       ((in_EAX != 0xc435 && ((in_EAX != 0xcec8 && (in_EAX != 0xd698)))))) &&
      ((in_EAX < 0xdeaa || (0xdeb3 < in_EAX)))) && ((in_EAX != 65000 && (in_EAX != 0x2a)))) {
    return 8;
  }
  return 0;
}



undefined4 FUN_00416c80(void)

{
  int in_EAX;
  
  if (((((in_EAX != 65000) && (in_EAX != 0xfde9)) && (in_EAX != 0xc42c)) &&
      ((((in_EAX != 0xc42d && (in_EAX != 0xc42e)) &&
        ((in_EAX != 0xc431 && ((in_EAX != 0xc433 && (in_EAX != 0xc435)))))) && (in_EAX != 0xcec8))))
     && ((in_EAX != 0xd698 && (((in_EAX < 0xdeaa || (0xdeb3 < in_EAX)) && (in_EAX != 0x2a)))))) {
    return 0;
  }
  return 1;
}



void __fastcall FUN_00416cf0(undefined4 param_1,short *param_2,undefined4 *param_3)

{
  int iVar1;
  int in_EAX;
  
  if ((*param_2 == -2) && ((*(byte *)(in_EAX + 0x14) & 1) != 0)) {
    *(uint *)(in_EAX + 0x10) = *(uint *)(in_EAX + 0x10) ^ 1;
    *(uint *)(in_EAX + 0x28) = *(uint *)(in_EAX + 0x28) | 2;
    *param_2 = -0x101;
  }
  else if (*param_2 != -0x101) {
    return;
  }
  iVar1 = *(int *)(in_EAX + 0x30);
  if (((((iVar1 != 0x4b0) && (iVar1 != 0x4b1)) && (iVar1 != 12000)) &&
      (((iVar1 != 0x2ee1 && (iVar1 != 65000)) && (iVar1 != 0xfde9)))) || (iVar1 == 0xfde9)) {
    *param_3 = 0;
  }
  return;
}



char * FUN_00416d60(void)

{
  char *pcVar1;
  char *pcVar2;
  char *_Str1;
  int iVar3;
  char *unaff_EDI;
  
  pcVar1 = "//";
  do {
    pcVar2 = pcVar1;
    pcVar1 = pcVar2 + 1;
  } while (*pcVar2 != '\0');
  pcVar1 = unaff_EDI;
  do {
    _Str1 = pcVar1;
    pcVar1 = _Str1 + 1;
  } while (*_Str1 != '\0');
  do {
    _Str1 = _Str1 + -1;
    if (_Str1 < unaff_EDI) {
      return (char *)0x0;
    }
  } while ((*_Str1 != '/') || (iVar3 = strncmp(_Str1,"//",(size_t)(pcVar2 + -0x43f990)), iVar3 != 0)
          );
  return _Str1;
}



void __cdecl FUN_00417160(undefined4 *param_1,undefined4 param_2,int param_3,void *param_4)

{
  int iVar1;
  void *_Dst;
  int iVar2;
  int *piVar3;
  uint unaff_EBX;
  int *piStack_30;
  undefined *puStack_2c;
  undefined4 *puStack_28;
  undefined4 local_18;
  undefined local_14 [8];
  int iStack_c;
  uint local_4;
  
  _Dst = param_4;
  iVar1 = param_3;
  local_4 = DAT_0044a01c ^ (uint)&local_18;
  puStack_28 = &local_18;
  puStack_2c = local_14;
  piStack_30 = &param_3;
  local_18 = 0x10;
  iVar2 = (*DAT_0044cec4)(param_1 + 6,*param_1,param_2);
  if ((iVar2 == 0) && (iVar1 == iStack_c)) {
    if ((int)local_4 < (int)piStack_30) {
      piVar3 = _errno();
      *piVar3 = 7;
      ___security_check_cookie_4(unaff_EBX ^ (uint)&piStack_30);
      return;
    }
    piVar3 = (int *)(*(code *)param_1[4])(param_1,&puStack_2c,piStack_30);
    if (piVar3 == piStack_30) {
      memcpy(_Dst,&puStack_2c,(size_t)piStack_30);
      ___security_check_cookie_4(unaff_EBX ^ (uint)&piStack_30);
      return;
    }
  }
  piVar3 = _errno();
  *piVar3 = 0x2a;
  ___security_check_cookie_4(unaff_EBX ^ (uint)&piStack_30);
  return;
}



undefined4 __cdecl
FUN_00417240(int *param_1,ushort *param_2,int param_3,ushort *param_4,undefined4 *param_5)

{
  ushort uVar1;
  int *piVar2;
  
  if (param_3 < 2) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    return 0xffffffff;
  }
  if (*param_1 == 0x4b0) {
    uVar1 = *param_2;
LAB_00417288:
    *param_4 = uVar1;
  }
  else if (*param_1 == 0x4b1) {
    uVar1 = CONCAT11(*(undefined *)param_2,*(undefined *)((int)param_2 + 1));
    goto LAB_00417288;
  }
  uVar1 = *param_4;
  if ((0xdbff < uVar1) && (uVar1 < 0xe000)) goto LAB_00417305;
  if ((uVar1 < 0xd800) || (0xdbff < uVar1)) {
    *param_5 = 1;
    return 2;
  }
  if (param_3 < 4) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    return 0xffffffff;
  }
  if (*param_1 == 0x4b0) {
    uVar1 = param_2[1];
LAB_004172df:
    param_4[1] = uVar1;
  }
  else if (*param_1 == 0x4b1) {
    uVar1 = CONCAT11(*(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3));
    goto LAB_004172df;
  }
  if ((0xdbff < param_4[1]) && (param_4[1] < 0xe000)) {
    *param_5 = 2;
    return 4;
  }
LAB_00417305:
  piVar2 = _errno();
  *piVar2 = 0x2a;
  return 0xffffffff;
}



undefined4 __cdecl
FUN_00417330(int *param_1,ushort *param_2,undefined4 param_3,undefined *param_4,int param_5)

{
  undefined uVar1;
  int *piVar2;
  
  if (param_5 < 2) {
    piVar2 = _errno();
    *piVar2 = 7;
    return 0xffffffff;
  }
  if (*param_1 == 0x4b0) {
    *param_4 = *(undefined *)param_2;
    uVar1 = *(undefined *)((int)param_2 + 1);
  }
  else {
    if (*param_1 != 0x4b1) goto LAB_0041737f;
    *param_4 = *(undefined *)((int)param_2 + 1);
    uVar1 = *(undefined *)param_2;
  }
  param_4[1] = uVar1;
LAB_0041737f:
  if ((*param_2 < 0xd800) || (0xdbff < *param_2)) {
    return 2;
  }
  if (param_5 < 4) {
    piVar2 = _errno();
    *piVar2 = 7;
    return 0xffffffff;
  }
  if (*param_1 == 0x4b0) {
    param_4[2] = *(undefined *)(param_2 + 1);
    param_4[3] = *(undefined *)((int)param_2 + 3);
    return 4;
  }
  if (*param_1 == 0x4b1) {
    param_4[2] = *(undefined *)((int)param_2 + 3);
    param_4[3] = *(undefined *)(param_2 + 1);
  }
  return 4;
}



void __cdecl
FUN_00417550(int *param_1,byte *param_2,size_t param_3,ushort *param_4,undefined4 *param_5)

{
  byte bVar1;
  size_t _Size;
  size_t sVar2;
  undefined **ppuVar3;
  int iVar4;
  int *piVar5;
  uint uVar6;
  size_t _Size_00;
  int iVar7;
  uint local_30;
  int *local_2c;
  uint local_28;
  undefined4 *local_24;
  ushort *local_20;
  int local_1c;
  undefined4 local_18;
  undefined local_14 [16];
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_30;
  local_20 = param_4;
  bVar1 = *param_2;
  local_2c = param_1;
  local_24 = param_5;
  local_18 = 0;
  if (bVar1 == 0x1b) {
    iVar7 = 0;
    if (PTR_DAT_0044ab80 != (undefined *)0x0) {
      ppuVar3 = &PTR_DAT_0044ab80;
      do {
        if ((int)param_3 < (int)ppuVar3[1]) {
          iVar4 = strncmp((char *)param_2,*ppuVar3,param_3);
          if (iVar4 == 0) goto LAB_004175bd;
        }
        else {
          iVar4 = strncmp((char *)param_2,*ppuVar3,(size_t)ppuVar3[1]);
          if (iVar4 == 0) {
            local_2c[6] = (&DAT_0044ab8c)[iVar7 * 4] << 8;
            *local_24 = 0;
            ___security_check_cookie_4(local_4 ^ (uint)&local_30);
            return;
          }
        }
        iVar7 = iVar7 + 1;
        ppuVar3 = &PTR_DAT_0044ab80 + iVar7 * 4;
      } while ((&PTR_DAT_0044ab80)[iVar7 * 4] != (undefined *)0x0);
    }
  }
  else {
    if (bVar1 == 0xe) {
      param_1[6] = (uint)*(byte *)((int)param_1 + 0x19) << 8 | 1;
      *param_5 = 0;
      ___security_check_cookie_4(local_4 ^ (uint)&local_30);
      return;
    }
    if (bVar1 == 0xf) {
      param_1[6] = (uint)*(byte *)((int)param_1 + 0x19) << 8;
      *param_5 = 0;
      ___security_check_cookie_4(local_4 ^ (uint)&local_30);
      return;
    }
    local_28 = (uint)*(byte *)((int)param_1 + 0x19);
    local_30 = param_1[6] & 0xff;
    if (bVar1 < 0x20) {
      local_28 = 0;
      local_30 = 0;
    }
    uVar6 = local_30;
    _Size = (&DAT_0044ab88)[local_28 * 4];
    if ((int)param_3 < (int)_Size) {
LAB_004175bd:
      piVar5 = _errno();
      *piVar5 = 0x16;
      goto LAB_004175fc;
    }
    iVar7 = 0;
    if (0 < (int)_Size) {
      do {
        if (0x7f < param_2[iVar7]) goto LAB_004175f0;
        iVar7 = iVar7 + 1;
      } while (iVar7 < (int)_Size);
    }
    _Size_00 = (&DAT_0044ab84)[local_28 * 4];
    memcpy(local_14,(&PTR_DAT_0044ab80)[local_28 * 4],_Size_00);
    if (uVar6 == 1) {
      local_14[_Size_00] = 0xe;
      _Size_00 = _Size_00 + 1;
    }
    memcpy(local_14 + _Size_00,param_2,_Size);
    sVar2 = DAT_0044aba4;
    iVar7 = *local_2c;
    if ((((iVar7 == 0xc42c) || (iVar7 == 0xc42d)) || (iVar7 == 0xc42e)) && (local_30 == 1)) {
      memcpy(local_14,PTR_DAT_0044aba0,DAT_0044aba4);
      memcpy(local_14 + sVar2,param_2,_Size);
      _Size_00 = sVar2;
    }
    local_1c = _Size_00 + _Size;
    iVar7 = (*DAT_0044ced0)(&local_18,iVar7,local_14,&local_1c,local_20,local_24);
    if (((iVar7 == 0) && (local_1c == _Size_00 + _Size)) &&
       ((*local_20 != (ushort)*param_2 || (local_2c[6] == 0)))) {
      uVar6 = local_28 << 8 | local_30;
      if (local_2c[6] != uVar6) {
        local_2c[6] = uVar6;
      }
      ___security_check_cookie_4(local_4 ^ (uint)&local_30);
      return;
    }
  }
LAB_004175f0:
  piVar5 = _errno();
  *piVar5 = 0x2a;
LAB_004175fc:
  ___security_check_cookie_4(local_4 ^ (uint)&local_30);
  return;
}



void __cdecl FUN_004177f0(undefined4 *param_1,ushort *param_2,int param_3,uint param_4)

{
  char *pcVar1;
  size_t _Size;
  undefined *_Size_00;
  int iVar2;
  int *piVar3;
  undefined **ppuVar4;
  uint uVar5;
  ushort *unaff_EBP;
  char *unaff_ESI;
  char *_MaxCount;
  int iVar6;
  int *piStack_40;
  undefined *puStack_3c;
  undefined4 *puStack_38;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 *local_20;
  uint local_1c;
  ushort *local_18;
  undefined local_14 [8];
  int iStack_c;
  uint local_4;
  
  iVar6 = param_3;
  local_4 = DAT_0044a01c ^ (uint)&local_28;
  puStack_38 = &local_24;
  puStack_3c = local_14;
  local_1c = param_4;
  piStack_40 = &param_3;
  local_20 = param_1;
  local_18 = param_2;
  local_24 = 0x10;
  local_28 = 0;
  iVar2 = (*DAT_0044cec4)(&local_28,*param_1,param_2);
  if ((iVar2 != 0) || (iVar6 != iStack_c)) {
    piVar3 = _errno();
    *piVar3 = 0x2a;
    ___security_check_cookie_4(local_1c ^ (uint)&piStack_40);
    return;
  }
  if ((int)local_4 < (int)puStack_3c) {
    piVar3 = _errno();
    *piVar3 = 7;
    ___security_check_cookie_4(local_1c ^ (uint)&piStack_40);
    return;
  }
  if (puStack_3c == (undefined *)0x1) {
    piVar3 = (int *)0x0;
    _MaxCount = (char *)0x0;
LAB_00417907:
    _Size_00 = DAT_0044ab84;
    pcVar1 = &stack0xffffffd4 + (int)_MaxCount;
    if (*pcVar1 == '\x0e') {
      _MaxCount = _MaxCount + 1;
    }
    _Size = (&DAT_0044ab88)[(int)piVar3 * 4];
    if (((piVar3 != (int *)0x0) || (*param_2 < 0x80)) &&
       ((int)(_MaxCount + _Size) <= (int)puStack_3c)) {
      uVar5 = (int)piVar3 << 8 | (uint)(*pcVar1 == '\x0e');
      if (param_1[6] == uVar5) {
        if (_MaxCount != (char *)0x0) {
          memmove(&stack0xffffffd4,&stack0xffffffd4 + (int)_MaxCount,_Size);
        }
        _MaxCount = (char *)0x0;
      }
      else {
        if (piVar3 == (int *)0x0) {
          memmove(&stack0xffffffd4 + (int)DAT_0044ab84,&stack0xffffffd4,_Size);
          memcpy(&stack0xffffffd4,PTR_DAT_0044ab80,(size_t)_Size_00);
          _MaxCount = _Size_00;
        }
        param_1 = puStack_38;
        if (*(char *)(puStack_38 + 6) == '\x01') {
          memmove(&stack0xffffffd5,&stack0xffffffd4,(size_t)(_MaxCount + _Size));
          _MaxCount = _MaxCount + 1;
          param_1 = puStack_38;
        }
      }
      if ((int)(_MaxCount + _Size) <= (int)local_4) {
        memcpy(unaff_ESI,&stack0xffffffd4,(size_t)(_MaxCount + _Size));
        param_1[6] = uVar5;
        ___security_check_cookie_4(local_1c ^ (uint)&piStack_40);
        return;
      }
      piVar3 = _errno();
      *piVar3 = 7;
      goto LAB_00417940;
    }
  }
  else {
    iVar6 = 1;
    piVar3 = piStack_40;
    _MaxCount = unaff_ESI;
    if (PTR_DAT_0044ab90 != (undefined *)0x0) {
      ppuVar4 = &PTR_DAT_0044ab90;
      iVar6 = 1;
      do {
        _MaxCount = ppuVar4[1];
        iVar2 = strncmp(&stack0xffffffd4,*ppuVar4,(size_t)_MaxCount);
        if (iVar2 == 0) {
          piVar3 = (int *)(&DAT_0044ab8c)[iVar6 * 4];
          break;
        }
        iVar6 = iVar6 + 1;
        ppuVar4 = &PTR_DAT_0044ab80 + iVar6 * 4;
        piVar3 = piStack_40;
      } while ((&PTR_DAT_0044ab80)[iVar6 * 4] != (undefined *)0x0);
    }
    param_2 = unaff_EBP;
    if ((&PTR_DAT_0044ab80)[iVar6 * 4] != (undefined *)0x0) goto LAB_00417907;
  }
  piVar3 = _errno();
  *piVar3 = 0x2a;
LAB_00417940:
  ___security_check_cookie_4(local_1c ^ (uint)&piStack_40);
  return;
}



void __fastcall FUN_00417ad0(void *param_1,uint param_2)

{
  int iVar1;
  int iVar2;
  __time64_t _Var3;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_24;
  if (((DAT_0044d250 == 0) && (-1 < (int)param_2)) && (param_1 != (void *)0x0)) {
    if (0x20 < param_2) {
      param_2 = 0x20;
    }
    local_24 = 0;
    local_20 = 0;
    local_1c = 0;
    local_18 = 0;
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    local_8 = 0;
    memcpy(&local_24,param_1,param_2);
    iVar2 = param_2 * 8;
    if (iVar2 < 0x81) {
      iVar2 = 0x80;
    }
    else if (iVar2 < 0xc1) {
      iVar2 = 0xc0;
    }
    else if (iVar2 < 0x101) {
      iVar2 = 0x100;
    }
    iVar1 = FUN_00417d80(iVar2,(undefined *)&local_24);
    if (iVar1 == 0) {
      iVar2 = FUN_00418290(iVar2,(undefined *)&local_24);
      if (iVar2 == 0) {
        _Var3 = _time64((__time64_t *)0x0);
        srand((uint)_Var3);
        iVar2 = 0;
        do {
          iVar1 = rand();
          *(char *)((int)&DAT_0044ced4 + iVar2) = (char)iVar1;
          iVar2 = iVar2 + 1;
        } while (iVar2 < 0x10);
        DAT_0044d250 = 1;
        ___security_check_cookie_4(local_4 ^ (uint)&local_24);
        return;
      }
    }
  }
  ___security_check_cookie_4(local_4 ^ (uint)&local_24);
  return;
}



void __cdecl FUN_00417bf0(undefined4 *param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  uint *puVar3;
  bool bVar4;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  uint local_4;
  
  puVar3 = DAT_0044d0d8;
  local_4 = DAT_0044a01c ^ (uint)&local_14;
  *DAT_0044d0d8 = param_2;
  puVar3[1] = DAT_0044ced4;
  puVar3[2] = DAT_0044ced8;
  puVar3[3] = DAT_0044cedc;
  puVar3[4] = DAT_0044cee0;
  puVar3 = puVar3 + 5;
  uVar1 = param_2 & 0x8000000f;
  bVar4 = uVar1 == 0;
  if ((int)uVar1 < 0) {
    bVar4 = (uVar1 - 1 | 0xfffffff0) == 0xffffffff;
  }
  if (bVar4) {
    FUN_00418fd0(&DAT_0044cfe0,param_1,puVar3,param_2,&DAT_0044ced4,1);
    ___security_check_cookie_4(local_4 ^ (uint)&local_14);
    return;
  }
  iVar2 = (int)(param_2 + ((int)param_2 >> 0x1f & 0xfU)) >> 4;
  FUN_00418fd0(&DAT_0044cfe0,param_1,puVar3,iVar2 * 0x10,&DAT_0044ced4,1);
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  memcpy(&local_14,param_1 + iVar2 * 4,param_2 + iVar2 * -0x10);
  FUN_00418fd0(&DAT_0044cfe0,&local_14,puVar3 + iVar2 * 4,0x10,&DAT_0044ced4,1);
  ___security_check_cookie_4(local_4 ^ (uint)&local_14);
  return;
}



void __cdecl FUN_00417d00(int param_1)

{
  uint local_14;
  uint local_10;
  uint local_c;
  uint local_8;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_14;
  local_14 = DAT_0044d0d8[1];
  local_10 = DAT_0044d0d8[2];
  local_c = DAT_0044d0d8[3];
  local_8 = DAT_0044d0d8[4];
  if (param_1 + -0x14 < (int)*DAT_0044d0d8) {
    ___security_check_cookie_4(local_4 ^ (uint)&local_14);
    return;
  }
  FUN_00418fd0(&DAT_0044cee8,DAT_0044d0d8 + 5,DAT_0044d0dc,*DAT_0044d0d8,&local_14,0);
  ___security_check_cookie_4(local_4 ^ (uint)&local_14);
  return;
}



undefined4 __fastcall FUN_00417d80(int param_1,undefined *param_2)

{
  byte bVar1;
  undefined uVar2;
  undefined uVar3;
  byte bVar4;
  uint3 uVar5;
  ushort uVar6;
  uint *in_EAX;
  uint *puVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint *puVar11;
  uint *puVar12;
  
  if ((param_2 == (undefined *)0x0) || (in_EAX == (uint *)0x0)) {
    return 0xffffffff;
  }
  if (param_1 != 0x80) {
    if ((param_1 != 0xc0) && (param_1 != 0x100)) {
      return 0xfffffffe;
    }
    if (param_1 != 0x80) {
      in_EAX[0x3c] = (uint)(param_1 != 0xc0) * 2 + 0xc;
      goto LAB_00417ddb;
    }
  }
  in_EAX[0x3c] = 10;
LAB_00417ddb:
  uVar2 = param_2[5];
  *in_EAX = CONCAT31(CONCAT21(CONCAT11(*param_2,param_2[1]),param_2[2]),param_2[3]);
  puVar7 = in_EAX + 1;
  uVar3 = param_2[9];
  *puVar7 = CONCAT31(CONCAT21(CONCAT11(param_2[4],uVar2),param_2[6]),param_2[7]);
  uVar2 = param_2[0xd];
  in_EAX[2] = CONCAT31(CONCAT21(CONCAT11(param_2[8],uVar3),param_2[10]),param_2[0xb]);
  bVar1 = param_2[0xc];
  uVar5 = CONCAT21(CONCAT11(bVar1,uVar2),param_2[0xe]);
  bVar4 = param_2[0xf];
  uVar8 = CONCAT31(uVar5,bVar4);
  in_EAX[3] = uVar8;
  if (param_1 == 0x80) {
    uVar10 = (*(uint *)(&DAT_00440c60 + (((uVar5 & 0xff00) << 8) >> 0x10) * 4) ^ 0x1000000) &
             0xff000000 ^ *(uint *)(&DAT_00441060 + (uVar5 & 0xff) * 4) & 0xff0000 ^
             (uint)(byte)(&DAT_00440860)[(uint)bVar1 * 4] ^
             *(uint *)(&DAT_00440460 + (uint)bVar4 * 4) & 0xff00 ^ *in_EAX;
    uVar9 = *puVar7 ^ uVar10;
    in_EAX[4] = uVar10;
    uVar10 = in_EAX[2] ^ uVar9;
    in_EAX[6] = uVar10;
    in_EAX[5] = uVar9;
    in_EAX[7] = uVar10 ^ uVar8;
    puVar12 = &DAT_00442564;
    do {
      uVar8 = puVar7[6];
      puVar11 = puVar12 + 1;
      uVar8 = *(uint *)(&DAT_00441060 + (uVar8 >> 8 & 0xff) * 4) & 0xff0000 ^
              *(uint *)(&DAT_00440c60 + (uVar8 >> 0x10 & 0xff) * 4) & 0xff000000 ^
              (uint)(byte)(&DAT_00440860)[(uVar8 >> 0x18) * 4] ^
              *(uint *)(&DAT_00440460 + (uVar8 & 0xff) * 4) & 0xff00 ^ puVar7[3] ^ *puVar12;
      puVar7[7] = uVar8;
      uVar8 = puVar7[4] ^ uVar8;
      puVar7[8] = uVar8;
      uVar8 = puVar7[5] ^ uVar8;
      puVar7[9] = uVar8;
      puVar7[10] = puVar7[6] ^ uVar8;
      puVar7 = puVar7 + 4;
      puVar12 = puVar11;
    } while (puVar11 != (uint *)&DAT_00442588);
  }
  else {
    uVar2 = param_2[0x15];
    in_EAX[4] = CONCAT31(CONCAT21(CONCAT11(param_2[0x10],param_2[0x11]),param_2[0x12]),param_2[0x13]
                        );
    bVar1 = param_2[0x14];
    uVar5 = CONCAT21(CONCAT11(bVar1,uVar2),param_2[0x16]);
    bVar4 = param_2[0x17];
    in_EAX[5] = CONCAT31(uVar5,bVar4);
    if (param_1 == 0xc0) {
      uVar8 = (*(uint *)(&DAT_00440c60 + (((uVar5 & 0xff00) << 8) >> 0x10) * 4) ^ 0x1000000) &
              0xff000000 ^ *(uint *)(&DAT_00441060 + (uVar5 & 0xff) * 4) & 0xff0000 ^
              (uint)(byte)(&DAT_00440860)[(uint)bVar1 * 4] ^
              *(uint *)(&DAT_00440460 + (uint)bVar4 * 4) & 0xff00 ^ *in_EAX;
      uVar9 = *puVar7 ^ uVar8;
      in_EAX[6] = uVar8;
      uVar8 = in_EAX[2] ^ uVar9;
      in_EAX[7] = uVar9;
      in_EAX[8] = uVar8;
      in_EAX[9] = in_EAX[3] ^ uVar8;
      puVar7 = in_EAX + 10;
      puVar12 = &DAT_00442564;
      do {
        *puVar7 = puVar7[-6] ^ puVar7[-1];
        puVar7[1] = puVar7[-5] ^ puVar7[-6] ^ puVar7[-1];
        uVar8 = puVar7[1];
        puVar11 = puVar12 + 1;
        uVar8 = *(uint *)(&DAT_00441060 + (uVar8 >> 8 & 0xff) * 4) & 0xff0000 ^
                *(uint *)(&DAT_00440c60 + (uVar8 >> 0x10 & 0xff) * 4) & 0xff000000 ^
                (uint)(byte)(&DAT_00440860)[(uVar8 >> 0x18) * 4] ^
                *(uint *)(&DAT_00440460 + (uVar8 & 0xff) * 4) & 0xff00 ^ puVar7[-4] ^ *puVar12;
        puVar7[2] = uVar8;
        uVar8 = puVar7[-3] ^ uVar8;
        puVar7[3] = uVar8;
        uVar8 = puVar7[-2] ^ uVar8;
        puVar7[4] = uVar8;
        puVar7[5] = puVar7[-1] ^ uVar8;
        puVar7 = puVar7 + 6;
        puVar12 = puVar11;
      } while (puVar11 != (uint *)&DAT_00442580);
      return 0;
    }
    uVar2 = param_2[0x1d];
    in_EAX[6] = CONCAT31(CONCAT21(CONCAT11(param_2[0x18],param_2[0x19]),param_2[0x1a]),param_2[0x1b]
                        );
    bVar1 = param_2[0x1c];
    uVar6 = CONCAT11(bVar1,uVar2);
    bVar4 = param_2[0x1f];
    uVar5 = CONCAT21(uVar6,param_2[0x1e]);
    in_EAX[7] = CONCAT31(uVar5,bVar4);
    if (param_1 == 0x100) {
      uVar8 = (*(uint *)(&DAT_00440c60 + (uVar6 & 0xff) * 4) ^ 0x1000000) & 0xff000000 ^
              *(uint *)(&DAT_00441060 + (uVar5 & 0xff) * 4) & 0xff0000 ^
              (uint)(byte)(&DAT_00440860)[(uint)bVar1 * 4] ^
              *(uint *)(&DAT_00440460 + (uint)bVar4 * 4) & 0xff00 ^ *in_EAX;
      uVar9 = *puVar7 ^ uVar8;
      in_EAX[8] = uVar8;
      uVar8 = in_EAX[2] ^ uVar9;
      in_EAX[9] = uVar9;
      in_EAX[10] = uVar8;
      in_EAX[0xb] = in_EAX[3] ^ uVar8;
      puVar7 = in_EAX + 0xc;
      puVar12 = &DAT_00442564;
      do {
        uVar8 = puVar7[-1];
        uVar8 = *(uint *)(&DAT_00441060 + (uVar8 >> 0x10 & 0xff) * 4) & 0xff0000 ^
                *(uint *)(&DAT_00440460 + (uVar8 >> 8 & 0xff) * 4) & 0xff00 ^
                *(uint *)(&DAT_00440c60 + (uVar8 >> 0x18) * 4) & 0xff000000 ^
                (uint)(byte)(&DAT_00440860)[(uVar8 & 0xff) * 4] ^ puVar7[-8];
        uVar9 = puVar7[-7] ^ uVar8;
        *puVar7 = uVar8;
        uVar8 = puVar7[-6] ^ uVar9;
        puVar7[1] = uVar9;
        puVar7[2] = uVar8;
        puVar7[3] = puVar7[-5] ^ uVar8;
        uVar8 = puVar7[3];
        puVar11 = puVar12 + 1;
        uVar8 = *(uint *)(&DAT_00441060 + (uVar8 >> 8 & 0xff) * 4) & 0xff0000 ^
                *(uint *)(&DAT_00440c60 + (uVar8 >> 0x10 & 0xff) * 4) & 0xff000000 ^
                (uint)(byte)(&DAT_00440860)[(uVar8 >> 0x18) * 4] ^
                *(uint *)(&DAT_00440460 + (uVar8 & 0xff) * 4) & 0xff00 ^ puVar7[-4] ^ *puVar12;
        puVar7[4] = uVar8;
        uVar8 = puVar7[-3] ^ uVar8;
        puVar7[5] = uVar8;
        uVar8 = puVar7[-2] ^ uVar8;
        puVar7[6] = uVar8;
        puVar7[7] = puVar7[-1] ^ uVar8;
        puVar7 = puVar7 + 8;
        puVar12 = puVar11;
      } while (puVar11 != (uint *)&DAT_0044257c);
      return 0;
    }
  }
  return 0;
}



int __fastcall FUN_00418290(int param_1,undefined *param_2)

{
  undefined4 uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  undefined4 *puVar5;
  byte *pbVar6;
  undefined4 *puVar7;
  int iVar8;
  
  iVar4 = FUN_00417d80(param_1,param_2);
  if (-1 < iVar4) {
    iVar4 = DAT_0044cfd8 * 4;
    iVar8 = 0;
    if (0 < iVar4) {
      puVar7 = &DAT_0044cef0 + DAT_0044cfd8 * 4;
      puVar5 = &DAT_0044cef0;
      do {
        uVar1 = puVar5[-2];
        puVar5[-2] = puVar7[-2];
        puVar7[-2] = uVar1;
        uVar1 = puVar5[-1];
        puVar5[-1] = puVar7[-1];
        puVar7[-1] = uVar1;
        uVar1 = *puVar5;
        *puVar5 = *puVar7;
        *puVar7 = uVar1;
        uVar1 = puVar5[1];
        puVar5[1] = puVar7[1];
        puVar7[1] = uVar1;
        iVar8 = iVar8 + 4;
        iVar4 = iVar4 + -4;
        puVar5 = puVar5 + 4;
        puVar7 = puVar7 + -4;
      } while (iVar8 < iVar4);
    }
    iVar4 = 1;
    if (1 < DAT_0044cfd8) {
      pbVar6 = (byte *)((int)&DAT_0044cee8 + 2);
      do {
        uVar2 = *(uint *)(&DAT_00440860 + (uint)pbVar6[0x13] * 4);
        *(uint *)(pbVar6 + 0xe) =
             *(uint *)(&DAT_00441460 +
                      (*(uint *)(&DAT_00440860 + (*(uint *)(pbVar6 + 0xe) >> 0x18) * 4) & 0xff) * 4)
             ^ *(uint *)(&DAT_00441c60 +
                        (*(uint *)(&DAT_00440860 + (uint)pbVar6[0xf] * 4) & 0xff) * 4) ^
             *(uint *)(&DAT_00442060 +
                      (*(uint *)(&DAT_00440860 + (*(uint *)(pbVar6 + 0xe) & 0xff) * 4) & 0xff) * 4)
             ^ *(uint *)(&DAT_00441860 +
                        (*(uint *)(&DAT_00440860 + (uint)pbVar6[0x10] * 4) & 0xff) * 4);
        uVar3 = *(uint *)(&DAT_00440860 + (uint)pbVar6[0x17] * 4);
        *(uint *)(pbVar6 + 0x12) =
             *(uint *)(&DAT_00441460 +
                      (*(uint *)(&DAT_00440860 + (*(uint *)(pbVar6 + 0x12) >> 0x18) * 4) & 0xff) * 4
                      ) ^ *(uint *)(&DAT_00441c60 + (uVar2 & 0xff) * 4) ^
             *(uint *)(&DAT_00441860 +
                      (*(uint *)(&DAT_00440860 + (uint)pbVar6[0x14] * 4) & 0xff) * 4) ^
             *(uint *)(&DAT_00442060 +
                      (*(uint *)(&DAT_00440860 + (*(uint *)(pbVar6 + 0x12) & 0xff) * 4) & 0xff) * 4)
        ;
        uVar2 = *(uint *)(&DAT_00440860 + (uint)pbVar6[0x1b] * 4);
        *(uint *)(pbVar6 + 0x16) =
             *(uint *)(&DAT_00441460 +
                      (*(uint *)(&DAT_00440860 + (*(uint *)(pbVar6 + 0x16) >> 0x18) * 4) & 0xff) * 4
                      ) ^ *(uint *)(&DAT_00441c60 + (uVar3 & 0xff) * 4) ^
             *(uint *)(&DAT_00441860 +
                      (*(uint *)(&DAT_00440860 + (uint)pbVar6[0x18] * 4) & 0xff) * 4) ^
             *(uint *)(&DAT_00442060 +
                      (*(uint *)(&DAT_00440860 + (*(uint *)(pbVar6 + 0x16) & 0xff) * 4) & 0xff) * 4)
        ;
        iVar4 = iVar4 + 1;
        *(uint *)(pbVar6 + 0x1a) =
             *(uint *)(&DAT_00441460 +
                      (*(uint *)(&DAT_00440860 + (*(uint *)(pbVar6 + 0x1a) >> 0x18) * 4) & 0xff) * 4
                      ) ^ *(uint *)(&DAT_00441c60 + (uVar2 & 0xff) * 4) ^
             *(uint *)(&DAT_00441860 +
                      (*(uint *)(&DAT_00440860 + (uint)pbVar6[0x1c] * 4) & 0xff) * 4) ^
             *(uint *)(&DAT_00442060 +
                      (*(uint *)(&DAT_00440860 + (*(uint *)(pbVar6 + 0x1a) & 0xff) * 4) & 0xff) * 4)
        ;
        pbVar6 = pbVar6 + 0x10;
      } while (iVar4 < DAT_0044cfd8);
    }
    iVar4 = 0;
  }
  return iVar4;
}



void __thiscall FUN_004184e0(void *this,undefined *param_1)

{
  uint *in_EAX;
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  uint *puVar9;
  undefined local_18;
  undefined local_10;
  undefined local_4;
  
                    // WARNING: Load size is inaccurate
  uVar1 = CONCAT31(CONCAT21(CONCAT11(*this,*(undefined *)((int)this + 1)),
                            *(undefined *)((int)this + 2)),*(undefined *)((int)this + 3)) ^ *in_EAX;
  uVar3 = CONCAT31(CONCAT21(CONCAT11(*(undefined *)((int)this + 4),*(undefined *)((int)this + 5)),
                            *(undefined *)((int)this + 6)),*(undefined *)((int)this + 7)) ^
          in_EAX[1];
  uVar4 = CONCAT31(CONCAT21(CONCAT11(*(undefined *)((int)this + 8),*(undefined *)((int)this + 9)),
                            *(undefined *)((int)this + 10)),*(undefined *)((int)this + 0xb)) ^
          in_EAX[2];
  uVar7 = CONCAT31(CONCAT21(CONCAT11(*(undefined *)((int)this + 0xc),*(undefined *)((int)this + 0xd)
                                    ),*(undefined *)((int)this + 0xe)),
                   *(undefined *)((int)this + 0xf)) ^ in_EAX[3];
  uVar2 = *(uint *)(&DAT_00440c60 + (uVar4 >> 8 & 0xff) * 4) ^
          *(uint *)(&DAT_00440860 + (uVar3 >> 0x10 & 0xff) * 4) ^
          *(uint *)(&DAT_00440460 + (uVar1 >> 0x18) * 4) ^
          *(uint *)(&DAT_00441060 + (uVar7 & 0xff) * 4) ^ in_EAX[4];
  uVar5 = *(uint *)(&DAT_00440c60 + (uVar7 >> 8 & 0xff) * 4) ^
          *(uint *)(&DAT_00440860 + (uVar4 >> 0x10 & 0xff) * 4) ^
          *(uint *)(&DAT_00440460 + (uVar3 >> 0x18) * 4) ^
          *(uint *)(&DAT_00441060 + (uVar1 & 0xff) * 4) ^ in_EAX[5];
  uVar6 = *(uint *)(&DAT_00440860 + (uVar7 >> 0x10 & 0xff) * 4) ^
          *(uint *)(&DAT_00440c60 + (uVar1 >> 8 & 0xff) * 4) ^
          *(uint *)(&DAT_00440460 + (uVar4 >> 0x18) * 4) ^
          *(uint *)(&DAT_00441060 + (uVar3 & 0xff) * 4) ^ in_EAX[6];
  iVar8 = (int)in_EAX[0x3c] >> 1;
  uVar1 = *(uint *)(&DAT_00440c60 + (uVar3 >> 8 & 0xff) * 4) ^
          *(uint *)(&DAT_00440860 + (uVar1 >> 0x10 & 0xff) * 4) ^
          *(uint *)(&DAT_00440460 + (uVar7 >> 0x18) * 4) ^
          *(uint *)(&DAT_00441060 + (uVar4 & 0xff) * 4) ^ in_EAX[7];
  puVar9 = in_EAX + 8;
  while (iVar8 = iVar8 + -1, iVar8 != 0) {
    uVar7 = *(uint *)(&DAT_00440c60 + (uVar1 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00440860 + (uVar6 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00440460 + (uVar5 >> 0x18) * 4) ^
            *(uint *)(&DAT_00441060 + (uVar2 & 0xff) * 4) ^ puVar9[1];
    uVar3 = *(uint *)(&DAT_00440c60 + (uVar6 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00440860 + (uVar5 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00440460 + (uVar2 >> 0x18) * 4) ^
            *(uint *)(&DAT_00441060 + (uVar1 & 0xff) * 4) ^ *puVar9;
    uVar4 = *(uint *)(&DAT_00440860 + (uVar1 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00440c60 + (uVar2 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00440460 + (uVar6 >> 0x18) * 4) ^
            *(uint *)(&DAT_00441060 + (uVar5 & 0xff) * 4) ^ puVar9[2];
    uVar1 = *(uint *)(&DAT_00440c60 + (uVar5 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00440860 + (uVar2 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00440460 + (uVar1 >> 0x18) * 4) ^
            *(uint *)(&DAT_00441060 + (uVar6 & 0xff) * 4) ^ puVar9[3];
    uVar2 = *(uint *)(&DAT_00440c60 + (uVar4 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00440860 + (uVar7 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00440460 + (uVar3 >> 0x18) * 4) ^
            *(uint *)(&DAT_00441060 + (uVar1 & 0xff) * 4) ^ puVar9[4];
    uVar5 = *(uint *)(&DAT_00440c60 + (uVar1 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00440860 + (uVar4 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00440460 + (uVar7 >> 0x18) * 4) ^
            *(uint *)(&DAT_00441060 + (uVar3 & 0xff) * 4) ^ puVar9[5];
    uVar6 = *(uint *)(&DAT_00440860 + (uVar1 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00440c60 + (uVar3 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00440460 + (uVar4 >> 0x18) * 4) ^
            *(uint *)(&DAT_00441060 + (uVar7 & 0xff) * 4) ^ puVar9[6];
    uVar1 = *(uint *)(&DAT_00440c60 + (uVar7 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00440860 + (uVar3 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00440460 + (uVar1 >> 0x18) * 4) ^
            *(uint *)(&DAT_00441060 + (uVar4 & 0xff) * 4) ^ puVar9[7];
    puVar9 = puVar9 + 8;
  }
  uVar3 = *(uint *)(&DAT_00441060 + (uVar5 >> 0x10 & 0xff) * 4) & 0xff0000 ^
          *(uint *)(&DAT_00440460 + (uVar6 >> 8 & 0xff) * 4) & 0xff00 ^
          *(uint *)(&DAT_00440c60 + (uVar2 >> 0x18) * 4) & 0xff000000 ^
          (uint)(byte)(&DAT_00440860)[(uVar1 & 0xff) * 4] ^ *puVar9;
  *param_1 = (char)(uVar3 >> 0x18);
  param_1[1] = (char)(uVar3 >> 0x10);
  param_1[2] = (char)(uVar3 >> 8);
  local_4 = (undefined)uVar3;
  param_1[3] = local_4;
  uVar3 = *(uint *)(&DAT_00441060 + (uVar6 >> 0x10 & 0xff) * 4) & 0xff0000 ^
          *(uint *)(&DAT_00440460 + (uVar1 >> 8 & 0xff) * 4) & 0xff00 ^
          *(uint *)(&DAT_00440c60 + (uVar5 >> 0x18) * 4) & 0xff000000 ^
          (uint)(byte)(&DAT_00440860)[(uVar2 & 0xff) * 4] ^ puVar9[1];
  param_1[4] = (char)(uVar3 >> 0x18);
  param_1[5] = (char)(uVar3 >> 0x10);
  param_1[6] = (char)(uVar3 >> 8);
  local_18 = (undefined)uVar3;
  param_1[7] = local_18;
  uVar3 = *(uint *)(&DAT_00441060 + (uVar1 >> 0x10 & 0xff) * 4) & 0xff0000 ^
          *(uint *)(&DAT_00440460 + (uVar2 >> 8 & 0xff) * 4) & 0xff00 ^
          *(uint *)(&DAT_00440c60 + (uVar6 >> 0x18) * 4) & 0xff000000 ^
          (uint)(byte)(&DAT_00440860)[(uVar5 & 0xff) * 4] ^ puVar9[2];
  param_1[8] = (char)(uVar3 >> 0x18);
  param_1[9] = (char)(uVar3 >> 0x10);
  param_1[10] = (char)(uVar3 >> 8);
  local_10 = (undefined)uVar3;
  param_1[0xb] = local_10;
  uVar2 = *(uint *)(&DAT_00441060 + (uVar2 >> 0x10 & 0xff) * 4) & 0xff0000 ^
          *(uint *)(&DAT_00440460 + (uVar5 >> 8 & 0xff) * 4) & 0xff00 ^
          *(uint *)(&DAT_00440c60 + (uVar1 >> 0x18) * 4) & 0xff000000 ^
          (uint)(byte)(&DAT_00440860)[(uVar6 & 0xff) * 4] ^ puVar9[3];
  param_1[0xc] = (char)(uVar2 >> 0x18);
  param_1[0xd] = (char)(uVar2 >> 0x10);
  param_1[0xe] = (char)(uVar2 >> 8);
  param_1[0xf] = (char)uVar2;
  return;
}



void __thiscall FUN_00418a80(void *this,undefined *param_1)

{
  uint *puVar1;
  undefined *in_EAX;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
                    // WARNING: Load size is inaccurate
  uVar3 = CONCAT31(CONCAT21(CONCAT11(*in_EAX,in_EAX[1]),in_EAX[2]),in_EAX[3]) ^ *this;
  uVar4 = CONCAT31(CONCAT21(CONCAT11(in_EAX[4],in_EAX[5]),in_EAX[6]),in_EAX[7]) ^
          *(uint *)((int)this + 4);
  uVar8 = CONCAT31(CONCAT21(CONCAT11(in_EAX[8],in_EAX[9]),in_EAX[10]),in_EAX[0xb]) ^
          *(uint *)((int)this + 8);
  uVar5 = CONCAT31(CONCAT21(CONCAT11(in_EAX[0xc],in_EAX[0xd]),in_EAX[0xe]),in_EAX[0xf]) ^
          *(uint *)((int)this + 0xc);
  uVar9 = *(uint *)(&DAT_00441860 + (uVar5 >> 0x10 & 0xff) * 4) ^
          *(uint *)(&DAT_00441c60 + (uVar8 >> 8 & 0xff) * 4) ^
          *(uint *)(&DAT_00441460 + (uVar3 >> 0x18) * 4) ^
          *(uint *)(&DAT_00442060 + (uVar4 & 0xff) * 4) ^ *(uint *)((int)this + 0x10);
  uVar6 = *(uint *)(&DAT_00441c60 + (uVar5 >> 8 & 0xff) * 4) ^
          *(uint *)(&DAT_00441860 + (uVar3 >> 0x10 & 0xff) * 4) ^
          *(uint *)(&DAT_00441460 + (uVar4 >> 0x18) * 4) ^
          *(uint *)(&DAT_00442060 + (uVar8 & 0xff) * 4) ^ *(uint *)((int)this + 0x14);
  uVar7 = *(uint *)(&DAT_00441860 + (uVar4 >> 0x10 & 0xff) * 4) ^
          *(uint *)(&DAT_00441c60 + (uVar3 >> 8 & 0xff) * 4) ^
          *(uint *)(&DAT_00441460 + (uVar8 >> 0x18) * 4) ^
          *(uint *)(&DAT_00442060 + (uVar5 & 0xff) * 4) ^ *(uint *)((int)this + 0x18);
  uVar3 = *(uint *)(&DAT_00441860 + (uVar8 >> 0x10 & 0xff) * 4) ^
          *(uint *)(&DAT_00441c60 + (uVar4 >> 8 & 0xff) * 4) ^
          *(uint *)(&DAT_00441460 + (uVar5 >> 0x18) * 4) ^
          *(uint *)(&DAT_00442060 + (uVar3 & 0xff) * 4) ^ *(uint *)((int)this + 0x1c);
  iVar2 = *(int *)((int)this + 0xf0) >> 1;
  puVar1 = (uint *)((int)this + 0x20);
  while (iVar2 = iVar2 + -1, iVar2 != 0) {
    uVar8 = *(uint *)(&DAT_00441c60 + (uVar3 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00441860 + (uVar9 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00441460 + (uVar6 >> 0x18) * 4) ^
            *(uint *)(&DAT_00442060 + (uVar7 & 0xff) * 4) ^ puVar1[1];
    uVar4 = *(uint *)(&DAT_00441860 + (uVar6 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00441c60 + (uVar9 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00441460 + (uVar7 >> 0x18) * 4) ^
            *(uint *)(&DAT_00442060 + (uVar3 & 0xff) * 4) ^ puVar1[2];
    uVar5 = *(uint *)(&DAT_00441860 + (uVar3 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00441c60 + (uVar7 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00441460 + (uVar9 >> 0x18) * 4) ^
            *(uint *)(&DAT_00442060 + (uVar6 & 0xff) * 4) ^ *puVar1;
    uVar3 = *(uint *)(&DAT_00441860 + (uVar7 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00441c60 + (uVar6 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00441460 + (uVar3 >> 0x18) * 4) ^
            *(uint *)(&DAT_00442060 + (uVar9 & 0xff) * 4) ^ puVar1[3];
    uVar9 = *(uint *)(&DAT_00441860 + (uVar3 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00441c60 + (uVar4 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00441460 + (uVar5 >> 0x18) * 4) ^
            *(uint *)(&DAT_00442060 + (uVar8 & 0xff) * 4) ^ puVar1[4];
    uVar6 = *(uint *)(&DAT_00441c60 + (uVar3 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00441860 + (uVar5 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00441460 + (uVar8 >> 0x18) * 4) ^
            *(uint *)(&DAT_00442060 + (uVar4 & 0xff) * 4) ^ puVar1[5];
    uVar7 = *(uint *)(&DAT_00441860 + (uVar8 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00441c60 + (uVar5 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00441460 + (uVar4 >> 0x18) * 4) ^
            *(uint *)(&DAT_00442060 + (uVar3 & 0xff) * 4) ^ puVar1[6];
    uVar3 = *(uint *)(&DAT_00441860 + (uVar4 >> 0x10 & 0xff) * 4) ^
            *(uint *)(&DAT_00441c60 + (uVar8 >> 8 & 0xff) * 4) ^
            *(uint *)(&DAT_00441460 + (uVar3 >> 0x18) * 4) ^
            *(uint *)(&DAT_00442060 + (uVar5 & 0xff) * 4) ^ puVar1[7];
    puVar1 = puVar1 + 8;
  }
  uVar4 = CONCAT31(CONCAT21(CONCAT11((&DAT_00442460)[uVar9 >> 0x18],
                                     (&DAT_00442460)[uVar3 >> 0x10 & 0xff]),
                            (&DAT_00442460)[uVar7 >> 8 & 0xff]),(&DAT_00442460)[uVar6 & 0xff]) ^
          *puVar1;
  *param_1 = (char)(uVar4 >> 0x18);
  param_1[1] = (char)(uVar4 >> 0x10);
  param_1[3] = (char)uVar4;
  param_1[2] = (char)(uVar4 >> 8);
  uVar4 = CONCAT31(CONCAT21(CONCAT11((&DAT_00442460)[uVar6 >> 0x18],
                                     (&DAT_00442460)[uVar9 >> 0x10 & 0xff]),
                            (&DAT_00442460)[uVar3 >> 8 & 0xff]),(&DAT_00442460)[uVar7 & 0xff]) ^
          puVar1[1];
  param_1[4] = (char)(uVar4 >> 0x18);
  param_1[5] = (char)(uVar4 >> 0x10);
  param_1[6] = (char)(uVar4 >> 8);
  param_1[7] = (char)uVar4;
  uVar4 = CONCAT31(CONCAT21(CONCAT11((&DAT_00442460)[uVar7 >> 0x18],
                                     (&DAT_00442460)[uVar6 >> 0x10 & 0xff]),
                            (&DAT_00442460)[uVar9 >> 8 & 0xff]),(&DAT_00442460)[uVar3 & 0xff]) ^
          puVar1[2];
  param_1[8] = (char)(uVar4 >> 0x18);
  param_1[9] = (char)(uVar4 >> 0x10);
  param_1[0xb] = (char)uVar4;
  param_1[10] = (char)(uVar4 >> 8);
  uVar9 = CONCAT31(CONCAT21(CONCAT11((&DAT_00442460)[uVar3 >> 0x18],
                                     (&DAT_00442460)[uVar7 >> 0x10 & 0xff]),
                            (&DAT_00442460)[uVar6 >> 8 & 0xff]),(&DAT_00442460)[uVar9 & 0xff]) ^
          puVar1[3];
  param_1[0xc] = (char)(uVar9 >> 0x18);
  param_1[0xd] = (char)(uVar9 >> 0x10);
  param_1[0xe] = (char)(uVar9 >> 8);
  param_1[0xf] = (char)uVar9;
  return;
}



void __fastcall
FUN_00418fd0(void *param_1,undefined4 *param_2,undefined4 *param_3,uint param_4,undefined4 *param_5,
            int param_6)

{
  undefined4 *puVar1;
  undefined *puVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  byte *pbVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  byte *pbVar10;
  uint local_30;
  uint local_2c;
  void *local_28;
  uint local_24;
  int local_20;
  int local_1c;
  undefined4 *local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_30;
  local_18 = param_5;
  local_30 = param_4;
  local_28 = param_1;
  if (param_6 == 1) {
    if (0xf < param_4) {
      local_2c = param_4 >> 4;
      puVar4 = param_5;
      param_3 = param_3;
      do {
        param_5 = param_3;
        local_20 = (int)puVar4 - (int)param_2;
        local_1c = (int)puVar4 - (int)param_5;
        local_24 = 4;
        puVar1 = param_2;
        pbVar6 = (byte *)((int)param_5 + 1);
        pbVar10 = (byte *)((int)puVar4 + 3);
        do {
          *(byte *)((int)param_5 + (-4 - (int)param_2) + (int)(puVar1 + 1)) =
               *(byte *)(local_20 + (int)puVar1) ^ *(byte *)puVar1;
          *pbVar6 = pbVar6[local_1c] ^ *(byte *)((int)puVar1 + 1);
          pbVar6[1] = *(byte *)((int)puVar1 + 2) ^ pbVar10[-1];
          local_24 = local_24 + -1;
          pbVar6[2] = *(byte *)((int)puVar1 + 3) ^ *pbVar10;
          puVar1 = puVar1 + 1;
          pbVar6 = pbVar6 + 4;
          pbVar10 = pbVar10 + 4;
        } while (local_24 != 0);
        FUN_004184e0(param_5,(undefined *)param_5);
        local_30 = local_30 - 0x10;
        param_2 = param_2 + 4;
        param_3 = param_5 + 4;
        local_2c = local_2c - 1;
        puVar4 = param_5;
      } while (local_2c != 0);
      local_2c = 0;
    }
    puVar4 = local_18;
    if (local_30 != 0) {
      if (local_30 != 0) {
        local_20 = (int)param_5 - (int)param_2;
        puVar1 = param_2;
        local_2c = local_30;
        do {
          local_2c = local_2c - 1;
          *(byte *)((int)puVar1 + ((int)param_3 - (int)param_2)) =
               *(byte *)((int)puVar1 + local_20) ^ *(byte *)puVar1;
          puVar1 = (undefined4 *)((int)puVar1 + 1);
        } while (local_2c != 0);
      }
      if (local_30 < 0x10) {
        puVar2 = (undefined *)((int)param_3 + local_30);
        iVar9 = 0x10 - local_30;
        do {
          *puVar2 = puVar2[(int)param_5 - (int)param_3];
          puVar2 = puVar2 + 1;
          iVar9 = iVar9 + -1;
        } while (iVar9 != 0);
      }
      FUN_004184e0(param_3,(undefined *)param_3);
      param_5 = param_3;
    }
    *puVar4 = *param_5;
    puVar4[1] = param_5[1];
    puVar4[2] = param_5[2];
    puVar4[3] = param_5[3];
    ___security_check_cookie_4(local_4 ^ (uint)&local_30);
    return;
  }
  if (param_2 == param_3) {
    if (0xf < param_4) {
      iVar9 = (int)param_5 - (int)param_3;
      local_2c = param_4 >> 4;
      do {
        local_14 = *param_2;
        local_c = param_2[2];
        local_10 = param_2[1];
        local_8 = param_2[3];
        FUN_00418a80(local_28,(undefined *)param_3);
        pbVar6 = (byte *)((int)param_5 + 2);
        iVar8 = 4;
        do {
          *(byte *)param_3 = *(byte *)param_3 ^ *(byte *)(iVar9 + (int)param_3);
          *(byte *)((int)param_3 + 1) = *(byte *)((int)param_3 + 1) ^ pbVar6[-1];
          *(byte *)((int)param_3 + 2) = *(byte *)((int)param_3 + 2) ^ *pbVar6;
          *(byte *)((int)param_3 + 3) = *(byte *)((int)param_3 + 3) ^ pbVar6[1];
          param_3 = param_3 + 1;
          pbVar6 = pbVar6 + 4;
          iVar8 = iVar8 + -1;
        } while (iVar8 != 0);
        local_30 = local_30 - 0x10;
        *param_5 = local_14;
        param_5[1] = local_10;
        param_2 = param_2 + 4;
        iVar9 = iVar9 + -0x10;
        local_2c = local_2c - 1;
        param_5[2] = local_c;
        param_5[3] = local_8;
      } while (local_2c != 0);
      local_2c = 0;
    }
    if (local_30 == 0) goto LAB_00419349;
    local_14 = *param_2;
    local_c = param_2[2];
    local_10 = param_2[1];
    local_8 = param_2[3];
    FUN_00418a80(local_28,(undefined *)param_3);
    if (local_30 != 0) {
      puVar4 = param_3;
      uVar7 = local_30;
      do {
        *(byte *)puVar4 = *(byte *)puVar4 ^ *(byte *)((int)puVar4 + ((int)param_5 - (int)param_3));
        puVar4 = (undefined4 *)((int)puVar4 + 1);
        uVar7 = uVar7 - 1;
      } while (uVar7 != 0);
    }
    if (local_30 < 0x10) {
      memcpy((byte *)((int)param_3 + local_30),(void *)((int)&local_14 + local_30),0x10 - local_30);
    }
    *param_5 = local_14;
    param_5[1] = local_10;
    param_5[2] = local_c;
    uVar5 = local_8;
  }
  else {
    puVar4 = param_5;
    if (0xf < param_4) {
      local_24 = param_4 >> 4;
      puVar1 = param_5;
      do {
        puVar4 = param_2;
        FUN_00418a80(local_28,(undefined *)param_3);
        pbVar6 = (byte *)((int)puVar1 + 2);
        local_2c = 4;
        puVar3 = param_3;
        do {
          *(byte *)puVar3 = *(byte *)puVar3 ^ *(byte *)(((int)puVar1 - (int)param_3) + (int)puVar3);
          *(byte *)((int)puVar3 + 1) = *(byte *)((int)puVar3 + 1) ^ pbVar6[-1];
          *(byte *)((int)puVar3 + 2) = *(byte *)((int)puVar3 + 2) ^ *pbVar6;
          *(byte *)((int)puVar3 + 3) = *(byte *)((int)puVar3 + 3) ^ pbVar6[1];
          puVar3 = puVar3 + 1;
          pbVar6 = pbVar6 + 4;
          local_2c = local_2c + -1;
        } while (local_2c != 0);
        local_30 = local_30 - 0x10;
        param_2 = puVar4 + 4;
        param_3 = param_3 + 4;
        local_24 = local_24 - 1;
        local_2c = 0;
        puVar1 = puVar4;
      } while (local_24 != 0);
      local_2c = 0;
      local_24 = 0;
    }
    puVar1 = puVar4;
    if (local_30 != 0) {
      FUN_00418a80(local_28,(undefined *)&local_14);
      uVar7 = 0;
      puVar1 = param_2;
      if (local_30 != 0) {
        do {
          pbVar6 = (byte *)((int)&local_14 + uVar7);
          uVar7 = uVar7 + 1;
          pbVar6[(int)param_3 - (int)&local_14] = pbVar6[(int)puVar4 - (int)&local_14] ^ *pbVar6;
        } while (uVar7 < local_30);
      }
    }
    *param_5 = *puVar1;
    param_5[1] = puVar1[1];
    param_5[2] = puVar1[2];
    uVar5 = puVar1[3];
  }
  param_5[3] = uVar5;
LAB_00419349:
  ___security_check_cookie_4(local_4 ^ (uint)&local_30);
  return;
}



undefined4 *
FUN_00419360(undefined4 *param_1,void *param_2,size_t param_3,undefined4 param_4,undefined4 param_5)

{
  void **ppvVar1;
  void **ppvVar2;
  size_t sVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004387a9;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  ppvVar1 = (void **)(param_1 + 2);
  *param_1 = aLog::vftable;
  *ppvVar1 = (void *)0x0;
  param_1[4] = 0;
  param_1[3] = 0;
  ppvVar2 = (void **)(param_1 + 7);
  *ppvVar2 = (void *)0x0;
  param_1[9] = 0;
  param_1[8] = 0;
  param_1[0xb] = aCriticalSection::vftable;
  param_1[0xc] = 0xffffffff;
  param_1[0xd] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xe));
  local_4 = CONCAT31(local_4._1_3_,3);
  *(undefined *)(param_1 + 6) = 1;
  *(undefined *)((int)param_1 + 0x19) = 0;
  if (param_2 != *ppvVar1) {
    FUN_0041b310();
    memcpy(*ppvVar1,param_2,param_3);
    param_1[3] = param_3;
    *(undefined *)(param_3 + (int)*ppvVar1) = 0;
  }
  param_1[5] = param_5;
  if (DAT_0044d228 != *ppvVar2) {
    FUN_0041b310();
    memcpy(*ppvVar2,DAT_0044d228,DAT_0044d22c);
    sVar3 = DAT_0044d22c;
    param_1[8] = DAT_0044d22c;
    *(undefined *)(sVar3 + (int)*ppvVar2) = 0;
  }
  local_4 = 0xffffffff;
  *(undefined *)(param_1 + 10) = 1;
  param_1[1] = 2;
  DAT_0044cee4 = param_1;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_00419490(void *this,byte param_1)

{
  FUN_004194b0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_004194b0(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00437edb;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = aLog::vftable;
  local_4 = 0;
  DAT_0044cee4 = -(uint)(param_1 != (undefined4 *)&DAT_0044d1d8) & 0x44d1d8;
  param_1[0xb] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xe));
  if ((void *)param_1[7] != (void *)0x0) {
    free((void *)param_1[7]);
  }
  local_4 = 0xffffffff;
  if ((void *)param_1[2] != (void *)0x0) {
    free((void *)param_1[2]);
  }
  ExceptionList = local_c;
  return;
}



void FUN_00419550(undefined4 param_1)

{
  int *piVar1;
  int in_EAX;
  DWORD DVar2;
  
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(in_EAX + 0x30) == DVar2) {
    *(int *)(in_EAX + 0x34) = *(int *)(in_EAX + 0x34) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(in_EAX + 0x38));
    *(undefined4 *)(in_EAX + 0x34) = 1;
    DVar2 = GetCurrentThreadId();
    *(DWORD *)(in_EAX + 0x30) = DVar2;
  }
  *(undefined4 *)(in_EAX + 4) = param_1;
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(in_EAX + 0x30) == DVar2) {
    piVar1 = (int *)(in_EAX + 0x34);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(in_EAX + 0x30) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(in_EAX + 0x38));
    }
  }
  return;
}



void __thiscall FUN_004195b0(void *this,void *param_1,size_t param_2)

{
  int *piVar1;
  uint uVar2;
  DWORD DVar3;
  int iVar4;
  code *pcVar5;
  void **ppvVar6;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  pcVar5 = GetCurrentThreadId_exref;
  puStack_8 = &LAB_00438760;
  local_c = ExceptionList;
  uVar2 = DAT_0044a01c ^ (uint)&stack0xffffffe0;
  ExceptionList = &local_c;
  local_4 = 0;
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)((int)this + 0x30) == DVar3) {
    *(int *)((int)this + 0x34) = *(int *)((int)this + 0x34) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x38));
    *(undefined4 *)((int)this + 0x34) = 1;
    DVar3 = GetCurrentThreadId();
    *(DWORD *)((int)this + 0x30) = DVar3;
  }
  local_4 = CONCAT31(local_4._1_3_,1);
  ppvVar6 = (void **)((int)this + 0x1c);
  if (param_1 != *ppvVar6) {
    FUN_0041b310();
    memcpy(*ppvVar6,param_1,param_2);
    *(size_t *)((int)this + 0x20) = param_2;
    *(undefined *)(param_2 + (int)*ppvVar6) = 0;
    pcVar5 = GetCurrentThreadId_exref;
  }
  iVar4 = (*pcVar5)(uVar2);
  if (*(int *)((int)this + 0x30) == iVar4) {
    piVar1 = (int *)((int)this + 0x34);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)((int)this + 0x30) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x38));
    }
  }
  local_4 = 0xffffffff;
  if (param_1 != (void *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return;
}



uint __fastcall FUN_00419690(void *param_1)

{
  void *this;
  void *_Src;
  size_t _Size;
  undefined *puVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  uint uVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  code *pcVar5;
  void *_Dst;
  size_t sVar6;
  undefined *local_34;
  void *local_30;
  size_t local_2c;
  undefined4 local_28;
  int local_24 [3];
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  this = DAT_0044cee4;
  puStack_8 = &LAB_0043a1c0;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_30 = (void *)0x0;
  local_28 = 0;
  local_2c = 0;
  local_4 = 0;
  FUN_0041b630(param_1,local_24);
  local_4._0_1_ = 1;
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,"Global/LogFilter");
  local_4._0_1_ = 2;
  uVar2 = FUN_0041bbf0(local_18,(int)local_24,&local_30);
  pcVar5 = free_exref;
  local_4 = CONCAT31(local_4._1_3_,1);
  uVar3 = extraout_ECX_00;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
    uVar3 = extraout_ECX_01;
  }
  _Size = local_2c;
  _Src = local_30;
  if ((char)uVar2 != '\0') {
    local_34 = &stack0xffffffa8;
    _Dst = (void *)0x0;
    sVar6 = 0;
    puVar1 = &stack0xffffffa8;
    if (local_30 != (void *)0x0) {
      FUN_0041b310();
      memcpy(_Dst,_Src,_Size);
      *(undefined *)(_Size + (int)_Dst) = 0;
      sVar6 = _Size;
      puVar1 = local_34;
    }
    local_34 = puVar1;
    FUN_004195b0(this,_Dst,sVar6);
    uVar3 = extraout_ECX_02;
    pcVar5 = free_exref;
  }
  FUN_0041aa80(uVar3,(char *)0x7fffffff,"Global/LogLevel");
  local_4._0_1_ = 3;
  uVar3 = FUN_0041bff0(local_24,(char *)local_18,(long *)&local_34);
  local_4._0_1_ = 1;
  if (local_18[0] != (void *)0x0) {
    (*pcVar5)();
  }
  if ((char)uVar3 == '\0') {
LAB_0041982c:
    local_4 = (uint)local_4._1_3_ << 8;
    uVar4 = FUN_00402ab0();
    local_4 = 0xffffffff;
    if (_Src != (void *)0x0) {
      uVar4 = (*pcVar5)();
    }
    ExceptionList = local_c;
    return uVar4 & 0xffffff00;
  }
  switch(local_34) {
  case (undefined *)0x0:
    uVar3 = 1;
    break;
  case (undefined *)0x1:
    uVar3 = 2;
    break;
  case (undefined *)0x2:
    uVar3 = 3;
    break;
  case (undefined *)0x3:
    uVar3 = 4;
    break;
  case (undefined *)0xffffffff:
    uVar3 = 0;
    break;
  default:
    FUN_0041a1f0("Log: Invalid configuration parameter (Global/LogLevel=%d)",(char)local_34);
    goto LAB_0041982c;
  }
  FUN_00419550(uVar3);
  local_4 = (uint)local_4._1_3_ << 8;
  uVar3 = FUN_00402ab0();
  local_4 = 0xffffffff;
  if (_Src != (void *)0x0) {
    uVar3 = (*pcVar5)();
  }
  ExceptionList = local_c;
  return CONCAT31((int3)((uint)uVar3 >> 8),1);
}



// WARNING: Function: __alloca_probe replaced with injection: alloca_probe

void FUN_00419880(void)

{
  int *piVar1;
  va_list unaff_EBX;
  char *unaff_EDI;
  char local_1004 [4096];
  uint local_4;
  
  piVar1 = DAT_0044cee4;
  local_4 = DAT_0044a01c ^ (uint)local_1004;
  if (DAT_0044cee4[1] < 2) {
    memset(local_1004,0,0x1000);
    _vsnprintf(local_1004,0x1000,unaff_EDI,unaff_EBX);
    (**(code **)(*piVar1 + 4))(1,local_1004);
  }
  ___security_check_cookie_4(local_4 ^ (uint)local_1004);
  return;
}



// WARNING: Function: __alloca_probe replaced with injection: alloca_probe

void FUN_00419900(void)

{
  int *piVar1;
  va_list unaff_EBX;
  char *unaff_EDI;
  char local_1004 [4096];
  uint local_4;
  
  piVar1 = DAT_0044cee4;
  local_4 = DAT_0044a01c ^ (uint)local_1004;
  if (DAT_0044cee4[1] < 3) {
    memset(local_1004,0,0x1000);
    _vsnprintf(local_1004,0x1000,unaff_EDI,unaff_EBX);
    (**(code **)(*piVar1 + 4))(2,local_1004);
  }
  ___security_check_cookie_4(local_4 ^ (uint)local_1004);
  return;
}



// WARNING: Function: __alloca_probe replaced with injection: alloca_probe

void FUN_00419980(void)

{
  int *piVar1;
  va_list unaff_EBX;
  char *unaff_EDI;
  char local_1004 [4096];
  uint local_4;
  
  piVar1 = DAT_0044cee4;
  local_4 = DAT_0044a01c ^ (uint)local_1004;
  if (DAT_0044cee4[1] < 4) {
    memset(local_1004,0,0x1000);
    _vsnprintf(local_1004,0x1000,unaff_EDI,unaff_EBX);
    (**(code **)(*piVar1 + 4))(3,local_1004);
  }
  ___security_check_cookie_4(local_4 ^ (uint)local_1004);
  return;
}



// WARNING: Function: __alloca_probe replaced with injection: alloca_probe

void FUN_00419a00(void)

{
  int *piVar1;
  va_list unaff_EBX;
  char *unaff_EDI;
  char local_1004 [4096];
  uint local_4;
  
  piVar1 = DAT_0044cee4;
  local_4 = DAT_0044a01c ^ (uint)local_1004;
  if (DAT_0044cee4[1] < 5) {
    memset(local_1004,0,0x1000);
    _vsnprintf(local_1004,0x1000,unaff_EDI,unaff_EBX);
    (**(code **)(*piVar1 + 4))(4,local_1004);
  }
  ___security_check_cookie_4(local_4 ^ (uint)local_1004);
  return;
}



// WARNING: Removing unreachable block (ram,0x00419f9e)
// WARNING: Removing unreachable block (ram,0x00419dd1)
// WARNING: Removing unreachable block (ram,0x00419fb8)

void __thiscall FUN_00419a80(void *this,undefined4 param_1,undefined4 param_2)

{
  char cVar1;
  bool bVar2;
  DWORD DVar3;
  int iVar4;
  char **ppcVar5;
  uint uVar6;
  void **ppvVar7;
  FILE *pFVar8;
  byte *pbVar9;
  undefined1 *this_00;
  bool bVar10;
  tm *ptVar11;
  int *piVar12;
  char *pcVar13;
  undefined *local_b0;
  undefined8 local_9c;
  void *apvStack_90 [3];
  int local_84;
  void *pvStack_80;
  ushort uStack_72;
  undefined **local_70;
  undefined4 local_6c;
  int aiStack_68 [10];
  tm tStack_40;
  uint uStack_1c;
  void *local_14;
  undefined *puStack_10;
  undefined4 local_c;
  
  puStack_10 = &LAB_00439c64;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  bVar10 = false;
  local_9c._0_4_ = (void *)0x0;
  local_70 = aDiskFile::vftable;
  local_6c = 0;
  local_c = 0;
  local_b0 = (undefined *)0x0;
  local_84 = (int)this + 0x2c;
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)((int)this + 0x30) == DVar3) {
    *(int *)((int)this + 0x34) = *(int *)((int)this + 0x34) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x38));
    *(undefined4 *)((int)this + 0x34) = 1;
    DVar3 = GetCurrentThreadId();
    *(DWORD *)((int)this + 0x30) = DVar3;
  }
  local_c._0_1_ = 3;
  pbVar9 = DAT_0044d228;
  if (DAT_0044d228 == (byte *)0x0) {
    pbVar9 = &DAT_0044d0d5;
  }
  iVar4 = FUN_0041ab00(pbVar9);
  if (iVar4 != 0) {
    ppcVar5 = (char **)FUN_0041aa80(param_2,(char *)0x7fffffff,(char *)param_2);
    local_c = CONCAT31(local_c._1_3_,4);
    this_00 = *(undefined1 **)((int)this + 0x1c);
    bVar10 = true;
    local_9c._0_4_ = (void *)0x1;
    if (this_00 == (undefined1 *)0x0) {
      this_00 = &DAT_0044d0d5;
    }
    uVar6 = FUN_0041afa0(this_00,ppcVar5);
    bVar2 = true;
    if ((char)uVar6 == '\0') goto LAB_00419b83;
  }
  bVar2 = false;
LAB_00419b83:
  local_c = 3;
  if ((bVar10) && (apvStack_90[0] != (void *)0x0)) {
    free(apvStack_90[0]);
  }
  if (bVar2) {
    DVar3 = GetCurrentThreadId();
    if (*(DWORD *)((int)this + 0x30) == DVar3) {
      piVar12 = (int *)((int)this + 0x34);
      *piVar12 = *piVar12 + -1;
      if (*piVar12 == 0) {
        *(undefined4 *)((int)this + 0x30) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x38));
        ExceptionList = local_14;
        return;
      }
    }
  }
  else {
    switch(param_1) {
    case 0:
      break;
    case 1:
      break;
    case 2:
      break;
    case 3:
      break;
    case 4:
    }
    FUN_00401080();
    GetSystemTime((LPSYSTEMTIME)&pvStack_80);
    local_9c = _time64((__time64_t *)0x0);
    _localtime64_s(&tStack_40,&local_9c);
    cVar1 = *(char *)((int)this + 0x28);
    uStack_1c = (uint)uStack_72;
    ptVar11 = &tStack_40;
    piVar12 = aiStack_68;
    for (iVar4 = 10; iVar4 != 0; iVar4 = iVar4 + -1) {
      *piVar12 = ptVar11->tm_sec;
      ptVar11 = (tm *)&ptVar11->tm_min;
      piVar12 = piVar12 + 1;
    }
    if (cVar1 == '\0') {
      FUN_0041e4b0();
      local_c._0_1_ = 8;
      FUN_0041e480();
      local_c._0_1_ = 9;
      ppvVar7 = (void **)FUN_0041b2a0((undefined4 *)&pvStack_80,"%s %s.%.3d | %s | %s\n");
      local_c._0_1_ = 10;
      if (*ppvVar7 != (void *)0x0) {
        FUN_0041b310();
        memcpy((void *)0x0,*ppvVar7,(size_t)ppvVar7[1]);
        local_b0 = (undefined *)ppvVar7[1];
        *local_b0 = 0;
      }
      local_c._0_1_ = 9;
      if (pvStack_80 != (void *)0x0) {
        free(pvStack_80);
      }
      local_c._0_1_ = 8;
      if (apvStack_90[0] != (void *)0x0) {
        free(apvStack_90[0]);
      }
      local_c = CONCAT31(local_c._1_3_,3);
      if ((void *)local_9c != (void *)0x0) {
        free((void *)local_9c);
      }
    }
    else {
      FUN_0041e4b0();
      local_c._0_1_ = 5;
      FUN_0041e480();
      local_c._0_1_ = 6;
      GetCurrentThreadId();
      ppvVar7 = (void **)FUN_0041b2a0(apvStack_90,"%s %s.%.3d | %s | %.5lu | %s\n");
      local_c._0_1_ = 7;
      if (*ppvVar7 == (void *)0x0) {
        local_b0 = (undefined *)0x0;
      }
      else {
        FUN_0041b310();
        memcpy((void *)0x0,*ppvVar7,(size_t)ppvVar7[1]);
        local_b0 = (undefined *)ppvVar7[1];
        *local_b0 = 0;
      }
      local_c._0_1_ = 6;
      if (apvStack_90[0] != (void *)0x0) {
        free(apvStack_90[0]);
      }
      local_c._0_1_ = 5;
      if ((void *)local_9c != (void *)0x0) {
        free((void *)local_9c);
      }
      local_c = CONCAT31(local_c._1_3_,3);
      if (pvStack_80 != (void *)0x0) {
        free(pvStack_80);
      }
    }
    if (*(char *)((int)this + 0x18) != '\0') {
      pFVar8 = __iob_func();
      fwrite(&DAT_0044d0d5,(size_t)local_b0,1,pFVar8 + 2);
    }
    if (*(char *)((int)this + 0x19) != '\0') {
      pFVar8 = __iob_func();
      fwrite(&DAT_0044d0d5,(size_t)local_b0,1,pFVar8 + 1);
    }
    pbVar9 = DAT_0044d228;
    if (DAT_0044d228 == (byte *)0x0) {
      pbVar9 = &DAT_0044d0d5;
    }
    iVar4 = FUN_0041ab00(pbVar9);
    if (iVar4 != 0) {
      pFVar8 = FUN_00419ff0((int)this);
      if (pFVar8 == (FILE *)0x0) {
        if (*(char *)((int)this + 0x18) != '\0') {
          pcVar13 = "Can\'t open log file\n";
          pFVar8 = __iob_func();
          fprintf(pFVar8 + 2,pcVar13);
        }
        if (*(char *)((int)this + 0x19) != '\0') {
          pcVar13 = "Can\'t open log file\n";
          pFVar8 = __iob_func();
          fprintf(pFVar8 + 1,pcVar13);
        }
      }
      else {
        fwrite(&DAT_0044d0d5,(size_t)local_b0,1,pFVar8);
        fclose(pFVar8);
      }
    }
    DVar3 = GetCurrentThreadId();
    if (*(DWORD *)(local_84 + 4) == DVar3) {
      piVar12 = (int *)(local_84 + 8);
      *piVar12 = *piVar12 + -1;
      if (*piVar12 == 0) {
        *(undefined4 *)(local_84 + 4) = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_84 + 0xc));
      }
    }
  }
  ExceptionList = local_14;
  return;
}



FILE * __fastcall FUN_00419ff0(int param_1)

{
  bool bVar1;
  FILE *pFVar2;
  char *pcVar3;
  char *pcVar4;
  LPCSTR _Dst;
  char *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439400;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_24 = (char *)0x0;
  local_1c = 0;
  local_20 = 0;
  local_4 = 0;
  _Dst = (LPCSTR)0x0;
  if (*(int *)(param_1 + 8) != 0) {
    FUN_0041b310();
    memcpy(_Dst,*(void **)(param_1 + 8),*(size_t *)(param_1 + 0xc));
    _Dst[*(int *)(param_1 + 0xc)] = '\0';
  }
  bVar1 = FUN_0041a5e0(_Dst);
  if (!bVar1) {
    pcVar4 = *(char **)(param_1 + 8);
    if (pcVar4 == (char *)0x0) {
      pcVar4 = &DAT_0044d0d5;
    }
    pFVar2 = fopen(pcVar4,"a+");
    ExceptionList = local_c;
    return pFVar2;
  }
  if ((0 < *(int *)(param_1 + 0x14)) && (*(int *)(param_1 + 0x14) < (int)&stack0xffffffb8)) {
    FUN_0041b2a0(local_18,"%s.old");
    local_4._0_1_ = 1;
    FUN_00401040(&local_24);
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    pcVar4 = local_24;
    pcVar3 = &DAT_0044d0d5;
    if (local_24 != (char *)0x0) {
      pcVar3 = local_24;
    }
    _unlink(pcVar3);
    if (pcVar4 == (char *)0x0) {
      pcVar4 = &DAT_0044d0d5;
    }
    pcVar3 = *(char **)(param_1 + 8);
    if (pcVar3 == (char *)0x0) {
      pcVar3 = &DAT_0044d0d5;
    }
    rename(pcVar3,pcVar4);
  }
  pcVar4 = *(char **)(param_1 + 8);
  if (pcVar4 == (char *)0x0) {
    pcVar4 = &DAT_0044d0d5;
  }
  pFVar2 = fopen(pcVar4,"a+");
  local_4 = 0xffffffff;
  if (local_24 != (char *)0x0) {
    free(local_24);
  }
  ExceptionList = local_c;
  return pFVar2;
}



void FUN_0041a190(undefined4 param_1,undefined1 param_2)

{
  if (DAT_0044cee4 != 0) {
    FUN_00419880();
  }
  return;
}



void FUN_0041a1b0(undefined4 param_1,undefined1 param_2)

{
  if (DAT_0044cee4 != 0) {
    FUN_00419900();
  }
  return;
}



void FUN_0041a1d0(undefined4 param_1,undefined1 param_2)

{
  if (DAT_0044cee4 != 0) {
    FUN_00419980();
  }
  return;
}



void FUN_0041a1f0(undefined4 param_1,undefined1 param_2)

{
  if (DAT_0044cee4 != 0) {
    FUN_00419a00();
  }
  return;
}



void __cdecl FUN_0041a210(void *param_1,size_t param_2)

{
  void **ppvVar1;
  void *_Dst;
  size_t sVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439018;
  local_c = ExceptionList;
  local_4 = 0;
  ppvVar1 = &local_c;
  if (DAT_0044cee4 != (void *)0x0) {
    _Dst = (void *)0x0;
    ExceptionList = &local_c;
    sVar2 = 0;
    if (param_1 != (void *)0x0) {
      FUN_0041b310();
      memcpy(_Dst,param_1,param_2);
      *(undefined *)(param_2 + (int)_Dst) = 0;
      sVar2 = param_2;
    }
    FUN_004195b0(DAT_0044cee4,_Dst,sVar2);
    ppvVar1 = (void **)ExceptionList;
  }
  ExceptionList = ppvVar1;
  if (param_1 != (void *)0x0) {
    local_4 = 0xffffffff;
    free(param_1);
  }
  ExceptionList = local_c;
  return;
}



undefined4 * __cdecl
FUN_0041a2d0(void *param_1,LPCSTR param_2,undefined4 param_3,void *param_4,undefined4 param_5,
            undefined4 param_6,undefined4 param_7)

{
  int iVar1;
  LPCSTR *ppCVar2;
  void **this;
  undefined4 *puVar3;
  LPCSTR lpFileName;
  HANDLE pvVar4;
  DWORD DVar5;
  LPCSTR _Memory;
  LPCSTR local_30;
  LPCSTR local_2c;
  undefined4 local_28;
  void *local_24 [3];
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004393d0;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  _Memory = (LPCSTR)0x0;
  local_30 = (LPCSTR)0x0;
  local_28 = 0;
  local_2c = (LPCSTR)0x0;
  local_4 = 2;
  if (param_1 != (void *)0x0) {
    FUN_0041b310();
    _Memory = local_30;
    memcpy(local_30,param_1,(size_t)param_2);
    local_2c = param_2;
    param_2[(int)_Memory] = '\0';
  }
  FUN_0041abc0((int *)&local_30);
  iVar1 = FUN_0041ab00(&DAT_0044268c);
  if (local_24[0] != (void *)0x0) {
    free(local_24[0]);
  }
  if (iVar1 == 0) {
    ppCVar2 = (LPCSTR *)FUN_0041b380(&local_30,local_24,&param_4);
    local_4._0_1_ = 3;
    local_18[0] = local_24[0];
    if (*ppCVar2 != _Memory) {
      FUN_0041b310();
      _Memory = local_30;
      memcpy(local_30,*ppCVar2,(size_t)ppCVar2[1]);
      local_2c = ppCVar2[1];
      local_2c[(int)_Memory] = '\0';
      local_18[0] = local_24[0];
    }
  }
  else {
    this = FUN_0041b440(&local_30,local_18,"\\");
    local_4._0_1_ = 4;
    ppCVar2 = (LPCSTR *)FUN_0041b380(this,local_24,&param_4);
    local_4._0_1_ = 5;
    if (*ppCVar2 != _Memory) {
      FUN_0041b310();
      _Memory = local_30;
      memcpy(local_30,*ppCVar2,(size_t)ppCVar2[1]);
      local_2c = ppCVar2[1];
      local_2c[(int)_Memory] = '\0';
    }
    local_4._0_1_ = 4;
    if (local_24[0] != (void *)0x0) {
      free(local_24[0]);
    }
  }
  local_4 = CONCAT31(local_4._1_3_,2);
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  puVar3 = (undefined4 *)operator_new(0x14c);
  puVar3[0x52] = param_7;
  *puVar3 = 0;
  lpFileName = &DAT_0044d0d5;
  if (_Memory != (LPCSTR)0x0) {
    lpFileName = _Memory;
  }
  pvVar4 = FindFirstFileA(lpFileName,(LPWIN32_FIND_DATAA)(puVar3 + 2));
  puVar3[1] = pvVar4;
  if ((pvVar4 == (HANDLE)0xffffffff) && (DVar5 = GetLastError(), DVar5 == 2)) {
    *puVar3 = 1;
  }
  else if (puVar3[1] == -1) {
    operator_delete(puVar3);
    puVar3 = (undefined4 *)0x0;
  }
  local_4._0_1_ = 1;
  if (_Memory != (LPCSTR)0x0) {
    free(_Memory);
  }
  local_4 = (uint)local_4._1_3_ << 8;
  if (param_1 != (void *)0x0) {
    free(param_1);
  }
  local_4 = 0xffffffff;
  if (param_4 != (void *)0x0) {
    free(param_4);
  }
  ExceptionList = local_c;
  return puVar3;
}



uint __cdecl FUN_0041a500(undefined4 param_1,uint *param_2)

{
  BOOL BVar1;
  int **ppiVar2;
  int **unaff_EDI;
  int *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004380e8;
  local_c = (int *)ExceptionList;
  ppiVar2 = &local_c;
  local_4 = 0;
  ExceptionList = ppiVar2;
  if (*unaff_EDI == (int *)0x0) {
    do {
      if (((unaff_EDI[0x52] != (int *)0x1) ||
          (ppiVar2 = unaff_EDI + 2, (*(byte *)(unaff_EDI + 2) & 0x10) != 0)) &&
         ((unaff_EDI[0x52] != (int *)0x0 ||
          (ppiVar2 = unaff_EDI + 2, (*(byte *)(unaff_EDI + 2) & 0x10) == 0)))) break;
      BVar1 = FindNextFileA(unaff_EDI[1],(LPWIN32_FIND_DATAA)(unaff_EDI + 2));
      ppiVar2 = (int **)(uint)(BVar1 == 0);
      *unaff_EDI = (int *)ppiVar2;
    } while (ppiVar2 == (int **)0x0);
    if (*unaff_EDI == (int *)0x0) {
      FUN_00401080();
      *param_2 = *(byte *)(unaff_EDI + 2) >> 4 & 1;
      BVar1 = FindNextFileA(unaff_EDI[1],(LPWIN32_FIND_DATAA)(unaff_EDI + 2));
      *unaff_EDI = (int *)(uint)(BVar1 == 0);
      ExceptionList = local_c;
      return 1;
    }
  }
  ExceptionList = local_c;
  return (uint)ppiVar2 & 0xffffff00;
}



bool __cdecl FUN_0041a5e0(LPCSTR param_1)

{
  int *in_EAX;
  LPCSTR lpFileName;
  BOOL BVar1;
  uint *unaff_EDI;
  undefined local_24 [28];
  int iStack_8;
  uint uStack_4;
  
  lpFileName = &DAT_0044d0d5;
  if (param_1 != (LPCSTR)0x0) {
    lpFileName = param_1;
  }
  BVar1 = GetFileAttributesExA(lpFileName,GetFileExInfoStandard,local_24);
  if (0x7fffffff < uStack_4) {
    uStack_4 = uStack_4 & 0x7fffffff;
    iStack_8 = iStack_8 * 2;
  }
  if (unaff_EDI != (uint *)0x0) {
    *unaff_EDI = uStack_4;
  }
  if (in_EAX != (int *)0x0) {
    *in_EAX = iStack_8;
  }
  if (param_1 != (LPCSTR)0x0) {
    free(param_1);
  }
  return BVar1 != 0;
}



int __cdecl FUN_0041a650(char *param_1)

{
  char *pcVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 extraout_ECX;
  uint uVar4;
  undefined4 uStack_5c;
  DWORD local_58;
  DWORD local_54;
  void *pvStack_50;
  undefined local_44 [20];
  uint uStack_30;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004380b8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  local_54 = 0;
  local_58 = 0;
  pcVar1 = &DAT_0044d0d5;
  if (param_1 != (char *)0x0) {
    pcVar1 = param_1;
  }
  _stat64i32(pcVar1,local_44,DAT_0044a01c ^ (uint)&stack0xffffff94);
  uStack_5c = 0;
  pcVar1 = strchr(param_1,0x3a);
  if (pcVar1 == (char *)0x0) {
    iVar2 = -1;
  }
  else {
    iVar2 = (int)pcVar1 - (int)param_1;
  }
  puVar3 = (undefined4 *)FUN_0041ab60(extraout_ECX,(char *)(iVar2 + 1));
  sprintf((char *)&uStack_5c,"%s",*puVar3,puVar3[1],puVar3[2]);
  if (pvStack_50 != (void *)0x0) {
    free(pvStack_50);
  }
  GetDiskFreeSpaceA((LPCSTR)&uStack_5c,&local_58,&local_54,(LPDWORD)0x0,(LPDWORD)0x0);
  uVar4 = local_58 * local_54;
  local_4 = 0xffffffff;
  if (param_1 != (char *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return (uStack_30 - uStack_30 % uVar4) + uVar4;
}



bool __cdecl FUN_0041a760(LPCSTR param_1)

{
  LPCSTR lpFileName;
  BOOL BVar1;
  undefined local_24 [36];
  
  lpFileName = &DAT_0044d0d5;
  if (param_1 != (LPCSTR)0x0) {
    lpFileName = param_1;
  }
  BVar1 = GetFileAttributesExA(lpFileName,GetFileExInfoStandard,local_24);
  if (param_1 != (LPCSTR)0x0) {
    free(param_1);
  }
  return BVar1 != 0;
}



undefined4 * __thiscall FUN_0041a7a0(void *this,byte param_1)

{
  *(undefined ***)this = aDiskFile::vftable;
  if (*(FILE **)((int)this + 4) != (FILE *)0x0) {
    fclose(*(FILE **)((int)this + 4));
  }
  *(undefined4 *)((int)this + 4) = 0;
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_0041a7e0(undefined4 *param_1)

{
  *param_1 = aDiskFile::vftable;
  if ((FILE *)param_1[1] != (FILE *)0x0) {
    fclose((FILE *)param_1[1]);
  }
  param_1[1] = 0;
  return;
}



bool __thiscall
FUN_0041a810(void *this,char *param_1,undefined4 param_2,undefined4 param_3,char *param_4)

{
  char *_Filename;
  FILE *pFVar1;
  char *_Mode;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438f38;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  _Mode = &DAT_0044d0d5;
  if (param_4 != (char *)0x0) {
    _Mode = param_4;
  }
  _Filename = &DAT_0044d0d5;
  if (param_1 != (char *)0x0) {
    _Filename = param_1;
  }
  pFVar1 = fopen(_Filename,_Mode);
  *(FILE **)((int)this + 4) = pFVar1;
  if (param_1 != (char *)0x0) {
    free(param_1);
  }
  local_4 = 0xffffffff;
  if (param_4 != (char *)0x0) {
    free(param_4);
  }
  ExceptionList = local_c;
  return pFVar1 != (FILE *)0x0;
}



void __fastcall FUN_0041a8b0(int param_1)

{
  fclose(*(FILE **)(param_1 + 4));
  *(undefined4 *)(param_1 + 4) = 0;
  return;
}



size_t __thiscall FUN_0041a8d0(void *this,void *param_1,size_t param_2,size_t param_3)

{
  int iVar1;
  size_t sVar2;
  
  iVar1 = feof(*(FILE **)((int)this + 4));
  if (iVar1 != 0) {
    return 0;
  }
  sVar2 = fread(param_1,param_2,param_3,*(FILE **)((int)this + 4));
  return sVar2;
}



void __thiscall FUN_0041a910(void *this,void *param_1,size_t param_2,size_t param_3)

{
  fwrite(param_1,param_2,param_3,*(FILE **)((int)this + 4));
  return;
}



void __thiscall FUN_0041a930(void *this,undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  int unaff_retaddr;
  
  _fseeki64(*(FILE **)((int)this + 4),CONCAT44(param_3,param_2),unaff_retaddr);
  return;
}



longlong __fastcall FUN_0041a950(int param_1)

{
  longlong lVar1;
  
  lVar1 = _ftelli64(*(FILE **)(param_1 + 4));
  return lVar1;
}



void __thiscall FUN_0041a960(void *this,int param_1)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  char acStack_404 [1024];
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)acStack_404;
  iVar2 = feof(*(FILE **)((int)this + 4));
  if (iVar2 == 0) {
    acStack_404[0] = '\0';
    fgets(acStack_404,0x3ff,*(FILE **)((int)this + 4));
    pcVar3 = acStack_404;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    for (pcVar3 = pcVar3 + (-1 - (int)(acStack_404 + 1));
        (0 < (int)pcVar3 &&
        ((acStack_404[(int)pcVar3] == '\r' || (acStack_404[(int)pcVar3] == '\n'))));
        pcVar3 = pcVar3 + -1) {
      acStack_404[(int)pcVar3] = '\0';
    }
    if (param_1 != 0) {
      FUN_00401080();
    }
  }
  ___security_check_cookie_4(local_4 ^ (uint)acStack_404);
  return;
}



void ** __fastcall FUN_0041aa30(void **param_1)

{
  void *pvVar1;
  void **in_EAX;
  
  *param_1 = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
  if (*in_EAX != (void *)0x0) {
    FUN_0041b310();
    memcpy(*param_1,*in_EAX,(size_t)in_EAX[1]);
    pvVar1 = in_EAX[1];
    param_1[1] = pvVar1;
    *(undefined *)((int)pvVar1 + (int)*param_1) = 0;
  }
  return param_1;
}



void __fastcall FUN_0041aa80(undefined4 param_1,char *param_2,char *param_3)

{
  char cVar1;
  void **in_EAX;
  char *pcVar2;
  char *_Size;
  
  *in_EAX = (void *)0x0;
  in_EAX[2] = (void *)0x0;
  in_EAX[1] = (void *)0x0;
  if (param_3 != (char *)0x0) {
    pcVar2 = param_3;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    _Size = pcVar2 + -(int)(param_3 + 1);
    if ((int)param_2 < (int)(pcVar2 + -(int)(param_3 + 1))) {
      _Size = param_2;
    }
    if (_Size != (char *)0x0) {
      FUN_0041b310();
      memcpy(*in_EAX,param_3,(size_t)_Size);
      in_EAX[1] = _Size;
      _Size[(int)*in_EAX] = '\0';
    }
    return;
  }
  return;
}



void __fastcall FUN_0041aaf0(void **param_1)

{
  if (*param_1 != (void *)0x0) {
    free(*param_1);
  }
  return;
}



int __fastcall FUN_0041ab00(byte *param_1)

{
  byte bVar1;
  byte **in_EAX;
  byte *pbVar2;
  bool bVar3;
  
  pbVar2 = *in_EAX;
  if (pbVar2 == (byte *)0x0) {
    if (param_1 == (byte *)0x0) {
      return 0;
    }
    if (*param_1 != 0) {
      return -1;
    }
  }
  else {
    if ((*pbVar2 != 0) && (param_1 == (byte *)0x0)) {
      return 1;
    }
    if ((pbVar2 != (byte *)0x0) && (*pbVar2 != 0)) goto LAB_0041ab33;
  }
  if (param_1 == (byte *)0x0) {
    return 0;
  }
  if (*param_1 == 0) {
    return 0;
  }
LAB_0041ab33:
  while( true ) {
    bVar1 = *pbVar2;
    bVar3 = bVar1 < *param_1;
    if (bVar1 != *param_1) break;
    if (bVar1 == 0) {
      return 0;
    }
    bVar1 = pbVar2[1];
    bVar3 = bVar1 < param_1[1];
    if (bVar1 != param_1[1]) break;
    pbVar2 = pbVar2 + 2;
    param_1 = param_1 + 2;
    if (bVar1 == 0) {
      return 0;
    }
  }
  return (1 - (uint)bVar3) - (uint)(bVar3 != 0);
}



void __fastcall FUN_0041ab60(undefined4 param_1,char *param_2)

{
  int iVar1;
  int in_EAX;
  int *unaff_ESI;
  
  if (param_2 == (char *)0x7fffffff) {
    param_2 = (char *)(unaff_ESI[1] - in_EAX);
  }
  iVar1 = unaff_ESI[1];
  if (iVar1 < (int)(param_2 + in_EAX)) {
    param_2 = (char *)(iVar1 - in_EAX);
  }
  if (iVar1 < in_EAX) {
    param_2 = (char *)0x0;
  }
  FUN_0041aa80(*unaff_ESI + in_EAX,param_2,(char *)(*unaff_ESI + in_EAX));
  return;
}



void __fastcall FUN_0041aba0(char **param_1,char *param_2)

{
  if ((int)param_1[1] < (int)param_2) {
    param_2 = param_1[1];
  }
  FUN_0041aa80(param_1,param_2,*param_1);
  return;
}



void __fastcall FUN_0041abc0(int *param_1)

{
  char *pcVar1;
  char *pcVar2;
  
  pcVar1 = (char *)param_1[1];
  pcVar2 = (char *)0x1;
  if ((int)pcVar1 < 1) {
    pcVar2 = pcVar1;
  }
  FUN_0041aa80(param_1,pcVar2,pcVar1 + (*param_1 - (int)pcVar2));
  return;
}



// WARNING: Removing unreachable block (ram,0x0041accf)
// WARNING: Removing unreachable block (ram,0x0041acfe)

void ** __thiscall FUN_0041abf0(void *this,char **param_1,void **param_2,char param_3)

{
  char cVar1;
  void **ppvVar2;
  char *pcVar3;
  char *local_14;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439381;
  local_c = ExceptionList;
  local_14 = (char *)0x0;
  local_4 = 1;
  pcVar3 = *param_1;
  if (pcVar3 == (char *)0x0) {
    ExceptionList = &local_c;
    FUN_0041aa80(this,(char *)0x7fffffff,(char *)&PTR_0043b324);
  }
  else {
    cVar1 = *pcVar3;
    ppvVar2 = &local_c;
    while ((ExceptionList = ppvVar2, cVar1 != '\0' && (cVar1 != param_3))) {
      if ((int)(local_14 + 1) < 0) {
        local_14[1] = '\0';
      }
      else {
        FUN_0041b310();
      }
      pcVar3 = pcVar3 + 1;
      *local_14 = cVar1;
      local_14 = local_14 + 1;
      ppvVar2 = (void **)ExceptionList;
      cVar1 = *pcVar3;
    }
    *param_2 = (void *)0x0;
    param_2[2] = (void *)0x0;
    param_2[1] = (void *)0x0;
  }
  ExceptionList = local_c;
  return param_2;
}



undefined4 * __thiscall FUN_0041ad20(char param_1,undefined4 *param_2)

{
  char *pcVar1;
  char **unaff_EBX;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439239;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_2 = 0;
  param_2[2] = 0;
  param_2[1] = 0;
  local_4 = 0;
  pcVar1 = strchr(*unaff_EBX,(int)param_1);
  if ((pcVar1 != (char *)0x0) && ((int)pcVar1 - (int)*unaff_EBX != -1)) {
    FUN_00401080();
  }
  ExceptionList = local_c;
  return param_2;
}



// WARNING: Removing unreachable block (ram,0x0041ae4b)
// WARNING: Removing unreachable block (ram,0x0041ae18)
// WARNING: Removing unreachable block (ram,0x0041ae20)
// WARNING: Removing unreachable block (ram,0x0041ae26)
// WARNING: Removing unreachable block (ram,0x0041ae77)

void ** __thiscall FUN_0041ada0(void *this,void **param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439341;
  local_c = ExceptionList;
  ExceptionList = &local_c;
                    // WARNING: Load size is inaccurate
  if (*this != 0) {
    FUN_0041b310();
                    // WARNING: Load size is inaccurate
    memcpy((void *)0x0,*this,*(size_t *)((int)this + 4));
    **(undefined **)((int)this + 4) = 0;
  }
  *param_1 = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
  ExceptionList = local_c;
  return param_1;
}



void FUN_0041aea0(char param_1)

{
  byte bVar1;
  int iVar2;
  byte **unaff_ESI;
  byte *pbVar3;
  
  if (unaff_ESI[1] == (byte *)0x0) {
    return;
  }
  if (param_1 == '\0') {
    if (0x7e < **unaff_ESI) {
      return;
    }
    iVar2 = isspace((uint)**unaff_ESI);
    if (iVar2 == 0) {
      return;
    }
    for (pbVar3 = (byte *)0x1;
        ((pbVar3[(int)*unaff_ESI] < 0x7f &&
         (iVar2 = isspace((uint)pbVar3[(int)*unaff_ESI]), iVar2 != 0)) &&
        ((int)pbVar3 < (int)unaff_ESI[1])); pbVar3 = pbVar3 + 1) {
    }
    if (unaff_ESI[1] != pbVar3) {
      memmove(*unaff_ESI,*unaff_ESI + (int)pbVar3,(int)unaff_ESI[1] - (int)pbVar3);
      unaff_ESI[1] = unaff_ESI[1] + -(int)pbVar3;
      unaff_ESI[1][(int)*unaff_ESI] = 0;
      return;
    }
  }
  else {
    bVar1 = (unaff_ESI[1] + -1)[(int)*unaff_ESI];
    if (0x7e < bVar1) {
      return;
    }
    iVar2 = isspace((uint)bVar1);
    if (iVar2 == 0) {
      return;
    }
    pbVar3 = unaff_ESI[1] + -2;
    while (((-1 < (int)pbVar3 && (pbVar3[(int)*unaff_ESI] < 0x7f)) &&
           (iVar2 = isspace((uint)pbVar3[(int)*unaff_ESI]), iVar2 != 0))) {
      pbVar3 = pbVar3 + -1;
    }
    pbVar3 = pbVar3 + 1;
    unaff_ESI[1] = pbVar3;
    if (pbVar3 != (byte *)0x0) {
      pbVar3[(int)*unaff_ESI] = 0;
      return;
    }
  }
  unaff_ESI[1] = (byte *)0x0;
  if (*unaff_ESI == (byte *)0x0) {
    return;
  }
  **unaff_ESI = 0;
  return;
}



uint __thiscall FUN_0041afa0(void *this,char **param_1)

{
  char cVar1;
  char *pcVar2;
  uint uVar3;
  char **ppcVar4;
  uint uVar5;
  char **ppcVar6;
  char *_Dst;
  uint _Size;
  char *pcVar7;
  char **local_14;
  char *local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00438088;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  ppcVar4 = (char **)*param_1;
  param_1 = ppcVar4;
  if (ppcVar4 == (char **)0x0) {
    param_1 = (char **)&DAT_0044d0d5;
  }
  local_10 = (char *)0x0;
  do {
    local_14 = (char **)0x0;
                    // WARNING: Load size is inaccurate
    cVar1 = *this;
    ppcVar4 = (char **)CONCAT31((int3)((uint)ppcVar4 >> 8),cVar1);
    pcVar7 = (char *)this;
    this = local_10;
    while (local_10 = pcVar7, cVar1 != '\0') {
      cVar1 = (char)ppcVar4;
      pcVar7 = local_10;
      if (cVar1 == '*') {
        while( true ) {
          cVar1 = *pcVar7;
          ppcVar4 = (char **)CONCAT31((int3)((uint)ppcVar4 >> 8),cVar1);
          if ((cVar1 != '*') && (cVar1 != '?')) break;
          pcVar7 = pcVar7 + 1;
        }
        if (*pcVar7 == '\0') goto LAB_0041b140;
        pcVar2 = strpbrk(pcVar7,"*?");
        if (pcVar2 == (char *)0x0) {
          pcVar2 = pcVar7;
          do {
            cVar1 = *pcVar2;
            pcVar2 = pcVar2 + 1;
          } while (cVar1 != '\0');
          uVar3 = (int)pcVar2 - (int)(pcVar7 + 1);
        }
        else {
          uVar3 = (int)pcVar2 - (int)pcVar7;
        }
        _Dst = (char *)0x0;
        pcVar2 = pcVar7;
        do {
          cVar1 = *pcVar2;
          pcVar2 = pcVar2 + 1;
        } while (cVar1 != '\0');
        _Size = (int)pcVar2 - (int)(pcVar7 + 1);
        if ((int)uVar3 < (int)pcVar2 - (int)(pcVar7 + 1)) {
          _Size = uVar3;
        }
        if (_Size != 0) {
          if (-1 < (int)_Size) {
            uVar5 = _Size & 0x8000001f;
            if ((int)uVar5 < 0) {
              uVar5 = (uVar5 - 1 | 0xffffffe0) + 1;
            }
            _Dst = (char *)malloc((_Size - uVar5) + 0x21);
            _Dst[_Size] = '\0';
          }
          memcpy(_Dst,pcVar7,_Size);
          _Dst[_Size] = '\0';
        }
        pcVar2 = &DAT_0044d0d5;
        if (_Dst != (char *)0x0) {
          pcVar2 = _Dst;
        }
        ppcVar4 = (char **)strstr((char *)param_1,pcVar2);
        uStack_4 = 0xffffffff;
        if (ppcVar4 == (char **)0x0) {
          if (_Dst != (char *)0x0) {
            free(_Dst);
          }
          goto LAB_0041b152;
        }
        ppcVar6 = (char **)((int)ppcVar4 + (uVar3 - 1));
        pcVar2 = pcVar7 + (uVar3 - 1);
        local_14 = param_1;
        if (_Dst != (char *)0x0) {
          free(_Dst);
        }
      }
      else {
        ppcVar6 = param_1;
        pcVar2 = local_10;
        if (cVar1 == '?') {
          local_10 = (char *)this;
          if (*(char *)param_1 == '\0') goto LAB_0041b152;
        }
        else {
          local_10 = (char *)this;
          if (cVar1 != *(char *)param_1) goto LAB_0041b152;
        }
      }
      cVar1 = pcVar2[1];
      ppcVar4 = (char **)CONCAT31((int3)((uint)ppcVar4 >> 8),cVar1);
      param_1 = (char **)((int)ppcVar6 + 1);
      pcVar7 = pcVar2 + 1;
      this = local_10;
    }
    if (*(char *)param_1 == '\0') {
LAB_0041b140:
      ExceptionList = local_c;
      return CONCAT31((int3)((uint)ppcVar4 >> 8),1);
    }
    ppcVar4 = local_14;
    if (local_14 == (char **)0x0) {
LAB_0041b152:
      ExceptionList = local_c;
      return (uint)ppcVar4 & 0xffffff00;
    }
    ppcVar4 = (char **)((int)local_14 + 1);
    param_1 = ppcVar4;
    local_10 = (char *)this;
  } while( true );
}



undefined4 FUN_0041b170(long *param_1)

{
  char **in_EAX;
  long lVar1;
  char *_Str;
  char *local_4;
  
  _Str = &DAT_0044d0d5;
  if (*in_EAX != (char *)0x0) {
    _Str = *in_EAX;
  }
  lVar1 = strtol(_Str,&local_4,10);
  *param_1 = lVar1;
  if ((*local_4 == '\0') && (local_4 != _Str)) {
    return 1;
  }
  return 0;
}



char * FUN_0041b1c0(char *param_1,va_list param_2)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  char *pcVar4;
  char *pcVar5;
  size_t _Count;
  char **unaff_ESI;
  int iVar6;
  
  _Count = 0x400;
  while( true ) {
    uVar1 = _Count + 1;
    if ((int)unaff_ESI[2] <= (int)uVar1) {
      if (*unaff_ESI == (char *)0x0) {
        uVar3 = uVar1 & 0x8000001f;
        if ((int)uVar3 < 0) {
          uVar3 = (uVar3 - 1 | 0xffffffe0) + 1;
        }
        iVar6 = uVar1 - uVar3;
        pcVar4 = (char *)malloc(iVar6 + 0x21);
      }
      else {
        uVar3 = uVar1 & 0x8000001f;
        if ((int)uVar3 < 0) {
          uVar3 = (uVar3 - 1 | 0xffffffe0) + 1;
        }
        iVar6 = uVar1 - uVar3;
        pcVar4 = (char *)realloc(*unaff_ESI,iVar6 + 0x21);
      }
      *unaff_ESI = pcVar4;
      unaff_ESI[2] = (char *)(iVar6 + 0x20);
      pcVar4[uVar1] = '\0';
    }
    pcVar4 = *unaff_ESI;
    if (pcVar4 == (char *)0x0) break;
    iVar6 = _vsnprintf(pcVar4,_Count,param_1,param_2);
    pcVar4[_Count] = '\0';
    pcVar5 = *unaff_ESI;
    pcVar4 = pcVar5 + 1;
    do {
      cVar2 = *pcVar5;
      pcVar5 = pcVar5 + 1;
    } while (cVar2 != '\0');
    unaff_ESI[1] = pcVar5 + -(int)pcVar4;
    if ((-1 < iVar6) && (iVar6 <= (int)_Count)) {
      pcVar4 = (char *)realloc(*unaff_ESI,(size_t)(pcVar5 + -(int)pcVar4 + 1));
      *unaff_ESI = pcVar4;
      unaff_ESI[2] = unaff_ESI[1];
      return unaff_ESI[1];
    }
    _Count = _Count * 2;
  }
  return (char *)0xffffffff;
}



undefined4 * __cdecl FUN_0041b2a0(undefined4 *param_1,char *param_2)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004392f9;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = 0;
  param_1[2] = 0;
  param_1[1] = 0;
  local_4 = 0;
  FUN_0041b1c0(param_2,&stack0x0000000c);
  ExceptionList = local_c;
  return param_1;
}



void FUN_0041b310(void)

{
  uint uVar1;
  void *pvVar2;
  uint unaff_EBX;
  void **unaff_EDI;
  
  if ((int)unaff_EDI[2] <= (int)unaff_EBX) {
    if (*unaff_EDI == (void *)0x0) {
      uVar1 = unaff_EBX & 0x8000001f;
      if ((int)uVar1 < 0) {
        uVar1 = (uVar1 - 1 | 0xffffffe0) + 1;
      }
      pvVar2 = malloc((unaff_EBX - uVar1) + 0x21);
      unaff_EDI[2] = (void *)((unaff_EBX - uVar1) + 0x20);
      *unaff_EDI = pvVar2;
      *(undefined *)(unaff_EBX + (int)pvVar2) = 0;
      return;
    }
    uVar1 = unaff_EBX & 0x8000001f;
    if ((int)uVar1 < 0) {
      uVar1 = (uVar1 - 1 | 0xffffffe0) + 1;
    }
    pvVar2 = realloc(*unaff_EDI,(unaff_EBX - uVar1) + 0x21);
    unaff_EDI[2] = (void *)((unaff_EBX - uVar1) + 0x20);
    *unaff_EDI = pvVar2;
    *(undefined *)(unaff_EBX + (int)pvVar2) = 0;
  }
  return;
}



void ** __thiscall FUN_0041b380(void *this,void **param_1,void **param_2)

{
  void *pvVar1;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004392b9;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  *param_1 = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
                    // WARNING: Load size is inaccurate
  if (*this != 0) {
    FUN_0041b310();
                    // WARNING: Load size is inaccurate
    memcpy(*param_1,*this,*(size_t *)((int)this + 4));
    pvVar1 = *(void **)((int)this + 4);
    param_1[1] = pvVar1;
    *(undefined *)((int)pvVar1 + (int)*param_1) = 0;
  }
  local_4 = 0;
  FUN_0041b310();
  memcpy((void *)((int)param_1[1] + (int)*param_1),*param_2,(size_t)param_2[1]);
  param_1[1] = (void *)((int)param_1[1] + (int)param_2[1]);
  *(undefined *)((int)param_1[1] + (int)*param_1) = 0;
  ExceptionList = local_c;
  return param_1;
}



void ** __thiscall FUN_0041b440(void *this,void **param_1,char *param_2)

{
  char cVar1;
  void *pvVar2;
  char *pcVar3;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439279;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  *param_1 = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
                    // WARNING: Load size is inaccurate
  if (*this != 0) {
    FUN_0041b310();
                    // WARNING: Load size is inaccurate
    memcpy(*param_1,*this,*(size_t *)((int)this + 4));
    pvVar2 = *(void **)((int)this + 4);
    param_1[1] = pvVar2;
    *(undefined *)((int)pvVar2 + (int)*param_1) = 0;
  }
  local_4 = 0;
  pcVar3 = param_2;
  do {
    cVar1 = *pcVar3;
    pcVar3 = pcVar3 + 1;
  } while (cVar1 != '\0');
  FUN_0041b310();
  memcpy((void *)((int)param_1[1] + (int)*param_1),param_2,(int)pcVar3 - (int)(param_2 + 1));
  param_1[1] = (void *)((int)param_1[1] + ((int)pcVar3 - (int)(param_2 + 1)));
  *(undefined *)((int)param_1[1] + (int)*param_1) = 0;
  ExceptionList = local_c;
  return param_1;
}



int * __thiscall FUN_0041b510(void *this,int *param_1,char *param_2)

{
  void **unaff_ESI;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439239;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  FUN_0041aa80(this,(char *)0x7fffffff,param_2);
  local_4 = 0;
  FUN_0041b310();
  memcpy((void *)(*param_1 + param_1[1]),*unaff_ESI,(size_t)unaff_ESI[1]);
  param_1[1] = param_1[1] + (int)unaff_ESI[1];
  *(undefined *)(param_1[1] + *param_1) = 0;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_0041b5b0(void *this,byte param_1)

{
  *(undefined ***)this = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)((int)this + 0xc));
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_0041b5e0(undefined4 *param_1)

{
  *param_1 = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  return;
}



void FUN_0041b600(void)

{
  int *piVar1;
  int iVar2;
  int *in_EAX;
  DWORD DVar3;
  
  iVar2 = *in_EAX;
  DVar3 = GetCurrentThreadId();
  if (*(DWORD *)(iVar2 + 4) == DVar3) {
    piVar1 = (int *)(iVar2 + 8);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(iVar2 + 4) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(iVar2 + 0xc));
    }
  }
  return;
}



int * __thiscall FUN_0041b630(void *this,int *param_1)

{
  bool bVar1;
  char cVar2;
  void **ppvVar3;
  char **ppcVar4;
  undefined4 extraout_ECX;
  char *_Src;
  undefined1 *puVar5;
  char *pcVar6;
  int iVar7;
  undefined4 uVar8;
  char *in_stack_ffffff84;
  void *pvVar9;
  char *pcVar10;
  undefined **local_54;
  FILE *local_50;
  char *local_4c;
  char *local_48;
  undefined4 local_44;
  void *local_40;
  void *local_3c;
  undefined4 local_38;
  void *pvStack_34;
  void *local_28 [3];
  void *local_1c [4];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439bc0;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  local_54 = aDiskFile::vftable;
  local_50 = (FILE *)0x0;
  local_4c = (char *)0x0;
  local_44 = 0;
  local_48 = (char *)0x0;
  local_40 = (void *)0x0;
  local_38 = 0;
  local_3c = (void *)0x0;
  local_4._0_1_ = 3;
  local_4._1_3_ = 0;
  FUN_0041aa80(this,(char *)0x7fffffff,"rt");
  local_4._0_1_ = 4;
  pcVar6 = (char *)0x0;
  uVar8 = 0;
  iVar7 = 0;
                    // WARNING: Load size is inaccurate
  if (*this != 0) {
    FUN_0041b310();
                    // WARNING: Load size is inaccurate
    memcpy(pcVar6,*this,*(size_t *)((int)this + 4));
    iVar7 = *(int *)((int)this + 4);
    pcVar6[iVar7] = '\0';
  }
  local_4 = CONCAT31(local_4._1_3_,3);
  bVar1 = FUN_0041a810(&local_54,pcVar6,iVar7,uVar8,in_stack_ffffff84);
  if (bVar1) {
    cVar2 = FUN_0041a960(&local_54,(int)&local_4c);
    while (cVar2 != '\0') {
      FUN_0041aea0('\x01');
      FUN_0041aea0('\0');
      pcVar6 = local_48;
      _Src = local_4c;
      if (local_48 != (char *)0x0) {
        if (*local_4c == '[') {
          pcVar6 = strchr(local_4c,0x5d);
          if (pcVar6 == (char *)0x0) {
            iVar7 = -1;
          }
          else {
            iVar7 = (int)pcVar6 - (int)_Src;
          }
          ppvVar3 = (void **)FUN_0041ab60(extraout_ECX,(char *)(iVar7 + -1));
          local_4._0_1_ = 5;
          if (*ppvVar3 != local_40) {
            FUN_0041b310();
            pvVar9 = local_40;
            memcpy(local_40,*ppvVar3,(size_t)ppvVar3[1]);
            local_3c = ppvVar3[1];
            *(undefined *)((int)local_3c + (int)pvVar9) = 0;
          }
          local_4 = CONCAT31(local_4._1_3_,3);
          if (pvStack_34 != (void *)0x0) {
            free(pvStack_34);
          }
        }
        else if (*local_4c != '#') {
          if (local_3c != (void *)0x0) {
            ppvVar3 = FUN_0041b440(&local_40,local_1c,"/");
            local_4._0_1_ = 6;
            ppcVar4 = (char **)FUN_0041b380(ppvVar3,local_28,&local_4c);
            local_4._0_1_ = 7;
            if (*ppcVar4 != _Src) {
              FUN_0041b310();
              _Src = local_4c;
              memcpy(local_4c,*ppcVar4,(size_t)ppcVar4[1]);
              pcVar6 = ppcVar4[1];
              pcVar6[(int)_Src] = '\0';
              local_48 = pcVar6;
            }
            local_4._0_1_ = 6;
            if (local_28[0] != (void *)0x0) {
              free(local_28[0]);
            }
            local_4 = CONCAT31(local_4._1_3_,3);
            if (local_1c[0] != (void *)0x0) {
              free(local_1c[0]);
            }
          }
          pvVar9 = (void *)0x0;
          pcVar10 = (char *)0x0;
          if (_Src != (char *)0x0) {
            FUN_0041b310();
            memcpy(pvVar9,_Src,(size_t)pcVar6);
            pcVar6[(int)pvVar9] = '\0';
            pcVar10 = pcVar6;
          }
          FUN_00402b40(param_1,pvVar9,(size_t)pcVar10);
        }
      }
      cVar2 = FUN_0041a960(&local_54,(int)&local_4c);
    }
    fclose(local_50);
    local_4._0_1_ = 2;
    local_50 = (FILE *)0x0;
    if (local_40 != (void *)0x0) {
      free(local_40);
    }
    local_4 = CONCAT31(local_4._1_3_,1);
    if (local_4c != (char *)0x0) {
      free(local_4c);
    }
  }
  else {
                    // WARNING: Load size is inaccurate
    puVar5 = *this;
    if (puVar5 == (undefined1 *)0x0) {
      puVar5 = &DAT_0044d0d5;
    }
    FUN_0041a1f0("Config.Config(): path not found %s",(char)puVar5);
    if (local_50 != (FILE *)0x0) {
      fclose(local_50);
    }
  }
  ExceptionList = local_c;
  return param_1;
}



uint __fastcall FUN_0041b960(int *param_1,int param_2,void **param_3,void **param_4)

{
  void *pvVar1;
  void *pvVar2;
  void *_Size;
  undefined4 *puVar3;
  void **ppvVar4;
  undefined4 extraout_ECX;
  char *_Str;
  char *local_3c;
  int local_38;
  undefined4 local_34;
  void *local_30;
  void *local_2c;
  undefined4 local_28;
  void *local_24;
  void *local_20;
  undefined4 local_1c;
  void *pvStack_18;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438728;
  local_c = ExceptionList;
  ppvVar4 = &local_c;
  _Str = (char *)0x0;
  local_3c = (char *)0x0;
  local_34 = 0;
  local_38 = 0;
  local_30 = (void *)0x0;
  local_28 = 0;
  local_2c = (void *)0x0;
  local_24 = (void *)0x0;
  local_1c = 0;
  local_20 = (void *)0x0;
  local_4 = 2;
  if ((-1 < param_2) && (param_2 < *param_1)) {
    ExceptionList = ppvVar4;
    puVar3 = (undefined4 *)FUN_0040e220((int)param_1);
    puVar3 = (undefined4 *)*puVar3;
    if (param_2 != 0) {
      do {
        param_2 = param_2 + -1;
        puVar3 = (undefined4 *)*puVar3;
      } while (param_2 != 0);
    }
    if (puVar3[2] != 0) {
      FUN_0041b310();
      _Str = local_3c;
      memcpy(local_3c,(void *)puVar3[2],puVar3[3]);
      local_38 = puVar3[3];
      _Str[local_38] = '\0';
    }
    ppvVar4 = (void **)strchr(_Str,0x3d);
    if (ppvVar4 != (void **)0x0) {
      if ((char *)((int)ppvVar4 - (int)_Str) != (char *)0xffffffff) {
        ppvVar4 = (void **)FUN_0041aba0(&local_3c,(char *)((int)ppvVar4 - (int)_Str));
        local_4._0_1_ = 3;
        if (*ppvVar4 != (void *)0x0) {
          FUN_0041b310();
          pvVar1 = local_30;
          memcpy(local_30,*ppvVar4,(size_t)ppvVar4[1]);
          local_2c = ppvVar4[1];
          *(undefined *)((int)local_2c + (int)pvVar1) = 0;
        }
        local_4._0_1_ = 2;
        if (pvStack_18 != (void *)0x0) {
          free(pvStack_18);
        }
        FUN_0041aea0('\x01');
        FUN_0041aea0('\0');
        ppvVar4 = (void **)FUN_0041ab60(extraout_ECX,(char *)0x7fffffff);
        local_4._0_1_ = 4;
        if (*ppvVar4 != (void *)0x0) {
          FUN_0041b310();
          pvVar1 = local_24;
          memcpy(local_24,*ppvVar4,(size_t)ppvVar4[1]);
          local_20 = ppvVar4[1];
          *(undefined *)((int)local_20 + (int)pvVar1) = 0;
        }
        local_4 = CONCAT31(local_4._1_3_,2);
        if (pvStack_18 != (void *)0x0) {
          free(pvStack_18);
        }
        FUN_0041aea0('\x01');
        FUN_0041aea0('\0');
        pvVar2 = local_2c;
        pvVar1 = local_30;
        if ((param_3 != (void **)0x0) && (local_30 != *param_3)) {
          FUN_0041b310();
          memcpy(*param_3,pvVar1,(size_t)pvVar2);
          param_3[1] = pvVar2;
          *(undefined *)((int)pvVar2 + (int)*param_3) = 0;
        }
        _Size = local_20;
        pvVar2 = local_24;
        if ((param_4 != (void **)0x0) && (local_24 != *param_4)) {
          FUN_0041b310();
          memcpy(*param_4,pvVar2,(size_t)_Size);
          param_4[1] = _Size;
          *(undefined *)((int)_Size + (int)*param_4) = 0;
        }
        local_4._0_1_ = 1;
        if (pvVar2 != (void *)0x0) {
          free(pvVar2);
        }
        local_4 = (uint)local_4._1_3_ << 8;
        if (pvVar1 != (void *)0x0) {
          free(pvVar1);
        }
        local_4 = 0xffffffff;
        if (local_3c != (char *)0x0) {
          free(local_3c);
        }
        ExceptionList = local_c;
        return CONCAT31((int3)((uint)local_3c >> 8),1);
      }
      ppvVar4 = (void **)0xffffffff;
      _Str = local_3c;
    }
    local_4 = 0xffffffff;
    if (_Str != (char *)0x0) {
      free(_Str);
    }
  }
  ExceptionList = local_c;
  return (uint)ppvVar4 & 0xffffff00;
}



uint __thiscall FUN_0041bbf0(void *this,int param_1,void **param_2)

{
  byte bVar1;
  undefined4 *puVar2;
  void **ppvVar3;
  int *piVar4;
  uint uVar5;
  void *pvVar6;
  byte **ppbVar7;
  byte *pbVar8;
  byte *pbVar9;
  uint uVar10;
  byte *pbVar11;
  byte *_Memory;
  int iVar12;
  bool bVar13;
  char *pcStack_50;
  int *local_48;
  int iStack_44;
  int iStack_40;
  byte *local_3c;
  byte *local_38;
  int local_34;
  byte *local_30;
  void *local_2c;
  undefined4 local_28;
  void *apvStack_24 [3];
  void *pvStack_18;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439b58;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_30 = (byte *)0x0;
  local_28 = 0;
  local_2c = (void *)0x0;
  _Memory = (byte *)0x0;
  local_3c = (byte *)0x0;
  local_34 = 0;
  local_38 = (byte *)0x0;
  local_4._0_1_ = 1;
  local_4._1_3_ = 0;
  ppvVar3 = FUN_0041ada0(this,&local_48);
  local_4._0_1_ = 2;
  if (*ppvVar3 != (void *)0x0) {
    FUN_0041b310();
    pbVar11 = local_30;
    memcpy(local_30,*ppvVar3,(size_t)ppvVar3[1]);
    local_2c = ppvVar3[1];
    *(byte *)((int)local_2c + (int)pbVar11) = 0;
  }
  local_4 = CONCAT31(local_4._1_3_,1);
  if (local_48 != (int *)0x0) {
    free(local_48);
  }
  FUN_0041aea0('\x01');
  FUN_0041aea0('\0');
  param_2[1] = (void *)0x0;
  if ((undefined *)*param_2 != (undefined *)0x0) {
    *(undefined *)*param_2 = 0;
  }
  piVar4 = (int *)FUN_0040e220(param_1);
  puVar2 = (undefined4 *)*piVar4;
  pbVar11 = local_30;
  do {
    if (puVar2 == (undefined4 *)0x0) {
      local_4 = local_4 & 0xffffff00;
      if (_Memory != (byte *)0x0) {
        free(_Memory);
      }
      local_4 = 0xffffffff;
      if (pbVar11 != (byte *)0x0) {
        free(pbVar11);
      }
      ExceptionList = local_c;
      return (uint)piVar4 & 0xffffff00;
    }
    local_48 = (int *)0x0;
    iStack_40 = 0;
    iStack_44 = 0;
    if (puVar2[2] != 0) {
      uVar10 = puVar2[3];
      if (-1 < (int)uVar10) {
        uVar5 = uVar10 & 0x8000001f;
        if ((int)uVar5 < 0) {
          uVar5 = (uVar5 - 1 | 0xffffffe0) + 1;
        }
        local_48 = (int *)malloc((uVar10 - uVar5) + 0x21);
        iStack_40 = (uVar10 - uVar5) + 0x20;
        *(undefined *)(uVar10 + (int)local_48) = 0;
      }
      memcpy(local_48,(void *)puVar2[2],puVar2[3]);
      iStack_44 = puVar2[3];
      *(undefined *)(iStack_44 + (int)local_48) = 0;
    }
    local_4._0_1_ = 3;
    pcStack_50 = strchr((char *)local_48,0x3d);
    if (pcStack_50 == (char *)0x0) {
      pcStack_50 = (char *)0xffffffff;
    }
    else {
      pcStack_50 = pcStack_50 + -(int)local_48;
    }
    pvVar6 = (void *)FUN_0041aba0((char **)&local_48,pcStack_50);
    local_4._0_1_ = 4;
    ppbVar7 = (byte **)FUN_0041ada0(pvVar6,apvStack_24);
    local_4._0_1_ = 5;
    if (*ppbVar7 != _Memory) {
      pbVar11 = ppbVar7[1];
      if (local_34 <= (int)pbVar11) {
        if (_Memory == (byte *)0x0) {
          uVar10 = (uint)pbVar11 & 0x8000001f;
          if ((int)uVar10 < 0) {
            uVar10 = (uVar10 - 1 | 0xffffffe0) + 1;
          }
          iVar12 = (int)pbVar11 - uVar10;
          _Memory = (byte *)malloc(iVar12 + 0x21);
        }
        else {
          uVar10 = (uint)pbVar11 & 0x8000001f;
          if ((int)uVar10 < 0) {
            uVar10 = (uVar10 - 1 | 0xffffffe0) + 1;
          }
          iVar12 = (int)pbVar11 - uVar10;
          _Memory = (byte *)realloc(_Memory,iVar12 + 0x21);
        }
        local_34 = iVar12 + 0x20;
        pbVar11[(int)_Memory] = 0;
        local_3c = _Memory;
      }
      memcpy(_Memory,*ppbVar7,(size_t)ppbVar7[1]);
      local_38 = ppbVar7[1];
      local_38[(int)_Memory] = 0;
    }
    local_4._0_1_ = 4;
    if (apvStack_24[0] != (void *)0x0) {
      free(apvStack_24[0]);
    }
    local_4._0_1_ = 3;
    if (pvStack_18 != (void *)0x0) {
      free(pvStack_18);
    }
    FUN_0041aea0('\x01');
    FUN_0041aea0('\0');
    pbVar11 = local_30;
    _Memory = local_3c;
    pbVar9 = &DAT_0044d0d5;
    if (local_3c != (byte *)0x0) {
      pbVar9 = local_3c;
    }
    pbVar8 = local_30;
    if (local_30 == (byte *)0x0) {
      if (pbVar9 == (byte *)0x0) goto LAB_0041bee4;
      if (*pbVar9 == 0) goto LAB_0041be6e;
    }
    else {
      if (*local_30 == 0) {
LAB_0041be6e:
        if ((pbVar9 == (byte *)0x0) || (*pbVar9 == 0)) goto LAB_0041bee4;
      }
      else if (pbVar9 == (byte *)0x0) goto LAB_0041beb4;
      do {
        bVar1 = *pbVar8;
        bVar13 = bVar1 < *pbVar9;
        if (bVar1 != *pbVar9) {
LAB_0041beab:
          iVar12 = (1 - (uint)bVar13) - (uint)(bVar13 != 0);
          goto LAB_0041beb0;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar8[1];
        bVar13 = bVar1 < pbVar9[1];
        if (bVar1 != pbVar9[1]) goto LAB_0041beab;
        pbVar9 = pbVar9 + 2;
        pbVar8 = pbVar8 + 2;
      } while (bVar1 != 0);
      iVar12 = 0;
LAB_0041beb0:
      if (iVar12 == 0) {
LAB_0041bee4:
        ppvVar3 = (void **)FUN_0041ab60(pbVar9,(char *)0x7fffffff);
        local_4._0_1_ = 6;
        if (*ppvVar3 != *param_2) {
          FUN_0041b310();
          memcpy(*param_2,*ppvVar3,(size_t)ppvVar3[1]);
          pvVar6 = ppvVar3[1];
          param_2[1] = pvVar6;
          *(undefined *)((int)pvVar6 + (int)*param_2) = 0;
          pbVar11 = local_30;
        }
        local_4._0_1_ = 3;
        if (pvStack_18 != (void *)0x0) {
          free(pvStack_18);
        }
        FUN_0041aea0('\x01');
        FUN_0041aea0('\0');
        local_4._0_1_ = 1;
        piVar4 = local_48;
        if (local_48 != (int *)0x0) {
          free(local_48);
        }
        local_4 = (uint)local_4._1_3_ << 8;
        if (_Memory != (byte *)0x0) {
          free(_Memory);
        }
        local_4 = 0xffffffff;
        if (pbVar11 != (byte *)0x0) {
          free(pbVar11);
        }
        ExceptionList = local_c;
        return CONCAT31((int3)((uint)piVar4 >> 8),1);
      }
    }
LAB_0041beb4:
    puVar2 = (undefined4 *)*puVar2;
    local_4 = CONCAT31(local_4._1_3_,1);
    piVar4 = local_48;
    if (local_48 != (int *)0x0) {
      free(local_48);
    }
  } while( true );
}



uint __thiscall FUN_0041bff0(void *this,char *param_1,long *param_2)

{
  char *_Memory;
  undefined4 uVar1;
  char *pcVar2;
  char *_Str;
  char *local_18;
  undefined4 local_14;
  undefined4 local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a178;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_18 = (char *)0x0;
  local_10 = 0;
  local_14 = 0;
  local_4 = 0;
  uVar1 = FUN_0041bbf0(param_1,(int)this,&local_18);
  _Memory = local_18;
  if ((char)uVar1 == '\0') {
    local_4 = 0xffffffff;
    pcVar2 = local_18;
    if (local_18 != (char *)0x0) {
      free(local_18);
      pcVar2 = local_18;
    }
  }
  else {
    _Str = &DAT_0044d0d5;
    if (local_18 != (char *)0x0) {
      _Str = local_18;
    }
    pcVar2 = (char *)strtol(_Str,&param_1,10);
    if ((*param_1 == '\0') && (param_1 != _Str)) {
      *param_2 = (long)pcVar2;
      local_4 = 0xffffffff;
      if (_Memory != (char *)0x0) {
        free(_Memory);
      }
      ExceptionList = local_c;
      return CONCAT31((int3)((uint)pcVar2 >> 8),1);
    }
    local_4 = 0xffffffff;
    if (_Memory != (char *)0x0) {
      free(_Memory);
      ExceptionList = local_c;
      return (uint)pcVar2 & 0xffffff00;
    }
  }
  ExceptionList = local_c;
  return (uint)pcVar2 & 0xffffff00;
}



undefined4 * __thiscall FUN_0041c100(void *this,byte param_1)

{
  *(undefined ***)this = aSyncObj::vftable;
  *(undefined ***)((int)this + 8) = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void FUN_0041c130(void)

{
  undefined4 *in_EAX;
  
  *in_EAX = aSyncObj::vftable;
  in_EAX[2] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined FUN_0041c150(void)

{
  code *pcVar1;
  undefined uVar2;
  uint uVar3;
  DWORD DVar4;
  int *unaff_ESI;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_004386d8;
  local_c = ExceptionList;
  uVar3 = DAT_0044a01c ^ (uint)&stack0xffffffe8;
  ExceptionList = &local_c;
  DVar4 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar4) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  local_4 = 0;
  *(undefined *)((int)unaff_ESI + 0x25) = 0;
  pcVar1 = *(code **)(*unaff_ESI + 8);
  *(undefined *)(unaff_ESI + 9) = 1;
  uVar2 = (*pcVar1)(0,uVar3);
  DVar4 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar4) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  ExceptionList = &PTR_vftable_0044b584;
  return uVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_0041c210(void)

{
  DWORD DVar1;
  DWORD extraout_EAX;
  int unaff_EDI;
  
  DVar1 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar1) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  *(undefined *)(unaff_EDI + 0x24) = 0;
  *(undefined *)(unaff_EDI + 0x25) = 0;
  DVar1 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar1) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    DVar1 = extraout_EAX;
  }
  return CONCAT31((int3)(DVar1 >> 8),1);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined FUN_0041c280(void)

{
  code *pcVar1;
  undefined uVar2;
  uint uVar3;
  DWORD DVar4;
  int *unaff_ESI;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_004386d8;
  local_c = ExceptionList;
  uVar3 = DAT_0044a01c ^ (uint)&stack0xffffffe8;
  ExceptionList = &local_c;
  DVar4 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar4) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  local_4 = 0;
  pcVar1 = *(code **)(*unaff_ESI + 8);
  *(undefined *)(unaff_ESI + 9) = 1;
  *(undefined *)((int)unaff_ESI + 0x25) = 1;
  uVar2 = (*pcVar1)(0,uVar3);
  DVar4 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar4) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  ExceptionList = &PTR_vftable_0044b584;
  return uVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined __fastcall FUN_0041c340(int param_1)

{
  undefined uVar1;
  DWORD DVar2;
  
  DVar2 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar2) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  uVar1 = *(undefined *)(param_1 + 0x24);
  DVar2 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar2) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  return uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool __fastcall FUN_0041c3b0(int *param_1,undefined param_2,undefined4 param_3)

{
  bool bVar1;
  DWORD DVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439178;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar2 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar2) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  local_4 = 0;
  if (*(char *)(param_1 + 9) != '\0') {
    DVar2 = GetCurrentThreadId();
    if ((DAT_0044b588 == DVar2) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
      DAT_0044b588 = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    }
    ExceptionList = local_c;
    return true;
  }
  bVar1 = FUN_0041dc30(param_1);
  DVar2 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar2) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  ExceptionList = local_c;
  return bVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 __fastcall FUN_0041c4b0(int *param_1)

{
  int **ppiVar1;
  int *piVar2;
  int iVar3;
  undefined4 *puVar4;
  DWORD DVar5;
  uint uVar6;
  undefined4 *puVar7;
  undefined4 uVar8;
  DWORD extraout_EAX;
  int **ppiVar9;
  int *piVar10;
  int local_24;
  undefined4 *local_20;
  undefined4 *local_1c;
  void *local_14;
  undefined *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_004386b0;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  DVar5 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar5) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  local_24 = 0;
  local_20 = (undefined4 *)0x0;
  local_1c = (undefined4 *)0x0;
  local_c = 1;
  *(undefined *)(param_1 + 9) = 1;
  ppiVar1 = (int **)(param_1 + 3);
  piVar2 = (int *)0x0;
  if (param_1[5] != 0) {
    uVar6 = 0;
    if (param_1[4] != 0) {
      ppiVar9 = (int **)*ppiVar1;
      do {
        piVar2 = *ppiVar9;
        if (piVar2 != (int *)0x0) break;
        uVar6 = uVar6 + 1;
        ppiVar9 = ppiVar9 + 1;
      } while (uVar6 < (uint)param_1[4]);
    }
  }
  do {
    piVar10 = piVar2;
    puVar4 = local_1c;
    if ((ppiVar1 == (int **)0x0) || (piVar10 == (int *)0x0)) break;
    iVar3 = piVar10[3];
    local_1c = (undefined4 *)operator_new(0xc);
    local_1c[1] = puVar4;
    *local_1c = 0;
    local_1c[2] = iVar3;
    puVar7 = local_1c;
    if (puVar4 != (undefined4 *)0x0) {
      *puVar4 = local_1c;
      puVar7 = local_20;
    }
    local_20 = puVar7;
    piVar2 = (int *)*piVar10;
    local_24 = local_24 + 1;
    if (piVar2 == (int *)0x0) {
      uVar6 = piVar10[1] + 1;
      if (uVar6 < (uint)param_1[4]) {
        ppiVar9 = (int **)(*ppiVar1 + uVar6);
        do {
          piVar2 = *ppiVar9;
          if (piVar2 != (int *)0x0) break;
          uVar6 = uVar6 + 1;
          ppiVar9 = ppiVar9 + 1;
        } while (uVar6 < (uint)param_1[4]);
      }
    }
  } while( true );
  puVar7 = (undefined4 *)FUN_0040e220((int)&local_24);
  for (puVar7 = (undefined4 *)*puVar7; puVar7 != (undefined4 *)0x0; puVar7 = (undefined4 *)*puVar7)
  {
    uVar8 = FUN_0041e620(puVar7[2]);
    if ((char)uVar8 != '\0') {
      FUN_0041e760(param_1);
    }
  }
  if (*(char *)((int)param_1 + 0x25) != '\0') {
    *(undefined *)(param_1 + 9) = 0;
  }
  if (local_24 < 2) {
    if (local_24 == 0) goto LAB_0041c641;
  }
  else {
    for (puVar7 = (undefined4 *)*local_20; puVar7 != (undefined4 *)0x0;
        puVar7 = (undefined4 *)*puVar7) {
      operator_delete((void *)puVar7[1]);
    }
  }
  operator_delete(puVar4);
LAB_0041c641:
  DVar5 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar5) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    DVar5 = extraout_EAX;
  }
  ExceptionList = local_14;
  return CONCAT31((int3)(DVar5 >> 8),1);
}



undefined4 * __thiscall FUN_0041c6b0(void *this,byte param_1)

{
  *(undefined ***)this = aThread::vftable;
  *(undefined ***)((int)this + 8) = aSyncObj::vftable;
  *(undefined ***)((int)this + 0x10) = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_0041c6f0(undefined4 *param_1)

{
  *param_1 = aThread::vftable;
  param_1[2] = aSyncObj::vftable;
  param_1[4] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  return;
}



undefined FUN_0041c710(char param_1)

{
  HANDLE pvVar1;
  LPVOID unaff_ESI;
  DWORD local_4;
  
  *(undefined *)((int)unaff_ESI + 0x35) = 1;
  *(undefined4 *)((int)unaff_ESI + 0x30) = 0;
  *(undefined *)((int)unaff_ESI + 4) = 0;
  *(undefined *)((int)unaff_ESI + 0x34) = 0;
  FUN_0041c210();
  pvVar1 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,(LPTHREAD_START_ROUTINE)&LAB_0041c690,unaff_ESI
                        ,0,&local_4);
  *(HANDLE *)((int)unaff_ESI + 0x38) = pvVar1;
  if (pvVar1 == (HANDLE)0x0) {
    return 0;
  }
  if (param_1 != '\0') {
    (**(code **)(*(int *)((int)unaff_ESI + 8) + 0x10))(0xffffffff);
  }
  return *(undefined *)((int)unaff_ESI + 0x35);
}



void FUN_0041c770(void)

{
  return;
}



void __cdecl FUN_0041c780(char *param_1,undefined4 param_2)

{
  undefined4 extraout_ECX;
  void *in_stack_ffffffcc;
  size_t sVar1;
  void *in_stack_ffffffd8;
  void *in_stack_ffffffdc;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_004391f8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  if (DAT_0044d0e0 == (undefined4 *)0x0) {
    in_stack_ffffffdc = (void *)0x41c7b5;
    DAT_0044d0e0 = (undefined4 *)operator_new(0x1c);
    if (DAT_0044d0e0 == (undefined4 *)0x0) {
      DAT_0044d0e0 = (undefined4 *)0x0;
    }
    else {
      *DAT_0044d0e0 = aMap<class_aString,class_aString>::vftable;
      DAT_0044d0e0[1] = 0;
      DAT_0044d0e0[2] = 0x11;
      DAT_0044d0e0[3] = 0;
      DAT_0044d0e0[4] = 0;
      DAT_0044d0e0[5] = 0;
      DAT_0044d0e0[6] = 10;
    }
  }
  sVar1 = 0x41c7fd;
  FUN_0041aa80(param_2,(char *)0x7fffffff,(char *)param_2);
  local_4 = 0;
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,param_1);
  local_4 = 0xffffffff;
  FUN_0040ee80((int)DAT_0044d0e0,in_stack_ffffffcc,sVar1,param_2,in_stack_ffffffd8,in_stack_ffffffdc
              );
  ExceptionList = local_c;
  return;
}



int __fastcall FUN_0041c840(undefined4 param_1)

{
  char cVar1;
  int *piVar2;
  char **ppcVar3;
  char *pcVar4;
  char *unaff_ESI;
  void *in_stack_ffffffd8;
  size_t in_stack_ffffffdc;
  undefined *local_18;
  int local_14;
  void *local_10 [4];
  
  if (DAT_0044d0e0 != 0) {
    local_18 = &stack0xffffffd8;
    FUN_0041aa80(param_1,(char *)0x7fffffff,(char *)param_1);
    piVar2 = FUN_00421e80(DAT_0044d0e0,local_10,in_stack_ffffffd8,in_stack_ffffffdc);
    local_18 = (undefined *)*piVar2;
    local_14 = piVar2[1];
    if ((local_14 != 0) && (local_18 != (undefined *)0x0)) {
      memset(unaff_ESI,0,0x100);
      ppcVar3 = (char **)FUN_0040ef80((int *)&local_18);
      pcVar4 = *ppcVar3;
      if (pcVar4 == (char *)0x0) {
        pcVar4 = &DAT_0044d0d5;
      }
      strncpy(unaff_ESI,pcVar4,0xff);
      if (local_10[0] != (void *)0x0) {
        free(local_10[0]);
      }
      pcVar4 = unaff_ESI + 1;
      do {
        cVar1 = *unaff_ESI;
        unaff_ESI = unaff_ESI + 1;
      } while (cVar1 != '\0');
      return (int)unaff_ESI - (int)pcVar4;
    }
    *unaff_ESI = '\0';
  }
  return 0;
}



void FUN_0041c8f0(void)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  int **ppiVar4;
  undefined1 *puVar5;
  int *local_24;
  int **local_20;
  void *local_1c;
  void *local_10;
  
  printf("\n");
  local_20 = (int **)(DAT_0044d0e0 + 4);
  local_24 = (int *)0x0;
  if (*(int *)(DAT_0044d0e0 + 0xc) != 0) {
    uVar1 = 0;
    if (*(uint *)(DAT_0044d0e0 + 8) != 0) {
      ppiVar4 = (int **)*local_20;
      do {
        local_24 = *ppiVar4;
        if (local_24 != (int *)0x0) break;
        uVar1 = uVar1 + 1;
        ppiVar4 = ppiVar4 + 1;
      } while (uVar1 < *(uint *)(DAT_0044d0e0 + 8));
    }
  }
  while ((local_20 != (int **)0x0 && (local_24 != (int *)0x0))) {
    puVar2 = (undefined4 *)FUN_0040ef80((int *)&local_24);
    puVar5 = &DAT_0044d0d5;
    if ((undefined1 *)*puVar2 != (undefined1 *)0x0) {
      puVar5 = (undefined1 *)*puVar2;
    }
    puVar2 = (undefined4 *)FUN_0040efd0((int *)&local_24);
    puVar3 = (undefined1 *)*puVar2;
    if (puVar3 == (undefined1 *)0x0) {
      puVar3 = &DAT_0044d0d5;
    }
    printf("%s: %s\n",puVar3,puVar5);
    if (local_1c != (void *)0x0) {
      free(local_1c);
    }
    if (local_10 != (void *)0x0) {
      free(local_10);
    }
    FUN_0040f020(&local_24);
  }
  printf("\n");
  return;
}



uint __cdecl FUN_0041c9d0(int param_1)

{
  uint in_EAX;
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  int unaff_EBX;
  char *pcVar4;
  char *pcVar5;
  char *pcVar6;
  bool bVar7;
  
  iVar3 = 1;
  if (1 < param_1) {
    do {
      pcVar5 = *(char **)(unaff_EBX + iVar3 * 4);
      iVar2 = 3;
      bVar7 = true;
      pcVar4 = pcVar5;
      pcVar6 = "-v";
      do {
        if (iVar2 == 0) break;
        iVar2 = iVar2 + -1;
        bVar7 = *pcVar4 == *pcVar6;
        pcVar4 = pcVar4 + 1;
        pcVar6 = pcVar6 + 1;
      } while (bVar7);
      if (bVar7) {
LAB_0041ca17:
        uVar1 = FUN_0041c8f0();
        return CONCAT31((int3)((uint)uVar1 >> 8),1);
      }
      iVar2 = 10;
      in_EAX = 0;
      bVar7 = true;
      pcVar4 = "--version";
      do {
        if (iVar2 == 0) break;
        iVar2 = iVar2 + -1;
        bVar7 = *pcVar5 == *pcVar4;
        pcVar5 = pcVar5 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar7);
      if (bVar7) goto LAB_0041ca17;
      iVar3 = iVar3 + 1;
    } while (iVar3 < param_1);
  }
  return in_EAX & 0xffffff00;
}



bool __fastcall FUN_0041ca30(int param_1)

{
  HANDLE hThread;
  BOOL BVar1;
  int unaff_ESI;
  
  if (0x14 < unaff_ESI + 10U) {
    return false;
  }
  GetCurrentThread();
  switch(unaff_ESI) {
  case 2:
  case 3:
  case 4:
    param_1 = -1;
    break;
  case 5:
  case 6:
  case 7:
    param_1 = -2;
    break;
  case 8:
  case 9:
  case 10:
    param_1 = -0xf;
    break;
  case -10:
  case -9:
  case -8:
    param_1 = 0xf;
    break;
  case -7:
  case -6:
  case -5:
    param_1 = 2;
    break;
  case -4:
  case -3:
  case -2:
    param_1 = 1;
    break;
  case -1:
  case 0:
  case 1:
    param_1 = 0;
  }
  hThread = GetCurrentThread();
  BVar1 = SetThreadPriority(hThread,param_1);
  return BVar1 != 0;
}



undefined4 * __thiscall FUN_0041cae0(void *this,undefined4 *param_1,void **param_2)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438683;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = 0;
  param_1[2] = 0;
  param_1[1] = 0;
  param_1[3] = 0;
  param_1[5] = 0;
  param_1[4] = 0;
  local_4 = 1;
  FUN_0041cb50((void **)this,param_2);
  ExceptionList = local_c;
  return param_1;
}



void FUN_0041cb50(void **param_1,void **param_2)

{
  void *pvVar1;
  void **unaff_ESI;
  
  if (*param_2 != *unaff_ESI) {
    FUN_0041b310();
    memcpy(*unaff_ESI,*param_2,(size_t)param_2[1]);
    pvVar1 = param_2[1];
    unaff_ESI[1] = pvVar1;
    *(undefined *)((int)*unaff_ESI + (int)pvVar1) = 0;
  }
  if (*param_1 != unaff_ESI[3]) {
    FUN_0041b310();
    memcpy(unaff_ESI[3],*param_1,(size_t)param_1[1]);
    pvVar1 = param_1[1];
    unaff_ESI[4] = pvVar1;
    *(undefined *)((int)unaff_ESI[3] + (int)pvVar1) = 0;
  }
  unaff_ESI[6] = (void *)0x0;
  *(bool *)(unaff_ESI + 7) = unaff_ESI[4] != (void *)0x0;
  return;
}



uint FUN_0041cbe0(void)

{
  char *_Control;
  char **unaff_ESI;
  
  _Control = *unaff_ESI;
  if (_Control == (char *)0x0) {
    _Control = &DAT_0044d0d5;
  }
  if (0 < (int)unaff_ESI[4]) {
    _Control = (char *)strspn(unaff_ESI[3],_Control);
    if (((int)_Control < (int)unaff_ESI[4]) && (_Control != (char *)0xffffffff)) {
      return CONCAT31((int3)((uint)_Control >> 8),1);
    }
  }
  return (uint)_Control & 0xffffff00;
}



// WARNING: Removing unreachable block (ram,0x0041cdb7)

char ** FUN_0041cc10(char **param_1,char **param_2)

{
  char **ppcVar1;
  char cVar2;
  char *pcVar3;
  size_t sVar4;
  char **ppcVar5;
  char *pcVar6;
  char *extraout_ECX;
  char *pcVar7;
  char *_Size;
  char *pcStack_30;
  char *pcStack_20;
  void *pvStack_18;
  void *local_c;
  undefined *puStack_8;
  uint local_4;
  
  puStack_8 = &LAB_004391c9;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_2 = (char *)0x0;
  param_2[2] = (char *)0x0;
  param_2[1] = (char *)0x0;
  local_4 = 0;
  ppcVar1 = param_1 + 3;
  while( true ) {
    pcVar3 = *param_1;
    if (pcVar3 == (char *)0x0) {
      pcVar3 = &DAT_0044d0d5;
    }
    if ((int)param_1[4] < 1) {
      ExceptionList = local_c;
      return param_2;
    }
    sVar4 = strspn(*ppcVar1,pcVar3);
    if ((int)param_1[4] <= (int)sVar4) {
      ExceptionList = local_c;
      return param_2;
    }
    if (sVar4 == 0xffffffff) break;
    pcVar3 = *param_1;
    if (pcVar3 == (char *)0x0) {
      pcVar3 = &DAT_0044d0d5;
    }
    if ((((int)param_1[4] < 1) || (pcVar3 = strpbrk(*ppcVar1,pcVar3), pcVar3 == (char *)0x0)) ||
       (pcVar3 = pcVar3 + -(int)*ppcVar1, pcVar3 == (char *)0xffffffff)) {
      if (*ppcVar1 != *param_2) {
        FUN_0041b310();
        memcpy(*param_2,*ppcVar1,(size_t)param_1[4]);
        pcVar3 = param_1[4];
        param_2[1] = pcVar3;
        pcVar3[(int)*param_2] = '\0';
      }
      param_1[6] = param_1[6] + (int)param_1[4];
      param_1[4] = (char *)0x0;
      if (*ppcVar1 != (char *)0x0) {
        **ppcVar1 = '\0';
      }
      *(undefined *)(param_1 + 7) = 0;
    }
    else {
      pcVar6 = *ppcVar1;
      pcStack_30 = pcVar6;
      if (pcVar6 == (char *)0x0) {
        pcStack_30 = &DAT_0044d0d5;
      }
      pcStack_20 = (char *)0x0;
      if (pcStack_30 != (char *)0x0) {
        pcVar7 = pcStack_30;
        do {
          cVar2 = *pcVar7;
          pcVar6 = (char *)CONCAT31((int3)((uint)pcVar6 >> 8),cVar2);
          pcVar7 = pcVar7 + 1;
        } while (cVar2 != '\0');
        _Size = pcVar7 + -(int)(pcStack_30 + 1);
        if ((int)pcVar3 < (int)(pcVar7 + -(int)(pcStack_30 + 1))) {
          _Size = pcVar3;
        }
        if (_Size != (char *)0x0) {
          FUN_0041b310();
          memcpy((void *)0x0,pcStack_30,(size_t)_Size);
          *_Size = '\0';
          pcVar6 = extraout_ECX;
          pcStack_20 = _Size;
        }
      }
      local_4 = 1;
      if (*param_2 != (char *)0x0) {
        FUN_0041b310();
        memcpy(*param_2,(void *)0x0,(size_t)pcStack_20);
        pcVar6 = *param_2;
        param_2[1] = pcStack_20;
        pcStack_20[(int)pcVar6] = '\0';
      }
      local_4 = local_4 & 0xffffff00;
      ppcVar5 = (char **)FUN_0041ab60(pcVar6,(char *)0x7fffffff);
      local_4 = 2;
      if (*ppcVar5 != *ppcVar1) {
        FUN_0041b310();
        memcpy(*ppcVar1,*ppcVar5,(size_t)ppcVar5[1]);
        pcVar6 = ppcVar5[1];
        param_1[4] = pcVar6;
        (*ppcVar1)[(int)pcVar6] = '\0';
      }
      local_4 = local_4 & 0xffffff00;
      if (pvStack_18 != (void *)0x0) {
        free(pvStack_18);
      }
      param_1[6] = param_1[6] + (int)(pcVar3 + 1);
    }
    if (param_2[1] != (char *)0x0) {
      ExceptionList = local_c;
      return param_2;
    }
  }
  ExceptionList = local_c;
  return param_2;
}



undefined4 * FUN_0041ce60(undefined4 *param_1)

{
  void **ppvVar1;
  size_t sVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043864b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  ppvVar1 = (void **)(param_1 + 1);
  *param_1 = aIpAddr::vftable;
  *ppvVar1 = (void *)0x0;
  param_1[3] = 0;
  param_1[2] = 0;
  local_4 = 0;
  if (DAT_0044d228 == (void *)0x0) {
    param_1[4] = 0;
  }
  else {
    FUN_0041b310();
    memcpy(*ppvVar1,DAT_0044d228,DAT_0044d22c);
    sVar2 = DAT_0044d22c;
    param_1[2] = DAT_0044d22c;
    *(undefined *)(sVar2 + (int)*ppvVar1) = 0;
    param_1[4] = 0;
  }
  ExceptionList = local_c;
  return param_1;
}



void __fastcall FUN_0041cf00(undefined4 *param_1)

{
  *param_1 = aIpAddr::vftable;
  if ((void *)param_1[1] != (void *)0x0) {
    free((void *)param_1[1]);
  }
  return;
}



void FUN_0041cf20(void)

{
  undefined4 *unaff_ESI;
  
  FUN_0041b2a0(unaff_ESI,"%d.%d.%d.%d");
  return;
}



void __thiscall FUN_0041cf50(void *this,char *param_1,size_t param_2)

{
  int iVar1;
  char *name;
  hostent *phVar2;
  char **ppcVar3;
  undefined auStack_1ac [4];
  void *local_1a8;
  WSADATA local_1a4;
  uint local_14;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438608;
  local_c = ExceptionList;
  local_14 = DAT_0044a01c ^ (uint)auStack_1ac;
  ExceptionList = &local_c;
  local_4 = 0;
  local_1a8 = this;
  iVar1 = WSAStartup(2,&local_1a4);
  if (iVar1 == 0) {
    ppcVar3 = (char **)((int)this + 4);
    if (param_1 != *ppcVar3) {
      FUN_0041b310();
      memcpy(*ppcVar3,param_1,param_2);
      *(size_t *)((int)this + 8) = param_2;
      (*ppcVar3)[param_2] = '\0';
    }
    name = &DAT_0044d0d5;
    if (param_1 != (char *)0x0) {
      name = param_1;
    }
    phVar2 = gethostbyname(name);
    WSACleanup();
    if (phVar2 == (hostent *)0x0) {
      local_4 = 0xffffffff;
      if (param_1 != (char *)0x0) {
        free(param_1);
      }
    }
    else {
      *(char *)((int)local_1a8 + 0x10) = **phVar2->h_addr_list;
      *(char *)((int)local_1a8 + 0x11) = (*phVar2->h_addr_list)[1];
      *(char *)((int)local_1a8 + 0x12) = (*phVar2->h_addr_list)[2];
      *(char *)((int)local_1a8 + 0x13) = (*phVar2->h_addr_list)[3];
      local_4 = 0xffffffff;
      if (param_1 != (char *)0x0) {
        free(param_1);
      }
    }
  }
  else {
    local_4 = 0xffffffff;
    if (param_1 != (char *)0x0) {
      free(param_1);
    }
  }
  ExceptionList = local_c;
  ___security_check_cookie_4(local_14 ^ (uint)auStack_1ac);
  return;
}



void FUN_0041d0c0(void)

{
  undefined4 *puVar1;
  int unaff_ESI;
  
  if (*(char **)(unaff_ESI + 4) != "localhost") {
    FUN_0041b310();
    puVar1 = *(undefined4 **)(int *)(unaff_ESI + 4);
    *puVar1 = 0x61636f6c;
    puVar1[1] = 0x736f686c;
    *(undefined *)(puVar1 + 2) = 0x74;
    *(undefined4 *)(unaff_ESI + 8) = 9;
    *(undefined *)(*(int *)(unaff_ESI + 4) + 9) = 0;
    *(undefined *)(unaff_ESI + 0x11) = 0;
    *(undefined *)(unaff_ESI + 0x12) = 0;
    *(undefined *)(unaff_ESI + 0x10) = 0x7f;
    *(undefined *)(unaff_ESI + 0x13) = 1;
    return;
  }
  *(undefined *)(unaff_ESI + 0x11) = 0;
  *(undefined *)(unaff_ESI + 0x12) = 0;
  *(undefined *)(unaff_ESI + 0x10) = 0x7f;
  *(undefined *)(unaff_ESI + 0x13) = 1;
  return;
}



undefined4 FUN_0041d130(undefined4 *param_1)

{
  void *pvVar1;
  void **ppvVar2;
  int unaff_ESI;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_0043a178;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *(undefined4 *)(unaff_ESI + 0x10) = *param_1;
  ppvVar2 = (void **)FUN_0041b2a0(local_18,"%d.%d.%d.%d");
  local_4 = 0;
  if (*ppvVar2 != *(void **)(unaff_ESI + 4)) {
    FUN_0041b310();
    memcpy(*(void **)(unaff_ESI + 4),*ppvVar2,(size_t)ppvVar2[1]);
    pvVar1 = ppvVar2[1];
    *(void **)(unaff_ESI + 8) = pvVar1;
    *(undefined *)((int)*(void **)(unaff_ESI + 4) + (int)pvVar1) = 0;
  }
  local_4 = 0xffffffff;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  ExceptionList = local_c;
  return CONCAT31((int3)((uint)local_18[0] >> 8),1);
}



undefined4 * __thiscall FUN_0041d200(void *this,byte param_1)

{
  *(undefined ***)this = aSyncRefCounter::vftable;
  *(undefined ***)((int)this + 8) = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)((int)this + 0x14));
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_0041d230(undefined4 *param_1)

{
  *param_1 = aSyncRefCounter::vftable;
  param_1[2] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 5));
  return;
}



void __fastcall FUN_0041d250(int param_1)

{
  int *piVar1;
  DWORD DVar2;
  
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0xc) == DVar2) {
    *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x14));
    *(undefined4 *)(param_1 + 0x10) = 1;
    DVar2 = GetCurrentThreadId();
    *(DWORD *)(param_1 + 0xc) = DVar2;
  }
  *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + 1;
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0xc) == DVar2) {
    piVar1 = (int *)(param_1 + 0x10);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(param_1 + 0xc) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x14));
    }
  }
  return;
}



void __fastcall FUN_0041d2a0(undefined4 *param_1)

{
  int *piVar1;
  DWORD DVar2;
  
  DVar2 = GetCurrentThreadId();
  if (param_1[3] == DVar2) {
    param_1[4] = param_1[4] + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 5));
    param_1[4] = 1;
    DVar2 = GetCurrentThreadId();
    param_1[3] = DVar2;
  }
  piVar1 = param_1 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    DVar2 = GetCurrentThreadId();
    if (param_1[3] == DVar2) {
      piVar1 = param_1 + 4;
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        param_1[3] = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 5));
      }
    }
    (**(code **)*param_1)(1);
    return;
  }
  DVar2 = GetCurrentThreadId();
  if (param_1[3] == DVar2) {
    piVar1 = param_1 + 4;
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      param_1[3] = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 5));
    }
  }
  return;
}



void FUN_0041d320(void)

{
  undefined4 *unaff_EDI;
  
  *unaff_EDI = aThread::vftable;
  FUN_0041db50();
  unaff_EDI[2] = aCondition::vftable;
  *(undefined *)(unaff_EDI + 0xb) = 0;
  *unaff_EDI = aTimer::vftable;
  FUN_0041db50();
  unaff_EDI[0xf] = aCondition::vftable;
  *(undefined *)(unaff_EDI + 0x18) = 0;
  unaff_EDI[0x1a] = aCriticalSection::vftable;
  unaff_EDI[0x1b] = 0xffffffff;
  unaff_EDI[0x1c] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(unaff_EDI + 0x1d));
  return;
}



undefined4 * __thiscall FUN_0041d380(void *this,byte param_1)

{
  *(undefined ***)this = aTimer::vftable;
  *(undefined ***)((int)this + 0x68) = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)((int)this + 0x74));
  *(undefined ***)((int)this + 0x3c) = aSyncObj::vftable;
  *(undefined ***)((int)this + 0x44) = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  *(undefined ***)this = aThread::vftable;
  *(undefined ***)((int)this + 8) = aSyncObj::vftable;
  *(undefined ***)((int)this + 0x10) = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_0041d3f0(undefined4 *param_1)

{
  *param_1 = aTimer::vftable;
  param_1[0x1a] = aCriticalSection::vftable;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x1d));
  param_1[0xf] = aSyncObj::vftable;
  param_1[0x11] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  *param_1 = aThread::vftable;
  param_1[2] = aSyncObj::vftable;
  param_1[4] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  return;
}



undefined4 FUN_0041d440(void)

{
  undefined4 in_EAX;
  HANDLE pvVar1;
  LPVOID unaff_ESI;
  DWORD local_4;
  
  *(undefined4 *)((int)unaff_ESI + 0x9c) = in_EAX;
  *(undefined4 *)((int)unaff_ESI + 100) = 0;
  *(undefined4 *)((int)unaff_ESI + 0x98) = 0;
  *(undefined4 *)((int)unaff_ESI + 0x8c) = 0xffffffff;
  *(undefined4 *)((int)unaff_ESI + 0x94) = 0;
  *(undefined *)((int)unaff_ESI + 0x35) = 1;
  *(undefined4 *)((int)unaff_ESI + 0x30) = 0;
  *(undefined *)((int)unaff_ESI + 4) = 0;
  *(undefined *)((int)unaff_ESI + 0x34) = 0;
  FUN_0041c210();
  pvVar1 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,(LPTHREAD_START_ROUTINE)&LAB_0041c690,unaff_ESI
                        ,0,&local_4);
  *(HANDLE *)((int)unaff_ESI + 0x38) = pvVar1;
  return CONCAT31((int3)((uint)pvVar1 >> 8),1);
}



void __thiscall FUN_0041d4a0(void *this,undefined4 param_1)

{
  int *piVar1;
  DWORD DVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439178;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)((int)this + 0x6c) == DVar2) {
    *(int *)((int)this + 0x70) = *(int *)((int)this + 0x70) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x74));
    *(undefined4 *)((int)this + 0x70) = 1;
    DVar2 = GetCurrentThreadId();
    *(DWORD *)((int)this + 0x6c) = DVar2;
  }
  local_4 = 0;
  *(undefined4 *)((int)this + 0x8c) = param_1;
  *(undefined *)((int)this + 0x90) = 0;
  *(undefined4 *)((int)this + 100) = 1;
  FUN_0041c280();
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)((int)this + 0x6c) == DVar2) {
    piVar1 = (int *)((int)this + 0x70);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)((int)this + 0x6c) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x74));
    }
  }
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0041d550(int param_1)

{
  int *piVar1;
  DWORD DVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439178;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0x6c) == DVar2) {
    *(int *)(param_1 + 0x70) = *(int *)(param_1 + 0x70) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x74));
    *(undefined4 *)(param_1 + 0x70) = 1;
    DVar2 = GetCurrentThreadId();
    *(DWORD *)(param_1 + 0x6c) = DVar2;
  }
  local_4 = 0;
  *(undefined4 *)(param_1 + 0x8c) = 0xffffffff;
  *(undefined4 *)(param_1 + 100) = 0;
  *(undefined *)(param_1 + 0x90) = 0;
  FUN_0041c280();
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0x6c) == DVar2) {
    piVar1 = (int *)(param_1 + 0x70);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(param_1 + 0x6c) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x74));
    }
  }
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_0041d600(int param_1)

{
  int *piVar1;
  int iVar2;
  char cVar3;
  DWORD DVar4;
  undefined4 unaff_EDI;
  
  cVar3 = *(char *)(param_1 + 4);
  do {
    if (cVar3 != '\0') {
      return;
    }
    cVar3 = (**(code **)(*(int *)(param_1 + 0x3c) + 0x10))(*(undefined4 *)(param_1 + 0x8c));
    if ((cVar3 == '\0') && (*(int *)(param_1 + 100) == 1)) {
      DVar4 = GetCurrentThreadId();
      if (*(DWORD *)(param_1 + 0x6c) == DVar4) {
        *(int *)(param_1 + 0x70) = *(int *)(param_1 + 0x70) + 1;
      }
      else {
        EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x74));
        *(undefined4 *)(param_1 + 0x70) = 1;
        DVar4 = GetCurrentThreadId();
        *(DWORD *)(param_1 + 0x6c) = DVar4;
      }
      *(undefined4 *)(param_1 + 100) = 2;
      DVar4 = GetCurrentThreadId();
      if (*(DWORD *)(param_1 + 0x6c) == DVar4) {
        piVar1 = (int *)(param_1 + 0x70);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 == 0) {
          *(undefined4 *)(param_1 + 0x6c) = 0xffffffff;
          LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x74));
        }
      }
    }
    if (*(int *)(param_1 + 100) == 1) {
      DVar4 = GetCurrentThreadId();
      if (*(DWORD *)(param_1 + 0x6c) == DVar4) {
        *(int *)(param_1 + 0x70) = *(int *)(param_1 + 0x70) + 1;
      }
      else {
        EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x74));
        *(undefined4 *)(param_1 + 0x70) = 1;
        DVar4 = GetCurrentThreadId();
        *(DWORD *)(param_1 + 0x6c) = DVar4;
      }
      *(undefined4 *)(param_1 + 100) = 2;
      DVar4 = GetCurrentThreadId();
      if (*(DWORD *)(param_1 + 0x6c) == DVar4) {
        piVar1 = (int *)(param_1 + 0x70);
        *piVar1 = *piVar1 + -1;
        iVar2 = *piVar1;
joined_r0x0041d71e:
        if (iVar2 == 0) {
          *(undefined4 *)(param_1 + 0x6c) = 0xffffffff;
          LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x74));
        }
      }
    }
    else if (*(int *)(param_1 + 100) == 2) {
      if (*(undefined4 **)(param_1 + 0x9c) == (undefined4 *)0x0) {
        FUN_0041a1d0("aTimer: There is no event handler installed.",(char)unaff_EDI);
      }
      else {
        (**(code **)**(undefined4 **)(param_1 + 0x9c))(*(undefined4 *)(param_1 + 0x98));
      }
      DVar4 = GetCurrentThreadId();
      if (*(DWORD *)(param_1 + 0x6c) == DVar4) {
        *(int *)(param_1 + 0x70) = *(int *)(param_1 + 0x70) + 1;
      }
      else {
        EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x74));
        *(undefined4 *)(param_1 + 0x70) = 1;
        DVar4 = GetCurrentThreadId();
        *(DWORD *)(param_1 + 0x6c) = DVar4;
      }
      if ((*(char *)(param_1 + 0x90) == '\0') && (*(int *)(param_1 + 100) == 2)) {
        *(undefined4 *)(param_1 + 100) = 0;
      }
      DVar4 = GetCurrentThreadId();
      if (*(DWORD *)(param_1 + 0x6c) == DVar4) {
        piVar1 = (int *)(param_1 + 0x70);
        *piVar1 = *piVar1 + -1;
        iVar2 = *piVar1;
        goto joined_r0x0041d71e;
      }
    }
    cVar3 = *(char *)(param_1 + 4);
  } while( true );
}



void __fastcall FUN_0041d750(int param_1)

{
  int *piVar1;
  DWORD DVar2;
  
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0x6c) == DVar2) {
    *(int *)(param_1 + 0x70) = *(int *)(param_1 + 0x70) + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x74));
    *(undefined4 *)(param_1 + 0x70) = 1;
    DVar2 = GetCurrentThreadId();
    *(DWORD *)(param_1 + 0x6c) = DVar2;
  }
  *(undefined4 *)(param_1 + 100) = 0;
  FUN_0041c150();
  DVar2 = GetCurrentThreadId();
  if (*(DWORD *)(param_1 + 0x6c) == DVar2) {
    piVar1 = (int *)(param_1 + 0x70);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      *(undefined4 *)(param_1 + 0x6c) = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x74));
    }
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool __fastcall FUN_0041d7b0(int param_1)

{
  int iVar1;
  DWORD DVar2;
  
  DVar2 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar2) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  iVar1 = *(int *)(param_1 + 0x24);
  DVar2 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar2) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  return 0 < iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool __fastcall FUN_0041d820(int *param_1,undefined param_2,undefined4 param_3)

{
  bool bVar1;
  DWORD DVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439178;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  DVar2 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar2) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  local_4 = 0;
  if (param_1[9] != 0) {
    param_1[9] = param_1[9] + -1;
    DVar2 = GetCurrentThreadId();
    if ((DAT_0044b588 == DVar2) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
      DAT_0044b588 = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    }
    ExceptionList = local_c;
    return true;
  }
  bVar1 = FUN_0041dc30(param_1);
  DVar2 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar2) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  ExceptionList = local_c;
  return bVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint __thiscall FUN_0041d930(void *this,int *param_1)

{
  int *piVar1;
  DWORD DVar2;
  uint uVar3;
  uint extraout_EAX;
  undefined4 uVar4;
  DWORD extraout_EAX_00;
  int **ppiVar5;
  int *piVar6;
  int **ppiVar7;
  void *local_14;
  undefined *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_004385e0;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  DVar2 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar2) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  local_c = 1;
  if (param_1 != (int *)0x0) {
    *param_1 = *(int *)((int)this + 0x24);
  }
  if ((*(int *)((int)this + 0x28) != 0) &&
     (*(int *)((int)this + 0x24) == *(int *)((int)this + 0x28))) {
    FUN_00411a00();
    uVar3 = GetCurrentThreadId();
    if ((DAT_0044b588 == uVar3) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
      DAT_0044b588 = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
      uVar3 = extraout_EAX;
    }
    ExceptionList = local_14;
    return uVar3 & 0xffffff00;
  }
  *(int *)((int)this + 0x24) = *(int *)((int)this + 0x24) + 1;
  ppiVar7 = (int **)((int)this + 0xc);
  piVar1 = (int *)0x0;
  if (*(int *)((int)this + 0x14) != 0) {
    uVar3 = 0;
    if (*(uint *)((int)this + 0x10) != 0) {
      ppiVar5 = (int **)*ppiVar7;
      do {
        piVar1 = *ppiVar5;
        if (piVar1 != (int *)0x0) break;
        uVar3 = uVar3 + 1;
        ppiVar5 = ppiVar5 + 1;
      } while (uVar3 < *(uint *)((int)this + 0x10));
    }
  }
  do {
    piVar6 = piVar1;
    if ((ppiVar7 == (int **)0x0) || (piVar6 == (int *)0x0)) goto LAB_0041da90;
    uVar4 = FUN_0041e620(piVar6[3]);
    if ((char)uVar4 != '\0') {
      FUN_0041e760((int *)this);
LAB_0041da90:
      DVar2 = GetCurrentThreadId();
      if ((DAT_0044b588 == DVar2) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
        DAT_0044b588 = 0xffffffff;
        LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
        DVar2 = extraout_EAX_00;
      }
      ExceptionList = local_14;
      return CONCAT31((int3)(DVar2 >> 8),1);
    }
    piVar1 = (int *)*piVar6;
    if (piVar1 == (int *)0x0) {
      uVar3 = piVar6[1] + 1;
      if (uVar3 < *(uint *)((int)this + 0x10)) {
        ppiVar5 = (int **)(*ppiVar7 + uVar3);
        do {
          piVar1 = *ppiVar5;
          if (piVar1 != (int *)0x0) break;
          uVar3 = uVar3 + 1;
          ppiVar5 = ppiVar5 + 1;
        } while (uVar3 < *(uint *)((int)this + 0x10));
      }
    }
  } while( true );
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __fastcall FUN_0041dae0(int param_1)

{
  DWORD DVar1;
  
  DVar1 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar1) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  *(int *)(param_1 + 0x24) = *(int *)(param_1 + 0x24) + -1;
  DVar1 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar1) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_0041db50(void)

{
  DWORD DVar1;
  undefined4 *unaff_ESI;
  
  *unaff_ESI = aSyncObj::vftable;
  unaff_ESI[2] = aMap<int,class_aLocker*>::vftable;
  unaff_ESI[3] = 0;
  unaff_ESI[4] = 0x11;
  unaff_ESI[5] = 0;
  unaff_ESI[6] = 0;
  unaff_ESI[7] = 0;
  unaff_ESI[8] = 10;
  DVar1 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar1) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  DAT_0044d0e4 = DAT_0044d0e4 + 1;
  unaff_ESI[1] = DAT_0044d0e4;
  DVar1 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar1) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  return;
}



void FUN_0041dbf0(undefined4 param_1)

{
  FUN_00406020();
  return;
}



void FUN_0041dc10(int param_1)

{
  int *piVar1;
  
  piVar1 = FUN_00406140(*(uint *)(param_1 + 4));
  *piVar1 = param_1;
  return;
}



bool __fastcall FUN_0041dc30(int *param_1)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  DWORD DVar3;
  HANDLE pvVar4;
  undefined4 *puVar5;
  int iVar6;
  DWORD unaff_retaddr;
  
  puVar2 = (undefined4 *)operator_new(0x24);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    DVar3 = GetCurrentThreadId();
    *puVar2 = aLocker::vftable;
    pvVar4 = CreateSemaphoreA((LPSECURITY_ATTRIBUTES)0x0,0,1,(LPCSTR)0x0);
    puVar2[2] = pvVar4;
    *(undefined *)(puVar2 + 3) = 1;
    puVar2[5] = 0;
    puVar2[6] = 0;
    puVar2[7] = 0;
    puVar2[1] = DVar3;
    *(undefined *)(puVar2 + 8) = 1;
  }
  (**(code **)(*param_1 + 0x18))(puVar2);
  uVar1 = puVar2[7];
  puVar5 = (undefined4 *)operator_new(0xc);
  puVar5[1] = uVar1;
  *puVar5 = 0;
  puVar5[2] = param_1;
  if ((undefined4 *)puVar2[7] == (undefined4 *)0x0) {
    puVar2[6] = puVar5;
  }
  else {
    *(undefined4 *)puVar2[7] = puVar5;
  }
  puVar2[5] = puVar2[5] + 1;
  puVar2[7] = puVar5;
  iVar6 = FUN_0041e880(unaff_retaddr);
  if (puVar2 != (undefined4 *)0x0) {
    (**(code **)*puVar2)(1);
  }
  return -1 < iVar6;
}



undefined4 * __thiscall FUN_0041dcf0(void *this,byte param_1)

{
  *(undefined ***)this = aMultiLock::vftable;
  if (*(void **)((int)this + 4) != (void *)0x0) {
    operator_delete__(*(void **)((int)this + 4));
  }
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_0041dd20(undefined4 *param_1)

{
  *param_1 = aMultiLock::vftable;
  if ((void *)param_1[1] != (void *)0x0) {
    operator_delete__((void *)param_1[1]);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int __fastcall FUN_0041dd40(int param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  uint uVar3;
  DWORD DVar4;
  int iVar5;
  void *pvVar6;
  undefined4 *puVar7;
  int iVar8;
  int iVar9;
  int *piVar10;
  code *pcVar11;
  undefined4 *puVar12;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  pcVar11 = GetCurrentThreadId_exref;
  local_4 = 0xffffffff;
  puStack_8 = &LAB_004385a8;
  local_c = ExceptionList;
  uVar3 = DAT_0044a01c ^ (uint)&stack0xffffffdc;
  ExceptionList = &local_c;
  DVar4 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar4) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  puVar12 = (undefined4 *)0x0;
  local_4 = 0;
  iVar5 = FUN_0041dec0();
  if (iVar5 < 0) {
    pvVar6 = operator_new(0x24);
    if (pvVar6 != (void *)0x0) {
      DVar4 = GetCurrentThreadId();
      puVar12 = (undefined4 *)FUN_0041e4e0(DVar4);
    }
    iVar5 = 0;
    *(undefined *)(puVar12 + 8) = *(undefined *)(param_1 + 0xc);
    if (0 < *(int *)(param_1 + 8)) {
      do {
        uVar1 = puVar12[7];
        uVar2 = *(undefined4 *)(*(int *)(param_1 + 4) + iVar5 * 4);
        puVar7 = (undefined4 *)operator_new(0xc);
        puVar7[1] = uVar1;
        *puVar7 = 0;
        puVar7[2] = uVar2;
        if ((undefined4 *)puVar12[7] == (undefined4 *)0x0) {
          puVar12[6] = puVar7;
        }
        else {
          *(undefined4 *)puVar12[7] = puVar7;
        }
        puVar12[5] = puVar12[5] + 1;
        puVar12[7] = puVar7;
        (**(code **)(**(int **)(*(int *)(param_1 + 4) + iVar5 * 4) + 0x18))(puVar12);
        iVar5 = iVar5 + 1;
        pcVar11 = GetCurrentThreadId_exref;
      } while (iVar5 < *(int *)(param_1 + 8));
    }
    iVar8 = FUN_0041e880(0xffffffff);
    (**(code **)*puVar12)(1);
    iVar5 = iVar8;
    if (-1 < iVar8) {
      iVar9 = 0;
      if (0 < *(int *)(param_1 + 8)) {
        piVar10 = *(int **)(param_1 + 4);
        do {
          iVar5 = iVar9;
          if (*(int *)(*piVar10 + 4) == iVar8) break;
          iVar9 = iVar9 + 1;
          piVar10 = piVar10 + 1;
          iVar5 = iVar8;
        } while (iVar9 < *(int *)(param_1 + 8));
      }
    }
  }
  DVar4 = (*pcVar11)(uVar3);
  if ((DAT_0044b588 == DVar4) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  ExceptionList = local_c;
  return iVar5;
}



int FUN_0041dec0(void)

{
  char cVar1;
  int unaff_ESI;
  int iVar2;
  
  if (*(char *)(unaff_ESI + 0xc) != '\0') {
    if (0 < *(int *)(unaff_ESI + 8)) {
      iVar2 = 0;
      do {
        cVar1 = (**(code **)(**(int **)(*(int *)(unaff_ESI + 4) + iVar2 * 4) + 4))();
        if (cVar1 == '\0') {
          return -1;
        }
        iVar2 = iVar2 + 1;
      } while (iVar2 < *(int *)(unaff_ESI + 8));
    }
    iVar2 = 0;
    if (0 < *(int *)(unaff_ESI + 8)) {
      do {
        (**(code **)(**(int **)(*(int *)(unaff_ESI + 4) + iVar2 * 4) + 0xc))();
        iVar2 = iVar2 + 1;
      } while (iVar2 < *(int *)(unaff_ESI + 8));
    }
    return 0;
  }
  if (0 < *(int *)(unaff_ESI + 8)) {
    iVar2 = 0;
    do {
      cVar1 = (**(code **)(**(int **)(*(int *)(unaff_ESI + 4) + iVar2 * 4) + 4))();
      if (cVar1 != '\0') {
        (**(code **)(**(int **)(*(int *)(unaff_ESI + 4) + iVar2 * 4) + 0xc))();
        return iVar2;
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < *(int *)(unaff_ESI + 8));
  }
  return -1;
}



undefined4 * __thiscall FUN_0041df40(void *this,byte param_1)

{
  *(undefined ***)this = aMemFile::vftable;
  if ((*(void **)((int)this + 4) != (void *)0x0) && (*(char *)((int)this + 0x10) != '\0')) {
    operator_delete(*(void **)((int)this + 4));
    *(undefined4 *)((int)this + 4) = 0;
  }
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



uint __thiscall FUN_0041df80(void *this,void *param_1,uint param_2,uint param_3)

{
  int iVar1;
  uint uVar2;
  
  iVar1 = *(int *)((int)this + 8);
  uVar2 = *(uint *)((int)this + 0xc);
  if ((int)uVar2 <= iVar1) {
    return 0;
  }
  if (uVar2 < param_2 * param_3 + iVar1) {
    param_3 = ((uVar2 - iVar1) - 1) / param_2;
  }
  memcpy(param_1,(void *)(*(int *)((int)this + 4) + iVar1),param_3 * param_2);
  *(int *)((int)this + 8) = *(int *)((int)this + 8) + param_3 * param_2;
  return param_3;
}



uint __thiscall FUN_0041dfe0(void *this,void *param_1,uint param_2,uint param_3)

{
  int iVar1;
  
  iVar1 = *(int *)((int)this + 8);
  if (*(uint *)((int)this + 0xc) <= param_2 * param_3 + iVar1) {
    param_3 = ((*(uint *)((int)this + 0xc) - iVar1) - 1) / param_2;
  }
  memcpy((void *)(*(int *)((int)this + 4) + iVar1),param_1,param_3 * param_2);
  *(int *)((int)this + 8) = *(int *)((int)this + 8) + param_3 * param_2;
  return param_3;
}



undefined4 __thiscall FUN_0041e030(void *this,int param_1,undefined4 param_2,int param_3)

{
  int iVar1;
  
  if (param_3 != 0) {
    if (param_3 == 1) {
      param_1 = *(int *)((int)this + 8) + param_1;
    }
    else {
      iVar1 = 0;
      if (param_3 != 2) goto LAB_0041e05e;
      param_1 = *(int *)((int)this + 0xc) - param_1;
    }
  }
  iVar1 = param_1;
  if (param_1 < 0) {
    return 1;
  }
LAB_0041e05e:
  if (*(int *)((int)this + 0xc) < iVar1) {
    return 1;
  }
  *(int *)((int)this + 8) = iVar1;
  return 0;
}



void FUN_0041e080(void)

{
  return;
}



undefined4 * __thiscall FUN_0041e130(void *this,undefined4 *param_1,void **param_2)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438683;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = 0;
  param_1[2] = 0;
  param_1[1] = 0;
  param_1[3] = 0;
  param_1[5] = 0;
  param_1[4] = 0;
  local_4 = 1;
  FUN_0041e1a0((void **)this,param_2);
  ExceptionList = local_c;
  return param_1;
}



void FUN_0041e1a0(void **param_1,void **param_2)

{
  void *pvVar1;
  void **unaff_ESI;
  
  if (*param_2 != *unaff_ESI) {
    FUN_0041b310();
    memcpy(*unaff_ESI,*param_2,(size_t)param_2[1]);
    pvVar1 = param_2[1];
    unaff_ESI[1] = pvVar1;
    *(undefined *)((int)*unaff_ESI + (int)pvVar1) = 0;
  }
  *(undefined *)((int)unaff_ESI + 0x1d) = 1;
  if (*param_1 != unaff_ESI[3]) {
    FUN_0041b310();
    memcpy(unaff_ESI[3],*param_1,(size_t)param_1[1]);
    pvVar1 = param_1[1];
    unaff_ESI[4] = pvVar1;
    *(undefined *)((int)unaff_ESI[3] + (int)pvVar1) = 0;
  }
  unaff_ESI[6] = (void *)0x0;
  *(bool *)(unaff_ESI + 7) = unaff_ESI[4] != (void *)0x0;
  return;
}



// WARNING: Removing unreachable block (ram,0x0041e3d7)

char ** FUN_0041e230(char **param_1,char **param_2)

{
  char **ppcVar1;
  char cVar2;
  char *pcVar3;
  size_t sVar4;
  char **ppcVar5;
  char *pcVar6;
  char *extraout_ECX;
  char *pcVar7;
  char *_Size;
  char *pcStack_30;
  char *pcStack_20;
  void *pvStack_18;
  void *local_c;
  undefined *puStack_8;
  uint local_4;
  
  puStack_8 = &LAB_004391c9;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_2 = (char *)0x0;
  param_2[2] = (char *)0x0;
  param_2[1] = (char *)0x0;
  local_4 = 0;
  ppcVar1 = param_1 + 3;
  while( true ) {
    pcVar3 = *param_1;
    if (pcVar3 == (char *)0x0) {
      pcVar3 = &DAT_0044d0d5;
    }
    if ((((int)param_1[4] < 1) || (sVar4 = strspn(*ppcVar1,pcVar3), (int)param_1[4] <= (int)sVar4))
       || (sVar4 == 0xffffffff)) {
      ExceptionList = local_c;
      return param_2;
    }
    pcVar3 = *param_1;
    if (pcVar3 == (char *)0x0) {
      pcVar3 = &DAT_0044d0d5;
    }
    if ((((int)param_1[4] < 1) || (pcVar3 = strpbrk(*ppcVar1,pcVar3), pcVar3 == (char *)0x0)) ||
       (pcVar3 = pcVar3 + -(int)*ppcVar1, pcVar3 == (char *)0xffffffff)) {
      if (*ppcVar1 != *param_2) {
        FUN_0041b310();
        memcpy(*param_2,*ppcVar1,(size_t)param_1[4]);
        pcVar3 = param_1[4];
        param_2[1] = pcVar3;
        pcVar3[(int)*param_2] = '\0';
      }
      param_1[6] = param_1[6] + (int)param_1[4];
      param_1[4] = (char *)0x0;
      if (*ppcVar1 != (char *)0x0) {
        **ppcVar1 = '\0';
      }
      *(undefined *)(param_1 + 7) = 0;
    }
    else {
      pcVar6 = *ppcVar1;
      pcStack_30 = pcVar6;
      if (pcVar6 == (char *)0x0) {
        pcStack_30 = &DAT_0044d0d5;
      }
      pcStack_20 = (char *)0x0;
      if (pcStack_30 != (char *)0x0) {
        pcVar7 = pcStack_30;
        do {
          cVar2 = *pcVar7;
          pcVar6 = (char *)CONCAT31((int3)((uint)pcVar6 >> 8),cVar2);
          pcVar7 = pcVar7 + 1;
        } while (cVar2 != '\0');
        _Size = pcVar7 + -(int)(pcStack_30 + 1);
        if ((int)pcVar3 < (int)(pcVar7 + -(int)(pcStack_30 + 1))) {
          _Size = pcVar3;
        }
        if (_Size != (char *)0x0) {
          FUN_0041b310();
          memcpy((void *)0x0,pcStack_30,(size_t)_Size);
          *_Size = '\0';
          pcVar6 = extraout_ECX;
          pcStack_20 = _Size;
        }
      }
      local_4 = 1;
      if (*param_2 != (char *)0x0) {
        FUN_0041b310();
        memcpy(*param_2,(void *)0x0,(size_t)pcStack_20);
        pcVar6 = *param_2;
        param_2[1] = pcStack_20;
        pcStack_20[(int)pcVar6] = '\0';
      }
      local_4 = local_4 & 0xffffff00;
      ppcVar5 = (char **)FUN_0041ab60(pcVar6,(char *)0x7fffffff);
      local_4 = 2;
      if (*ppcVar5 != *ppcVar1) {
        FUN_0041b310();
        memcpy(*ppcVar1,*ppcVar5,(size_t)ppcVar5[1]);
        pcVar6 = ppcVar5[1];
        param_1[4] = pcVar6;
        (*ppcVar1)[(int)pcVar6] = '\0';
      }
      local_4 = local_4 & 0xffffff00;
      if (pvStack_18 != (void *)0x0) {
        free(pvStack_18);
      }
      param_1[6] = param_1[6] + (int)(pcVar3 + 1);
    }
    if (param_2[1] != (char *)0x0) break;
    if (*(char *)((int)param_1 + 0x1d) != '\0') {
      ExceptionList = local_c;
      return param_2;
    }
  }
  ExceptionList = local_c;
  return param_2;
}



void FUN_0041e480(void)

{
  undefined4 *unaff_ESI;
  
  FUN_0041b2a0(unaff_ESI,"%.4d-%.2d-%.2d");
  return;
}



void FUN_0041e4b0(void)

{
  undefined4 *unaff_ESI;
  
  FUN_0041b2a0(unaff_ESI,"%.2d:%.2d:%.2d");
  return;
}



void FUN_0041e4e0(undefined4 param_1)

{
  HANDLE pvVar1;
  undefined4 *unaff_ESI;
  
  *unaff_ESI = aLocker::vftable;
  pvVar1 = CreateSemaphoreA((LPSECURITY_ATTRIBUTES)0x0,0,1,(LPCSTR)0x0);
  unaff_ESI[2] = pvVar1;
  *(undefined *)(unaff_ESI + 3) = 1;
  unaff_ESI[5] = 0;
  unaff_ESI[6] = 0;
  unaff_ESI[7] = 0;
  unaff_ESI[1] = param_1;
  *(undefined *)(unaff_ESI + 8) = 1;
  return;
}



undefined4 * __thiscall FUN_0041e520(void *this,byte param_1)

{
  FUN_0041e540((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_0041e540(undefined4 *param_1)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  int **ppiVar5;
  
  piVar1 = param_1 + 5;
  iVar2 = *piVar1;
  *param_1 = aLocker::vftable;
  while (iVar2 != 0) {
    ppiVar5 = (int **)FUN_0040e220((int)piVar1);
    piVar3 = *ppiVar5;
    if (1 < *piVar1) {
      if (piVar3 == (int *)param_1[6]) {
        iVar2 = *(int *)param_1[6];
        param_1[6] = iVar2;
        *(undefined4 *)(iVar2 + 4) = 0;
      }
      else if (piVar3 == (int *)param_1[7]) {
        puVar4 = (undefined4 *)((int *)param_1[7])[1];
        param_1[7] = puVar4;
        *puVar4 = 0;
      }
      else {
        *(int *)piVar3[1] = *piVar3;
        *(int *)(*piVar3 + 4) = piVar3[1];
      }
    }
    operator_delete(piVar3);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      param_1[7] = 0;
      param_1[6] = 0;
    }
    iVar2 = *piVar1;
  }
  if (1 < *piVar1) {
    for (puVar4 = *(undefined4 **)param_1[6]; puVar4 != (undefined4 *)0x0;
        puVar4 = (undefined4 *)*puVar4) {
      operator_delete((void *)puVar4[1]);
    }
    operator_delete((void *)param_1[7]);
    CloseHandle((HANDLE)param_1[2]);
    return;
  }
  if (*piVar1 != 0) {
    operator_delete((void *)param_1[7]);
  }
  CloseHandle((HANDLE)param_1[2]);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 __fastcall FUN_0041e620(int param_1)

{
  char cVar1;
  uint uVar2;
  DWORD DVar3;
  undefined4 *puVar4;
  DWORD extraout_EAX;
  uint extraout_EAX_00;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438578;
  local_c = ExceptionList;
  uVar2 = DAT_0044a01c ^ (uint)&stack0xffffffe0;
  ExceptionList = &local_c;
  DVar3 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar3) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  local_4 = 0;
  puVar4 = (undefined4 *)FUN_0040e220(param_1 + 0x14);
  puVar4 = (undefined4 *)*puVar4;
  if (*(char *)(param_1 + 0x20) != '\0') {
    do {
      if (puVar4 == (undefined4 *)0x0) {
LAB_0041e6c4:
        DVar3 = GetCurrentThreadId();
        if ((DAT_0044b588 == DVar3) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
          DAT_0044b588 = 0xffffffff;
          LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
          DVar3 = extraout_EAX;
        }
        ExceptionList = local_c;
        return CONCAT31((int3)(DVar3 >> 8),1);
      }
      cVar1 = (**(code **)(*(int *)puVar4[2] + 4))();
      if (cVar1 == '\0') goto LAB_0041e718;
      puVar4 = (undefined4 *)*puVar4;
    } while( true );
  }
  for (; puVar4 != (undefined4 *)0x0; puVar4 = (undefined4 *)*puVar4) {
    cVar1 = (**(code **)(*(int *)puVar4[2] + 4))(uVar2);
    if (cVar1 != '\0') goto LAB_0041e6c4;
  }
LAB_0041e718:
  uVar2 = GetCurrentThreadId();
  if ((DAT_0044b588 == uVar2) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    uVar2 = extraout_EAX_00;
  }
  ExceptionList = local_c;
  return uVar2 & 0xffffff00;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __fastcall FUN_0041e760(int *param_1)

{
  uint uVar1;
  DWORD DVar2;
  undefined4 *puVar3;
  int unaff_EDI;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00438548;
  local_c = ExceptionList;
  uVar1 = DAT_0044a01c ^ (uint)&stack0xffffffe0;
  ExceptionList = &local_c;
  DVar2 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar2) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  local_4 = 0;
  if (*(char *)(unaff_EDI + 0x20) == '\0') {
    *(int *)(unaff_EDI + 0x10) = param_1[1];
    (**(code **)(*param_1 + 0xc))(uVar1);
  }
  else {
    *(undefined4 *)(unaff_EDI + 0x10) = 0;
    puVar3 = (undefined4 *)FUN_0040e220(unaff_EDI + 0x14);
    for (puVar3 = (undefined4 *)*puVar3; puVar3 != (undefined4 *)0x0; puVar3 = (undefined4 *)*puVar3
        ) {
      (**(code **)(*(int *)puVar3[2] + 0xc))();
    }
  }
  puVar3 = (undefined4 *)FUN_0040e220(unaff_EDI + 0x14);
  for (puVar3 = (undefined4 *)*puVar3; puVar3 != (undefined4 *)0x0; puVar3 = (undefined4 *)*puVar3)
  {
    (**(code **)(*(int *)puVar3[2] + 0x14))();
  }
  ReleaseSemaphore(*(HANDLE *)(unaff_EDI + 8),1,(LPLONG)0x0);
  DVar2 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar2) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  ExceptionList = local_c;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_0041e880(DWORD param_1)

{
  DWORD DVar1;
  undefined4 *puVar2;
  int unaff_EDI;
  HANDLE hHandle;
  
  *(undefined4 *)(unaff_EDI + 0x10) = 0xffffffff;
  DVar1 = GetCurrentThreadId();
  if ((DAT_0044b588 == DVar1) && (_DAT_0044b58c = _DAT_0044b58c + -1, _DAT_0044b58c == 0)) {
    DAT_0044b588 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
  }
  if ((int)param_1 < 0) {
    hHandle = *(HANDLE *)(unaff_EDI + 8);
    param_1 = 0xffffffff;
  }
  else {
    hHandle = *(HANDLE *)(unaff_EDI + 8);
  }
  WaitForSingleObject(hHandle,param_1);
  DVar1 = GetCurrentThreadId();
  if (DAT_0044b588 == DVar1) {
    _DAT_0044b58c = _DAT_0044b58c + 1;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0044b590);
    _DAT_0044b58c = 1;
    DAT_0044b588 = GetCurrentThreadId();
  }
  puVar2 = (undefined4 *)FUN_0040e220(unaff_EDI + 0x14);
  for (puVar2 = (undefined4 *)*puVar2; puVar2 != (undefined4 *)0x0; puVar2 = (undefined4 *)*puVar2)
  {
    (**(code **)(*(int *)puVar2[2] + 0x14))();
  }
  return *(undefined4 *)(unaff_EDI + 0x10);
}



undefined4 * FUN_0041e930(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00439afe;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = aThread::vftable;
  FUN_0041db50();
  param_1[2] = aCondition::vftable;
  *(undefined *)(param_1 + 0xb) = 0;
  local_4 = 0;
  *param_1 = CConfigurationServer::vftable;
  FUN_0041ce60(param_1 + 0x10);
  param_1[0x17] = 0;
  param_1[0x19] = 0;
  param_1[0x18] = 0;
  param_1[0x1a] = 0;
  param_1[0x1c] = 0;
  param_1[0x1b] = 0;
  param_1[0x1d] = 0;
  param_1[0x1f] = 0;
  param_1[0x1e] = 0;
  param_1[0x20] = 0;
  param_1[0x22] = 0;
  param_1[0x21] = 0;
  param_1[0x23] = 0;
  param_1[0x25] = 0;
  param_1[0x24] = 0;
  local_4._0_1_ = 6;
  FUN_00436ea0(param_1 + 0x26);
  local_4 = CONCAT31(local_4._1_3_,7);
  FUN_00436ea0(param_1 + 0x2e);
  param_1[0x36] = aMap<class_aString,class_CConfigurationEntry*>::vftable;
  param_1[0x37] = 0;
  param_1[0x38] = 0x11;
  param_1[0x39] = 0;
  param_1[0x3a] = 0;
  param_1[0x3b] = 0;
  param_1[0x3c] = 10;
  param_1[0x3e] = CSysInfo::vftable;
  param_1[0x3f] = 0;
  param_1[0x41] = 0;
  param_1[0x40] = 0;
  param_1[0x43] = 0;
  param_1[0x45] = 0;
  param_1[0x44] = 0;
  param_1[0x46] = 0;
  param_1[0x48] = 0;
  param_1[0x47] = 0;
  param_1[0xf] = 0xffffffff;
  param_1[0x15] = 0xffffffff;
  param_1[0x3d] = 0;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_0041ea80(void *this,byte param_1)

{
  FUN_0041eaa0((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_0041eaa0(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439a7a;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = CConfigurationServer::vftable;
  local_4 = 9;
  FUN_00422370(param_1 + 0x3e);
  local_4._0_1_ = 8;
  param_1[0x36] = aMap<class_aString,class_CConfigurationEntry*>::vftable;
  FUN_00422000();
  local_4._0_1_ = 7;
  FUN_00436f20(param_1 + 0x2e);
  local_4._0_1_ = 6;
  FUN_00436f20(param_1 + 0x26);
  local_4._0_1_ = 5;
  if ((void *)param_1[0x23] != (void *)0x0) {
    free((void *)param_1[0x23]);
  }
  local_4._0_1_ = 4;
  if ((void *)param_1[0x20] != (void *)0x0) {
    free((void *)param_1[0x20]);
  }
  local_4._0_1_ = 3;
  if ((void *)param_1[0x1d] != (void *)0x0) {
    free((void *)param_1[0x1d]);
  }
  local_4._0_1_ = 2;
  if ((void *)param_1[0x1a] != (void *)0x0) {
    free((void *)param_1[0x1a]);
  }
  local_4._0_1_ = 1;
  if ((void *)param_1[0x17] != (void *)0x0) {
    free((void *)param_1[0x17]);
  }
  local_4 = (uint)local_4._1_3_ << 8;
  param_1[0x10] = aIpAddr::vftable;
  if ((void *)param_1[0x11] != (void *)0x0) {
    free((void *)param_1[0x11]);
  }
  *param_1 = aThread::vftable;
  param_1[2] = aSyncObj::vftable;
  param_1[4] = aMap<int,class_aLocker*>::vftable;
  FUN_00406070();
  ExceptionList = local_c;
  return;
}



uint FUN_0041ebd0(int param_1,void *param_2,size_t param_3,undefined4 param_4,void *param_5,
                 size_t param_6,undefined4 param_7,undefined1 *param_8,size_t param_9)

{
  void *pvVar1;
  size_t sVar2;
  void *_Src;
  undefined1 *_Memory;
  char cVar3;
  undefined4 uVar4;
  undefined1 *puVar5;
  void **ppvVar6;
  void *this;
  undefined1 *in_stack_ffffffb8;
  byte bVar7;
  undefined **local_24;
  void *local_20;
  undefined4 local_1c;
  void *local_18;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a588;
  local_c = ExceptionList;
  bVar7 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffc8;
  ExceptionList = &local_c;
  local_24 = aTextFile::vftable;
  local_20 = (void *)0x0;
  local_1c = 0;
  local_4._0_1_ = 3;
  local_4._1_3_ = 0;
  FUN_0041a1b0("ConfigServer: Initializing",bVar7);
  _Memory = param_8;
  puVar5 = &DAT_0044d0d5;
  if (param_8 != (undefined1 *)0x0) {
    puVar5 = param_8;
  }
  FUN_0041aa80(puVar5,(char *)0x7fffffff,puVar5);
  uVar4 = FUN_00436a40(this,(int)&local_24,in_stack_ffffffb8);
  if ((char)uVar4 == '\0') {
    FUN_0041a1f0("ConfigServer: Can\'t retrieve password info",bVar7);
    local_4._0_1_ = 2;
    if (local_20 != (void *)0x0) {
      pvVar1 = (void *)((int)local_20 + -4);
      _eh_vector_destructor_iterator_(local_20,0xc,*(int *)((int)local_20 + -4),FUN_0041aaf0);
      operator_delete(pvVar1);
    }
    local_4._0_1_ = 1;
    if (param_2 != (void *)0x0) {
      free(param_2);
    }
    local_4 = (uint)local_4._1_3_ << 8;
    puVar5 = (undefined1 *)param_5;
    if (param_5 != (void *)0x0) {
      free(param_5);
    }
    local_4 = 0xffffffff;
    if (_Memory != (undefined1 *)0x0) {
      free(_Memory);
    }
  }
  else {
    FUN_00436d70((int)&local_24);
    local_4 = CONCAT31(local_4._1_3_,4);
    ppvVar6 = (void **)FUN_00401080();
    if (*ppvVar6 != *(void **)(param_1 + 0x68)) {
      FUN_0041b310();
      memcpy(*(void **)(param_1 + 0x68),*ppvVar6,(size_t)ppvVar6[1]);
      pvVar1 = ppvVar6[1];
      *(void **)(param_1 + 0x6c) = pvVar1;
      *(undefined *)((int)pvVar1 + (int)*(void **)(param_1 + 0x68)) = 0;
    }
    local_4 = CONCAT31(local_4._1_3_,3);
    if (local_18 != (void *)0x0) {
      free(local_18);
    }
    if (local_20 != (void *)0x0) {
      pvVar1 = (void *)((int)local_20 + -4);
      _eh_vector_destructor_iterator_(local_20,0xc,*(int *)((int)local_20 + -4),FUN_0041aaf0);
      operator_delete(pvVar1);
    }
    sVar2 = param_3;
    pvVar1 = param_2;
    *(undefined4 *)(param_1 + 0x3c) = 0;
    *(undefined4 *)(param_1 + 0x140) = 0;
    ppvVar6 = (void **)(param_1 + 0x74);
    local_20 = (void *)0x0;
    local_1c = 0;
    if (param_2 != *ppvVar6) {
      FUN_0041b310();
      memcpy(*ppvVar6,pvVar1,sVar2);
      *(size_t *)(param_1 + 0x78) = sVar2;
      *(undefined *)(sVar2 + (int)*ppvVar6) = 0;
    }
    sVar2 = param_6;
    _Src = param_5;
    if (param_5 != *(void **)(param_1 + 0x80)) {
      FUN_0041b310();
      memcpy(*(void **)(param_1 + 0x80),_Src,sVar2);
      *(size_t *)(param_1 + 0x84) = sVar2;
      *(undefined *)(sVar2 + (int)*(void **)(param_1 + 0x80)) = 0;
    }
    sVar2 = param_9;
    if (param_8 != *(undefined1 **)(param_1 + 0x8c)) {
      FUN_0041b310();
      memcpy(*(void **)(param_1 + 0x8c),param_8,sVar2);
      *(size_t *)(param_1 + 0x90) = sVar2;
      *(undefined *)(sVar2 + (int)*(void **)(param_1 + 0x8c)) = 0;
    }
    uVar4 = FUN_00421c50(&param_2);
    if ((char)uVar4 != '\0') {
      uVar4 = FUN_00420880(param_1);
      if ((char)uVar4 == '\0') {
        local_4 = CONCAT31(local_4._1_3_,2);
        FUN_00436a00(&local_24);
      }
      else {
        cVar3 = FUN_004224f0(param_1 + 0xf8);
        if (cVar3 != '\0') {
          cVar3 = FUN_00437050((u_short)*(undefined4 *)(param_1 + 0x58));
          if (cVar3 != '\0') {
            FUN_0041c710('\x01');
            FUN_0041a1b0("ConfigServer: Initialized",bVar7);
            local_4._0_1_ = 2;
            FUN_00436a00(&local_24);
            local_4._0_1_ = 1;
            if (pvVar1 != (void *)0x0) {
              free(pvVar1);
            }
            local_4 = (uint)local_4._1_3_ << 8;
            if (param_5 != (void *)0x0) {
              free(param_5);
            }
            local_4 = 0xffffffff;
            if (param_8 != (undefined1 *)0x0) {
              free(param_8);
            }
            ExceptionList = local_c;
            return CONCAT31((int3)((uint)param_8 >> 8),1);
          }
          FUN_0041a1f0("ConfigServer: Can\'t open receiving socket",bVar7);
          local_4._0_1_ = 2;
          FUN_00436a00(&local_24);
          local_4._0_1_ = 1;
          if (pvVar1 != (void *)0x0) {
            free(pvVar1);
          }
          local_4 = (uint)local_4._1_3_ << 8;
          if (param_5 != (void *)0x0) {
            free(param_5);
          }
          local_4 = 0xffffffff;
          puVar5 = param_8;
          if (param_8 != (undefined1 *)0x0) {
            free(param_8);
            ExceptionList = local_c;
            return (uint)param_8 & 0xffffff00;
          }
          goto LAB_0041ecc5;
        }
        local_4 = CONCAT31(local_4._1_3_,2);
        FUN_00436a00(&local_24);
      }
    }
    local_4._0_1_ = 1;
    if (pvVar1 != (void *)0x0) {
      free(pvVar1);
    }
    local_4 = (uint)local_4._1_3_ << 8;
    if (_Src != (void *)0x0) {
      free(_Src);
    }
    local_4 = 0xffffffff;
    puVar5 = param_8;
    if (param_8 != (undefined1 *)0x0) {
      free(param_8);
      ExceptionList = local_c;
      return (uint)param_8 & 0xffffff00;
    }
  }
LAB_0041ecc5:
  ExceptionList = local_c;
  return (uint)puVar5 & 0xffffff00;
}



void FUN_0041ef90(void)

{
  code *pcVar1;
  int *unaff_EDI;
  
  FUN_0041c150();
  pcVar1 = *(code **)(*unaff_EDI + 4);
  *(undefined *)(unaff_EDI + 1) = 1;
  (*pcVar1)();
  if (*(char *)(unaff_EDI + 0xd) == '\0') {
    WaitForSingleObject((HANDLE)unaff_EDI[0xe],0xffffffff);
    CloseHandle((HANDLE)unaff_EDI[0xe]);
  }
  return;
}



undefined4 FUN_0041efd0(int param_1,void *param_2)

{
  SOCKET s;
  void *pvVar1;
  byte bVar2;
  undefined4 *puVar3;
  undefined1 *puVar4;
  int iVar5;
  undefined4 uVar6;
  DWORD DVar7;
  DWORD DVar8;
  byte *pbVar9;
  int iVar10;
  void *in_stack_00000018;
  size_t in_stack_0000001c;
  undefined4 in_stack_00000024;
  int in_stack_00000028;
  void *local_24 [3];
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a148;
  local_c = ExceptionList;
  bVar2 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffc8;
  ExceptionList = &local_c;
  local_4 = 1;
  puVar3 = (undefined4 *)FUN_0041cf20();
  iVar10 = in_stack_00000028;
  local_4._0_1_ = 2;
  puVar4 = (undefined1 *)*puVar3;
  if (puVar4 == (undefined1 *)0x0) {
    puVar4 = &DAT_0044d0d5;
  }
  FUN_0041a190("ConfigServer: Login(******, %s, %d)",(char)puVar4);
  local_4 = CONCAT31(local_4._1_3_,1);
  if (local_24[0] != (void *)0x0) {
    free(local_24[0]);
  }
  FUN_0041ada0(&param_2,local_24);
  pbVar9 = *(byte **)(param_1 + 0x5c);
  if (pbVar9 == (byte *)0x0) {
    pbVar9 = &DAT_0044d0d5;
  }
  iVar5 = FUN_0041ab00(pbVar9);
  if (local_24[0] != (void *)0x0) {
    free(local_24[0]);
  }
  pvVar1 = in_stack_00000018;
  if (iVar5 == 0) {
    if ((((*(char *)(param_1 + 0x50) != (char)in_stack_00000024) ||
         (*(char *)(param_1 + 0x51) != (char)((uint)in_stack_00000024 >> 8))) ||
        (*(char *)(param_1 + 0x52) != in_stack_00000024._2_1_)) ||
       ((*(char *)(param_1 + 0x53) != in_stack_00000024._3_1_ ||
        (*(int *)(param_1 + 0x54) != iVar10)))) {
      if (in_stack_00000018 != *(void **)(param_1 + 0x44)) {
        FUN_0041b310();
        memcpy(*(void **)(param_1 + 0x44),pvVar1,in_stack_0000001c);
        *(size_t *)(param_1 + 0x48) = in_stack_0000001c;
        *(undefined *)(in_stack_0000001c + (int)*(void **)(param_1 + 0x44)) = 0;
      }
      *(undefined4 *)(param_1 + 0x50) = in_stack_00000024;
      *(int *)(param_1 + 0x54) = in_stack_00000028;
      s = *(SOCKET *)(param_1 + 0xbc);
      if ((s != 0) && (s != 0xffffffff)) {
        closesocket(s);
      }
      *(undefined4 *)(param_1 + 0xd4) = 0;
      *(undefined4 *)(param_1 + 0xbc) = 0;
      FUN_00436fc0(param_1 + 0x40,*(undefined4 *)(param_1 + 0x54));
    }
    DVar7 = timeGetTime();
    DVar8 = timeGetTime();
    iVar10 = (int)(DVar8 * DVar7) % 0x499602d2;
    *(int *)(param_1 + 0x3c) = iVar10;
    if (iVar10 < 0) {
      *(int *)(param_1 + 0x3c) = -iVar10;
    }
    FUN_00421730(*(undefined4 *)(param_1 + 0x3c));
    FUN_0041cf20();
    pvVar1 = param_2;
    local_4._0_1_ = 5;
    puVar3 = FUN_0041b2a0(local_18,"Login(%s, %s, %d): Ok, SessionId=%d.");
    local_4._0_1_ = 6;
    puVar4 = (undefined1 *)*puVar3;
    if (puVar4 == (undefined1 *)0x0) {
      puVar4 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar4,bVar2);
    local_4._0_1_ = 5;
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    local_4._0_1_ = 1;
    if (local_24[0] != (void *)0x0) {
      free(local_24[0]);
    }
    FUN_0041a190("ConfigServer: Login (%d)",(char)*(undefined4 *)(param_1 + 0x3c));
    uVar6 = *(undefined4 *)(param_1 + 0x3c);
    local_4 = (uint)local_4._1_3_ << 8;
    if (pvVar1 != (void *)0x0) {
      free(pvVar1);
    }
    local_4 = 0xffffffff;
    if (in_stack_00000018 != (void *)0x0) {
      free(in_stack_00000018);
    }
  }
  else {
    FUN_0041cf20();
    pvVar1 = param_2;
    local_4._0_1_ = 3;
    puVar3 = FUN_0041b2a0(local_24,"Login(%s, %s, %d): Error, wrong password.");
    local_4._0_1_ = 4;
    puVar4 = (undefined1 *)*puVar3;
    if (puVar4 == (undefined1 *)0x0) {
      puVar4 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar4,bVar2);
    local_4._0_1_ = 3;
    if (local_24[0] != (void *)0x0) {
      free(local_24[0]);
    }
    local_4._0_1_ = 1;
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    FUN_0041a1f0("ConfigServer: Wrong password",bVar2);
    FUN_00421680(10,0);
    local_4 = (uint)local_4._1_3_ << 8;
    if (pvVar1 != (void *)0x0) {
      free(pvVar1);
    }
    local_4 = 0xffffffff;
    if (in_stack_00000018 != (void *)0x0) {
      free(in_stack_00000018);
    }
    uVar6 = 0xffffffff;
  }
  ExceptionList = local_c;
  return uVar6;
}



void FUN_0041f2f0(int param_1,void *param_2,size_t param_3)

{
  undefined4 *puVar1;
  undefined1 *puVar2;
  void **ppvVar3;
  byte bVar4;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004399e0;
  local_c = ExceptionList;
  bVar4 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffd8;
  ExceptionList = &local_c;
  local_4 = 0;
  FUN_0041a190("ConfigServer: ChangePassword(******)",bVar4);
  puVar1 = FUN_0041b2a0(local_18,"ChangePassword(%s): Ok.");
  local_4._0_1_ = 1;
  puVar2 = (undefined1 *)*puVar1;
  if (puVar2 == (undefined1 *)0x0) {
    puVar2 = &DAT_0044d0d5;
  }
  FUN_0041a1b0(puVar2,bVar4);
  local_4 = (uint)local_4._1_3_ << 8;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  ppvVar3 = (void **)(param_1 + 0x5c);
  if (param_2 != *ppvVar3) {
    FUN_0041b310();
    memcpy(*ppvVar3,param_2,param_3);
    *(size_t *)(param_1 + 0x60) = param_3;
    *(undefined *)(param_3 + (int)*ppvVar3) = 0;
  }
  FUN_004215f0();
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return;
}



void FUN_0041f3e0(undefined4 param_1)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  undefined1 unaff_SI;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_004399a8;
  local_c = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)local_18;
  ExceptionList = &local_c;
  FUN_0041a190("ConfigServer: SetTime(%d)",unaff_SI);
  puVar2 = FUN_0041b2a0(local_18,"SetTime(%d): Ok.");
  local_4 = 0;
  puVar3 = (undefined1 *)*puVar2;
  if (puVar3 == (undefined1 *)0x0) {
    puVar3 = &DAT_0044d0d5;
  }
  FUN_0041a1b0(puVar3,bVar1);
  local_4 = 0xffffffff;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  FUN_004215f0();
  ExceptionList = local_c;
  return;
}



void __thiscall FUN_0041f480(void *this,void *param_1)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  undefined uVar4;
  undefined uStack_1c;
  undefined uStack_1b;
  undefined uStack_1a;
  undefined uStack_19;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0043a0f0;
  local_c = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffd8;
  ExceptionList = &local_c;
  local_4 = 0;
  puVar3 = &DAT_0044d0d5;
  if (param_1 != (void *)0x0) {
    puVar3 = (undefined1 *)param_1;
  }
  FUN_0041a190("ConfigServer: UpdateFirmware(%s)",(char)puVar3);
  puVar2 = FUN_0041b2a0(local_18,"UpdateFirmware(%s): Ok.");
  local_4._0_1_ = 1;
  puVar3 = (undefined1 *)*puVar2;
  if (puVar3 == (undefined1 *)0x0) {
    puVar3 = &DAT_0044d0d5;
  }
  FUN_0041a1b0(puVar3,bVar1);
  local_4 = (uint)local_4._1_3_ << 8;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  FUN_004215f0();
  uVar4 = 0xa8;
  FUN_0041a1d0("ConfigServer: The unit would reboot now. Simulation will resume in 30 seconds.",
               bVar1);
  FUN_0041a1b0("Simulated reboot.",uVar4);
  FUN_00403a80();
  *(undefined4 *)((int)this + 0x3c) = 0xffffffff;
  *(undefined4 *)((int)this + 0x54) = 0xffffffff;
  uStack_19 = 0;
  uStack_1a = 0;
  uStack_1b = 0;
  uStack_1c = 0;
  FUN_0041d130((undefined4 *)&uStack_1c);
  local_4 = 0xffffffff;
  if (param_1 != (void *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return;
}



void FUN_0041f5a0(void)

{
  int in_EAX;
  undefined1 unaff_SI;
  undefined uVar1;
  undefined4 local_4;
  
  uVar1 = 0xfc;
  FUN_0041a190("ConfigServer: RestoreFirmware()",unaff_SI);
  FUN_0041a1b0("RestoreFirmware(): Ok.",uVar1);
  FUN_004215f0();
  uVar1 = 0xa8;
  FUN_0041a1d0("ConfigServer: The unit would reboot now. Simulation will resume in 30 seconds.",
               unaff_SI);
  FUN_0041a1b0("Simulated reboot.",uVar1);
  FUN_00403a80();
  *(undefined4 *)(in_EAX + 0x3c) = 0xffffffff;
  *(undefined4 *)(in_EAX + 0x54) = 0xffffffff;
  local_4 = 0;
  FUN_0041d130(&local_4);
  return;
}



void __thiscall FUN_0041f610(void *this,undefined4 param_1,void *param_2)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  void *local_48 [3];
  void *local_3c [3];
  void *local_30 [3];
  void *local_24 [3];
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439980;
  local_c = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffa8;
  ExceptionList = &local_c;
  local_4 = 0;
  FUN_0041a190("ConfigServer: ExportLog(%d,%s)",(char)this);
  switch(this) {
  case (void *)0x0:
    puVar2 = FUN_0041b2a0(local_48,"ExportLog(RECOGNIZER, %s): Ok.");
    local_4._0_1_ = 1;
    puVar3 = (undefined1 *)*puVar2;
    if (puVar3 == (undefined1 *)0x0) {
      puVar3 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar3,bVar1);
    local_4 = (uint)local_4._1_3_ << 8;
    local_24[0] = local_48[0];
    break;
  case (void *)0x1:
    puVar2 = FUN_0041b2a0(local_3c,"ExportLog(COMBRIDGE, %s): Ok.");
    local_4._0_1_ = 2;
    puVar3 = (undefined1 *)*puVar2;
    if (puVar3 == (undefined1 *)0x0) {
      puVar3 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar3,bVar1);
    local_4 = (uint)local_4._1_3_ << 8;
    local_24[0] = local_3c[0];
    break;
  case (void *)0x2:
    puVar2 = FUN_0041b2a0(local_30,"ExportLog(CONFIG, %s): Ok.");
    local_4._0_1_ = 3;
    puVar3 = (undefined1 *)*puVar2;
    if (puVar3 == (undefined1 *)0x0) {
      puVar3 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar3,bVar1);
    local_4 = (uint)local_4._1_3_ << 8;
    local_24[0] = local_30[0];
    break;
  case (void *)0x3:
    puVar2 = FUN_0041b2a0(local_24,"ExportLog(FILESYSTEM, %s): Ok.");
    local_4._0_1_ = 4;
    puVar3 = (undefined1 *)*puVar2;
    if (puVar3 == (undefined1 *)0x0) {
      puVar3 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar3,bVar1);
    local_4 = (uint)local_4._1_3_ << 8;
    break;
  default:
    puVar2 = FUN_0041b2a0(local_18,"ExportLog(???, %s): Error, unknwon log type.");
    local_4._0_1_ = 5;
    puVar3 = (undefined1 *)*puVar2;
    if (puVar3 == (undefined1 *)0x0) {
      puVar3 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar3,bVar1);
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    FUN_00421680(3,1);
    local_4 = 0xffffffff;
    if (param_2 == (void *)0x0) {
      ExceptionList = local_c;
      return;
    }
    free(param_2);
    ExceptionList = local_c;
    return;
  }
  if (local_24[0] != (void *)0x0) {
    free(local_24[0]);
  }
  FUN_004215f0();
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return;
}



void FUN_0041f830(undefined4 param_1,void *param_2)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439930;
  local_c = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffe0;
  ExceptionList = &local_c;
  local_4 = 0;
  puVar3 = &DAT_0044d0d5;
  if (param_2 != (void *)0x0) {
    puVar3 = (undefined1 *)param_2;
  }
  FUN_0041a190("ConfigServer: ExportStatus(%s)",(char)puVar3);
  puVar2 = FUN_0041b2a0(local_18,"ExportStatus(%s): Ok.");
  local_4._0_1_ = 1;
  puVar3 = (undefined1 *)*puVar2;
  if (puVar3 == (undefined1 *)0x0) {
    puVar3 = &DAT_0044d0d5;
  }
  FUN_0041a1b0(puVar3,bVar1);
  local_4 = (uint)local_4._1_3_ << 8;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  FUN_004215f0();
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return;
}



void FUN_0041f900(undefined4 param_1,void *param_2)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439930;
  local_c = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffe0;
  ExceptionList = &local_c;
  local_4 = 0;
  puVar3 = &DAT_0044d0d5;
  if (param_2 != (void *)0x0) {
    puVar3 = (undefined1 *)param_2;
  }
  FUN_0041a190("ConfigServer: ImportConfiguration(%s)",(char)puVar3);
  puVar2 = FUN_0041b2a0(local_18,"ImportConfiguration(%s): Ok.");
  local_4._0_1_ = 1;
  puVar3 = (undefined1 *)*puVar2;
  if (puVar3 == (undefined1 *)0x0) {
    puVar3 = &DAT_0044d0d5;
  }
  FUN_0041a1b0(puVar3,bVar1);
  local_4 = (uint)local_4._1_3_ << 8;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  FUN_004215f0();
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return;
}



void FUN_0041f9d0(undefined4 param_1,void *param_2)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439930;
  local_c = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffe0;
  ExceptionList = &local_c;
  local_4 = 0;
  puVar3 = &DAT_0044d0d5;
  if (param_2 != (void *)0x0) {
    puVar3 = (undefined1 *)param_2;
  }
  FUN_0041a190("ConfigServer: ExportConfiguration(%s)",(char)puVar3);
  puVar2 = FUN_0041b2a0(local_18,"ExportConfiguration(%s): Ok.");
  local_4._0_1_ = 1;
  puVar3 = (undefined1 *)*puVar2;
  if (puVar3 == (undefined1 *)0x0) {
    puVar3 = &DAT_0044d0d5;
  }
  FUN_0041a1b0(puVar3,bVar1);
  local_4 = (uint)local_4._1_3_ << 8;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  FUN_004215f0();
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return;
}



void FUN_0041faa0(int param_1)

{
  byte bVar1;
  void *_Size;
  undefined *puVar2;
  uint uVar3;
  char **ppcVar4;
  byte **ppbVar5;
  byte *pbVar6;
  void **ppvVar7;
  undefined1 *puVar8;
  FILE *_File;
  undefined4 extraout_ECX;
  void *this;
  byte *pbVar9;
  byte *pbVar10;
  undefined1 *puVar11;
  bool bVar12;
  char *pcVar13;
  int iVar14;
  undefined4 uVar15;
  char *in_stack_ffffff38;
  undefined uVar16;
  undefined *local_ac;
  undefined1 *local_a8;
  void *local_a4;
  undefined4 local_a0;
  byte *local_9c;
  byte *local_98;
  undefined4 local_94;
  byte *local_90;
  byte *local_8c;
  undefined4 local_88;
  undefined **local_84;
  FILE *local_80;
  undefined *local_7c;
  void *local_78 [3];
  void *apvStack_6c [3];
  void *local_60;
  void *pvStack_54;
  void *apvStack_48 [3];
  void *pvStack_3c;
  void *apvStack_30 [3];
  int local_24 [4];
  void *local_14;
  undefined *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_0043a0b4;
  local_14 = ExceptionList;
  uVar3 = DAT_0044a01c ^ (uint)&stack0xffffff48;
  ExceptionList = &local_14;
  FUN_0041b630((void *)(param_1 + 0x74),local_24);
  local_84 = aDiskFile::vftable;
  local_80 = (FILE *)0x0;
  local_9c = (byte *)0x0;
  local_94 = 0;
  local_98 = (byte *)0x0;
  local_90 = (byte *)0x0;
  local_88 = 0;
  local_8c = (byte *)0x0;
  local_a8 = (undefined1 *)0x0;
  local_a0 = 0;
  local_a4 = (void *)0x0;
  local_c._0_1_ = 4;
  local_c._1_3_ = 0;
  FUN_0041a190("ConfigServer: ApplyChanges()",(char)uVar3);
  FUN_0041a1b0("ApplyChanges(): Ok.",(char)uVar3);
  local_ac = &stack0xffffff38;
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,"wb");
  local_7c = &stack0xffffff2c;
  local_c._0_1_ = 5;
  pcVar13 = (char *)0x0;
  uVar15 = 0;
  iVar14 = 0;
  puVar2 = &stack0xffffff2c;
  if (*(int *)(param_1 + 0x74) != 0) {
    FUN_0041b310();
    memcpy(pcVar13,*(void **)(param_1 + 0x74),*(size_t *)(param_1 + 0x78));
    iVar14 = *(int *)(param_1 + 0x78);
    pcVar13[iVar14] = '\0';
    puVar2 = local_7c;
  }
  local_7c = puVar2;
  local_c = CONCAT31(local_c._1_3_,4);
  FUN_0041a810(&local_84,pcVar13,iVar14,uVar15,in_stack_ffffff38);
  FUN_0041b310();
  pbVar6 = local_9c;
  memcpy(local_9c,&PTR_0043b324,0);
  uVar16 = (undefined)uVar3;
  *pbVar6 = 0;
  local_98 = (byte *)0x0;
  local_ac = (undefined *)0x0;
  if (0 < *(int *)(param_1 + 0xe4)) {
    do {
      ppcVar4 = (char **)FUN_00422400(*(int *)(*(int *)(param_1 + 0xf4) + (int)local_ac * 4));
      local_c._0_1_ = 6;
      ppbVar5 = (byte **)FUN_0041abf0(this,ppcVar4,local_78,'/');
      local_c._0_1_ = 7;
      pbVar10 = local_90;
      if (*ppbVar5 != local_90) {
        FUN_0041b310();
        pbVar10 = local_90;
        memcpy(local_90,*ppbVar5,(size_t)ppbVar5[1]);
        local_8c = ppbVar5[1];
        local_8c[(int)pbVar10] = 0;
        pbVar6 = local_9c;
      }
      local_c._0_1_ = 6;
      if (local_78[0] != (void *)0x0) {
        free(local_78[0]);
      }
      local_c._0_1_ = 4;
      if (local_60 != (void *)0x0) {
        free(local_60);
      }
      pbVar9 = &DAT_0044d0d5;
      if (pbVar6 != (byte *)0x0) {
        pbVar9 = pbVar6;
      }
      pbVar6 = pbVar10;
      if (pbVar10 == (byte *)0x0) {
        if (pbVar9 != (byte *)0x0) {
          if (*pbVar9 == 0) goto LAB_0041fcb1;
          goto LAB_0041fd09;
        }
      }
      else {
        if (*pbVar10 == 0) {
LAB_0041fcb1:
          if ((pbVar9 == (byte *)0x0) || (*pbVar9 == 0)) goto LAB_0041fdd0;
        }
        else if (pbVar9 == (byte *)0x0) goto LAB_0041fd09;
        do {
          bVar1 = *pbVar6;
          bVar12 = bVar1 < *pbVar9;
          if (bVar1 != *pbVar9) {
LAB_0041fcef:
            iVar14 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
            goto LAB_0041fcf4;
          }
          if (bVar1 == 0) break;
          bVar1 = pbVar6[1];
          bVar12 = bVar1 < pbVar9[1];
          if (bVar1 != pbVar9[1]) goto LAB_0041fcef;
          pbVar9 = pbVar9 + 2;
          pbVar6 = pbVar6 + 2;
        } while (bVar1 != 0);
        iVar14 = 0;
LAB_0041fcf4:
        if (iVar14 != 0) {
LAB_0041fd09:
          ppvVar7 = (void **)FUN_0041b2a0(apvStack_30,"[%s]\n");
          local_c._0_1_ = 8;
          puVar11 = local_a8;
          if ((undefined1 *)*ppvVar7 != local_a8) {
            FUN_0041b310();
            puVar11 = local_a8;
            memcpy(local_a8,*ppvVar7,(size_t)ppvVar7[1]);
            local_a4 = ppvVar7[1];
            *(undefined *)((int)local_a4 + (int)puVar11) = 0;
            pbVar10 = local_90;
          }
          _Size = local_a4;
          local_c._0_1_ = 4;
          if (apvStack_30[0] != (void *)0x0) {
            free(apvStack_30[0]);
          }
          puVar8 = &DAT_0044d0d5;
          if (puVar11 != (undefined1 *)0x0) {
            puVar8 = puVar11;
          }
          fwrite(puVar8,(size_t)_Size,1,local_80);
          pbVar6 = local_8c;
          if (pbVar10 != local_9c) {
            FUN_0041b310();
            pbVar10 = local_9c;
            memcpy(local_9c,local_90,(size_t)pbVar6);
            local_98 = pbVar6;
            pbVar6[(int)pbVar10] = 0;
          }
        }
      }
LAB_0041fdd0:
      puVar2 = local_ac;
      FUN_00422ab0(*(int *)(*(int *)(param_1 + 0xf4) + (int)local_ac * 4));
      local_c._0_1_ = 9;
      FUN_00422400(*(int *)(*(int *)(param_1 + 0xf4) + (int)puVar2 * 4));
      local_c._0_1_ = 10;
      FUN_0041ad20('/',apvStack_6c);
      local_c._0_1_ = 0xb;
      ppvVar7 = (void **)FUN_0041b2a0(apvStack_48,"%s = %s\n");
      local_c._0_1_ = 0xc;
      puVar11 = local_a8;
      if ((undefined1 *)*ppvVar7 != local_a8) {
        FUN_0041b310();
        puVar11 = local_a8;
        memcpy(local_a8,*ppvVar7,(size_t)ppvVar7[1]);
        local_a4 = ppvVar7[1];
        *(undefined *)((int)local_a4 + (int)puVar11) = 0;
      }
      local_c._0_1_ = 0xb;
      if (apvStack_48[0] != (void *)0x0) {
        free(apvStack_48[0]);
      }
      local_c._0_1_ = 10;
      if (apvStack_6c[0] != (void *)0x0) {
        free(apvStack_6c[0]);
      }
      local_c._0_1_ = 9;
      if (pvStack_54 != (void *)0x0) {
        free(pvStack_54);
      }
      local_c = CONCAT31(local_c._1_3_,4);
      if (pvStack_3c != (void *)0x0) {
        free(pvStack_3c);
      }
      puVar8 = &DAT_0044d0d5;
      if (puVar11 != (undefined1 *)0x0) {
        puVar8 = puVar11;
      }
      fwrite(puVar8,(size_t)local_a4,1,local_80);
      uVar16 = (undefined)uVar3;
      local_ac = local_ac + 1;
      pbVar6 = local_9c;
    } while ((int)local_ac < *(int *)(param_1 + 0xe4));
  }
  fclose(local_80);
  pcVar13 = *(char **)(param_1 + 0x8c);
  local_80 = (FILE *)0x0;
  if (pcVar13 == (char *)0x0) {
    pcVar13 = &DAT_0044d0d5;
  }
  _File = fopen(pcVar13,"w");
  fprintf(_File,"%s\n");
  fclose(_File);
  ppvVar7 = (void **)(param_1 + 0x68);
  if (*(void **)(param_1 + 0x5c) != *ppvVar7) {
    FUN_0041b310();
    memcpy(*ppvVar7,*(void **)(param_1 + 0x5c),*(size_t *)(param_1 + 0x60));
    *(int *)(param_1 + 0x6c) = *(int *)(param_1 + 0x60);
    *(undefined *)(*(int *)(param_1 + 0x60) + (int)*ppvVar7) = 0;
  }
  FUN_004215f0();
  FUN_0041a1d0("ConfigServer: The unit would reboot now. Simulation will resume in 30 seconds.",
               uVar16);
  FUN_0041a1b0("Simulated reboot.",uVar16);
  FUN_00403a80();
  *(undefined4 *)(param_1 + 0x3c) = 0xffffffff;
  *(undefined4 *)(param_1 + 0x54) = 0xffffffff;
  local_ac = (undefined *)0x0;
  FUN_0041d130(&local_ac);
  local_c._0_1_ = 3;
  if (local_a8 != (undefined1 *)0x0) {
    free(local_a8);
  }
  local_c._0_1_ = 2;
  if (local_90 != (byte *)0x0) {
    free(local_90);
  }
  local_c = CONCAT31(local_c._1_3_,1);
  if (local_9c != (byte *)0x0) {
    free(local_9c);
  }
  local_c = 0xffffffff;
  FUN_00402ab0();
  ExceptionList = local_14;
  return;
}



void FUN_00420080(int param_1)

{
  void **ppvVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 unaff_EDI;
  undefined uVar5;
  
  iVar4 = param_1;
  uVar5 = 0x8c;
  FUN_0041a190("ConfigServer: DiscardChanges()",(char)unaff_EDI);
  FUN_0041a1b0("DiscardChanges(): Ok.",uVar5);
  ppvVar1 = (void **)(param_1 + 0x5c);
  if (*(void **)(param_1 + 0x68) != *ppvVar1) {
    FUN_0041b310();
    memcpy(*ppvVar1,*(void **)(param_1 + 0x68),*(size_t *)(param_1 + 0x6c));
    *(int *)(param_1 + 0x60) = *(int *)(param_1 + 0x6c);
    *(undefined *)(*(int *)(param_1 + 0x6c) + (int)*ppvVar1) = 0;
  }
  uVar5 = (undefined)unaff_EDI;
  piVar2 = (int *)(param_1 + 0xe4);
  param_1 = 0;
  if (0 < *piVar2) {
    do {
      iVar3 = *(int *)(*(int *)(iVar4 + 0xf4) + param_1 * 4);
      if (*(int *)(iVar3 + 0x40) != *(int *)(iVar3 + 0x10)) {
        FUN_0041b310();
        memcpy(*(void **)(iVar3 + 0x10),*(void **)(iVar3 + 0x40),*(size_t *)(iVar3 + 0x44));
        *(int *)(iVar3 + 0x14) = *(int *)(iVar3 + 0x44);
        *(undefined *)(*(int *)(iVar3 + 0x44) + (int)*(void **)(iVar3 + 0x10)) = 0;
      }
      uVar5 = (undefined)unaff_EDI;
      param_1 = param_1 + 1;
    } while (param_1 < *(int *)(iVar4 + 0xe4));
  }
  FUN_0041a1d0("ConfigServer: All changes discarded",uVar5);
  FUN_004215f0();
  return;
}



void FUN_00420150(void)

{
  int in_EAX;
  undefined1 unaff_SI;
  undefined uVar1;
  undefined4 local_4;
  
  uVar1 = 0xe8;
  FUN_0041a190("ConfigServer: Logout()",unaff_SI);
  FUN_0041a1b0("Logout(): Ok.",uVar1);
  FUN_004215f0();
  *(undefined4 *)(in_EAX + 0x3c) = 0xffffffff;
  *(undefined4 *)(in_EAX + 0x54) = 0xffffffff;
  local_4 = 0;
  FUN_0041d130(&local_4);
  return;
}



void FUN_004201a0(void *param_1)

{
  byte bVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined1 *puVar5;
  uint uVar6;
  byte bVar7;
  bool bVar8;
  void *in_stack_fffffe7c;
  void *in_stack_fffffe88;
  size_t in_stack_fffffe8c;
  void *in_stack_fffffe94;
  size_t sVar9;
  char *pcVar10;
  undefined uVar11;
  void *local_14c;
  undefined4 local_148;
  undefined4 local_144;
  undefined *local_140;
  undefined4 local_13c;
  undefined **local_134;
  void *local_130;
  undefined *local_120;
  void *local_11c;
  undefined4 local_118;
  undefined4 local_114;
  byte local_110;
  int local_10f;
  ushort local_107;
  ushort local_105;
  undefined4 local_103;
  int local_ff;
  byte local_fb;
  void *local_bb;
  uint local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_0043a532;
  local_c = ExceptionList;
  local_10 = DAT_0044a01c ^ (uint)&local_14c;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xfffffea4;
  ExceptionList = &local_c;
  FUN_0041ce60(&local_134);
  local_14c = (void *)0x0;
  local_144 = 0;
  local_148 = 0;
  local_11c = (void *)0x0;
  local_114 = 0;
  local_118 = 0;
  local_4._0_1_ = 2;
  local_4._1_3_ = 0;
  local_13c = 0;
  sVar9 = 0x420231;
  local_140 = (undefined *)((int)param_1 + 0x98);
  uVar2 = FUN_00436dc0((int *)&local_120);
  if ((char)uVar2 == '\0') {
    bVar8 = local_130 == (void *)0x0;
LAB_00420249:
    local_4 = 0xffffffff;
    local_134 = aIpAddr::vftable;
    if (!bVar8) {
      free(local_130);
    }
    goto LAB_0042078c;
  }
  iVar3 = FUN_00437110((int)(undefined *)((int)param_1 + 0x98),(int)&local_134);
  if (iVar3 < 1) {
    FUN_0041a1f0("ConfigServer: Unexpected communications error",bVar1);
    bVar8 = local_130 == (void *)0x0;
    goto LAB_00420249;
  }
  uVar6 = 1;
  bVar7 = local_110;
  if (1 < iVar3 - 2U) {
    do {
      bVar7 = bVar7 ^ (&local_110)[uVar6];
      uVar6 = uVar6 + 1;
    } while (uVar6 < iVar3 - 2U);
  }
  if (bVar7 != *(byte *)((int)&local_114 + iVar3 + 2)) {
    uVar11 = 0x40;
    FUN_0041a1f0("ConfigServer: Wrong checksum",bVar1);
    pcVar10 = "Error, wrong message checksum.";
LAB_004202d4:
    FUN_0041a1b0(pcVar10,uVar11);
    FUN_00421680(1,0);
    bVar8 = local_130 == (void *)0x0;
    goto LAB_00420249;
  }
  if (local_110 != 2) {
    uVar11 = 0x80;
    FUN_0041a1f0("ConfigServer: No STX found on msg",bVar1);
    pcVar10 = "Error, no STX found on message.";
    goto LAB_004202d4;
  }
  if (*(char *)((int)&local_114 + iVar3 + 3) != '\x03') {
    uVar11 = 0xc4;
    FUN_0041a1f0("ConfigServer: No ETX found on msg",bVar1);
    FUN_0041a1b0("Error, no ETX found on message.",uVar11);
    uVar11 = 1;
LAB_00420771:
    FUN_00421680(uVar11,0);
    goto LAB_00420778;
  }
  if ((uint)local_105 != (&DAT_0044af00)[local_107]) {
    uVar11 = 8;
    FUN_0041a1f0("ConfigServer: Incompatible message version",bVar1);
    FUN_0041a1b0("Error, incompatible message version.",uVar11);
    uVar11 = 6;
    goto LAB_00420771;
  }
  if (local_10f != *(int *)((int)param_1 + 0x144)) {
    FUN_0041a1f0("ConfigServer: Incorrect SystemId(%lu)",(char)local_10f);
    puVar4 = FUN_0041b2a0(&local_140,"Error, wrong unit id %lu.");
    local_4._0_1_ = 3;
    puVar5 = (undefined1 *)*puVar4;
    if (puVar5 == (undefined1 *)0x0) {
      puVar5 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar5,bVar1);
    local_4._0_1_ = 2;
    if (local_140 != (undefined *)0x0) {
      free(local_140);
    }
    uVar11 = 5;
    goto LAB_00420771;
  }
  *(undefined4 *)((int)param_1 + 0x140) = local_103;
  if (local_107 == 0x61) {
    FUN_00401080();
    local_120 = &stack0xfffffe88;
    FUN_004086f0((undefined4 *)&stack0xfffffe88);
    local_140 = &stack0xfffffe7c;
    local_4._0_1_ = 4;
    FUN_0041aa30((void **)&stack0xfffffe7c);
    local_4._0_1_ = 2;
    FUN_0041efd0((int)param_1,in_stack_fffffe7c);
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_14c != (void *)0x0) {
      free(local_14c);
    }
    goto LAB_00420778;
  }
  if (local_107 == 0x60) {
    FUN_00421420(&local_134,local_ff);
    goto LAB_00420778;
  }
  if ((*(int *)((int)param_1 + 0x3c) < 0) || (*(int *)((int)param_1 + 0x3c) != local_ff)) {
    uVar11 = 0xa0;
    FUN_0041a1f0("ConfigServer: Bad authorization",bVar1);
    FUN_0041a1b0("Error, unauthorized message.",uVar11);
    uVar11 = 10;
    goto LAB_00420771;
  }
  switch((uint)local_107) {
  case 0x62:
    FUN_00420150();
    break;
  case 99:
    FUN_00401080();
    local_140 = &stack0xfffffe94;
    FUN_0041aa30((void **)&stack0xfffffe94);
    FUN_0041f2f0((int)param_1,in_stack_fffffe94,sVar9);
    break;
  case 100:
    uVar11 = 100;
    FUN_0041a190("ConfigServer: SyncTime()",bVar1);
    pcVar10 = "SyncTime(): Ok.";
    goto LAB_00420700;
  case 0x65:
    FUN_0041f3e0(param_1);
    break;
  case 0x66:
    FUN_00401080();
    local_140 = &stack0xfffffe94;
    FUN_0041aa30((void **)&stack0xfffffe94);
    FUN_0041f610((void *)(uint)local_fb,param_1,in_stack_fffffe94);
    break;
  case 0x67:
    uVar11 = 0x40;
    FUN_0041a190("ConfigServer: GetSystemInfo()",bVar1);
    FUN_0041a1b0("GetSystemInfo(): Ok.",uVar11);
    FUN_004217d0((int)param_1 + 0xf8);
    break;
  case 0x68:
    FUN_00401080();
    local_140 = &stack0xfffffe94;
    FUN_0041aa30((void **)&stack0xfffffe94);
    FUN_0041f830(param_1,in_stack_fffffe94);
    break;
  case 0x69:
    FUN_00401080();
    local_140 = &stack0xfffffe94;
    FUN_0041aa30((void **)&stack0xfffffe94);
    FUN_0041f900(param_1,in_stack_fffffe94);
    break;
  case 0x6a:
    FUN_00401080();
    local_140 = &stack0xfffffe94;
    FUN_0041aa30((void **)&stack0xfffffe94);
    FUN_0041f9d0(param_1,in_stack_fffffe94);
    break;
  case 0x6b:
    FUN_0041faa0((int)param_1);
    break;
  case 0x6c:
    FUN_00420080((int)param_1);
    break;
  case 0x6d:
    uVar11 = 0x44;
    FUN_0041a190("ConfigServer: GetEntriesCount()",bVar1);
    FUN_0041a1b0("GetEntriesCount(): Ok.",uVar11);
    FUN_00421990();
    break;
  case 0x6e:
    FUN_00401080();
    local_140 = &stack0xfffffe94;
    FUN_0041aa30((void **)&stack0xfffffe94);
    FUN_00420ca0(local_bb,(int)param_1,in_stack_fffffe94,sVar9);
    break;
  case 0x6f:
    FUN_00401080();
    FUN_00401080();
    local_140 = &stack0xfffffe94;
    uVar2 = 0x42066f;
    FUN_0041aa30((void **)&stack0xfffffe94);
    local_120 = &stack0xfffffe88;
    local_4._0_1_ = 5;
    FUN_0041aa30((void **)&stack0xfffffe88);
    local_4._0_1_ = 2;
    FUN_00420f90((int)param_1,in_stack_fffffe88,in_stack_fffffe8c,uVar2,in_stack_fffffe94,sVar9);
    break;
  case 0x70:
    FUN_00401080();
    local_140 = &stack0xfffffe94;
    FUN_0041aa30((void **)&stack0xfffffe94);
    FUN_00421240((int)param_1,in_stack_fffffe94,sVar9);
    break;
  case 0x71:
    FUN_0041f5a0();
    break;
  case 0x72:
    FUN_00401080();
    local_140 = &stack0xfffffe94;
    FUN_0041aa30((void **)&stack0xfffffe94);
    FUN_0041f480(param_1,in_stack_fffffe94);
    break;
  case 0x73:
    uVar11 = 0x34;
    FUN_0041a190("ConfigServer: FormatRWPartition()",bVar1);
    pcVar10 = "FormatRWPartition(): Ok.";
LAB_00420700:
    FUN_0041a1b0(pcVar10,uVar11);
    FUN_004215f0();
    break;
  default:
    FUN_0041a1b0("Error, unknown message.",bVar1);
    uVar11 = 0;
    goto LAB_00420771;
  }
  local_4._0_1_ = 1;
  if (local_11c != (void *)0x0) {
    free(local_11c);
  }
  local_4 = (uint)local_4._1_3_ << 8;
  if (local_14c != (void *)0x0) {
    free(local_14c);
  }
LAB_00420778:
  local_4 = 0xffffffff;
  FUN_0041cf00(&local_134);
LAB_0042078c:
  ExceptionList = local_c;
  ___security_check_cookie_4(local_10 ^ (uint)&local_14c);
  return;
}



void __fastcall FUN_00420800(int param_1)

{
  SOCKET SVar1;
  
  SVar1 = *(SOCKET *)(param_1 + 0x9c);
  if ((SVar1 != 0) && (SVar1 != 0xffffffff)) {
    closesocket(SVar1);
  }
  *(undefined4 *)(param_1 + 0xb4) = 0;
  *(undefined4 *)(param_1 + 0x9c) = 0;
  SVar1 = *(SOCKET *)(param_1 + 0xbc);
  if ((SVar1 != 0) && (SVar1 != 0xffffffff)) {
    closesocket(SVar1);
  }
  *(undefined4 *)(param_1 + 0xd4) = 0;
  *(undefined4 *)(param_1 + 0xbc) = 0;
  return;
}



void __fastcall FUN_00420850(void *param_1)

{
  char cVar1;
  
  *(undefined *)((int)param_1 + 0x35) = 1;
  FUN_0041c150();
  cVar1 = *(char *)((int)param_1 + 4);
  while (cVar1 == '\0') {
    FUN_004201a0(param_1);
    cVar1 = *(char *)((int)param_1 + 4);
  }
  return;
}



undefined4 FUN_00420880(int param_1)

{
  char cVar1;
  byte bVar2;
  void *pvVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  char *pcVar6;
  size_t sVar7;
  size_t sVar8;
  size_t _Size;
  uint uVar9;
  char *pcVar10;
  void *_Dst;
  undefined4 uVar11;
  void *_Dst_00;
  size_t sVar12;
  undefined4 *local_64;
  int local_60;
  char *local_48;
  size_t local_44;
  undefined4 local_40;
  char *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  char *local_30;
  undefined4 local_2c;
  undefined4 local_28;
  uint local_24 [3];
  int local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_0043a023;
  local_c = ExceptionList;
  bVar2 = (byte)DAT_0044a01c ^ (byte)&stack0xffffff8c;
  ExceptionList = &local_c;
  FUN_0041b630((void *)(param_1 + 0x74),(int *)local_24);
  local_4 = 0;
  FUN_0041b630((void *)(param_1 + 0x80),local_18);
  local_48 = (char *)0x0;
  local_40 = 0;
  local_44 = 0;
  local_30 = (char *)0x0;
  local_28 = 0;
  local_2c = 0;
  local_3c = (char *)0x0;
  local_34 = 0;
  local_38 = 0;
  local_4 = CONCAT31(local_4._1_3_,4);
  FUN_0041a190("ConfigServer: LoadVariables()",bVar2);
  FUN_00422000();
  if (*(void **)(param_1 + 0xf4) != (void *)0x0) {
    operator_delete__(*(void **)(param_1 + 0xf4));
  }
  pvVar3 = operator_new(-(uint)((int)((ulonglong)local_24[0] * 4 >> 0x20) != 0) |
                        (uint)((ulonglong)local_24[0] * 4));
  *(void **)(param_1 + 0xf4) = pvVar3;
  local_60 = 0;
  pcVar10 = (char *)0x0;
  if (0 < (int)local_24[0]) {
    do {
      FUN_0041b960((int *)local_24,local_60,&local_48,&local_30);
      uVar4 = FUN_0041bbf0(&local_48,(int)local_18,&local_3c);
      pcVar10 = local_48;
      if ((char)uVar4 == '\0') {
        pcVar6 = &DAT_0044d0d5;
        if (local_48 != (char *)0x0) {
          pcVar6 = local_48;
        }
        FUN_0041a1f0("ConfigServer: variable %s not found in %s.",(char)pcVar6);
        local_4._0_1_ = 3;
        if (local_3c != (char *)0x0) {
          free(local_3c);
        }
        local_4._0_1_ = 2;
        if (local_30 != (char *)0x0) {
          free(local_30);
        }
        local_4._0_1_ = 1;
        if (pcVar10 != (char *)0x0) {
          free(pcVar10);
        }
        local_4 = (uint)local_4._1_3_ << 8;
        FUN_00402ab0();
        local_4 = 0xffffffff;
        uVar9 = FUN_00402ab0();
        ExceptionList = local_c;
        return uVar9 & 0xffffff00;
      }
      puVar5 = (undefined4 *)operator_new(0x4c);
      local_4._0_1_ = 5;
      if (puVar5 == (undefined4 *)0x0) {
        local_64 = (undefined4 *)0x0;
      }
      else {
        local_64 = FUN_00422950(puVar5);
      }
      local_4._0_1_ = 4;
      pcVar10 = local_3c;
      if (local_3c == (char *)0x0) {
        pcVar10 = &DAT_0044d0d5;
      }
      pvVar3 = (void *)0x0;
      sVar12 = 0;
      if (pcVar10 != (char *)0x0) {
        pcVar6 = pcVar10;
        do {
          cVar1 = *pcVar6;
          pcVar6 = pcVar6 + 1;
        } while (cVar1 != '\0');
        sVar7 = (int)pcVar6 - (int)(pcVar10 + 1);
        if ((int)sVar7 < -0x80000000) {
          if (sVar7 == 0) goto LAB_00420a2f;
        }
        else {
          sVar7 = 0x7fffffff;
        }
        FUN_0041b310();
        memcpy(pvVar3,pcVar10,sVar7);
        *(undefined *)(sVar7 + (int)pvVar3) = 0;
        sVar12 = sVar7;
      }
LAB_00420a2f:
      local_4._0_1_ = 6;
      pcVar10 = local_30;
      if (local_30 == (char *)0x0) {
        pcVar10 = &DAT_0044d0d5;
      }
      _Dst_00 = (void *)0x0;
      uVar4 = 0;
      sVar7 = 0;
      if (pcVar10 != (char *)0x0) {
        pcVar6 = pcVar10;
        do {
          cVar1 = *pcVar6;
          pcVar6 = pcVar6 + 1;
        } while (cVar1 != '\0');
        sVar8 = (int)pcVar6 - (int)(pcVar10 + 1);
        if ((int)sVar8 < -0x80000000) {
          if (sVar8 == 0) goto LAB_00420a9f;
        }
        else {
          sVar8 = 0x7fffffff;
        }
        FUN_0041b310();
        memcpy(_Dst_00,pcVar10,sVar8);
        *(undefined *)(sVar8 + (int)_Dst_00) = 0;
        sVar7 = sVar8;
      }
LAB_00420a9f:
      local_4._0_1_ = 7;
      pcVar10 = &DAT_0044d0d5;
      if (local_48 != (char *)0x0) {
        pcVar10 = local_48;
      }
      _Dst = (void *)0x0;
      uVar11 = 0;
      sVar8 = 0;
      if (pcVar10 != (char *)0x0) {
        pcVar6 = pcVar10;
        do {
          cVar1 = *pcVar6;
          pcVar6 = pcVar6 + 1;
        } while (cVar1 != '\0');
        _Size = (int)pcVar6 - (int)(pcVar10 + 1);
        if ((int)_Size < -0x80000000) {
          if (_Size == 0) goto LAB_00420b13;
        }
        else {
          _Size = 0x7fffffff;
        }
        FUN_0041b310();
        memcpy(_Dst,pcVar10,_Size);
        *(undefined *)(_Size + (int)_Dst) = 0;
        sVar8 = _Size;
      }
LAB_00420b13:
      pcVar10 = local_48;
      local_4 = CONCAT31(local_4._1_3_,4);
      FUN_00422b50((int)local_64,_Dst,sVar8,uVar11,_Dst_00,sVar7,uVar4,pvVar3,sVar12);
      sVar12 = local_44;
      pvVar3 = (void *)0x0;
      uVar4 = 0;
      sVar7 = 0;
      puVar5 = local_64;
      if (pcVar10 != (char *)0x0) {
        FUN_0041b310();
        memcpy(pvVar3,pcVar10,sVar12);
        *(undefined *)(sVar12 + (int)pvVar3) = 0;
        sVar7 = sVar12;
      }
      FUN_00421de0(param_1 + 0xd8,pvVar3,sVar7,uVar4,puVar5);
      *(undefined4 **)(*(int *)(param_1 + 0xf4) + local_60 * 4) = local_64;
      local_60 = local_60 + 1;
      pcVar10 = local_3c;
    } while (local_60 < (int)local_24[0]);
  }
  local_4._0_1_ = 3;
  if (pcVar10 != (char *)0x0) {
    free(pcVar10);
  }
  local_4._0_1_ = 2;
  if (local_30 != (char *)0x0) {
    free(local_30);
  }
  local_4._0_1_ = 1;
  if (local_48 != (char *)0x0) {
    free(local_48);
  }
  local_4 = (uint)local_4._1_3_ << 8;
  FUN_00402ab0();
  local_4 = 0xffffffff;
  uVar4 = FUN_00402ab0();
  ExceptionList = local_c;
  return CONCAT31((int3)((uint)uVar4 >> 8),1);
}



void __thiscall FUN_00420ca0(void *this,int param_1,void *param_2,size_t param_3)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  int *piVar4;
  code *pcVar5;
  int iVar6;
  char *in_stack_ffffff8c;
  undefined4 in_stack_ffffff90;
  undefined4 uVar7;
  char *in_stack_ffffff98;
  undefined4 in_stack_ffffff9c;
  undefined4 uVar8;
  char *in_stack_ffffffa4;
  uint in_stack_ffffffa8;
  undefined4 uVar9;
  void *_Dst;
  undefined **ppuVar10;
  size_t sVar11;
  undefined *local_24 [3];
  undefined *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439900;
  local_c = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffc0;
  ExceptionList = &local_c;
  local_4 = 0;
  puVar3 = &DAT_0044d0d5;
  if (param_2 != (void *)0x0) {
    puVar3 = (undefined1 *)param_2;
  }
  FUN_0041a190("ConfigServer: GetEntry(%s,%d)",(char)puVar3);
  if (param_3 == 0) {
    if (*(int *)(param_1 + 0xe4) + -1 < (int)this) {
      puVar2 = FUN_0041b2a0(local_24,"GetEntry(%d): Error, wrong entry number.");
      local_4._0_1_ = 1;
      puVar3 = (undefined1 *)*puVar2;
      if (puVar3 == (undefined1 *)0x0) {
        puVar3 = &DAT_0044d0d5;
      }
      FUN_0041a1b0(puVar3,bVar1);
      local_4 = (uint)local_4._1_3_ << 8;
      if (local_24[0] != (undefined *)0x0) {
        free(local_24[0]);
      }
      FUN_0041a1f0("ConfigServer: Wrong entry number query.",bVar1);
      FUN_00421680(3,2);
      local_4 = 0xffffffff;
      if (param_2 == (void *)0x0) {
        ExceptionList = local_c;
        return;
      }
      free(param_2);
      ExceptionList = local_c;
      return;
    }
    ppuVar10 = local_24;
    puVar2 = FUN_0041b2a0(ppuVar10,"GetEntry(%d): Ok.");
    local_4._0_1_ = 2;
    puVar3 = (undefined1 *)*puVar2;
    if (puVar3 == (undefined1 *)0x0) {
      puVar3 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar3,bVar1);
    pcVar5 = free_exref;
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_24[0] != (undefined *)0x0) {
      free(local_24[0]);
    }
    iVar6 = *(int *)(*(int *)(param_1 + 0xf4) + (int)this * 4);
  }
  else {
    _Dst = (void *)0x0;
    sVar11 = 0;
    if (param_2 != (void *)0x0) {
      FUN_0041b310();
      memcpy(_Dst,param_2,param_3);
      *(undefined *)(param_3 + (int)_Dst) = 0;
      sVar11 = param_3;
    }
    in_stack_ffffffa8 = param_1 + 0xd8;
    in_stack_ffffffa4 = (char *)0x420e1e;
    piVar4 = FUN_00421e80(in_stack_ffffffa8,local_24,_Dst,sVar11);
    iVar6 = *piVar4;
    if ((piVar4[1] == 0) || (iVar6 == 0)) {
      puVar2 = FUN_0041b2a0(local_24,"GetEntry(%s): Error, wrong entry name.");
      local_4._0_1_ = 3;
      puVar3 = (undefined1 *)*puVar2;
      if (puVar3 == (undefined1 *)0x0) {
        puVar3 = &DAT_0044d0d5;
      }
      FUN_0041a1b0(puVar3,bVar1);
      local_4 = (uint)local_4._1_3_ << 8;
      if (local_24[0] != (undefined *)0x0) {
        free(local_24[0]);
      }
      FUN_0041a1f0("ConfigServer: Wrong entry name query",bVar1);
      FUN_00421680(3,1);
      local_4 = 0xffffffff;
      if (param_2 == (void *)0x0) {
        ExceptionList = local_c;
        return;
      }
      free(param_2);
      ExceptionList = local_c;
      return;
    }
    ppuVar10 = local_18;
    puVar2 = FUN_0041b2a0(ppuVar10,"GetEntry(%s): Ok.");
    local_4._0_1_ = 4;
    puVar3 = (undefined1 *)*puVar2;
    if (puVar3 == (undefined1 *)0x0) {
      puVar3 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar3,bVar1);
    pcVar5 = free_exref;
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_18[0] != (undefined *)0x0) {
      free(local_18[0]);
    }
    iVar6 = *(int *)(iVar6 + 0x14);
  }
  uVar9 = 0x420f15;
  FUN_00422b00((void **)&stack0xffffffb0,iVar6);
  local_4._0_1_ = 5;
  uVar8 = 0x420f2f;
  FUN_00422b00((void **)&stack0xffffffa4,iVar6);
  local_4._0_1_ = 6;
  uVar7 = 0x420f44;
  FUN_00422ab0(iVar6);
  local_24[0] = &stack0xffffff8c;
  local_4._0_1_ = 7;
  FUN_00422400(iVar6);
  local_4 = (uint)local_4._1_3_ << 8;
  FUN_00421a30(param_1,in_stack_ffffff8c,in_stack_ffffff90,uVar7,in_stack_ffffff98,in_stack_ffffff9c
               ,uVar8,in_stack_ffffffa4,in_stack_ffffffa8,uVar9,(char *)ppuVar10);
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    (*pcVar5)();
  }
  ExceptionList = local_c;
  return;
}



void FUN_00420f90(int param_1,void *param_2,size_t param_3,undefined4 param_4,void *param_5,
                 size_t param_6)

{
  int iVar1;
  byte bVar2;
  int *piVar3;
  undefined4 *puVar4;
  undefined1 *puVar5;
  undefined4 uVar6;
  code *pcVar7;
  void *pvVar8;
  size_t sVar9;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439898;
  local_c = ExceptionList;
  bVar2 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffd4;
  ExceptionList = &local_c;
  local_4 = 1;
  puVar5 = &DAT_0044d0d5;
  if (param_2 != (void *)0x0) {
    puVar5 = (undefined1 *)param_2;
  }
  FUN_0041a190("ConfigServer: SetEntry(%s,%s)",(char)puVar5);
  pvVar8 = (void *)0x0;
  sVar9 = 0;
  if (param_2 != (void *)0x0) {
    FUN_0041b310();
    memcpy(pvVar8,param_2,param_3);
    *(undefined *)(param_3 + (int)pvVar8) = 0;
    sVar9 = param_3;
  }
  piVar3 = FUN_00421e80(param_1 + 0xd8,local_18,pvVar8,sVar9);
  iVar1 = *piVar3;
  if ((piVar3[1] == 0) || (iVar1 == 0)) {
    puVar4 = FUN_0041b2a0(local_18,"SetEntry(%s,%s): Error, wrong entry name.");
    local_4._0_1_ = 2;
    puVar5 = (undefined1 *)*puVar4;
    if (puVar5 == (undefined1 *)0x0) {
      puVar5 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar5,bVar2);
    pcVar7 = free_exref;
    local_4._0_1_ = 1;
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    FUN_0041a1f0("ConfigServer: Wrong entry name",bVar2);
    FUN_00421680(3,1);
    local_4 = (uint)local_4._1_3_ << 8;
    if (param_2 != (void *)0x0) {
      free(param_2);
    }
  }
  else {
    pvVar8 = (void *)0x0;
    sVar9 = 0;
    if (param_5 != (void *)0x0) {
      FUN_0041b310();
      memcpy(pvVar8,param_5,param_6);
      *(undefined *)(param_6 + (int)pvVar8) = 0;
      sVar9 = param_6;
    }
    uVar6 = FUN_00422d60(*(void **)(iVar1 + 0x14),pvVar8,sVar9);
    if ((char)uVar6 == '\0') {
      puVar4 = FUN_0041b2a0(local_18,"SetEntry(%s,%s): Error, wrong value.");
      local_4._0_1_ = 3;
      puVar5 = (undefined1 *)*puVar4;
      if (puVar5 == (undefined1 *)0x0) {
        puVar5 = &DAT_0044d0d5;
      }
      FUN_0041a1b0(puVar5,bVar2);
      pcVar7 = free_exref;
      local_4 = CONCAT31(local_4._1_3_,1);
      if (local_18[0] != (void *)0x0) {
        free(local_18[0]);
      }
      FUN_0041a1f0("ConfigServer: Wrong entry value",bVar2);
      FUN_00421680(3,2);
    }
    else {
      puVar4 = FUN_0041b2a0(local_18,"SetEntry(%s,%s): Ok.");
      local_4._0_1_ = 4;
      puVar5 = (undefined1 *)*puVar4;
      if (puVar5 == (undefined1 *)0x0) {
        puVar5 = &DAT_0044d0d5;
      }
      FUN_0041a1b0(puVar5,bVar2);
      pcVar7 = free_exref;
      local_4 = CONCAT31(local_4._1_3_,1);
      if (local_18[0] != (void *)0x0) {
        free(local_18[0]);
      }
      FUN_004215f0();
    }
    local_4 = local_4 & 0xffffff00;
    if (param_2 != (void *)0x0) {
      (*pcVar7)();
    }
  }
  if (param_5 != (void *)0x0) {
    local_4 = 0xffffffff;
    (*pcVar7)();
  }
  ExceptionList = local_c;
  return;
}



void FUN_00421240(int param_1,void *param_2,size_t param_3)

{
  int iVar1;
  undefined *puVar2;
  byte bVar3;
  int *piVar4;
  undefined4 *puVar5;
  undefined1 *puVar6;
  void *_Dst;
  size_t sVar7;
  undefined *local_24 [3];
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439848;
  local_c = ExceptionList;
  bVar3 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffcc;
  ExceptionList = &local_c;
  local_4 = 0;
  puVar6 = &DAT_0044d0d5;
  if (param_2 != (void *)0x0) {
    puVar6 = (undefined1 *)param_2;
  }
  FUN_0041a190("ConfigServer: RestoreEntry(%s)",(char)puVar6);
  local_24[0] = &stack0xffffffbc;
  _Dst = (void *)0x0;
  sVar7 = 0;
  puVar2 = &stack0xffffffbc;
  if (param_2 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_2,param_3);
    *(undefined *)(param_3 + (int)_Dst) = 0;
    sVar7 = param_3;
    puVar2 = local_24[0];
  }
  local_24[0] = puVar2;
  piVar4 = FUN_00421e80(param_1 + 0xd8,local_24,_Dst,sVar7);
  iVar1 = *piVar4;
  if ((piVar4[1] == 0) || (iVar1 == 0)) {
    puVar5 = FUN_0041b2a0(local_24,"RestoreEntry(%s,%s): Error, wrong entry name.");
    local_4._0_1_ = 1;
    puVar6 = (undefined1 *)*puVar5;
    if (puVar6 == (undefined1 *)0x0) {
      puVar6 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar6,bVar3);
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_24[0] != (undefined *)0x0) {
      free(local_24[0]);
    }
    FUN_0041a1f0("ConfigServer: Wrong entry name",bVar3);
    FUN_00421680(3,1);
    local_4 = 0xffffffff;
    if (param_2 != (void *)0x0) {
      free(param_2);
    }
  }
  else {
    puVar5 = FUN_0041b2a0(local_18,"RestoreEntry(%s): Ok.");
    local_4._0_1_ = 2;
    puVar6 = (undefined1 *)*puVar5;
    if (puVar6 == (undefined1 *)0x0) {
      puVar6 = &DAT_0044d0d5;
    }
    FUN_0041a1b0(puVar6,bVar3);
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    iVar1 = *(int *)(iVar1 + 0x14);
    if (*(int *)(iVar1 + 0x34) != *(int *)(iVar1 + 0x10)) {
      FUN_0041b310();
      memcpy(*(void **)(iVar1 + 0x10),*(void **)(iVar1 + 0x34),*(size_t *)(iVar1 + 0x38));
      *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x38);
      *(undefined *)(*(int *)(iVar1 + 0x38) + (int)*(void **)(iVar1 + 0x10)) = 0;
    }
    FUN_004215f0();
    local_4 = 0xffffffff;
    if (param_2 != (void *)0x0) {
      free(param_2);
    }
  }
  ExceptionList = local_c;
  return;
}



void FUN_00421420(undefined4 param_1,undefined4 param_2)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  uint uVar4;
  uint uVar5;
  int unaff_EDI;
  void *local_64 [3];
  void *local_58;
  byte bStack_4c;
  undefined4 uStack_4b;
  undefined4 uStack_47;
  undefined2 uStack_43;
  undefined2 uStack_41;
  undefined4 uStack_3f;
  byte bStack_3b;
  undefined uStack_3a;
  undefined4 local_38;
  SOCKET SStack_34;
  undefined4 uStack_1c;
  void *local_14;
  undefined *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00439fc0;
  local_14 = ExceptionList;
  bVar1 = (byte)DAT_0044a01c ^ (byte)&stack0xffffff90;
  ExceptionList = &local_14;
  FUN_00436ea0(&local_38);
  local_c = 0;
  puVar2 = (undefined4 *)FUN_0041cf20();
  local_c._0_1_ = 1;
  puVar3 = (undefined1 *)*puVar2;
  if (puVar3 == (undefined1 *)0x0) {
    puVar3 = &DAT_0044d0d5;
  }
  FUN_0041a190("ConfigServer: Ping(%s,%d)",(char)puVar3);
  local_c._0_1_ = 0;
  if (local_64[0] != (void *)0x0) {
    free(local_64[0]);
  }
  FUN_0041cf20();
  local_c._0_1_ = 2;
  puVar2 = FUN_0041b2a0(local_64,"Ping(%s,%d)");
  local_c._0_1_ = 3;
  puVar3 = (undefined1 *)*puVar2;
  if (puVar3 == (undefined1 *)0x0) {
    puVar3 = &DAT_0044d0d5;
  }
  FUN_0041a1b0(puVar3,bVar1);
  local_c._0_1_ = 2;
  if (local_64[0] != (void *)0x0) {
    free(local_64[0]);
  }
  local_c = (uint)local_c._1_3_ << 8;
  if (local_58 != (void *)0x0) {
    free(local_58);
  }
  uStack_3f = *(undefined4 *)(unaff_EDI + 0x140);
  bStack_4c = 2;
  uStack_4b = *(undefined4 *)(unaff_EDI + 0x144);
  uStack_47 = 0x13;
  uStack_43 = 0xc0;
  uStack_41 = 0;
  uStack_3a = 3;
  bStack_3b = 2;
  uVar4 = 1;
  do {
    uVar5 = uVar4 + 4;
    bStack_3b = bStack_3b ^
                (&bStack_4c)[uVar4] ^ *(byte *)((int)&uStack_4b + uVar4) ^
                *(byte *)((int)&uStack_4b + uVar4 + 2) ^ *(byte *)((int)&uStack_4b + uVar4 + 1);
    uVar4 = uVar5;
  } while (uVar5 < 0x11);
  FUN_00436fc0(param_1,param_2);
  FUN_004371e0(&bStack_4c,(int)&local_38,uStack_1c,0x13);
  Sleep(0xfa);
  if ((SStack_34 != 0) && (SStack_34 != 0xffffffff)) {
    closesocket(SStack_34);
  }
  uStack_1c = 0;
  SStack_34 = 0;
  local_c = 0xffffffff;
  FUN_00436f20(&local_38);
  ExceptionList = local_14;
  return;
}



void FUN_004215f0(void)

{
  int in_EAX;
  uint uVar1;
  uint uVar2;
  undefined1 unaff_SI;
  byte local_14;
  undefined4 local_13;
  undefined4 local_f;
  undefined2 local_b;
  undefined2 local_9;
  undefined4 local_7;
  byte local_3;
  undefined local_2;
  
  FUN_0041a190("ConfigServer: Sending ACK",unaff_SI);
  local_13 = *(undefined4 *)(in_EAX + 0x144);
  local_14 = 2;
  local_f = 0x13;
  local_b = 0xc0;
  local_9 = 0;
  local_7 = *(undefined4 *)(in_EAX + 0x140);
  local_2 = 3;
  local_3 = 2;
  uVar1 = 1;
  do {
    uVar2 = uVar1 + 4;
    local_3 = local_3 ^ (&local_14)[uVar1] ^ *(byte *)((int)&local_13 + uVar1) ^
                        *(byte *)((int)&local_13 + uVar1 + 2) ^
                        *(byte *)((int)&local_13 + uVar1 + 1);
    uVar1 = uVar2;
  } while (uVar2 < 0x11);
  FUN_004371e0(&local_14,in_EAX + 0xb8,*(undefined4 *)(in_EAX + 0xd4),0x13);
  return;
}



void FUN_00421680(undefined param_1,undefined param_2)

{
  int in_EAX;
  uint uVar1;
  uint uVar2;
  undefined1 unaff_SI;
  byte local_18;
  undefined4 local_17;
  undefined4 local_13;
  undefined2 local_f;
  undefined2 local_d;
  undefined4 local_b;
  undefined local_7;
  undefined local_6;
  byte local_5;
  undefined local_4;
  
  FUN_0041a190("ConfigServer: Sending NAK",unaff_SI);
  local_17 = *(undefined4 *)(in_EAX + 0x144);
  local_b = *(undefined4 *)(in_EAX + 0x140);
  local_7 = param_1;
  local_18 = 2;
  local_13 = 0x15;
  local_f = 0xc1;
  local_d = 0;
  local_6 = param_2;
  local_4 = 3;
  local_5 = 2;
  uVar1 = 1;
  do {
    uVar2 = uVar1 + 6;
    local_5 = local_5 ^ (&local_18)[uVar1] ^ *(byte *)((int)&local_17 + uVar1) ^
                        *(byte *)((int)&local_17 + uVar1 + 1) ^
                        *(byte *)((int)&local_17 + uVar1 + 2) ^ *(byte *)((int)&local_13 + uVar1) ^
                        *(byte *)((int)&local_17 + uVar1 + 3);
    uVar1 = uVar2;
  } while (uVar2 < 0x13);
  FUN_004371e0(&local_18,in_EAX + 0xb8,*(undefined4 *)(in_EAX + 0xd4),0x15);
  return;
}



void FUN_00421730(undefined4 param_1)

{
  int in_EAX;
  uint uVar1;
  uint uVar2;
  undefined1 unaff_SI;
  byte local_18;
  undefined4 local_17;
  undefined4 local_13;
  undefined2 local_f;
  undefined2 local_d;
  undefined4 local_b;
  undefined4 local_7;
  byte local_3;
  undefined local_2;
  
  FUN_0041a190("ConfigServer: Sending Login response",unaff_SI);
  local_17 = *(undefined4 *)(in_EAX + 0x144);
  local_3 = 2;
  local_7 = param_1;
  local_18 = 2;
  local_13 = 0x17;
  local_f = 0xa1;
  local_d = 0;
  local_b = *(undefined4 *)(in_EAX + 0x140);
  local_2 = 3;
  uVar1 = 1;
  do {
    uVar2 = uVar1 + 5;
    local_3 = local_3 ^ (&local_18)[uVar1] ^ *(byte *)((int)&local_17 + uVar1) ^
                        *(byte *)((int)&local_17 + uVar1 + 1) ^
                        *(byte *)((int)&local_17 + uVar1 + 3) ^
                        *(byte *)((int)&local_17 + uVar1 + 2);
    uVar1 = uVar2;
  } while (uVar2 < 0x15);
  FUN_004371e0(&local_18,in_EAX + 0xb8,*(undefined4 *)(in_EAX + 0xd4),0x17);
  return;
}



void __fastcall FUN_004217d0(int param_1)

{
  char **ppcVar1;
  char *pcVar2;
  uint uVar3;
  undefined1 unaff_SI;
  int unaff_EDI;
  void *local_94 [3];
  byte local_88;
  undefined4 local_87;
  undefined4 local_83;
  undefined2 local_7f;
  undefined2 local_7d;
  undefined4 local_7b;
  char local_77 [63];
  undefined local_38;
  undefined local_37;
  undefined local_36;
  undefined local_35;
  undefined4 local_34;
  char acStack_30 [14];
  undefined uStack_22;
  char acStack_21 [17];
  undefined uStack_10;
  undefined4 uStack_f;
  undefined uStack_b;
  undefined uStack_a;
  undefined uStack_9;
  byte bStack_8;
  undefined uStack_7;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)local_94;
  FUN_0041a190("ConfigServer: Sending SysInfo response",unaff_SI);
  local_87 = *(undefined4 *)(unaff_EDI + 0x144);
  local_7b = *(undefined4 *)(unaff_EDI + 0x140);
  local_88 = 2;
  local_83 = 0x82;
  local_7f = 0xa7;
  local_7d = 1;
  ppcVar1 = (char **)FUN_00422400(param_1);
  pcVar2 = *ppcVar1;
  if (pcVar2 == (char *)0x0) {
    pcVar2 = &DAT_0044d0d5;
  }
  strncpy(local_77,pcVar2,0x3f);
  if (local_94[0] != (void *)0x0) {
    free(local_94[0]);
  }
  local_37 = *(undefined *)(param_1 + 0x30);
  local_36 = *(undefined *)(param_1 + 0x34);
  local_35 = *(undefined *)(param_1 + 0x38);
  local_34 = *(undefined4 *)(param_1 + 0x10);
  local_38 = 0;
  ppcVar1 = (char **)FUN_00422450(param_1);
  pcVar2 = *ppcVar1;
  if (pcVar2 == (char *)0x0) {
    pcVar2 = &DAT_0044d0d5;
  }
  strncpy(acStack_30,pcVar2,0xe);
  if (local_94[0] != (void *)0x0) {
    free(local_94[0]);
  }
  uStack_22 = 0;
  ppcVar1 = (char **)FUN_004224a0(param_1);
  pcVar2 = *ppcVar1;
  if (pcVar2 == (char *)0x0) {
    pcVar2 = &DAT_0044d0d5;
  }
  strncpy(acStack_21,pcVar2,0x11);
  if (local_94[0] != (void *)0x0) {
    free(local_94[0]);
  }
  uStack_f = *(undefined4 *)(param_1 + 0x2c);
  uStack_b = *(undefined *)(param_1 + 0x3c);
  uStack_9 = *(undefined *)(param_1 + 0x44);
  uStack_10 = 0;
  uStack_a = *(undefined *)(param_1 + 0x40);
  uStack_7 = 3;
  uVar3 = 1;
  bStack_8 = local_88;
  do {
    bStack_8 = bStack_8 ^ (&local_88)[uVar3];
    uVar3 = uVar3 + 1;
  } while (uVar3 < 0x80);
  FUN_004371e0(&local_88,unaff_EDI + 0xb8,*(undefined4 *)(unaff_EDI + 0xd4),0x82);
  ___security_check_cookie_4(local_4 ^ (uint)local_94);
  return;
}



void FUN_00421990(void)

{
  int in_EAX;
  uint uVar1;
  uint uVar2;
  undefined1 unaff_SI;
  byte local_18;
  undefined4 local_17;
  undefined4 local_13;
  undefined2 local_f;
  undefined2 local_d;
  undefined4 local_b;
  undefined4 local_7;
  byte local_3;
  undefined local_2;
  
  FUN_0041a190("ConfigServer: Sending EntriesCount response",unaff_SI);
  local_17 = *(undefined4 *)(in_EAX + 0x144);
  local_3 = 2;
  local_7 = *(undefined4 *)(in_EAX + 0xe4);
  local_18 = 2;
  local_13 = 0x17;
  local_f = 0xad;
  local_d = 0;
  local_b = *(undefined4 *)(in_EAX + 0x140);
  local_2 = 3;
  uVar1 = 1;
  do {
    uVar2 = uVar1 + 5;
    local_3 = local_3 ^ (&local_18)[uVar1] ^ *(byte *)((int)&local_17 + uVar1) ^
                        *(byte *)((int)&local_17 + uVar1 + 1) ^
                        *(byte *)((int)&local_17 + uVar1 + 3) ^
                        *(byte *)((int)&local_17 + uVar1 + 2);
    uVar1 = uVar2;
  } while (uVar2 < 0x15);
  FUN_004371e0(&local_18,in_EAX + 0xb8,*(undefined4 *)(in_EAX + 0xd4),0x17);
  return;
}



void FUN_00421a30(int param_1,char *param_2,undefined4 param_3,undefined4 param_4,char *param_5,
                 undefined4 param_6,undefined4 param_7,char *param_8,undefined4 param_9,
                 undefined4 param_10,char *param_11)

{
  char *pcVar1;
  uint uVar2;
  uint uVar3;
  byte local_4a4;
  undefined4 local_4a3;
  undefined4 local_49f;
  undefined2 local_49b;
  undefined2 local_499;
  undefined4 local_497;
  char local_493 [63];
  undefined local_454;
  char local_453 [63];
  undefined local_414;
  char local_413 [511];
  undefined local_214;
  char local_213 [511];
  undefined local_14;
  byte local_13;
  undefined local_12;
  uint local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439140;
  local_c = ExceptionList;
  local_10 = DAT_0044a01c ^ (uint)&local_4a4;
  ExceptionList = &local_c;
  local_4 = 3;
  pcVar1 = &DAT_0044d0d5;
  if (param_2 != (char *)0x0) {
    pcVar1 = param_2;
  }
  FUN_0041a190("ConfigServer: Sending Entry response (%s)",(char)pcVar1);
  local_4a3 = *(undefined4 *)(param_1 + 0x144);
  local_497 = *(undefined4 *)(param_1 + 0x140);
  local_4a4 = 2;
  local_49f = 0x493;
  local_49b = 0xae;
  local_499 = 0;
  pcVar1 = &DAT_0044d0d5;
  if (param_2 != (char *)0x0) {
    pcVar1 = param_2;
  }
  strncpy(local_493,pcVar1,0x3f);
  local_454 = 0;
  pcVar1 = param_5;
  if (param_5 == (char *)0x0) {
    pcVar1 = &DAT_0044d0d5;
  }
  strncpy(local_453,pcVar1,0x3f);
  local_414 = 0;
  pcVar1 = param_8;
  if (param_8 == (char *)0x0) {
    pcVar1 = &DAT_0044d0d5;
  }
  strncpy(local_413,pcVar1,0x1ff);
  local_214 = 0;
  pcVar1 = param_11;
  if (param_11 == (char *)0x0) {
    pcVar1 = &DAT_0044d0d5;
  }
  strncpy(local_213,pcVar1,0x1ff);
  local_14 = 0;
  local_12 = 3;
  uVar2 = 1;
  local_13 = local_4a4;
  do {
    uVar3 = uVar2 + 4;
    local_13 = (&local_4a4)[uVar2] ^ *(byte *)((int)&local_4a3 + uVar2) ^
               *(byte *)((int)&local_4a3 + uVar2 + 2) ^ local_13 ^
               *(byte *)((int)&local_4a3 + uVar2 + 1);
    uVar2 = uVar3;
  } while (uVar3 < 0x491);
  FUN_004371e0(&local_4a4,param_1 + 0xb8,*(undefined4 *)(param_1 + 0xd4),0x493);
  local_4._0_1_ = 2;
  if (param_2 != (char *)0x0) {
    free(param_2);
  }
  local_4._0_1_ = 1;
  if (param_5 != (char *)0x0) {
    free(param_5);
  }
  local_4 = (uint)local_4._1_3_ << 8;
  if (param_8 != (char *)0x0) {
    free(param_8);
  }
  local_4 = 0xffffffff;
  if (param_11 != (char *)0x0) {
    free(param_11);
  }
  ExceptionList = local_c;
  ___security_check_cookie_4(local_10 ^ (uint)&local_4a4);
  return;
}



uint __fastcall FUN_00421c50(void *param_1)

{
  long *plVar1;
  int iVar2;
  byte bVar3;
  undefined4 uVar4;
  uint uVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  int unaff_EDI;
  undefined uVar6;
  char *pcVar7;
  int local_24 [3];
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_0043a4c8;
  local_c = ExceptionList;
  bVar3 = (byte)DAT_0044a01c ^ (byte)&stack0xffffffc8;
  ExceptionList = &local_c;
  FUN_0041b630(param_1,local_24);
  local_4 = 0;
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,"Global/SystemId");
  plVar1 = (long *)(unaff_EDI + 0x144);
  local_4._0_1_ = 1;
  uVar4 = FUN_0041bff0(local_24,(char *)local_18,plVar1);
  local_4._0_1_ = 0;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  if ((char)uVar4 == '\0') {
    pcVar7 = "ConfigurationServer: Missing or wrong configuration parameter (Global/SystemId)";
  }
  else {
    if (*plVar1 < 0) {
      *plVar1 = 0;
    }
    FUN_0041a1b0("ConfigurationServer: Unit identifier is %d",(char)*plVar1);
    FUN_0041aa80(extraout_ECX_00,(char *)0x7fffffff,"Communications/ConfigurationServerPort");
    local_4._0_1_ = 2;
    uVar4 = FUN_0041bff0(local_24,(char *)local_18,(long *)(unaff_EDI + 0x58));
    local_4._0_1_ = 0;
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
    if ((char)uVar4 != '\0') {
      iVar2 = *(long *)(unaff_EDI + 0x58);
      uVar6 = (undefined)iVar2;
      if (0 < iVar2) {
        FUN_0041a1b0("ConfigurationServer: Configuration server port is %d",uVar6);
        local_4 = 0xffffffff;
        uVar4 = FUN_00402ab0();
        ExceptionList = local_c;
        return CONCAT31((int3)((uint)uVar4 >> 8),1);
      }
      FUN_0041a1f0("ConfigurationServer: Invalid configuration parameter (Communications/ConfigurationServerPort=%d)"
                   ,uVar6);
      goto LAB_00421ce5;
    }
    pcVar7 = 
    "ConfigurationServer: Missing or wrong configuration parameter (Communications/ConfigurationServerPort)"
    ;
  }
  FUN_0041a1f0(pcVar7,bVar3);
LAB_00421ce5:
  local_4 = 0xffffffff;
  uVar5 = FUN_00402ab0();
  ExceptionList = local_c;
  return uVar5 & 0xffffff00;
}



void __fastcall FUN_00421dc0(undefined4 *param_1)

{
  *param_1 = aMap<class_aString,class_CConfigurationEntry*>::vftable;
  FUN_00422000();
  return;
}



void FUN_00421de0(int param_1,void *param_2,size_t param_3,undefined4 param_4,undefined4 param_5)

{
  void *_Dst;
  size_t sVar1;
  undefined4 uVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439808;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  _Dst = (void *)0x0;
  uVar2 = 0;
  sVar1 = 0;
  if (param_2 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_2,param_3);
    *(undefined *)(param_3 + (int)_Dst) = 0;
    sVar1 = param_3;
  }
  FUN_00421f60((int *)(param_1 + 4),_Dst,sVar1,uVar2,param_5);
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return;
}



undefined4 * FUN_00421e80(uint param_1,undefined4 *param_2,void *param_3,size_t param_4)

{
  undefined4 *puVar1;
  void *_Src;
  size_t _Size;
  undefined4 *puVar2;
  void *this;
  byte *_Dst;
  size_t sVar3;
  undefined4 uVar4;
  uint *puVar5;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  _Size = param_4;
  _Src = param_3;
  puStack_8 = &LAB_004390f8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  puVar5 = &param_1;
  local_4 = 0;
  _Dst = (byte *)0x0;
  uVar4 = 0;
  sVar3 = 0;
  if (param_3 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,_Src,_Size);
    _Dst[_Size] = 0;
    sVar3 = _Size;
  }
  this = (void *)(param_1 + 4);
  puVar2 = FUN_00422080(this,_Dst,sVar3,uVar4,puVar5);
  puVar1 = param_2;
  param_2[1] = this;
  *param_2 = puVar2;
  local_4 = 0xffffffff;
  if (_Src != (void *)0x0) {
    free(_Src);
  }
  ExceptionList = local_c;
  return puVar1;
}



undefined4 * __thiscall FUN_00421f30(void *this,byte param_1)

{
  *(undefined ***)this = aMap<class_aString,class_CConfigurationEntry*>::vftable;
  FUN_00422000();
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void FUN_00421f60(int *param_1,void *param_2,size_t param_3,undefined4 param_4,undefined4 param_5)

{
  undefined4 *puVar1;
  void *_Dst;
  size_t sVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438fe8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  _Dst = (void *)0x0;
  sVar2 = 0;
  if (param_2 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_2,param_3);
    *(undefined *)(param_3 + (int)_Dst) = 0;
    sVar2 = param_3;
  }
  puVar1 = FUN_004221c0(param_1,_Dst,sVar2);
  *puVar1 = param_5;
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return;
}



void FUN_00422000(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  void *pvVar3;
  void **unaff_EDI;
  
  if ((*unaff_EDI != (void *)0x0) && (pvVar3 = (void *)0x0, unaff_EDI[1] != (void *)0x0)) {
    do {
      for (puVar1 = *(undefined4 **)((int)*unaff_EDI + (int)pvVar3 * 4); puVar1 != (undefined4 *)0x0
          ; puVar1 = (undefined4 *)*puVar1) {
        if ((void *)puVar1[2] != (void *)0x0) {
          free((void *)puVar1[2]);
        }
      }
      pvVar3 = (void *)((int)pvVar3 + 1);
    } while (pvVar3 < unaff_EDI[1]);
  }
  operator_delete__(*unaff_EDI);
  *unaff_EDI = (void *)0x0;
  unaff_EDI[2] = (void *)0x0;
  unaff_EDI[3] = (void *)0x0;
  puVar1 = (undefined4 *)unaff_EDI[4];
  while (puVar1 != (undefined4 *)0x0) {
    puVar2 = (undefined4 *)*puVar1;
    operator_delete__(puVar1);
    puVar1 = puVar2;
  }
  unaff_EDI[4] = (void *)0x0;
  return;
}



undefined4 * __thiscall
FUN_00422080(void *this,byte *param_1,size_t param_2,undefined4 param_3,uint *param_4)

{
  byte bVar1;
  undefined4 *puVar2;
  uint uVar3;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  bool bVar7;
  char *_Dst;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004390c8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  _Dst = (char *)0x0;
  if (param_1 != (byte *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_1,param_2);
    _Dst[param_2] = '\0';
  }
  uVar3 = FUN_0040e5a0(_Dst);
  uVar3 = uVar3 % *(uint *)((int)this + 4);
  *param_4 = uVar3;
                    // WARNING: Load size is inaccurate
  if (*this != 0) {
    for (puVar2 = *(undefined4 **)(*this + uVar3 * 4); puVar2 != (undefined4 *)0x0;
        puVar2 = (undefined4 *)*puVar2) {
      pbVar6 = &DAT_0044d0d5;
      if (param_1 != (byte *)0x0) {
        pbVar6 = param_1;
      }
      pbVar4 = (byte *)puVar2[2];
      if (pbVar4 == (byte *)0x0) {
        if (pbVar6 == (byte *)0x0) goto LAB_004221a8;
        if (*pbVar6 == 0) goto LAB_00422142;
      }
      else if ((*pbVar4 == 0) || (pbVar6 != (byte *)0x0)) {
        if ((pbVar4 == (byte *)0x0) || (*pbVar4 == 0)) {
LAB_00422142:
          if ((pbVar6 == (byte *)0x0) || (*pbVar6 == 0)) goto LAB_004221a8;
        }
        do {
          bVar1 = *pbVar4;
          bVar7 = bVar1 < *pbVar6;
          if (bVar1 != *pbVar6) {
LAB_00422170:
            iVar5 = (1 - (uint)bVar7) - (uint)(bVar7 != 0);
            goto LAB_00422174;
          }
          if (bVar1 == 0) break;
          bVar1 = pbVar4[1];
          bVar7 = bVar1 < pbVar6[1];
          if (bVar1 != pbVar6[1]) goto LAB_00422170;
          pbVar4 = pbVar4 + 2;
          pbVar6 = pbVar6 + 2;
        } while (bVar1 != 0);
        iVar5 = 0;
LAB_00422174:
        if (iVar5 == 0) {
LAB_004221a8:
          local_4 = 0xffffffff;
          if (param_1 == (byte *)0x0) {
            ExceptionList = local_c;
            return puVar2;
          }
          free(param_1);
          ExceptionList = local_c;
          return puVar2;
        }
      }
    }
  }
  local_4 = 0xffffffff;
  if (param_1 != (byte *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return (undefined4 *)0x0;
}



undefined4 * FUN_004221c0(int *param_1,void *param_2,size_t param_3)

{
  void **ppvVar1;
  undefined *puVar2;
  undefined4 *puVar3;
  byte *_Dst;
  size_t sVar4;
  undefined4 uVar5;
  undefined **ppuVar6;
  undefined *local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004397d8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  ppuVar6 = &local_10;
  local_10 = &stack0xffffffcc;
  _Dst = (byte *)0x0;
  uVar5 = 0;
  sVar4 = 0;
  puVar2 = &stack0xffffffcc;
  if (param_2 != (void *)0x0) {
    FUN_0041b310();
    memcpy(_Dst,param_2,param_3);
    _Dst[param_3] = 0;
    sVar4 = param_3;
    puVar2 = local_10;
  }
  local_10 = puVar2;
  puVar3 = FUN_00422080(param_1,_Dst,sVar4,uVar5,(uint *)ppuVar6);
  if (puVar3 == (undefined4 *)0x0) {
    if (*param_1 == 0) {
      FUN_004061a0();
    }
    puVar3 = (undefined4 *)FUN_004222d0();
    ppvVar1 = (void **)(puVar3 + 2);
    puVar3[1] = local_10;
    if (param_2 != *ppvVar1) {
      FUN_0041b310();
      memcpy(*ppvVar1,param_2,param_3);
      puVar3[3] = param_3;
      *(undefined *)(param_3 + (int)*ppvVar1) = 0;
    }
    *puVar3 = *(undefined4 *)(*param_1 + (int)local_10 * 4);
    *(undefined4 **)(*param_1 + (int)local_10 * 4) = puVar3;
  }
  local_4 = 0xffffffff;
  if (param_2 != (void *)0x0) {
    free(param_2);
  }
  ExceptionList = local_c;
  return puVar3 + 5;
}



void FUN_004222d0(void)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int unaff_ESI;
  
  if (*(int *)(unaff_ESI + 0xc) == 0) {
    puVar4 = (undefined4 *)operator_new(*(int *)(unaff_ESI + 0x14) * 0x18 + 4);
    *puVar4 = *(undefined4 *)(unaff_ESI + 0x10);
    *(undefined4 **)(unaff_ESI + 0x10) = puVar4;
    iVar1 = *(int *)(unaff_ESI + 0x14);
    puVar4 = puVar4 + iVar1 * 6 + -5;
    while (iVar1 = iVar1 + -1, -1 < iVar1) {
      *puVar4 = *(undefined4 *)(unaff_ESI + 0xc);
      *(undefined4 **)(unaff_ESI + 0xc) = puVar4;
      puVar4 = puVar4 + -6;
    }
  }
  puVar2 = *(undefined4 **)(unaff_ESI + 0xc);
  uVar3 = *puVar2;
  *(int *)(unaff_ESI + 8) = *(int *)(unaff_ESI + 8) + 1;
  *(undefined4 *)(unaff_ESI + 0xc) = uVar3;
  puVar4 = puVar2 + 2;
  *puVar4 = 0;
  puVar2[3] = 0;
  puVar2[4] = 0;
  if (puVar4 != (undefined4 *)0x0) {
    *puVar4 = 0;
    puVar2[4] = 0;
    puVar2[3] = 0;
  }
  puVar2[5] = 0;
  return;
}



undefined4 * __thiscall FUN_00422350(void *this,byte param_1)

{
  FUN_00422370((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_00422370(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  uint local_4;
  
  puStack_8 = &LAB_00438056;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = CSysInfo::vftable;
  local_4 = 1;
  if ((void *)param_1[8] != (void *)0x0) {
    free((void *)param_1[8]);
  }
  local_4 = local_4 & 0xffffff00;
  if ((void *)param_1[5] != (void *)0x0) {
    free((void *)param_1[5]);
  }
  local_4 = 0xffffffff;
  if ((void *)param_1[1] != (void *)0x0) {
    free((void *)param_1[1]);
  }
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_00422400(int param_1)

{
  int iVar1;
  void *_Dst;
  void *pvVar2;
  void **in_EAX;
  
  iVar1 = *(int *)(param_1 + 4);
  *in_EAX = (void *)0x0;
  in_EAX[2] = (void *)0x0;
  in_EAX[1] = (void *)0x0;
  if (iVar1 != 0) {
    FUN_0041b310();
    _Dst = *in_EAX;
    memcpy(_Dst,*(void **)(param_1 + 4),*(size_t *)(param_1 + 8));
    pvVar2 = *(void **)(param_1 + 8);
    *(undefined *)((int)pvVar2 + (int)_Dst) = 0;
    in_EAX[1] = pvVar2;
  }
  return;
}



void __fastcall FUN_00422450(int param_1)

{
  int iVar1;
  void *_Dst;
  void *pvVar2;
  void **in_EAX;
  
  iVar1 = *(int *)(param_1 + 0x14);
  *in_EAX = (void *)0x0;
  in_EAX[2] = (void *)0x0;
  in_EAX[1] = (void *)0x0;
  if (iVar1 != 0) {
    FUN_0041b310();
    _Dst = *in_EAX;
    memcpy(_Dst,*(void **)(param_1 + 0x14),*(size_t *)(param_1 + 0x18));
    pvVar2 = *(void **)(param_1 + 0x18);
    *(undefined *)((int)pvVar2 + (int)_Dst) = 0;
    in_EAX[1] = pvVar2;
  }
  return;
}



void __fastcall FUN_004224a0(int param_1)

{
  int iVar1;
  void *_Dst;
  void *pvVar2;
  void **in_EAX;
  
  iVar1 = *(int *)(param_1 + 0x20);
  *in_EAX = (void *)0x0;
  in_EAX[2] = (void *)0x0;
  in_EAX[1] = (void *)0x0;
  if (iVar1 != 0) {
    FUN_0041b310();
    _Dst = *in_EAX;
    memcpy(_Dst,*(void **)(param_1 + 0x20),*(size_t *)(param_1 + 0x24));
    pvVar2 = *(void **)(param_1 + 0x24);
    *(undefined *)((int)pvVar2 + (int)_Dst) = 0;
    in_EAX[1] = pvVar2;
  }
  return;
}



void __fastcall FUN_004224f0(int param_1)

{
  char cVar1;
  undefined4 *puVar2;
  char *pcVar3;
  size_t _Size;
  char **ppcVar4;
  long lVar5;
  undefined4 uVar6;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  char *_Memory;
  __time64_t _Var7;
  int local_160;
  char *pcStack_15c;
  char *local_158;
  char *local_154;
  undefined4 local_150;
  char *apcStack_14c [3];
  char *pcStack_140;
  char *apcStack_13c [8];
  void *apvStack_11c [3];
  char local_110 [256];
  uint local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439f6f;
  local_c = ExceptionList;
  local_10 = DAT_0044a01c ^ (uint)&local_160;
  ExceptionList = &local_c;
  _Memory = (char *)0x0;
  local_158 = (char *)0x0;
  local_150 = 0;
  local_154 = (char *)0x0;
  local_4 = 0;
  local_160 = param_1;
  FUN_0041c840("Product name");
  ppcVar4 = (char **)(param_1 + 4);
  pcVar3 = local_110;
  if (pcVar3 != *ppcVar4) {
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    _Size = (int)pcVar3 - (int)(local_110 + 1);
    FUN_0041b310();
    memcpy(*ppcVar4,local_110,_Size);
    *(size_t *)(param_1 + 8) = _Size;
    (*ppcVar4)[_Size] = '\0';
    param_1 = local_160;
  }
  if (*(undefined4 **)(param_1 + 0x14) != &DAT_004434d4) {
    FUN_0041b310();
    puVar2 = *(undefined4 **)(int *)(param_1 + 0x14);
    *puVar2 = 0x34333231;
    puVar2[1] = 0x38373635;
    puVar2[2] = 0x32313039;
    *(undefined2 *)(puVar2 + 3) = 0x3433;
    *(undefined4 *)(param_1 + 0x18) = 0xe;
    *(undefined *)(*(int *)(param_1 + 0x14) + 0xe) = 0;
    param_1 = local_160;
  }
  if (*(undefined4 **)(param_1 + 0x20) != &DAT_004434e4) {
    FUN_0041b310();
    puVar2 = *(undefined4 **)(int *)(param_1 + 0x20);
    *puVar2 = 0x303a3130;
    puVar2[1] = 0x33303a32;
    puVar2[2] = 0x3a34303a;
    puVar2[3] = 0x303a3530;
    *(undefined *)(puVar2 + 4) = 0x36;
    *(undefined4 *)(param_1 + 0x24) = 0x11;
    *(undefined *)(*(int *)(param_1 + 0x20) + 0x11) = 0;
    param_1 = local_160;
  }
  _Var7 = _time64((__time64_t *)0x0);
  *(int *)(param_1 + 0x2c) = (int)_Var7 + -0xe10;
  *(undefined4 *)(param_1 + 0x10) = 0x4a1c6660;
  *(undefined4 *)(param_1 + 0x3c) = 3;
  *(undefined4 *)(param_1 + 0x40) = 0;
  *(undefined4 *)(param_1 + 0x44) = 0;
  FUN_0041c840("Product version");
  FUN_0041aa80(extraout_ECX,(char *)0x7fffffff,".\n");
  local_4._0_1_ = 1;
  FUN_0041aa80(extraout_ECX_00,(char *)0x7fffffff,local_110);
  local_4._0_1_ = 2;
  FUN_0041cae0(apvStack_11c,apcStack_13c,apcStack_14c);
  local_4._0_1_ = 4;
  if (apvStack_11c[0] != (void *)0x0) {
    free(apvStack_11c[0]);
  }
  local_4._0_1_ = 5;
  if (apcStack_14c[0] != (char *)0x0) {
    free(apcStack_14c[0]);
  }
  ppcVar4 = FUN_0041cc10(apcStack_13c,apcStack_14c);
  local_4._0_1_ = 6;
  if (*ppcVar4 != (char *)0x0) {
    FUN_0041b310();
    _Memory = local_158;
    memcpy(local_158,*ppcVar4,(size_t)ppcVar4[1]);
    local_154 = ppcVar4[1];
    local_154[(int)_Memory] = '\0';
    param_1 = local_160;
  }
  local_4._0_1_ = 5;
  if (apcStack_14c[0] != (char *)0x0) {
    free(apcStack_14c[0]);
  }
  pcVar3 = &DAT_0044d0d5;
  if (_Memory != (char *)0x0) {
    pcVar3 = _Memory;
  }
  lVar5 = strtol(pcVar3,&pcStack_15c,10);
  if ((*pcStack_15c == '\0') && (pcStack_15c != pcVar3)) {
    *(long *)(param_1 + 0x30) = lVar5;
    ppcVar4 = FUN_0041cc10(apcStack_13c,apcStack_14c);
    local_4._0_1_ = 7;
    if (*ppcVar4 != _Memory) {
      FUN_0041b310();
      _Memory = local_158;
      memcpy(local_158,*ppcVar4,(size_t)ppcVar4[1]);
      local_154 = ppcVar4[1];
      local_154[(int)_Memory] = '\0';
      param_1 = local_160;
    }
    local_4._0_1_ = 5;
    if (apcStack_14c[0] != (char *)0x0) {
      free(apcStack_14c[0]);
    }
    pcVar3 = &DAT_0044d0d5;
    if (_Memory != (char *)0x0) {
      pcVar3 = _Memory;
    }
    pcStack_15c = (char *)strtol(pcVar3,&pcStack_140,10);
    if ((*pcStack_140 == '\0') && (pcStack_140 != pcVar3)) {
      *(char **)(param_1 + 0x34) = pcStack_15c;
      ppcVar4 = FUN_0041cc10(apcStack_13c,apcStack_14c);
      local_4._0_1_ = 8;
      if (*ppcVar4 != _Memory) {
        FUN_0041b310();
        _Memory = local_158;
        memcpy(local_158,*ppcVar4,(size_t)ppcVar4[1]);
        local_154 = ppcVar4[1];
        local_154[(int)_Memory] = '\0';
        param_1 = local_160;
      }
      local_4._0_1_ = 5;
      if (apcStack_14c[0] != (char *)0x0) {
        free(apcStack_14c[0]);
      }
      uVar6 = FUN_0041b170((long *)&pcStack_15c);
      if ((char)uVar6 == '\0') {
        local_4 = (uint)local_4._1_3_ << 8;
        FUN_004037f0(apcStack_13c);
        local_4 = 0xffffffff;
        if (_Memory != (char *)0x0) {
          free(_Memory);
        }
      }
      else {
        *(char **)(param_1 + 0x38) = pcStack_15c;
        local_4 = (uint)local_4._1_3_ << 8;
        FUN_004037f0(apcStack_13c);
        local_4 = 0xffffffff;
        if (_Memory != (char *)0x0) {
          free(_Memory);
        }
      }
      goto LAB_00422926;
    }
  }
  local_4 = (uint)local_4._1_3_ << 8;
  FUN_004037f0(apcStack_13c);
  local_4 = 0xffffffff;
  if (_Memory != (char *)0x0) {
    free(_Memory);
  }
LAB_00422926:
  ExceptionList = local_c;
  ___security_check_cookie_4(local_10 ^ (uint)&local_160);
  return;
}



undefined4 * FUN_00422950(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438016;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = CConfigurationEntry::vftable;
  param_1[1] = 0;
  param_1[3] = 0;
  param_1[2] = 0;
  param_1[4] = 0;
  param_1[6] = 0;
  param_1[5] = 0;
  local_4 = 1;
  _eh_vector_constructor_iterator_
            (param_1 + 7,0xc,2,(_func_void_void_ptr *)&LAB_0041aa20,FUN_0041aaf0);
  param_1[0xd] = 0;
  param_1[0xf] = 0;
  param_1[0xe] = 0;
  param_1[0x10] = 0;
  param_1[0x12] = 0;
  param_1[0x11] = 0;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_004229e0(void *this,byte param_1)

{
  FUN_00422a00((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_00422a00(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00437fd7;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = CConfigurationEntry::vftable;
  local_4 = 3;
  if ((void *)param_1[0x10] != (void *)0x0) {
    free((void *)param_1[0x10]);
  }
  local_4._0_1_ = 2;
  if ((void *)param_1[0xd] != (void *)0x0) {
    free((void *)param_1[0xd]);
  }
  local_4._0_1_ = 1;
  _eh_vector_destructor_iterator_(param_1 + 7,0xc,2,FUN_0041aaf0);
  local_4 = (uint)local_4._1_3_ << 8;
  if ((void *)param_1[4] != (void *)0x0) {
    free((void *)param_1[4]);
  }
  local_4 = 0xffffffff;
  if ((void *)param_1[1] != (void *)0x0) {
    free((void *)param_1[1]);
  }
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_00422ab0(int param_1)

{
  int iVar1;
  void *_Dst;
  void *pvVar2;
  void **in_EAX;
  
  iVar1 = *(int *)(param_1 + 0x10);
  *in_EAX = (void *)0x0;
  in_EAX[2] = (void *)0x0;
  in_EAX[1] = (void *)0x0;
  if (iVar1 != 0) {
    FUN_0041b310();
    _Dst = *in_EAX;
    memcpy(_Dst,*(void **)(param_1 + 0x10),*(size_t *)(param_1 + 0x14));
    pvVar2 = *(void **)(param_1 + 0x14);
    *(undefined *)((int)pvVar2 + (int)_Dst) = 0;
    in_EAX[1] = pvVar2;
  }
  return;
}



void ** __fastcall FUN_00422b00(void **param_1,int param_2)

{
  void **ppvVar1;
  int iVar2;
  void *_Dst;
  void *pvVar3;
  int in_EAX;
  
  iVar2 = *(int *)(param_2 + 0x10 + in_EAX * 0xc);
  ppvVar1 = (void **)(param_2 + 0x10 + in_EAX * 0xc);
  *param_1 = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
  if (iVar2 != 0) {
    FUN_0041b310();
    _Dst = *param_1;
    memcpy(_Dst,*ppvVar1,(size_t)ppvVar1[1]);
    pvVar3 = ppvVar1[1];
    *(undefined *)((int)pvVar3 + (int)_Dst) = 0;
    param_1[1] = pvVar3;
  }
  return param_1;
}



undefined4
FUN_00422b50(int param_1,void *param_2,size_t param_3,undefined4 param_4,void *param_5,
            size_t param_6,undefined4 param_7,void *param_8,size_t param_9)

{
  void *pvVar1;
  void **ppvVar2;
  code *pcVar3;
  void *local_18 [3];
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004397a8;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 2;
  if (param_2 != *(void **)(param_1 + 4)) {
    FUN_0041b310();
    memcpy(*(void **)(param_1 + 4),param_2,param_3);
    *(size_t *)(param_1 + 8) = param_3;
    *(undefined *)(param_3 + (int)*(void **)(param_1 + 4)) = 0;
  }
  ppvVar2 = (void **)(param_1 + 0x10);
  if (param_5 != *(void **)(param_1 + 0x10)) {
    FUN_0041b310();
    memcpy(*ppvVar2,param_5,param_6);
    *(size_t *)(param_1 + 0x14) = param_6;
    *(undefined *)(param_6 + (int)*ppvVar2) = 0;
  }
  if (*ppvVar2 != *(void **)(param_1 + 0x40)) {
    FUN_0041b310();
    memcpy(*(void **)(param_1 + 0x40),*ppvVar2,*(size_t *)(param_1 + 0x14));
    *(int *)(param_1 + 0x44) = *(int *)(param_1 + 0x14);
    *(undefined *)(*(int *)(param_1 + 0x14) + (int)*(void **)(param_1 + 0x40)) = 0;
  }
  if (param_8 != *(void **)(param_1 + 0x34)) {
    FUN_0041b310();
    memcpy(*(void **)(param_1 + 0x34),param_8,param_9);
    *(size_t *)(param_1 + 0x38) = param_9;
    *(undefined *)(param_9 + (int)*(void **)(param_1 + 0x34)) = 0;
  }
  ppvVar2 = (void **)FUN_0041b510(local_18,(int *)local_18,"Description of variable ");
  local_4._0_1_ = 3;
  if (*ppvVar2 != *(void **)(param_1 + 0x1c)) {
    FUN_0041b310();
    memcpy(*(void **)(param_1 + 0x1c),*ppvVar2,(size_t)ppvVar2[1]);
    pvVar1 = ppvVar2[1];
    *(void **)(param_1 + 0x20) = pvVar1;
    *(undefined *)((int)pvVar1 + (int)*(void **)(param_1 + 0x1c)) = 0;
  }
  pcVar3 = free_exref;
  local_4._0_1_ = 2;
  if (local_18[0] != (void *)0x0) {
    free(local_18[0]);
  }
  ppvVar2 = (void **)FUN_0041b510(local_18,(int *)local_18,&DAT_00443520);
  local_4._0_1_ = 4;
  if (*ppvVar2 != *(void **)(param_1 + 0x28)) {
    FUN_0041b310();
    memcpy(*(void **)(param_1 + 0x28),*ppvVar2,(size_t)ppvVar2[1]);
    pcVar3 = free_exref;
    pvVar1 = ppvVar2[1];
    *(void **)(param_1 + 0x2c) = pvVar1;
    *(undefined *)((int)pvVar1 + (int)*(void **)(param_1 + 0x28)) = 0;
  }
  local_4._0_1_ = 2;
  if (local_18[0] != (void *)0x0) {
    (*pcVar3)(local_18[0]);
  }
  local_4._0_1_ = 1;
  if (param_2 != (void *)0x0) {
    (*pcVar3)(param_2);
  }
  local_4 = (uint)local_4._1_3_ << 8;
  if (param_5 != (void *)0x0) {
    (*pcVar3)(param_5);
  }
  local_4 = 0xffffffff;
  if (param_8 != (void *)0x0) {
    param_8 = (void *)(*pcVar3)(param_8);
  }
  ExceptionList = local_c;
  return CONCAT31((int3)((uint)param_8 >> 8),1);
}



undefined4 __thiscall FUN_00422d60(void *this,void *param_1,size_t param_2)

{
  void **ppvVar1;
  void **ppvVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438ad8;
  local_c = ExceptionList;
  ppvVar1 = &local_c;
  local_4 = 0;
  ppvVar2 = (void **)((int)this + 0x10);
  ExceptionList = ppvVar1;
  if (param_1 != *ppvVar2) {
    FUN_0041b310();
    ppvVar1 = (void **)memcpy(*ppvVar2,param_1,param_2);
    *(size_t *)((int)this + 0x14) = param_2;
    *(undefined *)(param_2 + (int)*ppvVar2) = 0;
  }
  local_4 = 0xffffffff;
  if (param_1 != (void *)0x0) {
    free(param_1);
  }
  ExceptionList = local_c;
  return CONCAT31((int3)((uint)ppvVar1 >> 8),1);
}



undefined4 FUN_00422df0(void)

{
  int *piVar1;
  int *in_EAX;
  code **ppcVar2;
  undefined4 uVar3;
  int iVar4;
  
  if (in_EAX[5] == 0xca) {
    ppcVar2 = (code **)(**(code **)in_EAX[1])();
    in_EAX[0x60] = (int)ppcVar2;
    *ppcVar2 = FUN_00426300;
    ppcVar2[1] = (code *)&LAB_00426460;
    *(undefined *)(ppcVar2 + 2) = 0;
    uVar3 = FUN_00426140();
    if (*(char *)(in_EAX + 0x10) != '\0') {
      in_EAX[5] = 0xcf;
      return CONCAT31((int3)((uint)uVar3 >> 8),1);
    }
    in_EAX[5] = 0xcb;
  }
  if (in_EAX[5] == 0xcb) {
    if (*(char *)(in_EAX[100] + 0x10) != '\0') {
      while( true ) {
        if ((code **)in_EAX[2] != (code **)0x0) {
          (**(code **)in_EAX[2])();
        }
        iVar4 = (**(code **)in_EAX[100])();
        if (iVar4 == 0) {
          return 0;
        }
        if (iVar4 == 2) break;
        if ((in_EAX[2] != 0) && ((iVar4 == 3 || (iVar4 == 1)))) {
          piVar1 = (int *)(in_EAX[2] + 4);
          *piVar1 = *piVar1 + 1;
          iVar4 = in_EAX[2];
          if (*(int *)(iVar4 + 8) <= *(int *)(iVar4 + 4)) {
            *(int *)(iVar4 + 8) = *(int *)(iVar4 + 8) + in_EAX[0x47];
          }
        }
      }
    }
    in_EAX[0x21] = in_EAX[0x1f];
    uVar3 = FUN_00422ef0();
    return uVar3;
  }
  if (in_EAX[5] != 0xcc) {
    *(undefined4 *)(*in_EAX + 0x14) = 0x14;
    *(int *)(*in_EAX + 0x18) = in_EAX[5];
    (**(code **)*in_EAX)();
  }
  uVar3 = FUN_00422ef0();
  return uVar3;
}



undefined4 FUN_00422ef0(void)

{
  uint *puVar1;
  uint uVar2;
  int in_EAX;
  uint uVar3;
  int unaff_ESI;
  
  if (*(int *)(unaff_ESI + 0x14) != 0xcc) {
    in_EAX = (***(code ***)(unaff_ESI + 0x180))();
    *(undefined4 *)(unaff_ESI + 0x78) = 0;
    *(undefined4 *)(unaff_ESI + 0x14) = 0xcc;
  }
  if (*(char *)(*(int *)(unaff_ESI + 0x180) + 8) != '\0') {
    puVar1 = (uint *)(unaff_ESI + 0x78);
    do {
      uVar3 = *puVar1;
      if (uVar3 < *(uint *)(unaff_ESI + 0x60)) {
        do {
          if (*(int *)(unaff_ESI + 8) != 0) {
            *(uint *)(*(int *)(unaff_ESI + 8) + 4) = uVar3;
            *(undefined4 *)(*(int *)(unaff_ESI + 8) + 8) = *(undefined4 *)(unaff_ESI + 0x60);
            (***(code ***)(unaff_ESI + 8))();
          }
          uVar2 = *puVar1;
          (**(code **)(*(int *)(unaff_ESI + 0x184) + 4))();
          uVar3 = *puVar1;
          if (uVar3 == uVar2) {
            return uVar3 & 0xffffff00;
          }
        } while (uVar3 < *(uint *)(unaff_ESI + 0x60));
      }
      (**(code **)(*(int *)(unaff_ESI + 0x180) + 4))();
      (***(code ***)(unaff_ESI + 0x180))();
      *puVar1 = 0;
      in_EAX = *(int *)(unaff_ESI + 0x180);
    } while (*(char *)(in_EAX + 8) != '\0');
  }
  *(uint *)(unaff_ESI + 0x14) = (*(char *)(unaff_ESI + 0x41) != '\0') + 0xcd;
  return CONCAT31((int3)((uint)in_EAX >> 8),1);
}



undefined4 FUN_00422fc0(void)

{
  int *unaff_ESI;
  
  if (unaff_ESI[5] != 0xcd) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    (**(code **)*unaff_ESI)();
  }
  if ((uint)unaff_ESI[0x18] <= (uint)unaff_ESI[0x1e]) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x7b;
    (**(code **)(*unaff_ESI + 4))();
    return 0;
  }
  if (unaff_ESI[2] != 0) {
    *(int *)(unaff_ESI[2] + 4) = unaff_ESI[0x1e];
    *(int *)(unaff_ESI[2] + 8) = unaff_ESI[0x18];
    (**(code **)unaff_ESI[2])();
  }
  (**(code **)(unaff_ESI[0x61] + 4))();
  unaff_ESI[0x1e] = unaff_ESI[0x1e];
  return 0;
}



void FUN_00423060(void)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 *in_EAX;
  code **ppcVar3;
  
  uVar1 = *in_EAX;
  uVar2 = in_EAX[3];
  in_EAX[1] = 0;
  memset(in_EAX,0,0x1b0);
  in_EAX[3] = uVar2;
  *in_EAX = uVar1;
  *(undefined *)(in_EAX + 4) = 1;
  FUN_00427530();
  in_EAX[2] = 0;
  in_EAX[6] = 0;
  in_EAX[0x24] = 0;
  in_EAX[0x25] = 0;
  in_EAX[0x26] = 0;
  in_EAX[0x27] = 0;
  in_EAX[0x28] = 0;
  in_EAX[0x2c] = 0;
  in_EAX[0x29] = 0;
  in_EAX[0x2d] = 0;
  in_EAX[0x2a] = 0;
  in_EAX[0x2e] = 0;
  in_EAX[0x2b] = 0;
  in_EAX[0x2f] = 0;
  in_EAX[0x43] = 0;
  FUN_00425a10();
  ppcVar3 = (code **)(**(code **)in_EAX[1])();
  in_EAX[100] = ppcVar3;
  *(undefined *)(ppcVar3 + 4) = 0;
  *(undefined *)((int)ppcVar3 + 0x11) = 0;
  *ppcVar3 = FUN_00426950;
  ppcVar3[1] = FUN_00426a10;
  ppcVar3[2] = FUN_004268f0;
  ppcVar3[3] = (code *)&LAB_00426930;
  *(undefined *)(ppcVar3 + 5) = 1;
  in_EAX[5] = 200;
  return;
}



void FUN_00423130(void)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *unaff_ESI;
  
  iVar1 = unaff_ESI[9];
  if (iVar1 == 1) {
    unaff_ESI[10] = 1;
    unaff_ESI[0xb] = 1;
    goto LAB_004232b2;
  }
  if (iVar1 != 3) {
    if (iVar1 == 4) {
      if ((*(char *)(unaff_ESI + 0x42) == '\0') || (*(char *)((int)unaff_ESI + 0x109) == '\0')) {
        unaff_ESI[10] = 4;
        unaff_ESI[0xb] = 4;
      }
      else {
        if (*(char *)((int)unaff_ESI + 0x109) != '\x02') {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x72;
          *(uint *)(*unaff_ESI + 0x18) = (uint)*(byte *)((int)unaff_ESI + 0x109);
          (**(code **)(*unaff_ESI + 4))();
        }
        unaff_ESI[10] = 5;
        unaff_ESI[0xb] = 4;
      }
    }
    else {
      unaff_ESI[10] = 0;
      unaff_ESI[0xb] = 0;
    }
    goto LAB_004232b2;
  }
  if (*(char *)(unaff_ESI + 0x40) == '\0') {
    if (*(char *)(unaff_ESI + 0x42) == '\0') {
      piVar2 = (int *)unaff_ESI[0x31];
      iVar1 = *piVar2;
      iVar3 = piVar2[0x15];
      iVar4 = piVar2[0x2a];
      if (iVar1 == 1) {
        if ((iVar3 == 2) && (iVar4 == 3)) {
          unaff_ESI[10] = 3;
          unaff_ESI[0xb] = 2;
          goto LAB_004232b2;
        }
      }
      else if (((iVar1 == 0x52) && (iVar3 == 0x47)) && (iVar4 == 0x42)) goto LAB_00423263;
      iVar5 = *unaff_ESI;
      *(int *)(iVar5 + 0x18) = iVar1;
      *(int *)(iVar5 + 0x1c) = iVar3;
      *(int *)(iVar5 + 0x20) = iVar4;
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x6f;
      (**(code **)(*unaff_ESI + 4))();
      unaff_ESI[10] = 3;
      unaff_ESI[0xb] = 2;
      goto LAB_004232b2;
    }
    if (*(char *)((int)unaff_ESI + 0x109) == '\0') {
LAB_00423263:
      unaff_ESI[10] = 2;
      unaff_ESI[0xb] = 2;
      goto LAB_004232b2;
    }
    if (*(char *)((int)unaff_ESI + 0x109) != '\x01') {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x72;
      *(uint *)(*unaff_ESI + 0x18) = (uint)*(byte *)((int)unaff_ESI + 0x109);
      (**(code **)(*unaff_ESI + 4))();
      unaff_ESI[10] = 3;
      unaff_ESI[0xb] = 2;
      goto LAB_004232b2;
    }
  }
  unaff_ESI[10] = 3;
  unaff_ESI[0xb] = 2;
LAB_004232b2:
  unaff_ESI[0xc] = 1;
  unaff_ESI[0xd] = 1;
  *(undefined8 *)(unaff_ESI + 0xe) = 0x3ff0000000000000;
  *(undefined *)(unaff_ESI + 0x10) = 0;
  *(undefined *)((int)unaff_ESI + 0x41) = 0;
  unaff_ESI[0x11] = 0;
  *(undefined *)((int)unaff_ESI + 0x4a) = 0;
  unaff_ESI[0x1d] = 0;
  *(undefined *)(unaff_ESI + 0x16) = 0;
  *(undefined *)((int)unaff_ESI + 0x59) = 0;
  *(undefined *)((int)unaff_ESI + 0x5a) = 0;
  *(undefined *)(unaff_ESI + 0x12) = 1;
  *(undefined *)((int)unaff_ESI + 0x49) = 1;
  unaff_ESI[0x13] = 2;
  *(undefined *)(unaff_ESI + 0x14) = 1;
  unaff_ESI[0x15] = 0x100;
  return;
}



int FUN_00423300(void)

{
  int iVar1;
  int *unaff_ESI;
  
  if ((unaff_ESI[5] != 200) && (unaff_ESI[5] != 0xc9)) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    (**(code **)*unaff_ESI)();
  }
  iVar1 = FUN_004233a0();
  if (iVar1 == 1) {
    iVar1 = 1;
  }
  else if (iVar1 == 2) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x33;
    (**(code **)*unaff_ESI)();
    if (unaff_ESI[1] != 0) {
      (**(code **)(unaff_ESI[1] + 0x24))();
      if (*(char *)(unaff_ESI + 4) != '\0') {
        unaff_ESI[5] = 200;
        unaff_ESI[0x43] = 0;
        return 2;
      }
      unaff_ESI[5] = 100;
    }
    return 2;
  }
  return iVar1;
}



int FUN_004233a0(void)

{
  int *in_EAX;
  int iVar1;
  
  iVar1 = 0;
  switch(in_EAX[5]) {
  case 200:
    (**(code **)(in_EAX[100] + 4))();
    (**(code **)(in_EAX[6] + 8))();
    in_EAX[5] = 0xc9;
  case 0xc9:
    iVar1 = (**(code **)in_EAX[100])();
    if (iVar1 == 1) {
      FUN_00423130();
      in_EAX[5] = 0xca;
      return 1;
    }
    break;
  case 0xca:
    return 1;
  case 0xcb:
  case 0xcc:
  case 0xcd:
  case 0xce:
  case 0xcf:
  case 0xd0:
  case 0xd2:
    iVar1 = (**(code **)in_EAX[100])();
    return iVar1;
  default:
    *(undefined4 *)(*in_EAX + 0x14) = 0x14;
    *(int *)(*in_EAX + 0x18) = in_EAX[5];
    (**(code **)*in_EAX)();
  }
  return iVar1;
}



undefined4 FUN_00423460(void)

{
  char cVar1;
  int iVar2;
  int *unaff_ESI;
  
  iVar2 = unaff_ESI[5];
  if (((iVar2 == 0xcd) || (iVar2 == 0xce)) && (*(char *)(unaff_ESI + 0x10) == '\0')) {
    if ((uint)unaff_ESI[0x1e] < (uint)unaff_ESI[0x18]) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x43;
      (**(code **)*unaff_ESI)();
    }
    (**(code **)(unaff_ESI[0x60] + 4))();
    unaff_ESI[5] = 0xd2;
  }
  else if (iVar2 == 0xcf) {
    unaff_ESI[5] = 0xd2;
  }
  else if (iVar2 != 0xd2) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    (**(code **)*unaff_ESI)();
  }
  cVar1 = *(char *)(unaff_ESI[100] + 0x11);
  while (cVar1 == '\0') {
    iVar2 = (**(code **)unaff_ESI[100])();
    if (iVar2 == 0) {
      return 0;
    }
    cVar1 = *(char *)(unaff_ESI[100] + 0x11);
  }
  (**(code **)(unaff_ESI[6] + 0x18))();
  iVar2 = unaff_ESI[1];
  if (iVar2 != 0) {
    iVar2 = (**(code **)(iVar2 + 0x24))();
    if (*(char *)(unaff_ESI + 4) != '\0') {
      unaff_ESI[5] = 200;
      unaff_ESI[0x43] = 0;
      return CONCAT31((int3)((uint)iVar2 >> 8),1);
    }
    unaff_ESI[5] = 100;
  }
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}



void FUN_00423550(void)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 *unaff_ESI;
  
  uVar1 = unaff_ESI[3];
  uVar2 = *unaff_ESI;
  unaff_ESI[1] = 0;
  memset(unaff_ESI,0,0x168);
  *(undefined *)(unaff_ESI + 4) = 0;
  *unaff_ESI = uVar2;
  unaff_ESI[3] = uVar1;
  FUN_00427530();
  unaff_ESI[2] = 0;
  unaff_ESI[6] = 0;
  unaff_ESI[0x11] = 0;
  unaff_ESI[0x12] = 0;
  unaff_ESI[0x13] = 0;
  unaff_ESI[0x14] = 0;
  unaff_ESI[0x15] = 0;
  unaff_ESI[0x16] = 0;
  unaff_ESI[0x1a] = 0;
  unaff_ESI[0x17] = 0;
  unaff_ESI[0x1b] = 0;
  unaff_ESI[0x18] = 0;
  unaff_ESI[0x1c] = 0;
  unaff_ESI[0x19] = 0;
  unaff_ESI[0x1d] = 0;
  unaff_ESI[0x58] = 0;
  *(undefined8 *)(unaff_ESI + 0xc) = 0x3ff0000000000000;
  unaff_ESI[5] = 100;
  return;
}



void FUN_004235d0(void)

{
  int iVar1;
  char cVar2;
  code *pcVar3;
  int *unaff_ESI;
  uint uVar4;
  
  iVar1 = unaff_ESI[5];
  if ((iVar1 == 0x65) || (iVar1 == 0x66)) {
    if ((uint)unaff_ESI[0x34] < (uint)unaff_ESI[8]) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x43;
      (**(code **)*unaff_ESI)();
    }
    pcVar3 = *(code **)(unaff_ESI[0x4f] + 8);
  }
  else {
    if (iVar1 == 0x67) goto LAB_00423626;
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    pcVar3 = *(code **)*unaff_ESI;
  }
  (*pcVar3)();
LAB_00423626:
  cVar2 = *(char *)(unaff_ESI[0x4f] + 0xd);
  while (cVar2 == '\0') {
    (**(code **)unaff_ESI[0x4f])();
    uVar4 = 0;
    if (unaff_ESI[0x38] != 0) {
      do {
        if (unaff_ESI[2] != 0) {
          *(uint *)(unaff_ESI[2] + 4) = uVar4;
          *(int *)(unaff_ESI[2] + 8) = unaff_ESI[0x38];
          (**(code **)unaff_ESI[2])();
        }
        cVar2 = (**(code **)(unaff_ESI[0x52] + 4))();
        if (cVar2 == '\0') {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
          (**(code **)*unaff_ESI)();
        }
        uVar4 = uVar4 + 1;
      } while (uVar4 < (uint)unaff_ESI[0x38]);
    }
    (**(code **)(unaff_ESI[0x4f] + 8))();
    cVar2 = *(char *)(unaff_ESI[0x4f] + 0xd);
  }
  (**(code **)(unaff_ESI[0x53] + 0xc))();
  (**(code **)(unaff_ESI[6] + 0x10))();
  if (unaff_ESI[1] != 0) {
    (**(code **)(unaff_ESI[1] + 0x24))();
    if (*(char *)(unaff_ESI + 4) != '\0') {
      unaff_ESI[5] = 200;
      unaff_ESI[0x43] = 0;
      return;
    }
    unaff_ESI[5] = 100;
  }
  return;
}



void FUN_00423720(void)

{
  int iVar1;
  code *pcVar2;
  int in_EAX;
  int *unaff_ESI;
  
  if ((unaff_ESI[0x34] != 0) ||
     (((iVar1 = unaff_ESI[5], iVar1 != 0x65 && (iVar1 != 0x66)) && (iVar1 != 0x67)))) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    (**(code **)*unaff_ESI)();
  }
  (**(code **)(unaff_ESI[0x53] + 0x14))();
  pcVar2 = *(code **)(unaff_ESI[0x53] + 0x18);
  if (in_EAX != 0) {
    do {
      in_EAX = in_EAX + -1;
      (*pcVar2)();
    } while (in_EAX != 0);
  }
  return;
}



void __cdecl FUN_004237a0(int *param_1,int param_2,int param_3)

{
  int iVar1;
  int iVar2;
  int unaff_EBX;
  int *piVar3;
  
  if (param_1[5] != 100) {
    *(undefined4 *)(*param_1 + 0x14) = 0x14;
    *(int *)(*param_1 + 0x18) = param_1[5];
    (**(code **)*param_1)(param_1);
  }
  if (param_1[unaff_EBX + 0x12] == 0) {
    iVar1 = (**(code **)param_1[1])(param_1,0,0x82);
    *(undefined *)(iVar1 + 0x80) = 0;
    param_1[unaff_EBX + 0x12] = iVar1;
  }
  iVar1 = 0;
  piVar3 = (int *)(param_2 + 8);
  do {
    iVar2 = (piVar3[-2] * param_3 + 0x32) / 100;
    if (iVar2 < 1) {
      iVar2 = 1;
    }
    else if ((0x7fff < iVar2) || (0xff < iVar2)) {
      iVar2 = 0xff;
    }
    *(short *)(iVar1 + param_1[unaff_EBX + 0x12]) = (short)iVar2;
    iVar2 = (piVar3[-1] * param_3 + 0x32) / 100;
    if (iVar2 < 1) {
      iVar2 = 1;
    }
    else if ((0x7fff < iVar2) || (0xff < iVar2)) {
      iVar2 = 0xff;
    }
    *(short *)(param_1[unaff_EBX + 0x12] + 2 + iVar1) = (short)iVar2;
    iVar2 = (*piVar3 * param_3 + 0x32) / 100;
    if (iVar2 < 1) {
      iVar2 = 1;
    }
    else if ((0x7fff < iVar2) || (0xff < iVar2)) {
      iVar2 = 0xff;
    }
    *(short *)(param_1[unaff_EBX + 0x12] + 4 + iVar1) = (short)iVar2;
    iVar2 = (piVar3[1] * param_3 + 0x32) / 100;
    if (iVar2 < 1) {
      iVar2 = 1;
    }
    else if ((0x7fff < iVar2) || (0xff < iVar2)) {
      iVar2 = 0xff;
    }
    *(short *)(iVar1 + 6 + param_1[unaff_EBX + 0x12]) = (short)iVar2;
    iVar1 = iVar1 + 8;
    piVar3 = piVar3 + 4;
  } while (iVar1 < 0x80);
  *(undefined *)(param_1[unaff_EBX + 0x12] + 0x80) = 0;
  return;
}



void __fastcall FUN_00423930(int param_1)

{
  int iVar1;
  int *unaff_EDI;
  
  if (param_1 < 1) {
    iVar1 = 5000;
  }
  else {
    if (param_1 < 0x65) {
      if (param_1 < 0x32) {
        iVar1 = (int)(5000 / (longlong)param_1);
        goto LAB_0042395a;
      }
    }
    else {
      param_1 = 100;
    }
    iVar1 = (100 - param_1) * 2;
  }
LAB_0042395a:
  FUN_004237a0(unaff_EDI,0x4400c8,iVar1);
  FUN_004237a0(unaff_EDI,0x4401c8,iVar1);
  return;
}



void __cdecl FUN_00423990(int *param_1,void *param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte bVar4;
  undefined4 *puVar5;
  undefined4 *in_EAX;
  int iVar6;
  byte *pbVar7;
  int *unaff_EBX;
  size_t _Size;
  
  if (*param_1 == 0) {
    iVar6 = (**(code **)unaff_EBX[1])();
    *(undefined *)(iVar6 + 0x111) = 0;
    *param_1 = iVar6;
  }
  puVar5 = (undefined4 *)*param_1;
  *puVar5 = *in_EAX;
  puVar5[1] = in_EAX[1];
  puVar5[2] = in_EAX[2];
  puVar5[3] = in_EAX[3];
  *(undefined *)(puVar5 + 4) = *(undefined *)(in_EAX + 4);
  _Size = 0;
  pbVar7 = (byte *)((int)in_EAX + 3);
  iVar6 = 4;
  do {
    pbVar1 = pbVar7 + -1;
    pbVar2 = pbVar7 + -2;
    pbVar3 = pbVar7 + 1;
    bVar4 = *pbVar7;
    pbVar7 = pbVar7 + 4;
    iVar6 = iVar6 + -1;
    _Size = bVar4 + _Size + (uint)*pbVar2 + (uint)*pbVar1 + (uint)*pbVar3;
  } while (iVar6 != 0);
  if (((int)_Size < 1) || (0x100 < (int)_Size)) {
    *(undefined4 *)(*unaff_EBX + 0x14) = 8;
    (**(code **)*unaff_EBX)();
  }
  memcpy((void *)(*param_1 + 0x11),param_2,_Size);
  *(undefined *)(*param_1 + 0x111) = 0;
  return;
}



void FUN_00423a50(void)

{
  int in_EAX;
  
  FUN_00423990((int *)(in_EAX + 0x58),&DAT_004400bc);
  FUN_00423990((int *)(in_EAX + 0x68),&DAT_00440300);
  FUN_00423990((int *)(in_EAX + 0x5c),&DAT_004402dc);
  FUN_00423990((int *)(in_EAX + 0x6c),&DAT_004403b8);
  return;
}



void FUN_00423ab0(void)

{
  undefined4 *puVar1;
  int iVar2;
  int *piVar3;
  int *unaff_ESI;
  
  if (unaff_ESI[5] != 100) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    (**(code **)*unaff_ESI)();
  }
  if (unaff_ESI[0x11] == 0) {
    iVar2 = (**(code **)unaff_ESI[1])();
    unaff_ESI[0x11] = iVar2;
  }
  unaff_ESI[0xe] = 8;
  FUN_004237a0(unaff_ESI,0x4400c8,0x32);
  FUN_004237a0(unaff_ESI,0x4401c8,0x32);
  FUN_00423a50();
  piVar3 = unaff_ESI + 0x22;
  iVar2 = 0x10;
  do {
    *(undefined *)(piVar3 + -4) = 0;
    *(undefined *)piVar3 = 1;
    *(undefined *)(piVar3 + 4) = 5;
    piVar3 = (int *)((int)piVar3 + 1);
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  unaff_ESI[0x2b] = 0;
  unaff_ESI[0x2a] = 0;
  *(undefined *)(unaff_ESI + 0x2c) = 0;
  *(undefined *)((int)unaff_ESI + 0xb1) = 0;
  *(undefined *)((int)unaff_ESI + 0xb2) = 0;
  if (8 < unaff_ESI[0xe]) {
    *(undefined *)((int)unaff_ESI + 0xb2) = 1;
  }
  *(undefined *)((int)unaff_ESI + 0xb3) = 0;
  unaff_ESI[0x2d] = 0;
  unaff_ESI[0x2e] = 0;
  unaff_ESI[0x2f] = 0;
  unaff_ESI[0x30] = 0;
  *(undefined *)((int)unaff_ESI + 0xc5) = 1;
  *(undefined *)((int)unaff_ESI + 0xc6) = 1;
  *(undefined *)((int)unaff_ESI + 199) = 0;
  *(undefined2 *)(unaff_ESI + 0x32) = 1;
  *(undefined2 *)((int)unaff_ESI + 0xca) = 1;
  switch(unaff_ESI[10]) {
  case 0:
    FUN_00423cf0(unaff_ESI);
    return;
  case 1:
    FUN_00423cf0(unaff_ESI);
    return;
  case 2:
  case 3:
    FUN_00423cf0(unaff_ESI);
    return;
  case 4:
    FUN_00423cf0(unaff_ESI);
    return;
  case 5:
    break;
  default:
    *(undefined4 *)(*unaff_ESI + 0x14) = 9;
    (**(code **)*unaff_ESI)();
    return;
  }
  if (unaff_ESI[5] != 100) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    (**(code **)*unaff_ESI)();
  }
  puVar1 = (undefined4 *)unaff_ESI[0x11];
  unaff_ESI[0x10] = 5;
  unaff_ESI[0xf] = 4;
  *(undefined *)(unaff_ESI + 0x33) = 1;
  *(undefined *)(unaff_ESI + 0x31) = 0;
  *puVar1 = 1;
  puVar1[4] = 0;
  puVar1[5] = 0;
  puVar1[6] = 0;
  puVar1[2] = 2;
  puVar1[3] = 2;
  iVar2 = unaff_ESI[0x11];
  *(undefined4 *)(iVar2 + 0x54) = 2;
  *(undefined4 *)(iVar2 + 0x5c) = 1;
  *(undefined4 *)(iVar2 + 0x60) = 1;
  *(undefined4 *)(iVar2 + 100) = 1;
  *(undefined4 *)(iVar2 + 0x68) = 1;
  *(undefined4 *)(iVar2 + 0x6c) = 1;
  iVar2 = unaff_ESI[0x11];
  *(undefined4 *)(iVar2 + 0xa8) = 3;
  *(undefined4 *)(iVar2 + 0xb0) = 1;
  *(undefined4 *)(iVar2 + 0xb4) = 1;
  *(undefined4 *)(iVar2 + 0xb8) = 1;
  *(undefined4 *)(iVar2 + 0xbc) = 1;
  *(undefined4 *)(iVar2 + 0xc0) = 1;
  iVar2 = unaff_ESI[0x11];
  *(undefined4 *)(iVar2 + 0x104) = 2;
  *(undefined4 *)(iVar2 + 0x108) = 2;
  *(undefined4 *)(iVar2 + 0xfc) = 4;
  *(undefined4 *)(iVar2 + 0x10c) = 0;
  *(undefined4 *)(iVar2 + 0x110) = 0;
  *(undefined4 *)(iVar2 + 0x114) = 0;
  return;
}



void __fastcall FUN_00423cf0(int *param_1)

{
  int in_EAX;
  
  if (param_1[5] != 100) {
    *(undefined4 *)(*param_1 + 0x14) = 0x14;
    *(int *)(*param_1 + 0x18) = param_1[5];
    (**(code **)*param_1)(param_1);
  }
  param_1[0x10] = in_EAX;
  *(undefined *)(param_1 + 0x31) = 0;
  *(undefined *)(param_1 + 0x33) = 0;
                    // WARNING: Could not recover jumptable at 0x00423d29. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)(&PTR_LAB_00423fa0)[in_EAX])();
  return;
}



undefined4 FUN_00423fc0(void)

{
  undefined *puVar1;
  int iVar2;
  int *unaff_ESI;
  
  *(undefined4 *)(*unaff_ESI + 0x14) = 0x66;
  (**(code **)(*unaff_ESI + 4))();
  if (*(char *)(unaff_ESI[0x65] + 0xc) != '\0') {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x3d;
    (**(code **)*unaff_ESI)();
  }
  puVar1 = (undefined *)((int)unaff_ESI + 0xda);
  iVar2 = 0x10;
  do {
    puVar1[-0x10] = 0;
    *puVar1 = 1;
    puVar1[0x10] = 5;
    puVar1 = puVar1 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  unaff_ESI[0x3f] = 0;
  unaff_ESI[10] = 0;
  *(undefined *)((int)unaff_ESI + 0x10a) = 0;
  *(undefined *)(unaff_ESI + 0x40) = 0;
  *(undefined *)((int)unaff_ESI + 0x103) = 0;
  *(undefined *)(unaff_ESI + 0x42) = 0;
  *(undefined *)((int)unaff_ESI + 0x109) = 0;
  *(undefined *)((int)unaff_ESI + 0x101) = 1;
  *(undefined *)((int)unaff_ESI + 0x102) = 1;
  *(undefined2 *)(unaff_ESI + 0x41) = 1;
  *(undefined2 *)((int)unaff_ESI + 0x106) = 1;
  *(undefined *)(unaff_ESI[0x65] + 0xc) = 1;
  return CONCAT31((int3)((uint)puVar1 >> 8),1);
}



uint __fastcall FUN_00424070(undefined param_1)

{
  byte bVar1;
  byte bVar2;
  byte **ppbVar3;
  undefined in_AL;
  uint uVar4;
  int iVar5;
  byte *pbVar6;
  uint *puVar7;
  int *unaff_ESI;
  byte *pbVar8;
  byte *pbVar9;
  uint local_8;
  
  ppbVar3 = (byte **)unaff_ESI[6];
  pbVar6 = ppbVar3[1];
  pbVar8 = *ppbVar3;
  *(undefined *)(unaff_ESI + 0x32) = in_AL;
  *(undefined *)((int)unaff_ESI + 0xc9) = param_1;
  if (pbVar6 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004240a0;
    pbVar8 = *ppbVar3;
    pbVar6 = ppbVar3[1];
  }
  bVar1 = *pbVar8;
  pbVar6 = pbVar6 + -1;
  pbVar8 = pbVar8 + 1;
  if (pbVar6 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004240a0;
    pbVar8 = *ppbVar3;
    pbVar6 = ppbVar3[1];
  }
  bVar2 = *pbVar8;
  pbVar6 = pbVar6 + -1;
  pbVar8 = pbVar8 + 1;
  if (pbVar6 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004240a0;
    pbVar8 = *ppbVar3;
    pbVar6 = ppbVar3[1];
  }
  pbVar6 = pbVar6 + -1;
  pbVar9 = pbVar8 + 1;
  unaff_ESI[0x30] = (uint)*pbVar8;
  if (pbVar6 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004240a0;
    pbVar9 = *ppbVar3;
    pbVar6 = ppbVar3[1];
  }
  pbVar6 = pbVar6 + -1;
  pbVar8 = pbVar9 + 1;
  unaff_ESI[8] = (uint)*pbVar9 << 8;
  if (pbVar6 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004240a0;
    pbVar8 = *ppbVar3;
    pbVar6 = ppbVar3[1];
  }
  unaff_ESI[8] = unaff_ESI[8] + (uint)*pbVar8;
  pbVar6 = pbVar6 + -1;
  pbVar8 = pbVar8 + 1;
  if (pbVar6 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004240a0;
    pbVar8 = *ppbVar3;
    pbVar6 = ppbVar3[1];
  }
  pbVar6 = pbVar6 + -1;
  pbVar9 = pbVar8 + 1;
  unaff_ESI[7] = (uint)*pbVar8 << 8;
  if (pbVar6 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004240a0;
    pbVar9 = *ppbVar3;
    pbVar6 = ppbVar3[1];
  }
  unaff_ESI[7] = unaff_ESI[7] + (uint)*pbVar9;
  pbVar6 = pbVar6 + -1;
  pbVar9 = pbVar9 + 1;
  if (pbVar6 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') {
LAB_004240a0:
      return uVar4 & 0xffffff00;
    }
    pbVar9 = *ppbVar3;
    pbVar6 = ppbVar3[1];
  }
  iVar5 = *unaff_ESI;
  unaff_ESI[9] = (uint)*pbVar9;
  *(int *)(iVar5 + 0x18) = unaff_ESI[0x5f];
  *(int *)(iVar5 + 0x1c) = unaff_ESI[7];
  *(int *)(iVar5 + 0x20) = unaff_ESI[8];
  *(int *)(iVar5 + 0x24) = unaff_ESI[9];
  *(undefined4 *)(*unaff_ESI + 0x14) = 100;
  pbVar6 = pbVar6 + -1;
  pbVar9 = pbVar9 + 1;
  (**(code **)(*unaff_ESI + 4))();
  if (*(char *)(unaff_ESI[0x65] + 0xd) != '\0') {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x3a;
    (**(code **)*unaff_ESI)();
  }
  if (((unaff_ESI[8] == 0) || (unaff_ESI[7] == 0)) || (unaff_ESI[9] < 1)) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x20;
    (**(code **)*unaff_ESI)();
  }
  if ((uint)bVar1 * 0x100 + (uint)bVar2 + -8 != unaff_ESI[9] * 3) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0xb;
    (**(code **)*unaff_ESI)();
  }
  if (unaff_ESI[0x31] == 0) {
    iVar5 = (**(code **)unaff_ESI[1])();
    unaff_ESI[0x31] = iVar5;
  }
  puVar7 = (uint *)unaff_ESI[0x31];
  local_8 = 0;
  if (0 < unaff_ESI[9]) {
    do {
      puVar7[1] = local_8;
      if (pbVar6 == (byte *)0x0) {
        uVar4 = (*(code *)ppbVar3[3])();
        if ((char)uVar4 == '\0') goto LAB_004240a0;
        pbVar9 = *ppbVar3;
        pbVar6 = ppbVar3[1];
      }
      pbVar6 = pbVar6 + -1;
      pbVar8 = pbVar9 + 1;
      *puVar7 = (uint)*pbVar9;
      if (pbVar6 == (byte *)0x0) {
        uVar4 = (*(code *)ppbVar3[3])();
        if ((char)uVar4 == '\0') goto LAB_004240a0;
        pbVar8 = *ppbVar3;
        pbVar6 = ppbVar3[1];
      }
      bVar1 = *pbVar8;
      pbVar6 = pbVar6 + -1;
      pbVar8 = pbVar8 + 1;
      puVar7[2] = (int)(uint)bVar1 >> 4;
      puVar7[3] = bVar1 & 0xf;
      if (pbVar6 == (byte *)0x0) {
        uVar4 = (*(code *)ppbVar3[3])();
        if ((char)uVar4 == '\0') goto LAB_004240a0;
        pbVar8 = *ppbVar3;
        pbVar6 = ppbVar3[1];
      }
      puVar7[4] = (uint)*pbVar8;
      iVar5 = *unaff_ESI;
      *(uint *)(iVar5 + 0x18) = *puVar7;
      *(uint *)(iVar5 + 0x1c) = puVar7[2];
      *(uint *)(iVar5 + 0x20) = puVar7[3];
      *(uint *)(iVar5 + 0x24) = puVar7[4];
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x65;
      pbVar6 = pbVar6 + -1;
      pbVar9 = pbVar8 + 1;
      (**(code **)(*unaff_ESI + 4))();
      local_8 = local_8 + 1;
      puVar7 = puVar7 + 0x15;
    } while ((int)local_8 < unaff_ESI[9]);
  }
  *(undefined *)(unaff_ESI[0x65] + 0xd) = 1;
  *ppbVar3 = pbVar9;
  ppbVar3[1] = pbVar6;
  return CONCAT31((int3)((uint)ppbVar3 >> 8),1);
}



uint FUN_004243a0(void)

{
  byte bVar1;
  byte bVar2;
  byte **ppbVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  byte *pbVar8;
  byte *pbVar9;
  int *unaff_ESI;
  byte *pbVar10;
  uint *puVar11;
  uint **ppuStack_10;
  int iStack_8;
  
  ppbVar3 = (byte **)unaff_ESI[6];
  pbVar8 = *ppbVar3;
  pbVar10 = ppbVar3[1];
  if (*(char *)(unaff_ESI[0x65] + 0xd) == '\0') {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x3e;
    (**(code **)*unaff_ESI)();
  }
  if (pbVar10 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004243e3;
    pbVar10 = ppbVar3[1];
    pbVar8 = *ppbVar3;
  }
  bVar1 = *pbVar8;
  pbVar10 = pbVar10 + -1;
  pbVar8 = pbVar8 + 1;
  if (pbVar10 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004243e3;
    pbVar10 = ppbVar3[1];
    pbVar8 = *ppbVar3;
  }
  bVar2 = *pbVar8;
  pbVar10 = pbVar10 + -1;
  pbVar8 = pbVar8 + 1;
  if (pbVar10 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004243e3;
    pbVar10 = ppbVar3[1];
    pbVar8 = *ppbVar3;
  }
  uVar5 = (uint)*pbVar8;
  *(undefined4 *)(*unaff_ESI + 0x14) = 0x67;
  *(uint *)(*unaff_ESI + 0x18) = uVar5;
  pbVar10 = pbVar10 + -1;
  pbVar8 = pbVar8 + 1;
  (**(code **)(*unaff_ESI + 4))();
  if ((((uint)bVar1 * 0x100 + (uint)bVar2 != uVar5 * 2 + 6) || (uVar5 == 0)) || (4 < uVar5)) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0xb;
    (**(code **)*unaff_ESI)();
  }
  unaff_ESI[0x49] = uVar5;
  iStack_8 = 0;
  if (uVar5 != 0) {
    ppuStack_10 = (uint **)(unaff_ESI + 0x4a);
    do {
      if (pbVar10 == (byte *)0x0) {
        uVar4 = (*(code *)ppbVar3[3])();
        if ((char)uVar4 == '\0') goto LAB_004243e3;
        pbVar10 = ppbVar3[1];
        pbVar8 = *ppbVar3;
      }
      uVar6 = (uint)*pbVar8;
      pbVar10 = pbVar10 + -1;
      pbVar8 = pbVar8 + 1;
      if (pbVar10 == (byte *)0x0) {
        uVar4 = (*(code *)ppbVar3[3])();
        if ((char)uVar4 == '\0') goto LAB_004243e3;
        pbVar10 = ppbVar3[1];
        pbVar8 = *ppbVar3;
      }
      bVar1 = *pbVar8;
      pbVar10 = pbVar10 + -1;
      iVar7 = 0;
      pbVar8 = pbVar8 + 1;
      puVar11 = (uint *)unaff_ESI[0x31];
      if (0 < unaff_ESI[9]) {
        do {
          if (uVar6 == *puVar11) goto LAB_00424550;
          iVar7 = iVar7 + 1;
          puVar11 = puVar11 + 0x15;
        } while (iVar7 < unaff_ESI[9]);
      }
      *(undefined4 *)(*unaff_ESI + 0x14) = 5;
      *(uint *)(*unaff_ESI + 0x18) = uVar6;
      (**(code **)*unaff_ESI)();
LAB_00424550:
      *ppuStack_10 = puVar11;
      puVar11[5] = (int)(uint)bVar1 >> 4;
      puVar11[6] = bVar1 & 0xf;
      iVar7 = *unaff_ESI;
      *(uint *)(iVar7 + 0x18) = uVar6;
      *(uint *)(iVar7 + 0x1c) = puVar11[5];
      *(uint *)(iVar7 + 0x20) = puVar11[6];
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x68;
      (**(code **)(*unaff_ESI + 4))();
      ppuStack_10 = ppuStack_10 + 1;
      iStack_8 = iStack_8 + 1;
    } while (iStack_8 < (int)uVar5);
  }
  if (pbVar10 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004243e3;
    pbVar10 = ppbVar3[1];
    pbVar8 = *ppbVar3;
  }
  pbVar10 = pbVar10 + -1;
  pbVar9 = pbVar8 + 1;
  unaff_ESI[0x5b] = (uint)*pbVar8;
  if (pbVar10 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_004243e3;
    pbVar10 = ppbVar3[1];
    pbVar9 = *ppbVar3;
  }
  pbVar10 = pbVar10 + -1;
  pbVar8 = pbVar9 + 1;
  unaff_ESI[0x5c] = (uint)*pbVar9;
  if (pbVar10 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])();
    if ((char)uVar4 == '\0') {
LAB_004243e3:
      return uVar4 & 0xffffff00;
    }
    pbVar10 = ppbVar3[1];
    pbVar8 = *ppbVar3;
  }
  bVar1 = *pbVar8;
  unaff_ESI[0x5e] = bVar1 & 0xf;
  iVar7 = *unaff_ESI;
  unaff_ESI[0x5d] = (int)(uint)bVar1 >> 4;
  *(int *)(iVar7 + 0x18) = unaff_ESI[0x5b];
  *(int *)(iVar7 + 0x1c) = unaff_ESI[0x5c];
  *(int *)(iVar7 + 0x20) = unaff_ESI[0x5d];
  *(int *)(iVar7 + 0x24) = unaff_ESI[0x5e];
  *(undefined4 *)(*unaff_ESI + 0x14) = 0x69;
  (**(code **)(*unaff_ESI + 4))();
  iVar7 = unaff_ESI[0x65];
  *(undefined4 *)(iVar7 + 0x10) = 0;
  unaff_ESI[0x1f] = unaff_ESI[0x1f] + 1;
  ppbVar3[1] = pbVar10 + -1;
  *ppbVar3 = pbVar8 + 1;
  return CONCAT31((int3)((uint)iVar7 >> 8),1);
}



void __cdecl FUN_004246c0(int *param_1)

{
  byte **ppbVar1;
  char cVar2;
  uint uVar3;
  uint *puVar4;
  byte *pbVar5;
  byte *pbVar6;
  uint **ppuVar7;
  undefined4 *puVar8;
  int iVar9;
  int iVar10;
  undefined4 *puVar11;
  byte *pbStack_12c;
  int local_128;
  int iStack_124;
  byte **local_120;
  uint uStack_11c;
  undefined4 uStack_118;
  uint uStack_114;
  uint uStack_110;
  uint uStack_10c;
  byte bStack_108;
  undefined4 auStack_104 [64];
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&pbStack_12c;
  ppbVar1 = (byte **)param_1[6];
  pbVar6 = ppbVar1[1];
  pbVar5 = *ppbVar1;
  local_120 = ppbVar1;
  if (pbVar6 == (byte *)0x0) {
    cVar2 = (*(code *)ppbVar1[3])(param_1);
    if (cVar2 == '\0') goto LAB_004249e1;
    pbVar6 = ppbVar1[1];
    pbVar5 = *ppbVar1;
  }
  local_128 = (uint)*pbVar5 << 8;
  pbVar6 = pbVar6 + -1;
  pbVar5 = pbVar5 + 1;
  if (pbVar6 == (byte *)0x0) {
    cVar2 = (*(code *)ppbVar1[3])(param_1);
    if (cVar2 == '\0') goto LAB_004249e1;
    pbVar6 = ppbVar1[1];
    pbVar5 = *ppbVar1;
  }
  local_128 = local_128 + (uint)*pbVar5 + -2;
  pbVar5 = pbVar5 + 1;
  pbVar6 = pbVar6 + -1;
  while (0x10 < local_128) {
    if (pbVar6 == (byte *)0x0) {
      cVar2 = (*(code *)ppbVar1[3])(param_1);
      if (cVar2 == '\0') goto LAB_004249e1;
      pbVar6 = ppbVar1[1];
      pbVar5 = *ppbVar1;
      pbStack_12c = pbVar6;
    }
    uStack_11c = (uint)*pbVar5;
    *(undefined4 *)(*param_1 + 0x14) = 0x50;
    *(uint *)(*param_1 + 0x18) = uStack_11c;
    pbVar6 = pbVar6 + -1;
    pbVar5 = pbVar5 + 1;
    (**(code **)(*param_1 + 4))(param_1,1);
    uStack_118 = uStack_118 & 0xffffff00;
    iStack_124 = 0;
    iVar9 = 1;
    do {
      ppbVar1 = local_120;
      if (pbVar6 == (byte *)0x0) {
        cVar2 = (*(code *)local_120[3])(param_1);
        if (cVar2 == '\0') goto LAB_004249e1;
        pbVar6 = ppbVar1[1];
        pbVar5 = *ppbVar1;
      }
      iStack_124 = iStack_124 + (uint)*pbVar5;
      *(byte *)((int)&uStack_118 + iVar9) = *pbVar5;
      pbVar6 = pbVar6 + -1;
      iVar9 = iVar9 + 1;
      pbVar5 = pbVar5 + 1;
      pbStack_12c = pbVar6;
    } while (iVar9 < 0x11);
    iVar9 = *param_1;
    local_128 = local_128 + -0x11;
    *(uint *)(iVar9 + 0x18) = uStack_118 >> 8 & 0xff;
    *(uint *)(iVar9 + 0x1c) = uStack_118 >> 0x10 & 0xff;
    *(uint *)(iVar9 + 0x20) = uStack_118 >> 0x18;
    *(uint *)(iVar9 + 0x24) = uStack_114 & 0xff;
    *(uint *)(iVar9 + 0x28) = uStack_114 >> 8 & 0xff;
    *(uint *)(iVar9 + 0x2c) = uStack_114 >> 0x10 & 0xff;
    *(uint *)(iVar9 + 0x30) = uStack_114 >> 0x18;
    *(uint *)(iVar9 + 0x34) = uStack_110 & 0xff;
    *(undefined4 *)(*param_1 + 0x14) = 0x56;
    (**(code **)(*param_1 + 4))(param_1,2);
    iVar9 = *param_1;
    *(uint *)(iVar9 + 0x18) = uStack_110 >> 8 & 0xff;
    *(uint *)(iVar9 + 0x1c) = uStack_110 >> 0x10 & 0xff;
    *(uint *)(iVar9 + 0x20) = uStack_110 >> 0x18;
    *(uint *)(iVar9 + 0x24) = uStack_10c & 0xff;
    *(uint *)(iVar9 + 0x28) = uStack_10c >> 8 & 0xff;
    *(uint *)(iVar9 + 0x2c) = uStack_10c >> 0x10 & 0xff;
    *(uint *)(iVar9 + 0x30) = uStack_10c >> 0x18;
    *(uint *)(iVar9 + 0x34) = (uint)bStack_108;
    *(undefined4 *)(*param_1 + 0x14) = 0x56;
    (**(code **)(*param_1 + 4))(param_1,2);
    if ((0x100 < iStack_124) || (local_128 < iStack_124)) {
      *(undefined4 *)(*param_1 + 0x14) = 8;
      (**(code **)*param_1)(param_1);
    }
    iVar10 = 0;
    iVar9 = iStack_124;
    if (0 < iStack_124) {
      do {
        ppbVar1 = local_120;
        if (pbVar6 == (byte *)0x0) {
          cVar2 = (*(code *)local_120[3])(param_1);
          if (cVar2 == '\0') goto LAB_004249e1;
          pbVar6 = ppbVar1[1];
          pbVar5 = *ppbVar1;
          iVar9 = iStack_124;
        }
        *(byte *)((int)auStack_104 + iVar10) = *pbVar5;
        pbVar6 = pbVar6 + -1;
        iVar10 = iVar10 + 1;
        pbVar5 = pbVar5 + 1;
        pbStack_12c = pbVar6;
      } while (iVar10 < iVar9);
    }
    local_128 = local_128 - iVar9;
    if ((uStack_11c & 0x10) == 0) {
      iVar9 = uStack_11c + 0x28;
      uVar3 = uStack_11c;
    }
    else {
      iVar9 = uStack_11c + 0x1c;
      uVar3 = uStack_11c - 0x10;
    }
    ppuVar7 = (uint **)(param_1 + iVar9);
    if (((int)uVar3 < 0) || (3 < (int)uVar3)) {
      *(undefined4 *)(*param_1 + 0x14) = 0x1e;
      *(uint *)(*param_1 + 0x18) = uVar3;
      (**(code **)*param_1)(param_1);
    }
    if (*ppuVar7 == (uint *)0x0) {
      puVar4 = (uint *)(**(code **)param_1[1])(param_1,0,0x112);
      *(undefined *)((int)puVar4 + 0x111) = 0;
      *ppuVar7 = puVar4;
    }
    puVar4 = *ppuVar7;
    *puVar4 = uStack_118;
    puVar4[1] = uStack_114;
    puVar4[2] = uStack_110;
    puVar4[3] = uStack_10c;
    *(byte *)(puVar4 + 4) = bStack_108;
    puVar8 = auStack_104;
    puVar11 = (undefined4 *)((int)*ppuVar7 + 0x11);
    for (iVar9 = 0x40; ppbVar1 = local_120, pbVar6 = pbStack_12c, iVar9 != 0; iVar9 = iVar9 + -1) {
      *puVar11 = *puVar8;
      puVar8 = puVar8 + 1;
      puVar11 = puVar11 + 1;
    }
  }
  if (local_128 != 0) {
    *(undefined4 *)(*param_1 + 0x14) = 0xb;
    (**(code **)*param_1)(param_1);
  }
  *ppbVar1 = pbVar5;
  ppbVar1[1] = pbVar6;
LAB_004249e1:
  ___security_check_cookie_4(local_4 ^ (uint)&pbStack_12c);
  return;
}



uint FUN_00424a00(void)

{
  byte bVar1;
  byte **ppbVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  ushort uVar8;
  byte *pbVar9;
  byte *pbVar10;
  byte *pbVar11;
  ushort *puVar12;
  int *unaff_EDI;
  int *piStack_c;
  
  ppbVar2 = (byte **)unaff_EDI[6];
  pbVar9 = ppbVar2[1];
  pbVar10 = *ppbVar2;
  if (pbVar9 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar2[3])();
    if ((char)uVar4 == '\0') goto LAB_00424a23;
    pbVar10 = *ppbVar2;
    pbVar9 = ppbVar2[1];
  }
  bVar1 = *pbVar10;
  pbVar9 = pbVar9 + -1;
  pbVar10 = pbVar10 + 1;
  if (pbVar9 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar2[3])();
    if ((char)uVar4 == '\0') {
LAB_00424a23:
      return uVar4 & 0xffffff00;
    }
    pbVar10 = *ppbVar2;
    pbVar9 = ppbVar2[1];
  }
  pbVar9 = pbVar9 + -1;
  pbVar11 = pbVar10 + 1;
  iVar6 = CONCAT11(bVar1,*pbVar10) - 2;
  do {
    iVar7 = iVar6;
    if (iVar7 < 1) {
      if (iVar7 != 0) {
        *(undefined4 *)(*unaff_EDI + 0x14) = 0xb;
        iVar7 = (**(code **)*unaff_EDI)();
      }
      *ppbVar2 = pbVar11;
      ppbVar2[1] = pbVar9;
      return CONCAT31((int3)((uint)iVar7 >> 8),1);
    }
    if (pbVar9 == (byte *)0x0) {
      uVar4 = (*(code *)ppbVar2[3])();
      if ((char)uVar4 == '\0') goto LAB_00424a23;
      pbVar11 = *ppbVar2;
      pbVar9 = ppbVar2[1];
    }
    bVar1 = *pbVar11;
    *(undefined4 *)(*unaff_EDI + 0x14) = 0x51;
    iVar5 = (int)(uint)bVar1 >> 4;
    uVar4 = bVar1 & 0xf;
    *(uint *)(*unaff_EDI + 0x18) = uVar4;
    *(int *)(*unaff_EDI + 0x1c) = iVar5;
    pbVar9 = pbVar9 + -1;
    pbVar11 = pbVar11 + 1;
    (**(code **)(*unaff_EDI + 4))();
    if (3 < uVar4) {
      *(undefined4 *)(*unaff_EDI + 0x14) = 0x1f;
      *(uint *)(*unaff_EDI + 0x18) = uVar4;
      (**(code **)*unaff_EDI)();
    }
    if (unaff_EDI[uVar4 + 0x24] == 0) {
      iVar6 = (**(code **)unaff_EDI[1])();
      *(undefined *)(iVar6 + 0x80) = 0;
      unaff_EDI[uVar4 + 0x24] = iVar6;
    }
    iVar6 = unaff_EDI[uVar4 + 0x24];
    piStack_c = &DAT_0043fd78;
    do {
      if (iVar5 == 0) {
        if (pbVar9 == (byte *)0x0) {
          uVar4 = (*(code *)ppbVar2[3])();
          if ((char)uVar4 == '\0') goto LAB_00424a23;
          pbVar11 = *ppbVar2;
          pbVar9 = ppbVar2[1];
        }
        uVar8 = (ushort)*pbVar11;
      }
      else {
        if (pbVar9 == (byte *)0x0) {
          uVar4 = (*(code *)ppbVar2[3])();
          if ((char)uVar4 == '\0') goto LAB_00424a23;
          pbVar11 = *ppbVar2;
          pbVar9 = ppbVar2[1];
        }
        bVar1 = *pbVar11;
        pbVar9 = pbVar9 + -1;
        pbVar11 = pbVar11 + 1;
        if (pbVar9 == (byte *)0x0) {
          uVar4 = (*(code *)ppbVar2[3])();
          if ((char)uVar4 == '\0') goto LAB_00424a23;
          pbVar11 = *ppbVar2;
          pbVar9 = ppbVar2[1];
        }
        uVar8 = (ushort)bVar1 * 0x100 + (ushort)*pbVar11;
      }
      iVar3 = *piStack_c;
      piStack_c = piStack_c + 1;
      pbVar9 = pbVar9 + -1;
      pbVar11 = pbVar11 + 1;
      *(ushort *)(iVar6 + iVar3 * 2) = uVar8;
    } while ((int)piStack_c < 0x43fe78);
    if (1 < *(int *)(*unaff_EDI + 0x68)) {
      puVar12 = (ushort *)(iVar6 + 4);
      piStack_c = (int *)0x8;
      do {
        iVar6 = *unaff_EDI;
        *(uint *)(iVar6 + 0x18) = (uint)puVar12[-2];
        *(uint *)(iVar6 + 0x1c) = (uint)puVar12[-1];
        *(uint *)(iVar6 + 0x20) = (uint)*puVar12;
        *(uint *)(iVar6 + 0x24) = (uint)puVar12[1];
        *(uint *)(iVar6 + 0x28) = (uint)puVar12[2];
        *(uint *)(iVar6 + 0x2c) = (uint)puVar12[3];
        *(uint *)(iVar6 + 0x30) = (uint)puVar12[4];
        *(uint *)(iVar6 + 0x34) = (uint)puVar12[5];
        *(undefined4 *)(*unaff_EDI + 0x14) = 0x5d;
        (**(code **)(*unaff_EDI + 4))();
        puVar12 = puVar12 + 8;
        piStack_c = (int *)((int)piStack_c + -1);
      } while (piStack_c != (int *)0x0);
    }
    iVar6 = iVar7 + -0x41;
    if (iVar5 != 0) {
      iVar6 = iVar7 + -0x81;
    }
  } while( true );
}



uint __cdecl FUN_00424c90(int *param_1)

{
  byte bVar1;
  byte **ppbVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  byte *pbVar6;
  byte *pbVar7;
  byte *pbVar8;
  
  ppbVar2 = (byte **)param_1[6];
  pbVar6 = *ppbVar2;
  pbVar8 = ppbVar2[1];
  if (pbVar8 == (byte *)0x0) {
    uVar3 = (*(code *)ppbVar2[3])(param_1);
    if ((char)uVar3 == '\0') goto LAB_00424cb1;
    pbVar6 = *ppbVar2;
    pbVar8 = ppbVar2[1];
  }
  bVar1 = *pbVar6;
  pbVar8 = pbVar8 + -1;
  pbVar6 = pbVar6 + 1;
  if (pbVar8 == (byte *)0x0) {
    uVar3 = (*(code *)ppbVar2[3])(param_1);
    if ((char)uVar3 == '\0') goto LAB_00424cb1;
    pbVar6 = *ppbVar2;
    pbVar8 = ppbVar2[1];
  }
  pbVar8 = pbVar8 + -1;
  pbVar7 = pbVar6 + 1;
  if (CONCAT11(bVar1,*pbVar6) != 4) {
    *(undefined4 *)(*param_1 + 0x14) = 0xb;
    (**(code **)*param_1)(param_1);
  }
  if (pbVar8 == (byte *)0x0) {
    uVar3 = (*(code *)ppbVar2[3])(param_1);
    if ((char)uVar3 == '\0') goto LAB_00424cb1;
    pbVar7 = *ppbVar2;
    pbVar8 = ppbVar2[1];
  }
  bVar1 = *pbVar7;
  pbVar8 = pbVar8 + -1;
  pbVar7 = pbVar7 + 1;
  if (pbVar8 == (byte *)0x0) {
    uVar3 = (*(code *)ppbVar2[3])(param_1);
    if ((char)uVar3 == '\0') {
LAB_00424cb1:
      return uVar3 & 0xffffff00;
    }
    pbVar7 = *ppbVar2;
    pbVar8 = ppbVar2[1];
  }
  iVar4 = (uint)bVar1 * 0x100 + (uint)*pbVar7;
  *(undefined4 *)(*param_1 + 0x14) = 0x52;
  *(int *)(*param_1 + 0x18) = iVar4;
  uVar5 = (**(code **)(*param_1 + 4))(param_1,1);
  param_1[0x3f] = iVar4;
  ppbVar2[1] = pbVar8 + -1;
  *ppbVar2 = pbVar7 + 1;
  return CONCAT31((int3)((uint)uVar5 >> 8),1);
}



void __fastcall FUN_00424d90(int param_1)

{
  int iVar1;
  char cVar2;
  int iVar3;
  uint in_EAX;
  int *unaff_ESI;
  char *unaff_EDI;
  
  iVar1 = in_EAX + param_1;
  if ((((in_EAX < 0xe) || (*unaff_EDI != 'J')) || (unaff_EDI[1] != 'F')) ||
     (((unaff_EDI[2] != 'I' || (unaff_EDI[3] != 'F')) || (unaff_EDI[4] != '\0')))) {
    if (((5 < in_EAX) && (*unaff_EDI == 'J')) &&
       ((unaff_EDI[1] == 'F' &&
        (((unaff_EDI[2] == 'X' && (unaff_EDI[3] == 'X')) && (unaff_EDI[4] == '\0')))))) {
      cVar2 = unaff_EDI[5];
      if (cVar2 == '\x10') {
        *(undefined4 *)(*unaff_ESI + 0x14) = 0x6c;
        *(int *)(*unaff_ESI + 0x18) = iVar1;
        (**(code **)(*unaff_ESI + 4))();
        return;
      }
      if (cVar2 != '\x11') {
        if (cVar2 != '\x13') {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x59;
          *(uint *)(*unaff_ESI + 0x18) = (uint)(byte)unaff_EDI[5];
          *(int *)(*unaff_ESI + 0x1c) = iVar1;
          (**(code **)(*unaff_ESI + 4))();
          return;
        }
        *(undefined4 *)(*unaff_ESI + 0x14) = 0x6e;
        *(int *)(*unaff_ESI + 0x18) = iVar1;
        (**(code **)(*unaff_ESI + 4))();
        return;
      }
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x6d;
      *(int *)(*unaff_ESI + 0x18) = iVar1;
      (**(code **)(*unaff_ESI + 4))();
      return;
    }
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x4d;
    *(int *)(*unaff_ESI + 0x18) = iVar1;
    (**(code **)(*unaff_ESI + 4))();
  }
  else {
    *(undefined *)(unaff_ESI + 0x40) = 1;
    *(char *)((int)unaff_ESI + 0x101) = unaff_EDI[5];
    *(char *)((int)unaff_ESI + 0x102) = unaff_EDI[6];
    *(char *)((int)unaff_ESI + 0x103) = unaff_EDI[7];
    *(ushort *)(unaff_ESI + 0x41) = (ushort)(byte)unaff_EDI[8] * 0x100 + (ushort)(byte)unaff_EDI[9];
    *(ushort *)((int)unaff_ESI + 0x106) =
         (ushort)(byte)unaff_EDI[10] * 0x100 + (ushort)(byte)unaff_EDI[0xb];
    if (*(char *)((int)unaff_ESI + 0x101) != '\x01') {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x77;
      *(uint *)(*unaff_ESI + 0x18) = (uint)*(byte *)((int)unaff_ESI + 0x101);
      *(uint *)(*unaff_ESI + 0x1c) = (uint)*(byte *)((int)unaff_ESI + 0x102);
      (**(code **)(*unaff_ESI + 4))();
    }
    iVar3 = *unaff_ESI;
    *(uint *)(iVar3 + 0x18) = (uint)*(byte *)((int)unaff_ESI + 0x101);
    *(uint *)(iVar3 + 0x1c) = (uint)*(byte *)((int)unaff_ESI + 0x102);
    *(uint *)(iVar3 + 0x20) = (uint)*(ushort *)(unaff_ESI + 0x41);
    *(uint *)(iVar3 + 0x24) = (uint)*(ushort *)((int)unaff_ESI + 0x106);
    *(uint *)(iVar3 + 0x28) = (uint)*(byte *)((int)unaff_ESI + 0x103);
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x57;
    (**(code **)(*unaff_ESI + 4))();
    if ((byte)(unaff_EDI[0xc] | unaff_EDI[0xd]) != 0) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x5a;
      *(uint *)(*unaff_ESI + 0x18) = (uint)(byte)unaff_EDI[0xc];
      *(uint *)(*unaff_ESI + 0x1c) = (uint)(byte)unaff_EDI[0xd];
      (**(code **)(*unaff_ESI + 4))();
    }
    if (iVar1 + -0xe != (uint)(byte)unaff_EDI[0xc] * (uint)(byte)unaff_EDI[0xd] * 3) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x58;
      *(int *)(*unaff_ESI + 0x18) = iVar1 + -0xe;
      (**(code **)(*unaff_ESI + 4))();
      return;
    }
  }
  return;
}



void __thiscall FUN_00424ff0(void *this,int param_1)

{
  char cVar1;
  char cVar2;
  byte bVar3;
  char cVar4;
  char cVar5;
  int iVar6;
  char *in_EAX;
  int *unaff_ESI;
  
  if (((((void *)0xb < this) && (*in_EAX == 'A')) && (in_EAX[1] == 'd')) &&
     (((in_EAX[2] == 'o' && (in_EAX[3] == 'b')) && (in_EAX[4] == 'e')))) {
    cVar1 = in_EAX[7];
    cVar2 = in_EAX[8];
    bVar3 = in_EAX[0xb];
    cVar4 = in_EAX[9];
    cVar5 = in_EAX[10];
    iVar6 = *unaff_ESI;
    *(uint *)(iVar6 + 0x18) = (uint)CONCAT11(in_EAX[5],in_EAX[6]);
    *(uint *)(iVar6 + 0x1c) = (uint)CONCAT11(cVar1,cVar2);
    *(uint *)(iVar6 + 0x20) = (uint)CONCAT11(cVar4,cVar5);
    *(uint *)(iVar6 + 0x24) = (uint)bVar3;
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x4c;
    (**(code **)(*unaff_ESI + 4))();
    *(byte *)((int)unaff_ESI + 0x109) = bVar3;
    *(undefined *)(unaff_ESI + 0x42) = 1;
    return;
  }
  *(undefined4 *)(*unaff_ESI + 0x14) = 0x4e;
  *(int *)(*unaff_ESI + 0x18) = (int)this + param_1;
  (**(code **)(*unaff_ESI + 4))();
  return;
}



void __cdecl FUN_004250a0(int *param_1)

{
  byte bVar1;
  char cVar2;
  void *this;
  byte *pbVar3;
  byte *pbVar4;
  uint uVar5;
  void *pvVar6;
  byte **ppbVar7;
  void *pvStack_24;
  int *local_20;
  void *pvStack_1c;
  byte **local_18;
  byte abStack_14 [16];
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&pvStack_24;
  ppbVar7 = (byte **)param_1[6];
  pbVar4 = ppbVar7[1];
  pbVar3 = *ppbVar7;
  local_20 = param_1;
  local_18 = ppbVar7;
  if (pbVar4 == (byte *)0x0) {
    cVar2 = (*(code *)ppbVar7[3])(param_1);
    if (cVar2 == '\0') {
      ___security_check_cookie_4(local_4 ^ (uint)&pvStack_24);
      return;
    }
    pbVar3 = *ppbVar7;
    pbVar4 = ppbVar7[1];
  }
  bVar1 = *pbVar3;
  pbVar4 = pbVar4 + -1;
  pbVar3 = pbVar3 + 1;
  if (pbVar4 == (byte *)0x0) {
    cVar2 = (*(code *)ppbVar7[3])(local_20);
    if (cVar2 == '\0') {
LAB_004251c8:
      ___security_check_cookie_4(local_4 ^ (uint)&pvStack_24);
      return;
    }
    pbVar3 = *ppbVar7;
    pbVar4 = ppbVar7[1];
  }
  uVar5 = ((uint)bVar1 * 0x100 + (uint)*pbVar3) - 2;
  pbVar4 = pbVar4 + -1;
  pbVar3 = pbVar3 + 1;
  if ((int)uVar5 < 0xe) {
    pvStack_1c = (void *)(((int)uVar5 < 1) - 1 & uVar5);
  }
  else {
    pvStack_1c = (void *)0xe;
  }
  pvStack_24 = (void *)0x0;
  this = pvStack_1c;
  if (pvStack_1c != (void *)0x0) {
    do {
      if (pbVar4 == (byte *)0x0) {
        cVar2 = (*(code *)ppbVar7[3])(local_20);
        if (cVar2 == '\0') goto LAB_004251c8;
        pbVar3 = *ppbVar7;
        pbVar4 = ppbVar7[1];
        this = pvStack_1c;
      }
      abStack_14[(int)pvStack_24] = *pbVar3;
      pvStack_24 = (void *)((int)pvStack_24 + 1);
      pbVar4 = pbVar4 + -1;
      pbVar3 = pbVar3 + 1;
    } while (pvStack_24 < this);
  }
  pvVar6 = (void *)(uVar5 - (int)this);
  pvStack_24 = pvVar6;
  if (local_20[0x5f] == 0xe0) {
    FUN_00424d90((int)pvVar6);
    pvVar6 = pvStack_24;
    ppbVar7 = local_18;
  }
  else if (local_20[0x5f] == 0xee) {
    FUN_00424ff0(this,(int)pvVar6);
    pvVar6 = pvStack_24;
  }
  else {
    *(undefined4 *)(*local_20 + 0x14) = 0x44;
    *(int *)(*local_20 + 0x18) = local_20[0x5f];
    (**(code **)*local_20)(local_20);
  }
  *ppbVar7 = pbVar3;
  ppbVar7[1] = pbVar4;
  if (0 < (int)pvVar6) {
    (**(code **)(local_20[6] + 0x10))(local_20,pvVar6);
  }
  ___security_check_cookie_4(local_4 ^ (uint)&pvStack_24);
  return;
}



uint __cdecl FUN_00425240(int *param_1)

{
  byte bVar1;
  byte bVar2;
  byte **ppbVar3;
  uint uVar4;
  int iVar5;
  byte *pbVar6;
  byte *pbVar7;
  
  ppbVar3 = (byte **)param_1[6];
  pbVar7 = ppbVar3[1];
  pbVar6 = *ppbVar3;
  if (pbVar7 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])(param_1);
    if ((char)uVar4 == '\0') goto LAB_00425261;
    pbVar6 = *ppbVar3;
    pbVar7 = ppbVar3[1];
  }
  bVar1 = *pbVar6;
  pbVar7 = pbVar7 + -1;
  pbVar6 = pbVar6 + 1;
  if (pbVar7 == (byte *)0x0) {
    uVar4 = (*(code *)ppbVar3[3])(param_1);
    if ((char)uVar4 == '\0') {
LAB_00425261:
      return uVar4 & 0xffffff00;
    }
    pbVar6 = *ppbVar3;
    pbVar7 = ppbVar3[1];
  }
  bVar2 = *pbVar6;
  *(undefined4 *)(*param_1 + 0x14) = 0x5b;
  iVar5 = (uint)bVar1 * 0x100 + -2 + (uint)bVar2;
  *(int *)(*param_1 + 0x18) = param_1[0x5f];
  *(int *)(*param_1 + 0x1c) = iVar5;
  (**(code **)(*param_1 + 4))(param_1,1);
  *ppbVar3 = pbVar6 + 1;
  ppbVar3[1] = pbVar7 + -1;
  if (0 < iVar5) {
    iVar5 = (**(code **)(param_1[6] + 0x10))(param_1,iVar5);
  }
  return CONCAT31((int3)((uint)iVar5 >> 8),1);
}



undefined4 __cdecl FUN_004252f0(int *param_1)

{
  byte bVar1;
  byte **ppbVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  
  ppbVar2 = (byte **)param_1[6];
  pbVar4 = *ppbVar2;
  pbVar5 = ppbVar2[1];
  do {
    if (pbVar5 == (byte *)0x0) {
      uVar3 = (*(code *)ppbVar2[3])(param_1);
      if ((char)uVar3 == '\0') {
LAB_004253bd:
        return uVar3 & 0xffffff00;
      }
      pbVar4 = *ppbVar2;
      pbVar5 = ppbVar2[1];
    }
    bVar1 = *pbVar4;
    while( true ) {
      pbVar4 = pbVar4 + 1;
      pbVar5 = pbVar5 + -1;
      if (bVar1 == 0xff) break;
      *(int *)(param_1[0x65] + 0x14) = *(int *)(param_1[0x65] + 0x14) + 1;
      *ppbVar2 = pbVar4;
      ppbVar2[1] = pbVar5;
      if (pbVar5 == (byte *)0x0) {
        uVar3 = (*(code *)ppbVar2[3])(param_1);
        if ((char)uVar3 == '\0') goto LAB_004253bd;
        pbVar4 = *ppbVar2;
        pbVar5 = ppbVar2[1];
      }
      bVar1 = *pbVar4;
    }
    do {
      if (pbVar5 == (byte *)0x0) {
        uVar3 = (*(code *)ppbVar2[3])(param_1);
        if ((char)uVar3 == '\0') goto LAB_004253bd;
        pbVar4 = *ppbVar2;
        pbVar5 = ppbVar2[1];
      }
      uVar3 = (uint)*pbVar4;
      pbVar5 = pbVar5 + -1;
      pbVar4 = pbVar4 + 1;
    } while (uVar3 == 0xff);
    if (uVar3 != 0) {
      if (*(int *)(param_1[0x65] + 0x14) != 0) {
        *(undefined4 *)(*param_1 + 0x14) = 0x74;
        *(undefined4 *)(*param_1 + 0x18) = *(undefined4 *)(param_1[0x65] + 0x14);
        *(uint *)(*param_1 + 0x1c) = uVar3;
        (**(code **)(*param_1 + 4))(param_1,0xffffffff);
        *(undefined4 *)(param_1[0x65] + 0x14) = 0;
      }
      param_1[0x5f] = uVar3;
      ppbVar2[1] = pbVar5;
      *ppbVar2 = pbVar4;
      return CONCAT31((int3)((uint)param_1 >> 8),1);
    }
    *(int *)(param_1[0x65] + 0x14) = *(int *)(param_1[0x65] + 0x14) + 2;
    *ppbVar2 = pbVar4;
    ppbVar2[1] = pbVar5;
  } while( true );
}



uint __cdecl FUN_00425420(int *param_1)

{
  byte bVar1;
  byte **ppbVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  
  ppbVar2 = (byte **)param_1[6];
  pbVar4 = *ppbVar2;
  pbVar5 = ppbVar2[1];
  if (pbVar5 == (byte *)0x0) {
    uVar3 = (*(code *)ppbVar2[3])(param_1);
    if ((char)uVar3 == '\0') goto LAB_00425441;
    pbVar4 = *ppbVar2;
    pbVar5 = ppbVar2[1];
  }
  bVar1 = *pbVar4;
  pbVar5 = pbVar5 + -1;
  pbVar4 = pbVar4 + 1;
  if (pbVar5 == (byte *)0x0) {
    uVar3 = (*(code *)ppbVar2[3])(param_1);
    if ((char)uVar3 == '\0') {
LAB_00425441:
      return uVar3 & 0xffffff00;
    }
    pbVar4 = *ppbVar2;
    pbVar5 = ppbVar2[1];
  }
  uVar3 = (uint)*pbVar4;
  if ((bVar1 != 0xff) || (uVar3 != 0xd8)) {
    *(undefined4 *)(*param_1 + 0x14) = 0x35;
    *(uint *)(*param_1 + 0x18) = (uint)bVar1;
    *(uint *)(*param_1 + 0x1c) = uVar3;
    (**(code **)*param_1)(param_1);
  }
  param_1[0x5f] = uVar3;
  ppbVar2[1] = pbVar5 + -1;
  *ppbVar2 = pbVar4 + 1;
  return 1;
}



uint __cdecl FUN_00425850(int *param_1)

{
  uint uVar1;
  
  if (param_1[0x5f] == 0) {
    uVar1 = FUN_004252f0(param_1);
    if ((char)uVar1 == '\0') goto LAB_0042586b;
  }
  if (param_1[0x5f] == *(int *)(param_1[0x65] + 0x10) + 0xd0) {
    *(undefined4 *)(*param_1 + 0x14) = 0x62;
    *(undefined4 *)(*param_1 + 0x18) = *(undefined4 *)(param_1[0x65] + 0x10);
    uVar1 = (**(code **)(*param_1 + 4))(param_1,3);
    param_1[0x5f] = 0;
  }
  else {
    uVar1 = (**(code **)(param_1[6] + 0x14))(param_1,*(int *)(param_1[0x65] + 0x10));
    if ((char)uVar1 == '\0') {
LAB_0042586b:
      return uVar1 & 0xffffff00;
    }
  }
  *(uint *)(param_1[0x65] + 0x10) = *(int *)(param_1[0x65] + 0x10) + 1U & 7;
  return CONCAT31((int3)(uVar1 >> 8),1);
}



void FUN_00425a10(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  int unaff_ESI;
  
  puVar1 = (undefined4 *)(***(code ***)(unaff_ESI + 4))();
  *(undefined4 **)(unaff_ESI + 0x194) = puVar1;
  *puVar1 = &LAB_004259e0;
  puVar1[1] = &LAB_004254d0;
  puVar1[2] = FUN_00425850;
  puVar1[6] = FUN_00425240;
  puVar1[0x17] = 0;
  puVar2 = puVar1 + 0x18;
  iVar3 = 0x10;
  do {
    puVar2[-0x11] = FUN_00425240;
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  puVar1[7] = FUN_004250a0;
  puVar1[0x15] = FUN_004250a0;
  iVar3 = *(int *)(unaff_ESI + 0x194);
  *(undefined4 *)(unaff_ESI + 0xc4) = 0;
  *(undefined4 *)(unaff_ESI + 0x7c) = 0;
  *(undefined4 *)(unaff_ESI + 0x17c) = 0;
  *(undefined *)(iVar3 + 0xc) = 0;
  *(undefined *)(iVar3 + 0xd) = 0;
  *(undefined4 *)(iVar3 + 0x14) = 0;
  *(undefined4 *)(iVar3 + 0xa0) = 0;
  return;
}



void FUN_00425aa0(void)

{
  int *unaff_ESI;
  
  if (unaff_ESI[5] != 100) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    (**(code **)*unaff_ESI)();
  }
  (**(code **)(*unaff_ESI + 0x10))();
  (**(code **)(unaff_ESI[6] + 8))();
  FUN_00428600();
  (**(code **)unaff_ESI[0x4f])();
  unaff_ESI[0x34] = 0;
  unaff_ESI[5] = (*(char *)(unaff_ESI + 0x2c) != '\0') + 0x65;
  return;
}



void FUN_00425b10(void)

{
  int *unaff_ESI;
  
  if (unaff_ESI[5] != 0x65) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    (**(code **)*unaff_ESI)();
  }
  if ((uint)unaff_ESI[8] <= (uint)unaff_ESI[0x34]) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x7b;
    (**(code **)(*unaff_ESI + 4))();
  }
  if (unaff_ESI[2] != 0) {
    *(int *)(unaff_ESI[2] + 4) = unaff_ESI[0x34];
    *(int *)(unaff_ESI[2] + 8) = unaff_ESI[8];
    (**(code **)unaff_ESI[2])();
  }
  if (*(char *)(unaff_ESI[0x4f] + 0xc) != '\0') {
    (**(code **)(unaff_ESI[0x4f] + 4))();
  }
  (**(code **)(unaff_ESI[0x50] + 4))();
  unaff_ESI[0x34] = unaff_ESI[0x34];
  return;
}



void FUN_00425be0(int *param_1)

{
  (**(code **)(*param_1 + 8))(param_1);
  if (param_1[1] != 0) {
    (**(code **)(param_1[1] + 0x28))(param_1);
  }
  param_1[1] = 0;
  param_1[5] = 0;
                    // WARNING: Subroutine does not return
  exit(1);
}



uint __fastcall FUN_00425d90(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  uint in_EAX;
  
  if (((((*(char *)(param_2 + 0x48) != '\0') || (*(char *)(param_2 + 0x10a) != '\0')) ||
       (in_EAX = 0, *(int *)(param_2 + 0x28) != 3)) ||
      (((*(int *)(param_2 + 0x24) != 3 || (*(int *)(param_2 + 0x2c) != 2)) ||
       ((*(int *)(param_2 + 100) != 3 ||
        ((iVar1 = *(int *)(param_2 + 0xc4), *(int *)(iVar1 + 8) != 2 ||
         (in_EAX = 1, *(int *)(iVar1 + 0x5c) != 1)))))))) ||
     ((*(int *)(iVar1 + 0xb0) != 1 ||
      (((((2 < *(int *)(iVar1 + 0xc) || (*(int *)(iVar1 + 0x60) != 1)) ||
         (*(int *)(iVar1 + 0xb4) != 1)) ||
        ((iVar2 = *(int *)(param_2 + 0x118), *(int *)(iVar1 + 0x24) != iVar2 ||
         (*(int *)(iVar1 + 0x78) != iVar2)))) || (*(int *)(iVar1 + 0xcc) != iVar2)))))) {
    in_EAX = in_EAX & 0xffffff00;
  }
  return in_EAX;
}



void FUN_00425e10(void)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int *unaff_ESI;
  int iStack_4;
  
  if (unaff_ESI[5] != 0xca) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x14;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[5];
    (**(code **)*unaff_ESI)();
  }
  iVar4 = unaff_ESI[0xc];
  uVar1 = unaff_ESI[0xd];
  if ((uint)(iVar4 * 8) < uVar1 || iVar4 * 8 - uVar1 == 0) {
    unaff_ESI[0x17] = (int)(unaff_ESI[7] + 7 + (unaff_ESI[7] + 7 >> 0x1f & 7U)) >> 3;
    unaff_ESI[0x18] = (int)(unaff_ESI[8] + 7 + (unaff_ESI[8] + 7 >> 0x1f & 7U)) >> 3;
    unaff_ESI[0x46] = 1;
  }
  else if ((uint)(iVar4 * 4) < uVar1 || iVar4 * 4 - uVar1 == 0) {
    unaff_ESI[0x17] = (int)(unaff_ESI[7] + 3 + (unaff_ESI[7] + 3 >> 0x1f & 3U)) >> 2;
    unaff_ESI[0x18] = (int)(unaff_ESI[8] + 3 + (unaff_ESI[8] + 3 >> 0x1f & 3U)) >> 2;
    unaff_ESI[0x46] = 2;
  }
  else if (uVar1 < (uint)(iVar4 * 2)) {
    unaff_ESI[0x17] = unaff_ESI[7];
    unaff_ESI[0x18] = unaff_ESI[8];
    unaff_ESI[0x46] = 8;
  }
  else {
    unaff_ESI[0x17] = (unaff_ESI[7] + 1) / 2;
    unaff_ESI[0x18] = (unaff_ESI[8] + 1) / 2;
    unaff_ESI[0x46] = 4;
  }
  iStack_4 = 0;
  if (0 < unaff_ESI[9]) {
    piVar3 = (int *)(unaff_ESI[0x31] + 0xc);
    do {
      iVar4 = unaff_ESI[0x46];
      iVar2 = iVar4;
      if (iVar4 < 8) {
        do {
          if ((unaff_ESI[0x44] * iVar4 < piVar3[-1] * iVar2 * 2) ||
             (unaff_ESI[0x45] * iVar4 < *piVar3 * iVar2 * 2)) break;
          iVar2 = iVar2 * 2;
        } while (iVar2 < 8);
      }
      piVar3[6] = iVar2;
      iStack_4 = iStack_4 + 1;
      piVar3 = piVar3 + 0x15;
    } while (iStack_4 < unaff_ESI[9]);
  }
  iVar4 = 0;
  if (0 < unaff_ESI[9]) {
    piVar3 = (int *)(unaff_ESI[0x31] + 0x24);
    do {
      iVar4 = iVar4 + 1;
      piVar3[1] = (piVar3[-7] * *piVar3 * unaff_ESI[7] + -1 + unaff_ESI[0x44] * 8) /
                  (unaff_ESI[0x44] * 8);
      piVar3[2] = (piVar3[-6] * unaff_ESI[8] * *piVar3 + -1 + unaff_ESI[0x45] * 8) /
                  (unaff_ESI[0x45] * 8);
      piVar3 = piVar3 + 0x15;
    } while (iVar4 < unaff_ESI[9]);
  }
  switch(unaff_ESI[0xb]) {
  case 1:
    unaff_ESI[0x19] = 1;
    break;
  case 2:
  case 3:
    unaff_ESI[0x19] = 3;
    break;
  case 4:
  case 5:
    unaff_ESI[0x19] = 4;
    break;
  default:
    unaff_ESI[0x19] = unaff_ESI[9];
  }
  iVar4 = 1;
  if (*(char *)((int)unaff_ESI + 0x4a) == '\0') {
    iVar4 = unaff_ESI[0x19];
  }
  unaff_ESI[0x1a] = iVar4;
  if (((((*(char *)(unaff_ESI + 0x12) == '\0') && (*(char *)((int)unaff_ESI + 0x10a) == '\0')) &&
       (unaff_ESI[10] == 3)) &&
      (((unaff_ESI[9] == 3 && (unaff_ESI[0xb] == 2)) &&
       ((unaff_ESI[0x19] == 3 &&
        ((iVar4 = unaff_ESI[0x31], *(int *)(iVar4 + 8) == 2 && (*(int *)(iVar4 + 0x5c) == 1))))))))
     && ((*(int *)(iVar4 + 0xb0) == 1 &&
         (((((*(int *)(iVar4 + 0xc) < 3 && (*(int *)(iVar4 + 0x60) == 1)) &&
            (*(int *)(iVar4 + 0xb4) == 1)) &&
           ((iVar2 = unaff_ESI[0x46], *(int *)(iVar4 + 0x24) == iVar2 &&
            (*(int *)(iVar4 + 0x78) == iVar2)))) && (*(int *)(iVar4 + 0xcc) == iVar2)))))) {
    unaff_ESI[0x1b] = unaff_ESI[0x45];
    return;
  }
  unaff_ESI[0x1b] = 1;
  return;
}



void FUN_004260a0(void)

{
  void *_Dst;
  int iVar1;
  int unaff_EBX;
  undefined4 *puVar2;
  undefined4 *puVar3;
  
  _Dst = (void *)(***(code ***)(unaff_EBX + 4))();
  *(int *)(unaff_EBX + 0x120) = (int)_Dst + 0x100;
  memset(_Dst,0,0x100);
  iVar1 = 0;
  do {
    *(char *)(iVar1 + (int)_Dst + 0x100) = (char)iVar1;
    iVar1 = iVar1 + 1;
  } while (iVar1 < 0x100);
  memset((void *)((int)_Dst + 0x200),0xff,0x180);
  memset((void *)((int)_Dst + 0x380),0,0x180);
  puVar2 = *(undefined4 **)(unaff_EBX + 0x120);
  puVar3 = (undefined4 *)((int)_Dst + 0x500);
  for (iVar1 = 0x20; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar3 = puVar3 + 1;
  }
  return;
}



void FUN_00426140(void)

{
  int iVar1;
  int *in_EAX;
  uint uVar2;
  int iVar3;
  undefined4 extraout_ECX;
  char cStack_4;
  
  iVar1 = in_EAX[0x60];
  FUN_00425e10();
  FUN_004260a0();
  *(undefined4 *)(iVar1 + 0xc) = 0;
  uVar2 = FUN_00425d90(extraout_ECX,(int)in_EAX);
  *(char *)(iVar1 + 0x10) = (char)uVar2;
  *(undefined4 *)(iVar1 + 0x14) = 0;
  *(undefined4 *)(iVar1 + 0x18) = 0;
  if ((*(char *)((int)in_EAX + 0x4a) == '\0') || (*(char *)(in_EAX + 0x10) == '\0')) {
    *(undefined *)(in_EAX + 0x16) = 0;
    *(undefined *)((int)in_EAX + 0x59) = 0;
    *(undefined *)((int)in_EAX + 0x5a) = 0;
  }
  if (*(char *)((int)in_EAX + 0x4a) == '\0') goto LAB_004261de;
  if (*(char *)((int)in_EAX + 0x41) != '\0') {
    *(undefined4 *)(*in_EAX + 0x14) = 0x2f;
    (**(code **)*in_EAX)();
  }
  if (in_EAX[0x19] == 3) {
    if (in_EAX[0x1d] == 0) {
      if (*(char *)(in_EAX + 0x14) == '\0') goto LAB_004261ad;
      *(undefined *)((int)in_EAX + 0x5a) = 1;
    }
    else {
      *(undefined *)((int)in_EAX + 0x59) = 1;
    }
  }
  else {
    *(undefined *)((int)in_EAX + 0x59) = 0;
    *(undefined *)((int)in_EAX + 0x5a) = 0;
    in_EAX[0x1d] = 0;
LAB_004261ad:
    *(undefined *)(in_EAX + 0x16) = 1;
  }
  if (*(char *)(in_EAX + 0x16) != '\0') {
    FUN_00429da0();
    *(int *)(iVar1 + 0x14) = in_EAX[0x6a];
  }
  if ((*(char *)((int)in_EAX + 0x5a) != '\0') || (*(char *)((int)in_EAX + 0x59) != '\0')) {
    FUN_0042de10();
    *(int *)(iVar1 + 0x18) = in_EAX[0x6a];
  }
LAB_004261de:
  if (*(char *)((int)in_EAX + 0x41) == '\0') {
    if (*(char *)(iVar1 + 0x10) == '\0') {
      FUN_0042ba30();
      FUN_0042a6d0();
    }
    else {
      FUN_0042e4b0();
    }
    FUN_0042eeb0(*(char *)((int)in_EAX + 0x5a));
  }
  FUN_0042a160();
  if (*(char *)((int)in_EAX + 0xc9) == '\0') {
    if (*(char *)(in_EAX + 0x32) == '\0') {
      FUN_00429200();
    }
    else {
      FUN_0042b550();
    }
  }
  else {
    *(undefined4 *)(*in_EAX + 0x14) = 1;
    (**(code **)*in_EAX)();
  }
  if ((*(char *)(in_EAX[100] + 0x10) != '\0') || (cStack_4 = '\0', *(char *)(in_EAX + 0x10) != '\0')
     ) {
    cStack_4 = '\x01';
  }
  FUN_0042ca50(cStack_4);
  if (*(char *)((int)in_EAX + 0x41) == '\0') {
    FUN_0042eb20();
  }
  (**(code **)(in_EAX[1] + 0x18))();
  (**(code **)(in_EAX[100] + 8))();
  if (((in_EAX[2] != 0) && (*(char *)(in_EAX + 0x10) == '\0')) &&
     (*(char *)(in_EAX[100] + 0x10) != '\0')) {
    iVar3 = in_EAX[9];
    if (*(char *)(in_EAX + 0x32) != '\0') {
      iVar3 = iVar3 * 3 + 2;
    }
    *(undefined4 *)(in_EAX[2] + 4) = 0;
    *(int *)(in_EAX[2] + 8) = in_EAX[0x47] * iVar3;
    *(undefined4 *)(in_EAX[2] + 0xc) = 0;
    *(uint *)(in_EAX[2] + 0x10) = (*(char *)((int)in_EAX + 0x5a) != '\0') + 2;
    *(int *)(iVar1 + 0xc) = *(int *)(iVar1 + 0xc) + 1;
  }
  return;
}



void __cdecl FUN_00426300(int *param_1)

{
  int iVar1;
  
  iVar1 = param_1[0x60];
  if (*(char *)(iVar1 + 8) == '\0') {
    if ((*(char *)((int)param_1 + 0x4a) != '\0') && (param_1[0x1d] == 0)) {
      if ((*(char *)(param_1 + 0x14) == '\0') || (*(char *)((int)param_1 + 0x5a) == '\0')) {
        if (*(char *)(param_1 + 0x16) == '\0') {
          *(undefined4 *)(*param_1 + 0x14) = 0x2e;
          (**(code **)*param_1)(param_1);
        }
        else {
          param_1[0x6a] = *(int *)(iVar1 + 0x14);
        }
      }
      else {
        param_1[0x6a] = *(int *)(iVar1 + 0x18);
        *(undefined *)(iVar1 + 8) = 1;
      }
    }
    (**(code **)param_1[0x67])(param_1);
    (**(code **)(param_1[0x62] + 8))(param_1);
    if (*(char *)((int)param_1 + 0x41) == '\0') {
      if (*(char *)(iVar1 + 0x10) == '\0') {
        (**(code **)param_1[0x69])(param_1);
      }
      (**(code **)param_1[0x68])(param_1);
      if (*(char *)((int)param_1 + 0x4a) != '\0') {
        (**(code **)param_1[0x6a])(param_1,*(undefined *)(iVar1 + 8));
      }
      (**(code **)param_1[99])(param_1,-(*(char *)(iVar1 + 8) != '\0') & 3);
      (**(code **)param_1[0x61])(param_1,0);
    }
  }
  else {
    *(undefined *)(iVar1 + 8) = 0;
    (**(code **)param_1[0x6a])(param_1,0);
    (**(code **)param_1[99])(param_1,2);
    (**(code **)param_1[0x61])(param_1,2);
  }
  if (param_1[2] != 0) {
    *(undefined4 *)(param_1[2] + 0xc) = *(undefined4 *)(iVar1 + 0xc);
    *(uint *)(param_1[2] + 0x10) = (*(char *)(iVar1 + 8) != '\0') + 1 + *(int *)(iVar1 + 0xc);
    if ((*(char *)(param_1 + 0x10) != '\0') && (*(char *)(param_1[100] + 0x11) == '\0')) {
      *(int *)(param_1[2] + 0x10) =
           *(int *)(param_1[2] + 0x10) + (*(char *)((int)param_1 + 0x5a) != '\0') + 1;
    }
  }
  return;
}



void FUN_00426490(void)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int *unaff_ESI;
  int iStack_4;
  
  if ((0xffdc < unaff_ESI[8]) || (0xffdc < unaff_ESI[7])) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x29;
    *(undefined4 *)(*unaff_ESI + 0x18) = 0xffdc;
    (**(code **)*unaff_ESI)();
  }
  if (unaff_ESI[0x30] != 8) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0xf;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[0x30];
    (**(code **)*unaff_ESI)();
  }
  if (10 < unaff_ESI[9]) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x1a;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[9];
    *(undefined4 *)(*unaff_ESI + 0x1c) = 10;
    (**(code **)*unaff_ESI)();
  }
  iVar3 = 0;
  unaff_ESI[0x44] = 1;
  unaff_ESI[0x45] = 1;
  if (0 < unaff_ESI[9]) {
    piVar2 = (int *)(unaff_ESI[0x31] + 0xc);
    do {
      if ((((piVar2[-1] < 1) || (4 < piVar2[-1])) || (*piVar2 < 1)) || (4 < *piVar2)) {
        *(undefined4 *)(*unaff_ESI + 0x14) = 0x12;
        (**(code **)*unaff_ESI)();
      }
      iVar1 = unaff_ESI[0x44];
      if (unaff_ESI[0x44] <= piVar2[-1]) {
        iVar1 = piVar2[-1];
      }
      unaff_ESI[0x44] = iVar1;
      iVar1 = unaff_ESI[0x45];
      if (unaff_ESI[0x45] <= *piVar2) {
        iVar1 = *piVar2;
      }
      iVar3 = iVar3 + 1;
      unaff_ESI[0x45] = iVar1;
      piVar2 = piVar2 + 0x15;
    } while (iVar3 < unaff_ESI[9]);
  }
  unaff_ESI[0x46] = 8;
  iStack_4 = 0;
  if (0 < unaff_ESI[9]) {
    piVar2 = (int *)(unaff_ESI[0x31] + 0x1c);
    do {
      piVar2[2] = 8;
      *piVar2 = (unaff_ESI[7] * piVar2[-5] + -1 + unaff_ESI[0x44] * 8) / (unaff_ESI[0x44] * 8);
      piVar2[1] = (unaff_ESI[8] * piVar2[-4] + -1 + unaff_ESI[0x45] * 8) / (unaff_ESI[0x45] * 8);
      piVar2[3] = (unaff_ESI[7] * piVar2[-5] + -1 + unaff_ESI[0x44]) / unaff_ESI[0x44];
      iVar3 = unaff_ESI[8];
      iVar1 = unaff_ESI[0x45];
      *(undefined *)(piVar2 + 5) = 1;
      piVar2[0xc] = 0;
      piVar2[4] = (iVar3 * piVar2[-4] + -1 + iVar1) / iVar1;
      iStack_4 = iStack_4 + 1;
      piVar2 = piVar2 + 0x15;
    } while (iStack_4 < unaff_ESI[9]);
  }
  unaff_ESI[0x47] = (unaff_ESI[0x45] * 8 + -1 + unaff_ESI[8]) / (unaff_ESI[0x45] * 8);
  if ((unaff_ESI[9] <= unaff_ESI[0x49]) && (*(char *)(unaff_ESI + 0x32) == '\0')) {
    *(undefined *)(unaff_ESI[100] + 0x10) = 0;
    return;
  }
  *(undefined *)(unaff_ESI[100] + 0x10) = 1;
  return;
}



uint FUN_00426690(void)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int *unaff_ESI;
  uint local_8;
  int *piStack_4;
  
  iVar1 = unaff_ESI[0x49];
  if (iVar1 != 1) {
    if ((iVar1 < 1) || (4 < iVar1)) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x1a;
      *(int *)(*unaff_ESI + 0x18) = unaff_ESI[0x49];
      *(undefined4 *)(*unaff_ESI + 0x1c) = 4;
      (**(code **)*unaff_ESI)();
    }
    unaff_ESI[0x50] = 0;
    local_8 = 0;
    unaff_ESI[0x4e] = (unaff_ESI[7] + -1 + unaff_ESI[0x44] * 8) / (unaff_ESI[0x44] * 8);
    uVar3 = (unaff_ESI[8] + -1 + unaff_ESI[0x45] * 8) / (unaff_ESI[0x45] * 8);
    unaff_ESI[0x4f] = uVar3;
    if (0 < unaff_ESI[0x49]) {
      piStack_4 = unaff_ESI + 0x4a;
      do {
        iVar1 = *piStack_4;
        uVar3 = *(uint *)(iVar1 + 8);
        uVar2 = *(uint *)(iVar1 + 0xc);
        *(uint *)(iVar1 + 0x40) = *(int *)(iVar1 + 0x24) * uVar3;
        uVar4 = *(uint *)(iVar1 + 0x1c) % uVar3;
        iVar5 = uVar2 * uVar3;
        *(uint *)(iVar1 + 0x34) = uVar3;
        *(uint *)(iVar1 + 0x38) = uVar2;
        *(int *)(iVar1 + 0x3c) = iVar5;
        if (uVar4 == 0) {
          uVar4 = uVar3;
        }
        *(uint *)(iVar1 + 0x44) = uVar4;
        uVar3 = *(uint *)(iVar1 + 0x20) % uVar2;
        if (uVar3 == 0) {
          uVar3 = uVar2;
        }
        *(uint *)(iVar1 + 0x48) = uVar3;
        if (10 < unaff_ESI[0x50] + iVar5) {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0xd;
          (**(code **)*unaff_ESI)();
        }
        for (; 0 < iVar5; iVar5 = iVar5 + -1) {
          unaff_ESI[unaff_ESI[0x50] + 0x51] = local_8;
          unaff_ESI[0x50] = unaff_ESI[0x50] + 1;
        }
        piStack_4 = piStack_4 + 1;
        uVar3 = local_8 + 1;
        local_8 = uVar3;
      } while ((int)uVar3 < unaff_ESI[0x49]);
    }
    return uVar3;
  }
  iVar1 = unaff_ESI[0x4a];
  unaff_ESI[0x4e] = *(int *)(iVar1 + 0x1c);
  unaff_ESI[0x4f] = *(int *)(iVar1 + 0x20);
  uVar3 = *(uint *)(iVar1 + 0xc);
  *(undefined4 *)(iVar1 + 0x40) = *(undefined4 *)(iVar1 + 0x24);
  uVar2 = *(uint *)(iVar1 + 0x20);
  uVar4 = uVar2 % uVar3;
  *(undefined4 *)(iVar1 + 0x34) = 1;
  *(undefined4 *)(iVar1 + 0x38) = 1;
  *(undefined4 *)(iVar1 + 0x3c) = 1;
  *(undefined4 *)(iVar1 + 0x44) = 1;
  if (uVar4 == 0) {
    uVar4 = uVar3;
  }
  *(uint *)(iVar1 + 0x48) = uVar4;
  unaff_ESI[0x50] = 1;
  unaff_ESI[0x51] = 0;
  return uVar2 / uVar3;
}



void FUN_00426840(void)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  int iVar4;
  int *unaff_EBX;
  undefined4 *puVar5;
  undefined4 *puVar6;
  int *local_8;
  int local_4;
  
  local_4 = 0;
  if (0 < unaff_EBX[0x49]) {
    local_8 = unaff_EBX + 0x4a;
    do {
      iVar1 = *local_8;
      if (*(int *)(iVar1 + 0x4c) == 0) {
        uVar2 = *(uint *)(iVar1 + 0x10);
        if ((3 < uVar2) || (unaff_EBX[uVar2 + 0x24] == 0)) {
          *(undefined4 *)(*unaff_EBX + 0x14) = 0x34;
          *(uint *)(*unaff_EBX + 0x18) = uVar2;
          (**(code **)*unaff_EBX)();
        }
        puVar3 = (undefined4 *)(**(code **)unaff_EBX[1])();
        puVar5 = (undefined4 *)unaff_EBX[uVar2 + 0x24];
        puVar6 = puVar3;
        for (iVar4 = 0x20; iVar4 != 0; iVar4 = iVar4 + -1) {
          *puVar6 = *puVar5;
          puVar5 = puVar5 + 1;
          puVar6 = puVar6 + 1;
        }
        *(undefined2 *)puVar6 = *(undefined2 *)puVar5;
        *(undefined4 **)(iVar1 + 0x4c) = puVar3;
      }
      local_8 = local_8 + 1;
      local_4 = local_4 + 1;
    } while (local_4 < unaff_EBX[0x49]);
  }
  return;
}



void __cdecl FUN_004268f0(int param_1)

{
  FUN_00426690();
  FUN_00426840();
  (***(code ***)(param_1 + 0x198))(param_1);
  (***(code ***)(param_1 + 0x188))(param_1);
  **(undefined4 **)(param_1 + 400) = *(undefined4 *)(*(int *)(param_1 + 0x188) + 4);
  return;
}



int __cdecl FUN_00426950(int *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = param_1[100];
  if (*(char *)(iVar1 + 0x11) != '\0') {
    return 2;
  }
  iVar2 = (**(code **)(param_1[0x65] + 4))(param_1);
  if (iVar2 == 1) {
    if (*(char *)(iVar1 + 0x14) != '\0') {
      FUN_00426490();
      *(undefined *)(iVar1 + 0x14) = 0;
      return 1;
    }
    if (*(char *)(iVar1 + 0x10) == '\0') {
      *(undefined4 *)(*param_1 + 0x14) = 0x23;
      (**(code **)*param_1)(param_1);
    }
    FUN_004268f0((int)param_1);
  }
  else if (iVar2 == 2) {
    *(undefined *)(iVar1 + 0x11) = 1;
    if (*(char *)(iVar1 + 0x14) == '\0') {
      if (param_1[0x1f] < param_1[0x21]) {
        param_1[0x21] = param_1[0x1f];
        return 2;
      }
    }
    else if (*(char *)(param_1[0x65] + 0xd) != '\0') {
      *(undefined4 *)(*param_1 + 0x14) = 0x3b;
      (**(code **)*param_1)(param_1);
      return 2;
    }
  }
  return iVar2;
}



void __cdecl FUN_00426a10(int *param_1)

{
  code **ppcVar1;
  
  ppcVar1 = (code **)param_1[100];
  *ppcVar1 = FUN_00426950;
  *(undefined *)(ppcVar1 + 4) = 0;
  *(undefined *)((int)ppcVar1 + 0x11) = 0;
  *(undefined *)(ppcVar1 + 5) = 1;
  (**(code **)(*param_1 + 0x10))(param_1);
  (**(code **)param_1[0x65])(param_1);
  param_1[0x23] = 0;
  return;
}



int __cdecl FUN_00426a50(int *param_1,int param_2,uint param_3)

{
  int iVar1;
  int *piVar2;
  int **ppiVar3;
  int **ppiVar4;
  uint uVar5;
  int iVar6;
  
  piVar2 = param_1;
  iVar1 = param_1[1];
  if (0x3b9ac9f0 < param_3) {
    *(undefined4 *)(*param_1 + 0x14) = 0x36;
    *(undefined4 *)(*param_1 + 0x18) = 1;
    (**(code **)*param_1)(param_1);
  }
  if ((param_3 & 7) != 0) {
    param_3 = param_3 + (8 - (param_3 & 7));
  }
  if ((param_2 < 0) || (1 < param_2)) {
    *(undefined4 *)(*param_1 + 0x14) = 0xe;
    *(int *)(*param_1 + 0x18) = param_2;
    (**(code **)*param_1)(param_1);
  }
  param_1 = (int *)0x0;
  ppiVar3 = (int **)*(int **)(iVar1 + 0x34 + param_2 * 4);
  while (ppiVar4 = ppiVar3, ppiVar4 != (int **)0x0) {
    if (param_3 <= ppiVar4[2]) goto LAB_00426b88;
    param_1 = (int *)ppiVar4;
    ppiVar3 = (int **)*ppiVar4;
  }
  iVar6 = param_3 + 0x10;
  if (param_1 == (int *)0x0) {
    uVar5 = *(uint *)(&DAT_0043feb8 + param_2 * 4);
  }
  else {
    uVar5 = *(uint *)(&DAT_0043fec0 + param_2 * 4);
  }
  if (1000000000U - iVar6 < uVar5) {
    uVar5 = 1000000000U - iVar6;
  }
  ppiVar4 = (int **)malloc(uVar5 + iVar6);
  while (ppiVar4 == (int **)0x0) {
    uVar5 = uVar5 >> 1;
    if (uVar5 < 0x32) {
      *(undefined4 *)(*piVar2 + 0x14) = 0x36;
      *(undefined4 *)(*piVar2 + 0x18) = 2;
      (**(code **)*piVar2)(piVar2);
    }
    ppiVar4 = (int **)malloc(uVar5 + iVar6);
  }
  *(int *)(iVar1 + 0x4c) = *(int *)(iVar1 + 0x4c) + uVar5 + iVar6;
  *ppiVar4 = (int *)0x0;
  ((int *)ppiVar4)[1] = 0;
  ((int *)ppiVar4)[2] = uVar5 + param_3;
  if (param_1 == (int *)0x0) {
    *(int ***)(iVar1 + 0x34 + param_2 * 4) = ppiVar4;
  }
  else {
    *param_1 = (int)ppiVar4;
  }
LAB_00426b88:
  iVar1 = ((int *)ppiVar4)[1];
  ((int *)ppiVar4)[2] = ((int *)ppiVar4)[2] - param_3;
  ((int *)ppiVar4)[1] = iVar1 + param_3;
  return iVar1 + 0x10 + (int)ppiVar4;
}



undefined4 * __cdecl FUN_00426ba0(int *param_1,int param_2,uint param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  iVar1 = param_1[1];
  if (0x3b9ac9f0 < param_3) {
    *(undefined4 *)(*param_1 + 0x14) = 0x36;
    *(undefined4 *)(*param_1 + 0x18) = 3;
    (**(code **)*param_1)(param_1);
  }
  if ((param_3 & 7) != 0) {
    param_3 = param_3 + (8 - (param_3 & 7));
  }
  if ((param_2 < 0) || (1 < param_2)) {
    *(undefined4 *)(*param_1 + 0x14) = 0xe;
    *(int *)(*param_1 + 0x18) = param_2;
    (**(code **)*param_1)(param_1);
  }
  puVar3 = (undefined4 *)malloc(param_3 + 0x10);
  if (puVar3 == (undefined4 *)0x0) {
    *(undefined4 *)(*param_1 + 0x14) = 0x36;
    *(undefined4 *)(*param_1 + 0x18) = 4;
    (**(code **)*param_1)(param_1);
  }
  *(int *)(iVar1 + 0x4c) = *(int *)(iVar1 + 0x4c) + param_3 + 0x10;
  uVar2 = *(undefined4 *)(iVar1 + 0x3c + param_2 * 4);
  puVar3[1] = param_3;
  *puVar3 = uVar2;
  puVar3[2] = 0;
  *(undefined4 **)(iVar1 + 0x3c + param_2 * 4) = puVar3;
  return puVar3 + 4;
}



int __cdecl FUN_00426c60(int *param_1,int param_2,uint param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  undefined4 *puVar3;
  uint uVar4;
  uint uVar5;
  
  uVar1 = (uint)(0x3b9ac9f0 / (ulonglong)param_3);
  iVar2 = param_1[1];
  if (uVar1 == 0) {
    *(undefined4 *)(*param_1 + 0x14) = 0x46;
    (**(code **)*param_1)(param_1);
  }
  if ((int)param_4 <= (int)uVar1) {
    uVar1 = param_4;
  }
  *(uint *)(iVar2 + 0x50) = uVar1;
  iVar2 = FUN_00426a50(param_1,param_2,param_4 * 4);
  uVar5 = 0;
  if (param_4 != 0) {
    do {
      if (param_4 - uVar5 <= uVar1) {
        uVar1 = param_4 - uVar5;
      }
      puVar3 = FUN_00426ba0(param_1,param_2,uVar1 * param_3);
      for (uVar4 = uVar1; uVar4 != 0; uVar4 = uVar4 - 1) {
        *(undefined4 **)(iVar2 + uVar5 * 4) = puVar3;
        uVar5 = uVar5 + 1;
        puVar3 = (undefined4 *)((int)puVar3 + param_3);
      }
    } while (uVar5 < param_4);
  }
  return iVar2;
}



int __cdecl FUN_00426d10(int *param_1,int param_2,int param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  undefined4 *puVar3;
  uint uVar4;
  uint uVar5;
  
  uVar1 = (uint)(0x3b9ac9f0 / (ulonglong)(uint)(param_3 * 0x80));
  iVar2 = param_1[1];
  if (uVar1 == 0) {
    *(undefined4 *)(*param_1 + 0x14) = 0x46;
    (**(code **)*param_1)(param_1);
  }
  if ((int)param_4 <= (int)uVar1) {
    uVar1 = param_4;
  }
  *(uint *)(iVar2 + 0x50) = uVar1;
  iVar2 = FUN_00426a50(param_1,param_2,param_4 * 4);
  uVar5 = 0;
  if (param_4 != 0) {
    do {
      if (param_4 - uVar5 <= uVar1) {
        uVar1 = param_4 - uVar5;
      }
      puVar3 = FUN_00426ba0(param_1,param_2,uVar1 * param_3 * 0x80);
      for (uVar4 = uVar1; uVar4 != 0; uVar4 = uVar4 - 1) {
        *(undefined4 **)(iVar2 + uVar5 * 4) = puVar3;
        uVar5 = uVar5 + 1;
        puVar3 = puVar3 + param_3 * 0x20;
      }
    } while (uVar5 < param_4);
  }
  return iVar2;
}



void __cdecl
FUN_00426dc0(int *param_1,int param_2,undefined param_3,undefined4 param_4,undefined4 param_5,
            undefined4 param_6)

{
  int iVar1;
  undefined4 *puVar2;
  
  iVar1 = param_1[1];
  if (param_2 != 1) {
    *(undefined4 *)(*param_1 + 0x14) = 0xe;
    *(int *)(*param_1 + 0x18) = param_2;
    (**(code **)*param_1)(param_1);
  }
  puVar2 = (undefined4 *)FUN_00426a50(param_1,param_2,0x78);
  puVar2[1] = param_5;
  puVar2[2] = param_4;
  *puVar2 = 0;
  puVar2[3] = param_6;
  *(undefined *)(puVar2 + 8) = param_3;
  *(undefined *)((int)puVar2 + 0x22) = 0;
  puVar2[9] = *(undefined4 *)(iVar1 + 0x44);
  *(undefined4 **)(iVar1 + 0x44) = puVar2;
  return;
}



void __cdecl
FUN_00426e30(int *param_1,int param_2,undefined param_3,undefined4 param_4,undefined4 param_5,
            undefined4 param_6)

{
  int iVar1;
  undefined4 *puVar2;
  
  iVar1 = param_1[1];
  if (param_2 != 1) {
    *(undefined4 *)(*param_1 + 0x14) = 0xe;
    *(int *)(*param_1 + 0x18) = param_2;
    (**(code **)*param_1)(param_1);
  }
  puVar2 = (undefined4 *)FUN_00426a50(param_1,param_2,0x78);
  puVar2[1] = param_5;
  puVar2[2] = param_4;
  *puVar2 = 0;
  puVar2[3] = param_6;
  *(undefined *)(puVar2 + 8) = param_3;
  *(undefined *)((int)puVar2 + 0x22) = 0;
  puVar2[9] = *(undefined4 *)(iVar1 + 0x48);
  *(undefined4 **)(iVar1 + 0x48) = puVar2;
  return;
}



void __cdecl FUN_00426ea0(int *param_1)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  
  iVar1 = param_1[1];
  iVar4 = 0;
  piVar2 = *(int **)(iVar1 + 0x44);
  for (piVar3 = piVar2; piVar3 != (int *)0x0; piVar3 = (int *)piVar3[9]) {
    if (*piVar3 == 0) {
      iVar4 = iVar4 + piVar3[3] * piVar3[2];
    }
  }
  for (piVar3 = *(int **)(iVar1 + 0x48); piVar3 != (int *)0x0; piVar3 = (int *)piVar3[9]) {
    if (*piVar3 == 0) {
      iVar4 = iVar4 + piVar3[3] * piVar3[2] * 0x80;
    }
  }
  if (0 < iVar4) {
    for (; piVar2 != (int *)0x0; piVar2 = (int *)piVar2[9]) {
      if (*piVar2 == 0) {
        if ((int)((piVar2[1] - 1U) / (uint)piVar2[3] + 1) < 0x3b9aca01) {
          piVar2[4] = piVar2[1];
        }
        else {
          piVar2[4] = piVar2[3] * 1000000000;
          *(undefined4 *)(*param_1 + 0x14) = 0x31;
          (**(code **)*param_1)(param_1);
          *(undefined *)((int)piVar2 + 0x22) = 1;
        }
        iVar4 = FUN_00426c60(param_1,1,piVar2[2],piVar2[4]);
        *piVar2 = iVar4;
        piVar2[5] = *(int *)(iVar1 + 0x50);
        piVar2[6] = 0;
        piVar2[7] = 0;
        *(undefined *)((int)piVar2 + 0x21) = 0;
      }
    }
    for (piVar3 = *(int **)(iVar1 + 0x48); piVar3 != (int *)0x0; piVar3 = (int *)piVar3[9]) {
      if (*piVar3 == 0) {
        if ((int)((piVar3[1] - 1U) / (uint)piVar3[3] + 1) < 0x3b9aca01) {
          piVar3[4] = piVar3[1];
        }
        else {
          piVar3[4] = piVar3[3] * 1000000000;
          *(undefined4 *)(*param_1 + 0x14) = 0x31;
          (**(code **)*param_1)(param_1);
          *(undefined *)((int)piVar3 + 0x22) = 1;
        }
        iVar4 = FUN_00426d10(param_1,1,piVar3[2],piVar3[4]);
        *piVar3 = iVar4;
        piVar3[5] = *(int *)(iVar1 + 0x50);
        piVar3[6] = 0;
        piVar3[7] = 0;
        *(undefined *)((int)piVar3 + 0x21) = 0;
      }
    }
  }
  return;
}



void __cdecl FUN_00427020(undefined4 param_1,char param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *unaff_ESI;
  int iVar5;
  
  iVar3 = unaff_ESI[4];
  iVar1 = unaff_ESI[2];
  iVar4 = unaff_ESI[6] * iVar1;
  iVar5 = 0;
  if (0 < iVar3) {
    do {
      iVar2 = iVar3 - iVar5;
      if (unaff_ESI[5] < iVar3 - iVar5) {
        iVar2 = unaff_ESI[5];
      }
      iVar3 = unaff_ESI[7] - (unaff_ESI[6] + iVar5);
      if (iVar3 <= iVar2) {
        iVar2 = iVar3;
      }
      iVar3 = unaff_ESI[1] - (unaff_ESI[6] + iVar5);
      if (iVar3 <= iVar2) {
        iVar2 = iVar3;
      }
      if (iVar2 < 1) {
        return;
      }
      iVar2 = iVar2 * iVar1;
      if (param_2 == '\0') {
        (*(code *)unaff_ESI[10])
                  (param_1,unaff_ESI + 10,*(undefined4 *)(*unaff_ESI + iVar5 * 4),iVar4,iVar2);
      }
      else {
        (*(code *)unaff_ESI[0xb])(param_1,unaff_ESI + 10,*(undefined4 *)(*unaff_ESI + iVar5 * 4));
      }
      iVar5 = iVar5 + unaff_ESI[5];
      iVar3 = unaff_ESI[4];
      iVar4 = iVar4 + iVar2;
    } while (iVar5 < iVar3);
  }
  return;
}



void __cdecl FUN_004270c0(undefined4 param_1,char param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *unaff_ESI;
  int iVar5;
  
  iVar3 = unaff_ESI[4];
  iVar1 = unaff_ESI[2];
  iVar4 = unaff_ESI[6] * iVar1 * 0x80;
  iVar5 = 0;
  if (0 < iVar3) {
    do {
      iVar2 = iVar3 - iVar5;
      if (unaff_ESI[5] < iVar3 - iVar5) {
        iVar2 = unaff_ESI[5];
      }
      iVar3 = unaff_ESI[7] - (unaff_ESI[6] + iVar5);
      if (iVar3 <= iVar2) {
        iVar2 = iVar3;
      }
      iVar3 = unaff_ESI[1] - (unaff_ESI[6] + iVar5);
      if (iVar3 <= iVar2) {
        iVar2 = iVar3;
      }
      if (iVar2 < 1) {
        return;
      }
      iVar2 = iVar2 * iVar1 * 0x80;
      if (param_2 == '\0') {
        (*(code *)unaff_ESI[10])
                  (param_1,unaff_ESI + 10,*(undefined4 *)(*unaff_ESI + iVar5 * 4),iVar4,iVar2);
      }
      else {
        (*(code *)unaff_ESI[0xb])(param_1,unaff_ESI + 10,*(undefined4 *)(*unaff_ESI + iVar5 * 4));
      }
      iVar5 = iVar5 + unaff_ESI[5];
      iVar3 = unaff_ESI[4];
      iVar4 = iVar4 + iVar2;
    } while (iVar5 < iVar3);
  }
  return;
}



void __cdecl FUN_004273f0(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 *puVar5;
  
  iVar1 = param_1[1];
  if ((param_2 < 0) || (1 < param_2)) {
    *(undefined4 *)(*param_1 + 0x14) = 0xe;
    *(int *)(*param_1 + 0x18) = param_2;
    (**(code **)*param_1)(param_1);
  }
  if (param_2 == 1) {
    for (iVar2 = *(int *)(iVar1 + 0x44); iVar2 != 0; iVar2 = *(int *)(iVar2 + 0x24)) {
      if (*(char *)(iVar2 + 0x22) != '\0') {
        *(undefined *)(iVar2 + 0x22) = 0;
        (**(code **)(iVar2 + 0x30))(param_1,iVar2 + 0x28);
      }
    }
    iVar2 = *(int *)(iVar1 + 0x48);
    *(undefined4 *)(iVar1 + 0x44) = 0;
    for (; iVar2 != 0; iVar2 = *(int *)(iVar2 + 0x24)) {
      if (*(char *)(iVar2 + 0x22) != '\0') {
        *(undefined *)(iVar2 + 0x22) = 0;
        (**(code **)(iVar2 + 0x30))(param_1,iVar2 + 0x28);
      }
    }
    *(undefined4 *)(iVar1 + 0x48) = 0;
  }
  puVar3 = *(undefined4 **)(iVar1 + 0x3c + param_2 * 4);
  *(undefined4 *)(iVar1 + 0x3c + param_2 * 4) = 0;
  while (puVar3 != (undefined4 *)0x0) {
    iVar2 = puVar3[2];
    iVar4 = puVar3[1];
    puVar5 = (undefined4 *)*puVar3;
    free(puVar3);
    *(int *)(iVar1 + 0x4c) = *(int *)(iVar1 + 0x4c) - (iVar2 + 0x10 + iVar4);
    puVar3 = puVar5;
  }
  puVar3 = *(undefined4 **)(iVar1 + 0x34 + param_2 * 4);
  *(undefined4 *)(iVar1 + 0x34 + param_2 * 4) = 0;
  while (puVar3 != (undefined4 *)0x0) {
    iVar2 = puVar3[2];
    iVar4 = puVar3[1];
    puVar5 = (undefined4 *)*puVar3;
    free(puVar3);
    *(int *)(iVar1 + 0x4c) = *(int *)(iVar1 + 0x4c) - (iVar2 + 0x10 + iVar4);
    puVar3 = puVar5;
  }
  return;
}



void FUN_00427530(void)

{
  code **ppcVar1;
  char *_Src;
  int iVar2;
  int *unaff_EBX;
  char cStack_5;
  code *local_4;
  
  unaff_EBX[1] = 0;
  local_4 = (code *)0x0;
  ppcVar1 = (code **)malloc(0x54);
  if (ppcVar1 == (code **)0x0) {
    *(undefined4 *)(*unaff_EBX + 0x14) = 0x36;
    *(undefined4 *)(*unaff_EBX + 0x18) = 0;
    (**(code **)*unaff_EBX)();
  }
  *ppcVar1 = FUN_00426a50;
  ppcVar1[1] = FUN_00426ba0;
  ppcVar1[2] = FUN_00426c60;
  ppcVar1[3] = FUN_00426d10;
  ppcVar1[4] = FUN_00426dc0;
  ppcVar1[5] = FUN_00426e30;
  ppcVar1[6] = FUN_00426ea0;
  ppcVar1[7] = (code *)&LAB_00427160;
  ppcVar1[8] = (code *)&LAB_004272a0;
  ppcVar1[9] = FUN_004273f0;
  ppcVar1[10] = (code *)&LAB_004274f0;
  ppcVar1[0xc] = (code *)0x3b9aca00;
  ppcVar1[0xb] = local_4;
  ppcVar1[0xe] = (code *)0x0;
  ppcVar1[0x10] = (code *)0x0;
  ppcVar1[0xd] = (code *)0x0;
  ppcVar1[0xf] = (code *)0x0;
  ppcVar1[0x11] = (code *)0x0;
  ppcVar1[0x12] = (code *)0x0;
  ppcVar1[0x13] = (code *)0x54;
  unaff_EBX[1] = (int)ppcVar1;
  _Src = getenv("JPEGMEM");
  if (_Src != (char *)0x0) {
    cStack_5 = 'x';
    iVar2 = sscanf(_Src,"%ld%c",&local_4,&cStack_5);
    if (0 < iVar2) {
      if ((cStack_5 == 'm') || (cStack_5 == 'M')) {
        ppcVar1[0xb] = (code *)((int)local_4 * 1000000);
        return;
      }
      ppcVar1[0xb] = (code *)((int)local_4 * 1000);
    }
  }
  return;
}



// WARNING: Variable defined which should be unmapped: param_1

void __cdecl FUN_00427650(undefined param_1)

{
  int *piVar1;
  int *piVar2;
  char cVar3;
  int *unaff_ESI;
  
  piVar2 = (int *)unaff_ESI[6];
  *(undefined *)*piVar2 = 0xff;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
      (**(code **)*unaff_ESI)();
    }
  }
  piVar2 = (int *)unaff_ESI[6];
  *(undefined *)*piVar2 = param_1;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
                    // WARNING: Could not recover jumptable at 0x004276b3. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)*unaff_ESI)();
      return;
    }
  }
  return;
}



void FUN_004276c0(void)

{
  int *piVar1;
  int *piVar2;
  char cVar3;
  undefined4 unaff_EBX;
  int *unaff_ESI;
  
  piVar2 = (int *)unaff_ESI[6];
  *(char *)*piVar2 = (char)((uint)unaff_EBX >> 8);
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
      (**(code **)*unaff_ESI)();
    }
  }
  piVar2 = (int *)unaff_ESI[6];
  *(char *)*piVar2 = (char)unaff_EBX;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
      (**(code **)*unaff_ESI)();
    }
  }
  return;
}



char __cdecl FUN_00427730(int param_1)

{
  char **ppcVar1;
  undefined2 uVar2;
  int iVar3;
  int *piVar4;
  char **ppcVar5;
  int *piVar6;
  bool bVar7;
  char cVar8;
  ushort *puVar9;
  int iVar10;
  int *unaff_ESI;
  int *piVar11;
  
  iVar3 = unaff_ESI[param_1 + 0x12];
  if (iVar3 == 0) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x34;
    *(int *)(*unaff_ESI + 0x18) = param_1;
    (**(code **)*unaff_ESI)();
  }
  bVar7 = false;
  puVar9 = (ushort *)(iVar3 + 4);
  iVar10 = 0x10;
  do {
    if (0xff < puVar9[-2]) {
      bVar7 = true;
    }
    if (0xff < puVar9[-1]) {
      bVar7 = true;
    }
    if (0xff < *puVar9) {
      bVar7 = true;
    }
    if (0xff < puVar9[1]) {
      bVar7 = true;
    }
    puVar9 = puVar9 + 4;
    iVar10 = iVar10 + -1;
  } while (iVar10 != 0);
  if (*(char *)(iVar3 + 0x80) == '\0') {
    piVar4 = (int *)unaff_ESI[6];
    *(undefined *)*piVar4 = 0xff;
    *piVar4 = *piVar4 + 1;
    piVar11 = piVar4 + 1;
    *piVar11 = *piVar11 + -1;
    if ((*piVar11 == 0) && (cVar8 = (*(code *)piVar4[3])(), cVar8 == '\0')) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
      (**(code **)*unaff_ESI)();
    }
    piVar4 = (int *)unaff_ESI[6];
    *(undefined *)*piVar4 = 0xdb;
    *piVar4 = *piVar4 + 1;
    piVar11 = piVar4 + 1;
    *piVar11 = *piVar11 + -1;
    if ((*piVar11 == 0) && (cVar8 = (*(code *)piVar4[3])(), cVar8 == '\0')) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
      (**(code **)*unaff_ESI)();
    }
    piVar4 = (int *)unaff_ESI[6];
    *(undefined *)*piVar4 = 0;
    *piVar4 = *piVar4 + 1;
    piVar11 = piVar4 + 1;
    *piVar11 = *piVar11 + -1;
    if ((*piVar11 == 0) && (cVar8 = (*(code *)piVar4[3])(), cVar8 == '\0')) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
      (**(code **)*unaff_ESI)();
    }
    ppcVar5 = (char **)unaff_ESI[6];
    **ppcVar5 = (-bVar7 & 0x40U) + 0x43;
    *ppcVar5 = *ppcVar5 + 1;
    ppcVar1 = ppcVar5 + 1;
    *ppcVar1 = *ppcVar1 + -1;
    if ((*ppcVar1 == (char *)0x0) && (cVar8 = (*(code *)ppcVar5[3])(), cVar8 == '\0')) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
      (**(code **)*unaff_ESI)();
    }
    ppcVar5 = (char **)unaff_ESI[6];
    **ppcVar5 = bVar7 * '\x10' + (char)param_1;
    *ppcVar5 = *ppcVar5 + 1;
    ppcVar1 = ppcVar5 + 1;
    *ppcVar1 = *ppcVar1 + -1;
    if ((*ppcVar1 == (char *)0x0) && (cVar8 = (*(code *)ppcVar5[3])(), cVar8 == '\0')) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
      (**(code **)*unaff_ESI)();
    }
    piVar11 = &DAT_0043fd78;
    do {
      uVar2 = *(undefined2 *)(iVar3 + *piVar11 * 2);
      if (bVar7) {
        piVar6 = (int *)unaff_ESI[6];
        *(char *)*piVar6 = (char)((ushort)uVar2 >> 8);
        *piVar6 = *piVar6 + 1;
        piVar4 = piVar6 + 1;
        *piVar4 = *piVar4 + -1;
        if ((*piVar4 == 0) && (cVar8 = (*(code *)piVar6[3])(), cVar8 == '\0')) {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
          (**(code **)*unaff_ESI)();
        }
      }
      piVar6 = (int *)unaff_ESI[6];
      *(char *)*piVar6 = (char)uVar2;
      *piVar6 = *piVar6 + 1;
      piVar4 = piVar6 + 1;
      *piVar4 = *piVar4 + -1;
      if ((*piVar4 == 0) && (cVar8 = (*(code *)piVar6[3])(), cVar8 == '\0')) {
        *(undefined4 *)(*unaff_ESI + 0x14) = 0x18;
        (**(code **)*unaff_ESI)();
      }
      piVar11 = piVar11 + 1;
    } while ((int)piVar11 < 0x43fe78);
    *(undefined *)(iVar3 + 0x80) = 1;
  }
  return bVar7;
}



void __cdecl FUN_00427960(int param_1,char param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  int *piVar4;
  byte bVar5;
  int *piVar6;
  char cVar7;
  int *in_EAX;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  
  if (param_2 == '\0') {
    iVar11 = in_EAX[param_1 + 0x16];
  }
  else {
    iVar11 = in_EAX[param_1 + 0x1a];
    param_1 = param_1 + 0x10;
  }
  if (iVar11 == 0) {
    *(undefined4 *)(*in_EAX + 0x14) = 0x32;
    *(int *)(*in_EAX + 0x18) = param_1;
    (**(code **)*in_EAX)();
  }
  if (*(char *)(iVar11 + 0x111) == '\0') {
    FUN_00427650(0xc4);
    iVar10 = 0;
    pbVar8 = (byte *)(iVar11 + 3);
    iVar9 = 4;
    do {
      pbVar1 = pbVar8 + -1;
      pbVar2 = pbVar8 + -2;
      pbVar3 = pbVar8 + 1;
      bVar5 = *pbVar8;
      pbVar8 = pbVar8 + 4;
      iVar9 = iVar9 + -1;
      iVar10 = (uint)bVar5 + iVar10 + (uint)*pbVar2 + (uint)*pbVar1 + (uint)*pbVar3;
    } while (iVar9 != 0);
    piVar6 = (int *)in_EAX[6];
    *(char *)*piVar6 = (char)((uint)(iVar10 + 0x13) >> 8);
    *piVar6 = *piVar6 + 1;
    piVar4 = piVar6 + 1;
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      cVar7 = (*(code *)piVar6[3])();
      if (cVar7 == '\0') {
        *(undefined4 *)(*in_EAX + 0x14) = 0x18;
        (**(code **)*in_EAX)();
      }
    }
    piVar6 = (int *)in_EAX[6];
    *(char *)*piVar6 = (char)(iVar10 + 0x13);
    *piVar6 = *piVar6 + 1;
    piVar4 = piVar6 + 1;
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      cVar7 = (*(code *)piVar6[3])();
      if (cVar7 == '\0') {
        *(undefined4 *)(*in_EAX + 0x14) = 0x18;
        (**(code **)*in_EAX)();
      }
    }
    piVar6 = (int *)in_EAX[6];
    *(undefined *)*piVar6 = (undefined)param_1;
    *piVar6 = *piVar6 + 1;
    piVar4 = piVar6 + 1;
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      cVar7 = (*(code *)piVar6[3])();
      if (cVar7 == '\0') {
        *(undefined4 *)(*in_EAX + 0x14) = 0x18;
        (**(code **)*in_EAX)();
      }
    }
    iVar9 = 1;
    do {
      piVar6 = (int *)in_EAX[6];
      *(undefined *)*piVar6 = *(undefined *)(iVar9 + iVar11);
      *piVar6 = *piVar6 + 1;
      piVar4 = piVar6 + 1;
      *piVar4 = *piVar4 + -1;
      if (*piVar4 == 0) {
        cVar7 = (*(code *)piVar6[3])();
        if (cVar7 == '\0') {
          *(undefined4 *)(*in_EAX + 0x14) = 0x18;
          (**(code **)*in_EAX)();
        }
      }
      iVar9 = iVar9 + 1;
    } while (iVar9 < 0x11);
    iVar9 = 0;
    if (0 < iVar10) {
      do {
        piVar6 = (int *)in_EAX[6];
        *(undefined *)*piVar6 = *(undefined *)(iVar11 + 0x11 + iVar9);
        *piVar6 = *piVar6 + 1;
        piVar4 = piVar6 + 1;
        *piVar4 = *piVar4 + -1;
        if (*piVar4 == 0) {
          cVar7 = (*(code *)piVar6[3])();
          if (cVar7 == '\0') {
            *(undefined4 *)(*in_EAX + 0x14) = 0x18;
            (**(code **)*in_EAX)();
          }
        }
        iVar9 = iVar9 + 1;
      } while (iVar9 < iVar10);
    }
    *(undefined *)(iVar11 + 0x111) = 1;
  }
  return;
}



void __fastcall FUN_00427b20(int *param_1)

{
  int *piVar1;
  char **ppcVar2;
  int *piVar3;
  char **ppcVar4;
  undefined in_AL;
  char cVar5;
  int iVar6;
  undefined *puVar7;
  
  FUN_00427650(in_AL);
  FUN_004276c0();
  if ((0xffff < param_1[8]) || (0xffff < param_1[7])) {
    *(undefined4 *)(*param_1 + 0x14) = 0x29;
    *(undefined4 *)(*param_1 + 0x18) = 0xffff;
    (**(code **)*param_1)(param_1);
  }
  piVar3 = (int *)param_1[6];
  *(undefined *)*piVar3 = *(undefined *)(param_1 + 0xe);
  *piVar3 = *piVar3 + 1;
  piVar1 = piVar3 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar5 = (*(code *)piVar3[3])(param_1);
    if (cVar5 == '\0') {
      *(undefined4 *)(*param_1 + 0x14) = 0x18;
      (**(code **)*param_1)(param_1);
    }
  }
  FUN_004276c0();
  FUN_004276c0();
  piVar3 = (int *)param_1[6];
  *(undefined *)*piVar3 = *(undefined *)(param_1 + 0xf);
  *piVar3 = *piVar3 + 1;
  piVar1 = piVar3 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar5 = (*(code *)piVar3[3])(param_1);
    if (cVar5 == '\0') {
      *(undefined4 *)(*param_1 + 0x14) = 0x18;
      (**(code **)*param_1)(param_1);
    }
  }
  puVar7 = (undefined *)param_1[0x11];
  iVar6 = 0;
  if (0 < param_1[0xf]) {
    do {
      piVar3 = (int *)param_1[6];
      *(undefined *)*piVar3 = *puVar7;
      *piVar3 = *piVar3 + 1;
      piVar1 = piVar3 + 1;
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        cVar5 = (*(code *)piVar3[3])(param_1);
        if (cVar5 == '\0') {
          *(undefined4 *)(*param_1 + 0x14) = 0x18;
          (**(code **)*param_1)(param_1);
        }
      }
      ppcVar4 = (char **)param_1[6];
      **ppcVar4 = puVar7[8] * '\x10' + puVar7[0xc];
      *ppcVar4 = *ppcVar4 + 1;
      ppcVar2 = ppcVar4 + 1;
      *ppcVar2 = *ppcVar2 + -1;
      if (*ppcVar2 == (char *)0x0) {
        cVar5 = (*(code *)ppcVar4[3])(param_1);
        if (cVar5 == '\0') {
          *(undefined4 *)(*param_1 + 0x14) = 0x18;
          (**(code **)*param_1)(param_1);
        }
      }
      piVar3 = (int *)param_1[6];
      *(undefined *)*piVar3 = puVar7[0x10];
      *piVar3 = *piVar3 + 1;
      piVar1 = piVar3 + 1;
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        cVar5 = (*(code *)piVar3[3])(param_1);
        if (cVar5 == '\0') {
          *(undefined4 *)(*param_1 + 0x14) = 0x18;
          (**(code **)*param_1)(param_1);
        }
      }
      iVar6 = iVar6 + 1;
      puVar7 = puVar7 + 0x54;
    } while (iVar6 < param_1[0xf]);
  }
  return;
}



void FUN_00427ca0(void)

{
  char **ppcVar1;
  int *piVar2;
  undefined *puVar3;
  int *piVar4;
  char **ppcVar5;
  char cVar6;
  char cVar7;
  int *in_EAX;
  char cVar8;
  int *piVar9;
  int iVar10;
  
  FUN_00427650(0xda);
  FUN_004276c0();
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = *(undefined *)(in_EAX + 0x39);
  *piVar2 = *piVar2 + 1;
  piVar9 = piVar2 + 1;
  *piVar9 = *piVar9 + -1;
  if ((*piVar9 == 0) && (cVar7 = (*(code *)piVar2[3])(), cVar7 == '\0')) {
    *(undefined4 *)(*in_EAX + 0x14) = 0x18;
    (**(code **)*in_EAX)();
  }
  iVar10 = 0;
  if (0 < in_EAX[0x39]) {
    piVar9 = in_EAX + 0x3a;
    do {
      puVar3 = (undefined *)*piVar9;
      piVar4 = (int *)in_EAX[6];
      *(undefined *)*piVar4 = *puVar3;
      *piVar4 = *piVar4 + 1;
      piVar2 = piVar4 + 1;
      *piVar2 = *piVar2 + -1;
      if ((*piVar2 == 0) && (cVar7 = (*(code *)piVar4[3])(), cVar7 == '\0')) {
        *(undefined4 *)(*in_EAX + 0x14) = 0x18;
        (**(code **)*in_EAX)();
      }
      cVar7 = (char)*(undefined4 *)(puVar3 + 0x14);
      cVar8 = (char)*(undefined4 *)(puVar3 + 0x18);
      if (*(char *)(in_EAX + 0x35) != '\0') {
        cVar6 = cVar8;
        if (in_EAX[0x4b] == 0) {
          cVar8 = '\0';
          if ((in_EAX[0x4d] == 0) || (cVar6 = '\0', *(char *)((int)in_EAX + 0xb1) != '\0'))
          goto LAB_00427d76;
        }
        cVar8 = cVar6;
        cVar7 = '\0';
      }
LAB_00427d76:
      ppcVar5 = (char **)in_EAX[6];
      **ppcVar5 = cVar7 * '\x10' + cVar8;
      *ppcVar5 = *ppcVar5 + 1;
      ppcVar1 = ppcVar5 + 1;
      *ppcVar1 = *ppcVar1 + -1;
      if ((*ppcVar1 == (char *)0x0) && (cVar7 = (*(code *)ppcVar5[3])(), cVar7 == '\0')) {
        *(undefined4 *)(*in_EAX + 0x14) = 0x18;
        (**(code **)*in_EAX)();
      }
      iVar10 = iVar10 + 1;
      piVar9 = piVar9 + 1;
    } while (iVar10 < in_EAX[0x39]);
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = *(undefined *)(in_EAX + 0x4b);
  *piVar2 = *piVar2 + 1;
  piVar9 = piVar2 + 1;
  *piVar9 = *piVar9 + -1;
  if ((*piVar9 == 0) && (cVar7 = (*(code *)piVar2[3])(), cVar7 == '\0')) {
    *(undefined4 *)(*in_EAX + 0x14) = 0x18;
    (**(code **)*in_EAX)();
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = *(undefined *)(in_EAX + 0x4c);
  *piVar2 = *piVar2 + 1;
  piVar9 = piVar2 + 1;
  *piVar9 = *piVar9 + -1;
  if ((*piVar9 == 0) && (cVar7 = (*(code *)piVar2[3])(), cVar7 == '\0')) {
    *(undefined4 *)(*in_EAX + 0x14) = 0x18;
    (**(code **)*in_EAX)();
  }
  ppcVar5 = (char **)in_EAX[6];
  **ppcVar5 = *(char *)(in_EAX + 0x4d) * '\x10' + *(char *)(in_EAX + 0x4e);
  *ppcVar5 = *ppcVar5 + 1;
  ppcVar1 = ppcVar5 + 1;
  *ppcVar1 = *ppcVar1 + -1;
  if ((*ppcVar1 == (char *)0x0) && (cVar7 = (*(code *)ppcVar5[3])(), cVar7 == '\0')) {
    *(undefined4 *)(*in_EAX + 0x14) = 0x18;
    (**(code **)*in_EAX)();
  }
  return;
}



void FUN_00427e70(void)

{
  int *piVar1;
  int *piVar2;
  char cVar3;
  int *in_EAX;
  
  FUN_00427650(0xe0);
  FUN_004276c0();
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = 0x4a;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = 0x46;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = 0x49;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = 0x46;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = 0;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = *(undefined *)((int)in_EAX + 0xc5);
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = *(undefined *)((int)in_EAX + 0xc6);
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = *(undefined *)((int)in_EAX + 199);
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  FUN_004276c0();
  FUN_004276c0();
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = 0;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar2 = (int *)in_EAX[6];
  *(undefined *)*piVar2 = 0;
  *piVar2 = *piVar2 + 1;
  piVar1 = piVar2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar3 = (*(code *)piVar2[3])();
    if (cVar3 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  return;
}



void FUN_00428080(void)

{
  int *piVar1;
  char cVar2;
  int *in_EAX;
  int *piVar3;
  
  FUN_00427650(0xee);
  FUN_004276c0();
  piVar1 = (int *)in_EAX[6];
  *(undefined *)*piVar1 = 0x41;
  *piVar1 = *piVar1 + 1;
  piVar3 = piVar1 + 1;
  *piVar3 = *piVar3 + -1;
  if (*piVar3 == 0) {
    cVar2 = (*(code *)piVar1[3])();
    if (cVar2 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar1 = (int *)in_EAX[6];
  *(undefined *)*piVar1 = 100;
  *piVar1 = *piVar1 + 1;
  piVar3 = piVar1 + 1;
  *piVar3 = *piVar3 + -1;
  if (*piVar3 == 0) {
    cVar2 = (*(code *)piVar1[3])();
    if (cVar2 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar1 = (int *)in_EAX[6];
  *(undefined *)*piVar1 = 0x6f;
  *piVar1 = *piVar1 + 1;
  piVar3 = piVar1 + 1;
  *piVar3 = *piVar3 + -1;
  if (*piVar3 == 0) {
    cVar2 = (*(code *)piVar1[3])();
    if (cVar2 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar1 = (int *)in_EAX[6];
  *(undefined *)*piVar1 = 0x62;
  *piVar1 = *piVar1 + 1;
  piVar3 = piVar1 + 1;
  *piVar3 = *piVar3 + -1;
  if (*piVar3 == 0) {
    cVar2 = (*(code *)piVar1[3])();
    if (cVar2 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  piVar1 = (int *)in_EAX[6];
  *(undefined *)*piVar1 = 0x65;
  *piVar1 = *piVar1 + 1;
  piVar3 = piVar1 + 1;
  *piVar3 = *piVar3 + -1;
  if (*piVar3 == 0) {
    cVar2 = (*(code *)piVar1[3])();
    if (cVar2 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  FUN_004276c0();
  FUN_004276c0();
  FUN_004276c0();
  if (in_EAX[0x10] == 3) {
    piVar3 = (int *)in_EAX[6];
    *(undefined *)*piVar3 = 1;
  }
  else {
    piVar3 = (int *)in_EAX[6];
    if (in_EAX[0x10] == 5) {
      *(undefined *)*piVar3 = 2;
    }
    else {
      *(undefined *)*piVar3 = 0;
    }
  }
  *piVar3 = *piVar3 + 1;
  piVar1 = piVar3 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    cVar2 = (*(code *)piVar3[3])();
    if (cVar2 == '\0') {
      *(undefined4 *)(*in_EAX + 0x14) = 0x18;
      (**(code **)*in_EAX)();
    }
  }
  return;
}



void __cdecl FUN_00428270(int param_1)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 0x14c);
  FUN_00427650(0xd8);
  *(undefined4 *)(iVar1 + 0x1c) = 0;
  if (*(char *)(param_1 + 0xc4) != '\0') {
    FUN_00427e70();
  }
  if (*(char *)(param_1 + 0xcc) != '\0') {
    FUN_00428080();
    return;
  }
  return;
}



void FUN_004284b0(undefined4 param_1)

{
  FUN_00427650(0xd9);
  return;
}



void __fastcall FUN_004285b0(int param_1,int param_2,int param_3,int param_4,size_t param_5)

{
  void *_Src;
  void *_Dst;
  int in_EAX;
  void **ppvVar1;
  void **ppvVar2;
  
  ppvVar1 = (void **)(param_1 + in_EAX * 4);
  ppvVar2 = (void **)(param_3 + param_2 * 4);
  if (0 < param_4) {
    do {
      _Src = *ppvVar1;
      _Dst = *ppvVar2;
      ppvVar1 = ppvVar1 + 1;
      ppvVar2 = ppvVar2 + 1;
      memcpy(_Dst,_Src,param_5);
      param_4 = param_4 + -1;
    } while (0 < param_4);
  }
  return;
}



void FUN_00428600(void)

{
  char cVar1;
  int *in_EAX;
  code **ppcVar2;
  
  FUN_004302a0();
  if (*(char *)(in_EAX + 0x2c) == '\0') {
    FUN_0042f420();
    FUN_00432970();
    FUN_004311c0();
  }
  FUN_004320f0();
  if (*(char *)((int)in_EAX + 0xb1) == '\0') {
    if (*(char *)(in_EAX + 0x35) == '\0') {
      FUN_00434610();
    }
    else {
      ppcVar2 = (code **)(**(code **)in_EAX[1])();
      in_EAX[0x57] = (int)ppcVar2;
      *ppcVar2 = FUN_00432af0;
      ppcVar2[0x13] = (code *)0x0;
      ppcVar2[0x17] = (code *)0x0;
      ppcVar2[0x14] = (code *)0x0;
      ppcVar2[0x18] = (code *)0x0;
      ppcVar2[0x15] = (code *)0x0;
      ppcVar2[0x19] = (code *)0x0;
      ppcVar2[0x16] = (code *)0x0;
      ppcVar2[0x1a] = (code *)0x0;
      ppcVar2[0x10] = (code *)0x0;
    }
  }
  else {
    *(undefined4 *)(*in_EAX + 0x14) = 1;
    (**(code **)*in_EAX)();
  }
  if ((in_EAX[0x2a] < 2) && (*(char *)((int)in_EAX + 0xb2) == '\0')) {
    cVar1 = '\0';
  }
  else {
    cVar1 = '\x01';
  }
  FUN_00430b00((int)in_EAX,cVar1);
  FUN_0042f740();
  ppcVar2 = (code **)(**(code **)in_EAX[1])();
  in_EAX[0x53] = (int)ppcVar2;
  *ppcVar2 = FUN_00428270;
  ppcVar2[1] = (code *)&LAB_004282c0;
  ppcVar2[2] = (code *)&LAB_004283c0;
  ppcVar2[3] = FUN_004284b0;
  ppcVar2[4] = (code *)&LAB_004284d0;
  ppcVar2[5] = (code *)&LAB_004281f0;
  ppcVar2[6] = (code *)&LAB_00428230;
  ppcVar2[7] = (code *)0x0;
  (**(code **)(in_EAX[1] + 0x18))();
  (**(code **)in_EAX[0x53])();
  return;
}



void __fastcall FUN_00428870(int param_1,int *param_2,char param_3,int *param_4)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  undefined *puVar8;
  uint _Size;
  undefined *puVar9;
  int iVar10;
  int iStack_528;
  int iStack_524;
  int iStack_520;
  int iStack_51c;
  int iStack_518;
  int *local_514;
  int aiStack_510 [258];
  char acStack_108 [260];
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&iStack_528;
  local_514 = param_2;
  if ((param_1 < 0) || (3 < param_1)) {
    *(undefined4 *)(*param_2 + 0x14) = 0x32;
    *(int *)(*param_2 + 0x18) = param_1;
    (**(code **)*param_2)(param_2);
  }
  if (param_3 == '\0') {
    iVar6 = param_2[param_1 + 0x2c];
  }
  else {
    iVar6 = param_2[param_1 + 0x28];
  }
  iStack_528 = iVar6;
  if (iVar6 == 0) {
    *(undefined4 *)(*param_2 + 0x14) = 0x32;
    *(int *)(*param_2 + 0x18) = param_1;
    (**(code **)*param_2)(param_2);
  }
  if (*param_4 == 0) {
    iVar2 = (**(code **)param_2[1])(param_2,1,0x590);
    *param_4 = iVar2;
  }
  iVar2 = *param_4;
  *(int *)(iVar2 + 0x8c) = iVar6;
  iVar10 = 0;
  iVar6 = 1;
  iStack_524 = iVar2;
  do {
    _Size = (uint)*(byte *)(iStack_528 + iVar6);
    if (0x100 < (int)(_Size + iVar10)) {
      *(undefined4 *)(*param_2 + 0x14) = 8;
      (**(code **)*param_2)(param_2);
      iVar2 = iStack_524;
    }
    if (_Size != 0) {
      memset(acStack_108 + iVar10,iVar6,_Size);
      iVar10 = iVar10 + _Size;
      iVar2 = iStack_524;
    }
    iVar6 = iVar6 + 1;
  } while (iVar6 < 0x11);
  acStack_108[iVar10] = '\0';
  aiStack_510[0] = iVar10;
  iVar6 = 0;
  iVar10 = 0;
  iVar7 = (int)acStack_108[0];
  if (acStack_108[0] != '\0') {
    pcVar3 = acStack_108;
    do {
      cVar1 = *pcVar3;
      while (cVar1 == iVar7) {
        cVar1 = acStack_108[iVar10 + 1];
        aiStack_510[iVar10 + 1] = iVar6;
        iVar10 = iVar10 + 1;
        iVar6 = iVar6 + 1;
      }
      if (1 << ((byte)iVar7 & 0x1f) <= iVar6) {
        *(undefined4 *)(*param_2 + 0x14) = 8;
        (**(code **)*param_2)(param_2);
        iVar2 = iStack_524;
      }
      pcVar3 = acStack_108 + iVar10;
      iVar6 = iVar6 * 2;
      iVar7 = iVar7 + 1;
    } while (*pcVar3 != '\0');
  }
  iVar10 = 0;
  iVar6 = 1;
  do {
    if (*(char *)(iVar6 + iStack_528) == '\0') {
      *(undefined4 *)(iVar2 + iVar6 * 4) = 0xffffffff;
    }
    else {
      *(int *)(iVar2 + 0x48 + iVar6 * 4) = iVar10 - aiStack_510[iVar10 + 1];
      iVar10 = iVar10 + (uint)*(byte *)(iVar6 + iStack_528);
      *(int *)(iVar2 + iVar6 * 4) = aiStack_510[iVar10];
    }
    iVar6 = iVar6 + 1;
  } while (iVar6 < 0x11);
  *(undefined4 *)(iVar2 + 0x44) = 0xfffff;
  memset((void *)(iVar2 + 0x90),0,0x400);
  iVar2 = aiStack_510[0];
  iVar6 = iStack_528;
  iVar10 = 0;
  iVar7 = 1;
  iStack_520 = 7;
  do {
    iStack_51c = 1;
    if (*(char *)(iVar7 + iStack_528) != '\0') {
      iStack_518 = 1 << ((byte)iStack_520 & 0x1f);
      puVar8 = (undefined *)(iVar10 + 0x11 + iStack_528);
      do {
        iVar4 = aiStack_510[iVar10 + 1] << ((byte)iStack_520 & 0x1f);
        if (0 < iStack_518) {
          puVar9 = (undefined *)(iVar4 + 0x490 + iStack_524);
          piVar5 = (int *)(iStack_524 + 0x90 + iVar4 * 4);
          iVar4 = iStack_518;
          do {
            *piVar5 = iVar7;
            *puVar9 = *puVar8;
            iVar4 = iVar4 + -1;
            piVar5 = piVar5 + 1;
            puVar9 = puVar9 + 1;
          } while (0 < iVar4);
        }
        iStack_51c = iStack_51c + 1;
        iVar10 = iVar10 + 1;
        puVar8 = puVar8 + 1;
      } while (iStack_51c <= (int)(uint)*(byte *)(iVar7 + iStack_528));
    }
    iVar7 = iVar7 + 1;
    iStack_520 = iStack_520 + -1;
  } while (-1 < iStack_520);
  if ((param_3 != '\0') && (iVar10 = 0, 0 < aiStack_510[0])) {
    do {
      if (0xf < *(byte *)(iVar6 + 0x11 + iVar10)) {
        *(undefined4 *)(*local_514 + 0x14) = 8;
        (**(code **)*local_514)(local_514);
      }
      iVar10 = iVar10 + 1;
    } while (iVar10 < iVar2);
  }
  ___security_check_cookie_4(local_4 ^ (uint)&iStack_528);
  return;
}



undefined4 __cdecl FUN_00428b60(byte **param_1,byte *param_2,byte *param_3,int param_4)

{
  int *piVar1;
  char cVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  
  piVar1 = (int *)param_1[4];
  pbVar4 = *param_1;
  pbVar5 = param_1[1];
  if (piVar1[0x5f] == 0) {
    if ((int)param_3 < 0x19) {
      do {
        if (pbVar5 == (byte *)0x0) {
          uVar3 = (**(code **)(piVar1[6] + 0xc))(piVar1);
          if ((char)uVar3 == '\0') {
LAB_00428c18:
            return uVar3 & 0xffffff00;
          }
          pbVar4 = *(byte **)piVar1[6];
          pbVar5 = ((byte **)piVar1[6])[1];
        }
        uVar3 = (uint)*pbVar4;
        pbVar5 = pbVar5 + -1;
        pbVar4 = pbVar4 + 1;
        if (uVar3 == 0xff) {
          do {
            if (pbVar5 == (byte *)0x0) {
              uVar3 = (**(code **)(piVar1[6] + 0xc))(piVar1);
              if ((char)uVar3 == '\0') goto LAB_00428c18;
              pbVar4 = *(byte **)piVar1[6];
              pbVar5 = ((byte **)piVar1[6])[1];
            }
            uVar3 = (uint)*pbVar4;
            pbVar5 = pbVar5 + -1;
            pbVar4 = pbVar4 + 1;
          } while (uVar3 == 0xff);
          if (uVar3 != 0) {
            piVar1[0x5f] = uVar3;
            goto LAB_00428c25;
          }
          uVar3 = 0xff;
        }
        param_2 = (byte *)((int)param_2 << 8 | uVar3);
        param_3 = param_3 + 8;
      } while ((int)param_3 < 0x19);
    }
  }
  else {
LAB_00428c25:
    if ((int)param_3 < param_4) {
      if (*(char *)(piVar1[0x66] + 8) == '\0') {
        *(undefined4 *)(*piVar1 + 0x14) = 0x75;
        (**(code **)(*piVar1 + 4))(piVar1,0xffffffff);
        *(undefined *)(piVar1[0x66] + 8) = 1;
      }
      cVar2 = (char)param_3;
      param_3 = (byte *)0x19;
      param_2 = (byte *)((int)param_2 << (0x19U - cVar2 & 0x1f));
    }
  }
  param_1[1] = pbVar5;
  *param_1 = pbVar4;
  param_1[3] = param_3;
  param_1[2] = param_2;
  return CONCAT31((int3)((uint)param_3 >> 8),1);
}



uint __fastcall FUN_00428c90(int param_1,byte *param_2,byte **param_3,int param_4)

{
  int *piVar1;
  byte *in_EAX;
  undefined4 uVar2;
  byte *pbVar3;
  uint uVar4;
  
  if ((int)in_EAX < param_1) {
    uVar2 = FUN_00428b60(param_3,param_2,in_EAX,param_1);
    if ((char)uVar2 == '\0') {
      return 0xffffffff;
    }
    param_2 = param_3[2];
    in_EAX = param_3[3];
  }
  pbVar3 = in_EAX + -param_1;
  uVar4 = (int)param_2 >> ((byte)pbVar3 & 0x1f) & (1 << ((byte)param_1 & 0x1f)) - 1U;
  if (*(int *)(param_4 + param_1 * 4) < (int)uVar4) {
    do {
      if ((int)pbVar3 < 1) {
        uVar2 = FUN_00428b60(param_3,param_2,pbVar3,1);
        if ((char)uVar2 == '\0') {
          return 0xffffffff;
        }
        param_2 = param_3[2];
        pbVar3 = param_3[3];
      }
      pbVar3 = pbVar3 + -1;
      param_1 = param_1 + 1;
      uVar4 = uVar4 * 2 | (int)param_2 >> ((byte)pbVar3 & 0x1f) & 1U;
    } while (*(int *)(param_4 + param_1 * 4) < (int)uVar4);
  }
  param_3[2] = param_2;
  param_3[3] = pbVar3;
  if (param_1 < 0x11) {
    return (uint)*(byte *)(*(int *)(param_4 + 0x48 + param_1 * 4) + *(int *)(param_4 + 0x8c) + 0x11
                          + uVar4);
  }
  piVar1 = (int *)param_3[4];
  *(undefined4 *)(*piVar1 + 0x14) = 0x76;
  (**(code **)(*piVar1 + 4))(piVar1,0xffffffff);
  return 0;
}



undefined4 FUN_00428d70(void)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  undefined4 *puVar5;
  int unaff_ESI;
  
  iVar2 = *(int *)(unaff_ESI + 0x198);
  piVar1 = (int *)(*(int *)(unaff_ESI + 0x194) + 0x14);
  *piVar1 = *piVar1 + ((int)(*(int *)(iVar2 + 0x10) + (*(int *)(iVar2 + 0x10) >> 0x1f & 7U)) >> 3);
  *(undefined4 *)(iVar2 + 0x10) = 0;
  uVar3 = (**(code **)(*(int *)(unaff_ESI + 0x194) + 8))();
  if ((char)uVar3 == '\0') {
    return uVar3;
  }
  iVar4 = 0;
  if (0 < *(int *)(unaff_ESI + 0x124)) {
    puVar5 = (undefined4 *)(iVar2 + 0x14);
    do {
      *puVar5 = 0;
      iVar4 = iVar4 + 1;
      puVar5 = puVar5 + 1;
    } while (iVar4 < *(int *)(unaff_ESI + 0x124));
  }
  *(undefined4 *)(iVar2 + 0x24) = *(undefined4 *)(unaff_ESI + 0xfc);
  if (*(int *)(unaff_ESI + 0x17c) == 0) {
    *(undefined *)(iVar2 + 8) = 0;
  }
  return CONCAT31((int3)((uint)iVar4 >> 8),1);
}



uint __cdecl FUN_00428df0(int param_1,int param_2)

{
  int iVar1;
  undefined2 *puVar2;
  int iVar3;
  uint in_EAX;
  uint uVar4;
  byte *pbVar5;
  int *piVar6;
  int iVar7;
  byte *pbVar8;
  int iVar9;
  uint uVar10;
  int local_48;
  int *local_3c;
  int local_2c [4];
  byte *local_1c;
  byte *local_18;
  byte *local_14;
  byte *local_10;
  int local_c;
  
  iVar1 = *(int *)(param_1 + 0x198);
  local_2c[1] = in_EAX;
  if (((*(int *)(param_1 + 0xfc) != 0) && (local_2c[1] = in_EAX, *(int *)(iVar1 + 0x24) == 0)) &&
     (uVar4 = FUN_00428d70(), local_2c[1] = uVar4, (char)uVar4 == '\0')) {
LAB_00428e21:
    return uVar4 & 0xffffff00;
  }
  if (*(char *)(iVar1 + 8) == '\0') {
    pbVar5 = *(byte **)(iVar1 + 0x10);
    local_1c = **(byte ***)(param_1 + 0x18);
    local_2c[0] = *(int *)(iVar1 + 0x14);
    local_2c[1] = *(uint *)(iVar1 + 0x18);
    local_2c[2] = *(undefined4 *)(iVar1 + 0x1c);
    local_18 = (*(byte ***)(param_1 + 0x18))[1];
    pbVar8 = *(byte **)(iVar1 + 0xc);
    local_c = param_1;
    local_2c[3] = *(undefined4 *)(iVar1 + 0x20);
    local_48 = 0;
    if (0 < *(int *)(param_1 + 0x140)) {
      local_3c = (int *)(param_1 + 0x144);
      piVar6 = (int *)(iVar1 + 0x70);
      do {
        puVar2 = *(undefined2 **)(param_2 + local_48 * 4);
        iVar3 = *piVar6;
        iVar9 = piVar6[-10];
        if ((int)pbVar5 < 8) {
          uVar4 = FUN_00428b60(&local_1c,pbVar8,pbVar5,0);
          if ((char)uVar4 == '\0') goto LAB_00428e21;
          pbVar5 = local_10;
          pbVar8 = local_14;
          if (7 < (int)local_10) goto LAB_00428edf;
          iVar7 = 1;
LAB_00428f08:
          uVar4 = FUN_00428c90(iVar7,pbVar8,&local_1c,iVar9);
          pbVar5 = local_10;
          pbVar8 = local_14;
          uVar10 = uVar4;
          if ((int)uVar4 < 0) goto LAB_00428e21;
        }
        else {
LAB_00428edf:
          uVar4 = (int)pbVar8 >> ((char)pbVar5 - 8U & 0x1f) & 0xff;
          iVar7 = *(int *)(iVar9 + 0x90 + uVar4 * 4);
          if (iVar7 == 0) {
            iVar7 = 9;
            goto LAB_00428f08;
          }
          pbVar5 = pbVar5 + -iVar7;
          uVar10 = (uint)*(byte *)(uVar4 + 0x490 + iVar9);
        }
        uVar4 = uVar10;
        if (uVar10 != 0) {
          if (((int)pbVar5 < (int)uVar10) &&
             (uVar4 = FUN_00428b60(&local_1c,pbVar8,pbVar5,uVar10), pbVar5 = local_10,
             pbVar8 = local_14, (char)uVar4 == '\0')) goto LAB_00428e21;
          pbVar5 = pbVar5 + -uVar10;
          uVar4 = (1 << ((byte)uVar10 & 0x1f)) - 1U & (int)pbVar8 >> ((byte)pbVar5 & 0x1f);
          if ((int)uVar4 < *(int *)(&DAT_0043fcf8 + uVar10 * 4)) {
            uVar4 = *(int *)(&DAT_0043fd38 + uVar10 * 4) + uVar4;
          }
        }
        if (*(char *)(local_48 + 0x98 + iVar1) != '\0') {
          iVar9 = *local_3c;
          local_2c[iVar9] = local_2c[iVar9] + uVar4;
          *puVar2 = (short)local_2c[iVar9];
        }
        iVar9 = 1;
        if (*(char *)(local_48 + 0xa2 + iVar1) == '\0') {
          do {
            if ((int)pbVar5 < 8) {
              uVar4 = FUN_00428b60(&local_1c,pbVar8,pbVar5,0);
              if ((char)uVar4 == '\0') goto LAB_00428e21;
              pbVar5 = local_10;
              pbVar8 = local_14;
              if (7 < (int)local_10) goto LAB_00429102;
              iVar7 = 1;
LAB_0042912b:
              uVar4 = FUN_00428c90(iVar7,pbVar8,&local_1c,iVar3);
              pbVar5 = local_10;
              pbVar8 = local_14;
              if ((int)uVar4 < 0) goto LAB_00428e21;
            }
            else {
LAB_00429102:
              uVar4 = (int)pbVar8 >> ((char)pbVar5 - 8U & 0x1f) & 0xff;
              iVar7 = *(int *)(iVar3 + 0x90 + uVar4 * 4);
              if (iVar7 == 0) {
                iVar7 = 9;
                goto LAB_0042912b;
              }
              uVar4 = (uint)*(byte *)(uVar4 + 0x490 + iVar3);
              pbVar5 = pbVar5 + -iVar7;
            }
            iVar7 = (int)uVar4 >> 4;
            uVar10 = uVar4 & 0xf;
            if (uVar10 == 0) {
              if (iVar7 != 0xf) break;
            }
            else {
              if (((int)pbVar5 < (int)uVar10) &&
                 (uVar4 = FUN_00428b60(&local_1c,pbVar8,pbVar5,uVar10), pbVar5 = local_10,
                 pbVar8 = local_14, (char)uVar4 == '\0')) goto LAB_00428e21;
              pbVar5 = pbVar5 + -uVar10;
            }
            iVar9 = iVar9 + iVar7 + 1;
          } while (iVar9 < 0x40);
        }
        else {
          do {
            if ((int)pbVar5 < 8) {
              uVar4 = FUN_00428b60(&local_1c,pbVar8,pbVar5,0);
              if ((char)uVar4 == '\0') goto LAB_00428e21;
              pbVar5 = local_10;
              pbVar8 = local_14;
              if (7 < (int)local_10) goto LAB_00428ff2;
              iVar7 = 1;
LAB_0042901b:
              uVar4 = FUN_00428c90(iVar7,pbVar8,&local_1c,iVar3);
              pbVar5 = local_10;
              pbVar8 = local_14;
              if ((int)uVar4 < 0) goto LAB_00428e21;
            }
            else {
LAB_00428ff2:
              uVar4 = (int)pbVar8 >> ((char)pbVar5 - 8U & 0x1f) & 0xff;
              iVar7 = *(int *)(iVar3 + 0x90 + uVar4 * 4);
              if (iVar7 == 0) {
                iVar7 = 9;
                goto LAB_0042901b;
              }
              uVar4 = (uint)*(byte *)(uVar4 + 0x490 + iVar3);
              pbVar5 = pbVar5 + -iVar7;
            }
            uVar10 = uVar4 & 0xf;
            if (uVar10 == 0) {
              if ((int)uVar4 >> 4 != 0xf) break;
              iVar9 = iVar9 + 0xf;
            }
            else {
              iVar9 = iVar9 + ((int)uVar4 >> 4);
              if (((int)pbVar5 < (int)uVar10) &&
                 (uVar4 = FUN_00428b60(&local_1c,pbVar8,pbVar5,uVar10), pbVar5 = local_10,
                 pbVar8 = local_14, (char)uVar4 == '\0')) goto LAB_00428e21;
              pbVar5 = pbVar5 + -uVar10;
              uVar4 = (1 << (sbyte)uVar10) - 1U & (int)pbVar8 >> ((byte)pbVar5 & 0x1f);
              if ((int)uVar4 < *(int *)(&DAT_0043fcf8 + uVar10 * 4)) {
                uVar4 = *(int *)(&DAT_0043fd38 + uVar10 * 4) + uVar4;
              }
              puVar2[(&DAT_0043fd78)[iVar9]] = (short)uVar4;
            }
            iVar9 = iVar9 + 1;
          } while (iVar9 < 0x40);
        }
        piVar6 = piVar6 + 1;
        local_3c = local_3c + 1;
        local_48 = local_48 + 1;
      } while (local_48 < *(int *)(param_1 + 0x140));
    }
    **(byte ***)(param_1 + 0x18) = local_1c;
    *(byte **)(*(int *)(param_1 + 0x18) + 4) = local_18;
    *(byte **)(iVar1 + 0xc) = pbVar8;
    *(int *)(iVar1 + 0x14) = local_2c[0];
    *(byte **)(iVar1 + 0x10) = pbVar5;
    *(int *)(iVar1 + 0x18) = local_2c[1];
    *(int *)(iVar1 + 0x1c) = local_2c[2];
    *(int *)(iVar1 + 0x20) = local_2c[3];
  }
  *(int *)(iVar1 + 0x24) = *(int *)(iVar1 + 0x24) + -1;
  return CONCAT31((int3)((uint)local_2c[1] >> 8),1);
}



void FUN_00429200(void)

{
  undefined4 *puVar1;
  int unaff_ESI;
  
  puVar1 = (undefined4 *)(***(code ***)(unaff_ESI + 4))();
  *(undefined4 **)(unaff_ESI + 0x198) = puVar1;
  *puVar1 = &LAB_00428720;
  puVar1[1] = FUN_00428df0;
  puVar1[0xe] = 0;
  puVar1[10] = 0;
  puVar1[0xf] = 0;
  puVar1[0xb] = 0;
  puVar1[0x10] = 0;
  puVar1[0xc] = 0;
  puVar1[0x11] = 0;
  puVar1[0xd] = 0;
  return;
}



int __cdecl FUN_00429240(int *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  bool bVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int *piVar9;
  
  iVar2 = param_1[0x19];
  iVar3 = param_1[0x15];
  iVar7 = 1;
  do {
    iVar8 = iVar7;
    iVar7 = iVar8 + 1;
    iVar5 = iVar7;
    if (1 < iVar2) {
      iVar6 = iVar2 + -1;
      do {
        iVar5 = iVar5 * iVar7;
        iVar6 = iVar6 + -1;
      } while (iVar6 != 0);
    }
  } while (iVar5 <= iVar3);
  if (iVar8 < 2) {
    *(undefined4 *)(*param_1 + 0x14) = 0x38;
    *(int *)(*param_1 + 0x18) = iVar5;
    (**(code **)*param_1)(param_1);
  }
  iVar5 = 1;
  iVar7 = iVar2;
  piVar9 = param_2;
  if (0 < iVar2) {
    for (; iVar6 = iVar2, iVar7 != 0; iVar7 = iVar7 + -1) {
      *piVar9 = iVar8;
      piVar9 = piVar9 + 1;
    }
    do {
      iVar5 = iVar5 * iVar8;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
  }
  do {
    iVar8 = 0;
    bVar4 = false;
    iVar7 = iVar5;
    if (iVar2 < 1) {
      return iVar5;
    }
    do {
      iVar6 = iVar8;
      if (param_1[0xb] == 2) {
        iVar6 = (&DAT_0043fcd8)[iVar8];
      }
      iVar1 = param_2[iVar6] + 1;
      iVar5 = (iVar7 / param_2[iVar6]) * iVar1;
      if (iVar5 - iVar3 != 0 && iVar3 <= iVar5) {
        iVar5 = iVar7;
        if (!bVar4) {
          return iVar7;
        }
        break;
      }
      iVar8 = iVar8 + 1;
      param_2[iVar6] = iVar1;
      bVar4 = true;
      iVar7 = iVar5;
    } while (iVar8 < iVar2);
  } while( true );
}



void __cdecl FUN_00429330(int *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int *piVar10;
  int iStack_28;
  int iStack_24;
  int *piStack_20;
  int iStack_1c;
  int iStack_18;
  
  iVar2 = param_1[0x6a];
  piStack_20 = (int *)(iVar2 + 0x20);
  iVar3 = FUN_00429240(param_1,piStack_20);
  if (param_1[0x19] == 3) {
    iVar5 = *param_1;
    *(int *)(iVar5 + 0x18) = iVar3;
    *(int *)(iVar5 + 0x1c) = *piStack_20;
    *(undefined4 *)(iVar5 + 0x20) = *(undefined4 *)(iVar2 + 0x24);
    *(undefined4 *)(iVar5 + 0x24) = *(undefined4 *)(iVar2 + 0x28);
    *(undefined4 *)(*param_1 + 0x14) = 0x5e;
    (**(code **)(*param_1 + 4))();
  }
  else {
    *(undefined4 *)(*param_1 + 0x14) = 0x5f;
    *(int *)(*param_1 + 0x18) = iVar3;
    (**(code **)(*param_1 + 4))(param_1,1);
  }
  piVar4 = (int *)(**(code **)(param_1[1] + 8))(param_1,1,iVar3,param_1[0x19]);
  iStack_18 = 0;
  piVar10 = piVar4;
  iStack_24 = iVar3;
  if (0 < param_1[0x19]) {
    do {
      iStack_1c = *piStack_20;
      iVar5 = iStack_24 / iStack_1c;
      if (0 < iStack_1c) {
        iVar1 = iStack_1c + -1;
        iVar8 = 0;
        iStack_28 = 0;
        do {
          for (iVar7 = iVar8; iVar7 < iVar3; iVar7 = iVar7 + iStack_24) {
            iVar6 = 0;
            if (0 < iVar5) {
              do {
                iVar9 = *piVar10 + iVar6;
                iVar6 = iVar6 + 1;
                *(char *)(iVar7 + iVar9) = (char)((iVar1 / 2 + iStack_28) / iVar1);
              } while (iVar6 < iVar5);
            }
          }
          iStack_28 = iStack_28 + 0xff;
          iVar8 = iVar8 + iVar5;
          iStack_1c = iStack_1c + -1;
        } while (iStack_1c != 0);
      }
      piStack_20 = piStack_20 + 1;
      iStack_18 = iStack_18 + 1;
      piVar10 = piVar10 + 1;
      iStack_24 = iVar5;
    } while (iStack_18 < param_1[0x19]);
    *(int *)(iVar2 + 0x14) = iVar3;
    *(int **)(iVar2 + 0x10) = piVar4;
    return;
  }
  *(int *)(iVar2 + 0x14) = iVar3;
  *(int **)(iVar2 + 0x10) = piVar4;
  return;
}



void __cdecl FUN_004294a0(int param_1)

{
  int *piVar1;
  int iVar2;
  undefined *puVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  undefined *puVar9;
  int iVar10;
  int iVar11;
  int local_18;
  int *piStack_14;
  char cStack_10;
  int iStack_c;
  
  iVar2 = *(int *)(param_1 + 0x1a8);
  if (*(int *)(param_1 + 0x4c) == 1) {
    local_18 = 0x1fe;
    *(undefined *)(iVar2 + 0x1c) = 1;
  }
  else {
    local_18 = 0;
    *(undefined *)(iVar2 + 0x1c) = 0;
  }
  uVar4 = (**(code **)(*(int *)(param_1 + 4) + 8))
                    (param_1,1,local_18 + 0x100,*(undefined4 *)(param_1 + 100));
  *(undefined4 *)(iVar2 + 0x18) = uVar4;
  iVar5 = *(int *)(iVar2 + 0x14);
  iStack_c = 0;
  if (0 < *(int *)(param_1 + 100)) {
    piStack_14 = (int *)(iVar2 + 0x20);
    do {
      iVar7 = *piStack_14;
      iVar5 = iVar5 / iVar7;
      if (local_18 != 0) {
        piVar1 = (int *)(*(int *)(iVar2 + 0x18) + iStack_c * 4);
        *piVar1 = *piVar1 + 0xff;
      }
      puVar3 = *(undefined **)(*(int *)(iVar2 + 0x18) + iStack_c * 4);
      iVar6 = (iVar7 + 0xfe) / (iVar7 * 2 + -2);
      iVar10 = 0;
      iVar11 = 0;
      do {
        if (iVar6 < iVar11) {
          iVar8 = iVar10 * 0x1fe;
          do {
            iVar6 = (iVar8 + 0x2fc + iVar7) / (iVar7 * 2 + -2);
            iVar10 = iVar10 + 1;
            iVar8 = iVar8 + 0x1fe;
          } while (iVar6 < iVar11);
        }
        cStack_10 = (char)iVar5;
        puVar3[iVar11] = cStack_10 * (char)iVar10;
        iVar11 = iVar11 + 1;
      } while (iVar11 < 0x100);
      if (local_18 != 0) {
        iVar7 = 1;
        puVar9 = puVar3;
        do {
          puVar9 = puVar9 + -1;
          *puVar9 = *puVar3;
          puVar3[iVar7 + 0xff] = puVar3[0xff];
          iVar7 = iVar7 + 1;
        } while (iVar7 < 0x100);
      }
      piStack_14 = piStack_14 + 1;
      iStack_c = iStack_c + 1;
    } while (iStack_c < *(int *)(param_1 + 100));
  }
  return;
}



int * __fastcall FUN_00429610(int param_1)

{
  byte *pbVar1;
  int in_EAX;
  int *piVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  undefined1 *puVar6;
  
  piVar2 = (int *)(***(code ***)(in_EAX + 4))();
  puVar6 = &DAT_0043fbd8;
  piVar4 = piVar2;
  do {
    iVar3 = 0;
    piVar5 = piVar4;
    do {
      pbVar1 = puVar6 + iVar3;
      iVar3 = iVar3 + 1;
      piVar4 = piVar5 + 1;
      *piVar5 = (int)((uint)*pbVar1 * -0x1fe + 0xfe01) / (param_1 * 0x200 + -0x200);
      piVar5 = piVar4;
    } while (iVar3 < 0x10);
    puVar6 = puVar6 + 0x10;
  } while ((int)puVar6 < 0x43fcd8);
  return piVar2;
}



void FUN_00429690(void)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int **ppiVar4;
  int unaff_EBX;
  int iVar5;
  int **ppiVar6;
  
  iVar1 = *(int *)(unaff_EBX + 0x1a8);
  iVar5 = 0;
  if (0 < *(int *)(unaff_EBX + 100)) {
    ppiVar6 = (int **)(iVar1 + 0x34);
    do {
      iVar2 = 0;
      if (0 < iVar5) {
        ppiVar4 = (int **)(iVar1 + 0x20);
        do {
          if (ppiVar6[-5] == *ppiVar4) {
            piVar3 = *(int **)(iVar1 + 0x34 + iVar2 * 4);
            if (piVar3 != (int *)0x0) goto LAB_004296cf;
            break;
          }
          iVar2 = iVar2 + 1;
          ppiVar4 = ppiVar4 + 1;
        } while (iVar2 < iVar5);
      }
      piVar3 = FUN_00429610((int)ppiVar6[-5]);
LAB_004296cf:
      *ppiVar6 = piVar3;
      iVar5 = iVar5 + 1;
      ppiVar6 = ppiVar6 + 1;
    } while (iVar5 < *(int *)(unaff_EBX + 100));
  }
  return;
}



void __cdecl FUN_00429790(char **param_1,int param_2,char **param_3,int param_4)

{
  int *piVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  char *pcVar7;
  char *pcVar8;
  
  piVar1 = *(int **)(param_1[0x6a] + 0x18);
  iVar2 = piVar1[1];
  pcVar3 = param_1[0x17];
  iVar4 = *piVar1;
  iVar5 = piVar1[2];
  if (0 < param_4) {
    param_1 = param_3;
    do {
      pbVar6 = *(byte **)((param_2 - (int)param_3) + (int)param_1);
      pcVar7 = *param_1;
      for (pcVar8 = pcVar3; pcVar8 != (char *)0x0; pcVar8 = pcVar8 + -1) {
        *pcVar7 = *(char *)((uint)*pbVar6 + iVar4) + *(char *)((uint)pbVar6[1] + iVar2) +
                  *(char *)((uint)pbVar6[2] + iVar5);
        pbVar6 = pbVar6 + 3;
        pcVar7 = pcVar7 + 1;
      }
      param_1 = param_1 + 1;
      param_4 = param_4 + -1;
    } while (param_4 != 0);
  }
  return;
}



void __cdecl FUN_00429850(int param_1,int param_2,char **param_3,int *param_4)

{
  byte bVar1;
  int iVar2;
  size_t _Size;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  char *pcVar8;
  size_t sVar9;
  uint uVar10;
  int local_20;
  char **local_18;
  int *local_14;
  
  iVar2 = *(int *)(param_1 + 100);
  _Size = *(size_t *)(param_1 + 0x5c);
  iVar3 = *(int *)(param_1 + 0x1a8);
  if (0 < (int)param_4) {
    local_18 = param_3;
    local_14 = param_4;
    do {
      memset(*local_18,0,_Size);
      iVar4 = *(int *)(iVar3 + 0x30);
      local_20 = 0;
      if (0 < iVar2) {
        param_4 = (int *)(iVar3 + 0x34);
        do {
          iVar5 = *(int *)(*(int *)(iVar3 + 0x18) + local_20 * 4);
          pcVar8 = *local_18;
          iVar6 = *param_4;
          pbVar7 = (byte *)(*(int *)((param_2 - (int)param_3) + (int)local_18) + local_20);
          uVar10 = 0;
          for (sVar9 = _Size; sVar9 != 0; sVar9 = sVar9 - 1) {
            bVar1 = *pbVar7;
            pbVar7 = pbVar7 + iVar2;
            *pcVar8 = *pcVar8 + *(char *)(*(int *)(iVar6 + iVar4 * 0x40 + uVar10 * 4) + (uint)bVar1
                                         + iVar5);
            pcVar8 = pcVar8 + 1;
            uVar10 = uVar10 + 1 & 0xf;
          }
          param_4 = param_4 + 1;
          local_20 = local_20 + 1;
        } while (local_20 < iVar2);
      }
      local_18 = local_18 + 1;
      local_14 = (int *)((int)local_14 + -1);
      *(uint *)(iVar3 + 0x30) = iVar4 + 1U & 0xf;
    } while (local_14 != (int *)0x0);
  }
  return;
}



void __cdecl FUN_00429970(int param_1,int param_2,char **param_3,int param_4)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  byte *pbVar12;
  int iVar13;
  uint uVar14;
  char *pcVar15;
  char **local_28;
  int local_24;
  
  iVar2 = *(int *)(param_1 + 0x1a8);
  piVar3 = *(int **)(iVar2 + 0x18);
  iVar4 = *(int *)(param_1 + 0x5c);
  iVar5 = *piVar3;
  iVar6 = piVar3[1];
  iVar7 = piVar3[2];
  if (0 < param_4) {
    local_28 = param_3;
    local_24 = param_4;
    do {
      iVar8 = *(int *)(iVar2 + 0x30);
      pcVar15 = *local_28;
      iVar9 = *(int *)(iVar2 + 0x3c);
      iVar10 = *(int *)(iVar2 + 0x38);
      pbVar12 = *(byte **)((param_2 - (int)param_3) + (int)local_28);
      iVar13 = iVar8 * 0x40;
      iVar11 = *(int *)(iVar2 + 0x34);
      uVar14 = 0;
      for (iVar1 = iVar4; iVar1 != 0; iVar1 = iVar1 + -1) {
        *pcVar15 = *(char *)(*(int *)(iVar11 + iVar13 + uVar14 * 4) + (uint)*pbVar12 + iVar5) +
                   *(char *)(iVar6 + *(int *)(iVar10 + iVar13 + uVar14 * 4) + (uint)pbVar12[1]) +
                   *(char *)(iVar7 + *(int *)(iVar9 + iVar13 + uVar14 * 4) + (uint)pbVar12[2]);
        pcVar15 = pcVar15 + 1;
        pbVar12 = pbVar12 + 3;
        uVar14 = uVar14 + 1 & 0xf;
      }
      local_28 = local_28 + 1;
      local_24 = local_24 + -1;
      *(uint *)(iVar2 + 0x30) = iVar8 + 1U & 0xf;
    } while (local_24 != 0);
  }
  return;
}



void __cdecl FUN_00429aa0(int param_1,int param_2,char **param_3,int param_4)

{
  size_t sVar1;
  byte bVar2;
  size_t _Size;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  short **ppsVar11;
  short *psVar12;
  byte *pbVar13;
  int iVar14;
  int iVar15;
  char *pcVar16;
  char **local_30;
  int local_2c;
  int local_1c;
  int local_18;
  
  _Size = *(size_t *)(param_1 + 0x5c);
  iVar3 = *(int *)(param_1 + 0x120);
  iVar4 = *(int *)(param_1 + 100);
  iVar5 = *(int *)(param_1 + 0x1a8);
  if (0 < param_4) {
    local_30 = param_3;
    local_18 = param_4;
    do {
      memset(*local_30,0,_Size);
      local_1c = 0;
      if (0 < iVar4) {
        ppsVar11 = (short **)(iVar5 + 0x44);
        do {
          pcVar16 = *local_30;
          psVar12 = *ppsVar11;
          pbVar13 = (byte *)(*(int *)((param_2 - (int)param_3) + (int)local_30) + local_1c);
          if (*(char *)(iVar5 + 0x54) == '\0') {
            iVar15 = 1;
            iVar14 = iVar4;
          }
          else {
            pcVar16 = pcVar16 + (_Size - 1);
            pbVar13 = pbVar13 + (_Size - 1) * iVar4;
            iVar15 = -1;
            psVar12 = psVar12 + _Size + 1;
            iVar14 = -iVar4;
          }
          iVar6 = *(int *)(*(int *)(iVar5 + 0x18) + local_1c * 4);
          iVar7 = *(int *)(*(int *)(iVar5 + 0x10) + local_1c * 4);
          iVar8 = 0;
          param_4 = 0;
          param_4._0_2_ = 0;
          local_2c = 0;
          for (sVar1 = _Size; sVar1 != 0; sVar1 = sVar1 - 1) {
            bVar2 = *pbVar13;
            pbVar13 = pbVar13 + iVar14;
            uVar9 = (uint)*(byte *)((uint)bVar2 + (psVar12[iVar15] + 8 + iVar8 >> 4) + iVar3);
            bVar2 = *(byte *)(uVar9 + iVar6);
            *pcVar16 = *pcVar16 + bVar2;
            iVar10 = uVar9 - *(byte *)((uint)bVar2 + iVar7);
            *psVar12 = (short)param_4 + (short)iVar10 * 3;
            param_4 = local_2c + iVar10 * 5;
            iVar8 = iVar10 * 7;
            pcVar16 = pcVar16 + iVar15;
            psVar12 = psVar12 + iVar15;
            local_2c = iVar10;
          }
          ppsVar11 = ppsVar11 + 1;
          local_1c = local_1c + 1;
          *psVar12 = (short)param_4;
        } while (local_1c < iVar4);
      }
      local_30 = local_30 + 1;
      local_18 = local_18 + -1;
      *(bool *)(iVar5 + 0x54) = *(char *)(iVar5 + 0x54) == '\0';
    } while (local_18 != 0);
  }
  return;
}



void FUN_00429c50(void)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  int unaff_ESI;
  int iVar3;
  
  iVar3 = 0;
  if (0 < *(int *)(unaff_ESI + 100)) {
    puVar2 = (undefined4 *)(*(int *)(unaff_ESI + 0x1a8) + 0x44);
    do {
      uVar1 = (**(code **)(*(int *)(unaff_ESI + 4) + 4))();
      *puVar2 = uVar1;
      iVar3 = iVar3 + 1;
      puVar2 = puVar2 + 1;
    } while (iVar3 < *(int *)(unaff_ESI + 100));
  }
  return;
}



void __cdecl FUN_00429c90(int *param_1)

{
  int iVar1;
  void **ppvVar2;
  int iVar3;
  
  iVar1 = param_1[0x6a];
  param_1[0x1d] = *(int *)(iVar1 + 0x10);
  iVar3 = param_1[0x13];
  param_1[0x1c] = *(int *)(iVar1 + 0x14);
  if (iVar3 == 0) {
    if (param_1[0x19] != 3) {
      *(undefined **)(iVar1 + 4) = &LAB_004296e0;
      return;
    }
    *(code **)(iVar1 + 4) = FUN_00429790;
    return;
  }
  if (iVar3 == 1) {
    if (param_1[0x19] == 3) {
      *(code **)(iVar1 + 4) = FUN_00429970;
    }
    else {
      *(code **)(iVar1 + 4) = FUN_00429850;
    }
    *(undefined4 *)(iVar1 + 0x30) = 0;
    if (*(char *)(iVar1 + 0x1c) == '\0') {
      FUN_004294a0((int)param_1);
    }
    if (*(int *)(iVar1 + 0x34) == 0) {
      FUN_00429690();
      return;
    }
  }
  else {
    if (iVar3 != 2) {
      *(undefined4 *)(*param_1 + 0x14) = 0x30;
      (**(code **)*param_1)(param_1);
      return;
    }
    ppvVar2 = (void **)(iVar1 + 0x44);
    *(code **)(iVar1 + 4) = FUN_00429aa0;
    *(undefined *)(iVar1 + 0x54) = 0;
    if (*(int *)(iVar1 + 0x44) == 0) {
      FUN_00429c50();
    }
    iVar1 = param_1[0x17];
    if (0 < param_1[0x19]) {
      iVar3 = 0;
      do {
        memset(*ppvVar2,0,iVar1 * 2 + 4);
        iVar3 = iVar3 + 1;
        ppvVar2 = ppvVar2 + 1;
      } while (iVar3 < param_1[0x19]);
    }
  }
  return;
}



void FUN_00429da0(void)

{
  int *in_EAX;
  code **ppcVar1;
  
  ppcVar1 = (code **)(**(code **)in_EAX[1])();
  in_EAX[0x6a] = (int)ppcVar1;
  *ppcVar1 = FUN_00429c90;
  ppcVar1[2] = FUN_0041c770;
  ppcVar1[3] = (code *)&LAB_00429d80;
  ppcVar1[0x11] = (code *)0x0;
  ppcVar1[0xd] = (code *)0x0;
  if (4 < in_EAX[0x19]) {
    *(undefined4 *)(*in_EAX + 0x14) = 0x37;
    *(undefined4 *)(*in_EAX + 0x18) = 4;
    (**(code **)*in_EAX)();
  }
  if (0x100 < in_EAX[0x15]) {
    *(undefined4 *)(*in_EAX + 0x14) = 0x39;
    *(undefined4 *)(*in_EAX + 0x18) = 0x100;
    (**(code **)*in_EAX)();
  }
  FUN_00429330(in_EAX);
  FUN_004294a0((int)in_EAX);
  if (in_EAX[0x13] == 2) {
    FUN_00429c50();
  }
  return;
}



void __cdecl FUN_00429e40(int *param_1)

{
  int iVar1;
  int iVar2;
  double *pdVar3;
  double *pdVar4;
  ushort *puVar5;
  int iVar6;
  int *piVar7;
  float *pfVar8;
  short *psVar9;
  int iVar10;
  int *piVar11;
  undefined4 *puVar12;
  code *local_14;
  int local_10;
  int local_8;
  
  iVar10 = 0;
  local_10 = 0;
  local_14 = (code *)0x0;
  local_8 = 0;
  if (0 < param_1[9]) {
    piVar11 = (int *)(param_1[0x67] + 0x2c);
    puVar12 = (undefined4 *)(param_1[0x31] + 0x24);
    do {
      switch(*puVar12) {
      case 1:
        iVar10 = 0;
        local_14 = (code *)&LAB_00434df0;
        local_10 = 0;
        break;
      case 2:
        iVar10 = 0;
        local_14 = FUN_00434980;
        local_10 = 0;
        break;
      default:
        *(undefined4 *)(*param_1 + 0x14) = 7;
        *(undefined4 *)(*param_1 + 0x18) = *puVar12;
        (**(code **)*param_1)(param_1);
        break;
      case 4:
        iVar10 = 0;
        local_14 = (code *)&LAB_00434660;
        local_10 = 0;
        break;
      case 8:
        iVar1 = param_1[0x11];
        if (iVar1 == 0) {
          iVar10 = 0;
          local_14 = (code *)&LAB_00435760;
          local_10 = 0;
        }
        else if (iVar1 == 1) {
          iVar10 = 1;
          local_14 = (code *)&LAB_00435380;
          local_10 = 1;
        }
        else if (iVar1 == 2) {
          iVar10 = 2;
          local_14 = (code *)&LAB_00434e30;
          local_10 = 2;
        }
        else {
          *(undefined4 *)(*param_1 + 0x14) = 0x30;
          (**(code **)*param_1)(param_1);
        }
      }
      piVar11[-10] = (int)local_14;
      if (((*(char *)(puVar12 + 3) != '\0') && (*piVar11 != iVar10)) &&
         (iVar1 = puVar12[10], iVar1 != 0)) {
        *piVar11 = iVar10;
        if (iVar10 == 0) {
          iVar2 = puVar12[0xb];
          iVar6 = 0;
          do {
            *(uint *)(iVar2 + iVar6 * 4) = (uint)*(ushort *)(iVar1 + iVar6 * 2);
            iVar6 = iVar6 + 1;
          } while (iVar6 < 0x40);
        }
        else if (iVar10 == 1) {
          piVar7 = (int *)(puVar12[0xb] + 8);
          puVar5 = (ushort *)(iVar1 + 4);
          psVar9 = &DAT_0043fb1a;
          do {
            piVar7[-2] = (int)((int)psVar9[-1] * (uint)puVar5[-2] + 0x800) >> 0xc;
            piVar7[-1] = (int)((uint)puVar5[-1] * (int)*psVar9 + 0x800) >> 0xc;
            *piVar7 = (int)((int)*(short *)((int)&DAT_0043fb18 + -iVar1 + (int)puVar5) *
                            (uint)*puVar5 + 0x800) >> 0xc;
            piVar7[1] = (int)((int)*(short *)((int)&DAT_0043fb1a + -iVar1 + (int)puVar5) *
                              (uint)puVar5[1] + 0x800) >> 0xc;
            psVar9 = psVar9 + 4;
            piVar7 = piVar7 + 4;
            puVar5 = puVar5 + 4;
            iVar10 = local_10;
          } while ((int)psVar9 < 0x43fb9a);
        }
        else if (iVar10 == 2) {
          pdVar3 = (double *)&DAT_0043fb98;
          puVar5 = (ushort *)(iVar1 + 4);
          pfVar8 = (float *)(puVar12[0xb] + 8);
          do {
            pdVar4 = pdVar3 + 1;
            pfVar8[-2] = (float)(uint)puVar5[-2] * (float)*pdVar3;
            pfVar8[-1] = (float)(uint)puVar5[-1] * (float)*pdVar3 * 1.38704;
            *pfVar8 = (float)(uint)*puVar5 * (float)*pdVar3 * 1.306563;
            pfVar8[1] = (float)(uint)puVar5[1] * (float)*pdVar3 * 1.175876;
            pfVar8[2] = (float)(uint)puVar5[2] * (float)*pdVar3;
            pfVar8[3] = (float)(uint)puVar5[3] * (float)*pdVar3 * 0.785695;
            pfVar8[4] = (float)(uint)puVar5[4] * (float)*pdVar3 * 0.5411961;
            pfVar8[5] = (float)(uint)puVar5[5] * (float)*pdVar3 * 0.2758994;
            pdVar3 = pdVar4;
            puVar5 = puVar5 + 8;
            pfVar8 = pfVar8 + 8;
          } while ((int)pdVar4 < 0x43fbd8);
        }
        else {
          *(undefined4 *)(*param_1 + 0x14) = 0x30;
          (**(code **)*param_1)(param_1);
        }
      }
      local_8 = local_8 + 1;
      piVar11 = piVar11 + 1;
      puVar12 = puVar12 + 0x15;
    } while (local_8 < param_1[9]);
  }
  return;
}



void FUN_0042a160(void)

{
  code **ppcVar1;
  void *_Dst;
  void **ppvVar2;
  int unaff_ESI;
  int iVar3;
  
  ppcVar1 = (code **)(***(code ***)(unaff_ESI + 4))();
  *(code ***)(unaff_ESI + 0x19c) = ppcVar1;
  *ppcVar1 = FUN_00429e40;
  iVar3 = 0;
  if (0 < *(int *)(unaff_ESI + 0x24)) {
    ppvVar2 = (void **)(*(int *)(unaff_ESI + 0xc4) + 0x50);
    ppcVar1 = ppcVar1 + 0xb;
    do {
      _Dst = (void *)(***(code ***)(unaff_ESI + 4))();
      *ppvVar2 = _Dst;
      memset(_Dst,0,0x100);
      *ppcVar1 = (code *)0xffffffff;
      iVar3 = iVar3 + 1;
      ppcVar1 = ppcVar1 + 1;
      ppvVar2 = ppvVar2 + 0x15;
    } while (iVar3 < *(int *)(unaff_ESI + 0x24));
  }
  return;
}



void __cdecl
FUN_0042a1f0(int param_1,int param_2,int *param_3,undefined4 param_4,int param_5,int *param_6,
            int param_7)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  
  iVar2 = param_1;
  iVar1 = *(int *)(param_1 + 0x1a0);
  if (*(int *)(param_1 + 0x114) <= *(int *)(iVar1 + 0x5c)) {
    iVar4 = 0;
    if (0 < *(int *)(param_1 + 0x24)) {
      iVar5 = iVar1 + 0xc;
      param_1 = *(int *)(param_1 + 0xc4);
      do {
        (**(code **)(iVar5 + 0x28))
                  (iVar2,param_1,
                   *(int *)(param_2 + iVar4 * 4) + *(int *)(iVar5 + 0x58) * *param_3 * 4,iVar5);
        param_1 = param_1 + 0x54;
        iVar4 = iVar4 + 1;
        iVar5 = iVar5 + 4;
      } while (iVar4 < *(int *)(iVar2 + 0x24));
    }
    *(undefined4 *)(iVar1 + 0x5c) = 0;
  }
  uVar6 = *(int *)(iVar2 + 0x114) - *(int *)(iVar1 + 0x5c);
  if (*(uint *)(iVar1 + 0x60) < uVar6) {
    uVar6 = *(uint *)(iVar1 + 0x60);
  }
  uVar3 = param_7 - *param_6;
  if (uVar3 < uVar6) {
    uVar6 = uVar3;
  }
  (**(code **)(*(int *)(iVar2 + 0x1a4) + 4))
            (iVar2,iVar1 + 0xc,*(undefined4 *)(iVar1 + 0x5c),param_5 + *param_6 * 4,uVar6);
  *param_6 = *param_6 + uVar6;
  *(int *)(iVar1 + 0x60) = *(int *)(iVar1 + 0x60) - uVar6;
  *(int *)(iVar1 + 0x5c) = *(int *)(iVar1 + 0x5c) + uVar6;
  if (*(int *)(iVar2 + 0x114) <= *(int *)(iVar1 + 0x5c)) {
    *param_3 = *param_3 + 1;
  }
  return;
}



void __cdecl FUN_0042a2e0(int param_1,undefined4 *param_2,undefined4 *param_3,int **param_4)

{
  size_t _Size;
  uint uVar1;
  int iVar2;
  uint uVar3;
  void **ppvVar4;
  undefined *puVar5;
  void **ppvVar6;
  uint _Size_00;
  void *pvVar7;
  void *pvVar8;
  void **ppvVar9;
  int local_10;
  undefined4 local_4;
  
  ppvVar4 = (void **)*param_4;
  iVar2 = *(int *)(param_1 + 0x1a0) + param_2[1];
  _Size_00 = (uint)*(byte *)(iVar2 + 0x8c);
  uVar3 = (uint)*(byte *)(iVar2 + 0x96);
  local_10 = 0;
  if (0 < *(int *)(param_1 + 0x114)) {
    param_2 = param_3;
    do {
      puVar5 = (undefined *)*param_2;
      pvVar7 = *ppvVar4;
      pvVar8 = (void *)(*(int *)(param_1 + 0x5c) + (int)pvVar7);
      while (pvVar7 < pvVar8) {
        uVar1 = (uint)local_4 >> 8;
        local_4 = CONCAT31((int3)uVar1,*puVar5);
        puVar5 = puVar5 + 1;
        if (_Size_00 != 0) {
          memset(pvVar7,local_4,_Size_00);
          pvVar7 = (void *)((int)pvVar7 + _Size_00);
        }
      }
      if (1 < uVar3) {
        _Size = *(size_t *)(param_1 + 0x5c);
        ppvVar9 = ppvVar4;
        ppvVar6 = ppvVar4;
        uVar1 = uVar3;
        while (uVar1 = uVar1 - 1, 0 < (int)uVar1) {
          ppvVar6 = ppvVar6 + 1;
          pvVar7 = *ppvVar9;
          ppvVar9 = ppvVar9 + 1;
          memcpy(*ppvVar6,pvVar7,_Size);
        }
      }
      local_10 = local_10 + uVar3;
      param_2 = param_2 + 1;
      ppvVar4 = ppvVar4 + uVar3;
    } while (local_10 < *(int *)(param_1 + 0x114));
  }
  return;
}



void __cdecl FUN_0042a590(int param_1,int param_2,byte **param_3,byte **param_4)

{
  byte *pbVar1;
  undefined *puVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  int iVar8;
  byte *pbVar9;
  int local_c;
  
  pbVar1 = *param_4;
  iVar3 = 0;
  if (0 < *(int *)(param_1 + 0x114)) {
    param_4 = param_3;
    do {
      local_c = 0;
      do {
        pbVar7 = *param_4;
        if (local_c == 0) {
          pbVar9 = param_4[-1];
        }
        else {
          pbVar9 = param_4[1];
        }
        puVar2 = *(undefined **)(pbVar1 + iVar3 * 4);
        iVar3 = iVar3 + 1;
        iVar8 = (uint)*pbVar7 * 3 + (uint)*pbVar9;
        iVar4 = (uint)pbVar7[1] * 3 + (uint)pbVar9[1];
        *puVar2 = (char)(iVar8 * 4 + 8 >> 4);
        puVar2[1] = (char)(iVar8 * 3 + 7 + iVar4 >> 4);
        pbVar9 = pbVar9 + 2;
        pbVar7 = pbVar7 + 2;
        for (iVar6 = *(int *)(param_2 + 0x28) + -2; puVar2 = puVar2 + 2, iVar6 != 0;
            iVar6 = iVar6 + -1) {
          iVar5 = (uint)*pbVar7 * 3 + (uint)*pbVar9;
          *puVar2 = (char)(iVar4 * 3 + 8 + iVar8 >> 4);
          puVar2[1] = (char)(iVar4 * 3 + 7 + iVar5 >> 4);
          pbVar9 = pbVar9 + 1;
          pbVar7 = pbVar7 + 1;
          iVar8 = iVar4;
          iVar4 = iVar5;
        }
        *puVar2 = (char)(iVar4 * 3 + 8 + iVar8 >> 4);
        puVar2[1] = (char)(iVar4 * 4 + 7 >> 4);
        local_c = local_c + 1;
      } while (local_c < 2);
      param_4 = param_4 + 1;
    } while (iVar3 < *(int *)(param_1 + 0x114));
  }
  return;
}



void FUN_0042a6d0(void)

{
  int iVar1;
  bool bVar2;
  undefined4 *puVar3;
  int iVar4;
  code *pcVar5;
  code *pcVar6;
  int *piVar7;
  code **ppcVar8;
  int *unaff_ESI;
  int iStack_10;
  undefined uStack_c;
  
  puVar3 = (undefined4 *)(**(code **)unaff_ESI[1])();
  unaff_ESI[0x68] = (int)puVar3;
  *puVar3 = &LAB_0042a1d0;
  puVar3[1] = FUN_0042a1f0;
  *(undefined *)(puVar3 + 2) = 0;
  if (*(char *)((int)unaff_ESI + 0x10a) != '\0') {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x19;
    (**(code **)*unaff_ESI)();
  }
  if ((*(char *)(unaff_ESI + 0x12) == '\0') || (bVar2 = true, unaff_ESI[0x46] < 2)) {
    bVar2 = false;
  }
  iStack_10 = 0;
  if (0 < unaff_ESI[9]) {
    piVar7 = (int *)(unaff_ESI[0x31] + 0x24);
    ppcVar8 = (code **)(puVar3 + 0xd);
    do {
      iVar4 = (piVar7[-7] * *piVar7) / unaff_ESI[0x46];
      pcVar5 = (code *)((piVar7[-6] * *piVar7) / unaff_ESI[0x46]);
      pcVar6 = (code *)unaff_ESI[0x45];
      iVar1 = unaff_ESI[0x44];
      ppcVar8[0xc] = pcVar5;
      if (*(char *)(piVar7 + 3) == '\0') {
        *ppcVar8 = (code *)&LAB_0042a2d0;
      }
      else if ((iVar4 == iVar1) && (pcVar5 == pcVar6)) {
        *ppcVar8 = (code *)&LAB_0042a2c0;
      }
      else {
        if (iVar4 * 2 == iVar1) {
          if (pcVar5 == pcVar6) {
            if ((bVar2) && (2 < (uint)piVar7[1])) {
              *ppcVar8 = (code *)&LAB_0042a4c0;
            }
            else {
              *ppcVar8 = (code *)&LAB_0042a3f0;
            }
          }
          else {
            if ((iVar4 * 2 != iVar1) || ((code *)((int)pcVar5 * 2) != pcVar6)) goto LAB_0042a820;
            if ((bVar2) && (2 < (uint)piVar7[1])) {
              *ppcVar8 = FUN_0042a590;
              *(undefined *)(puVar3 + 2) = 1;
            }
            else {
              *ppcVar8 = (code *)&LAB_0042a450;
            }
          }
        }
        else {
LAB_0042a820:
          if ((iVar1 % iVar4 == 0) && ((int)pcVar6 % (int)pcVar5 == 0)) {
            uStack_c = (undefined)(iVar1 / iVar4);
            *ppcVar8 = FUN_0042a2e0;
            *(undefined *)(iStack_10 + 0x8c + (int)puVar3) = uStack_c;
            *(char *)(iStack_10 + 0x96 + (int)puVar3) = (char)((int)pcVar6 / (int)pcVar5);
          }
          else {
            *(undefined4 *)(*unaff_ESI + 0x14) = 0x26;
            (**(code **)*unaff_ESI)();
          }
        }
        pcVar6 = (code *)(**(code **)(unaff_ESI[1] + 8))();
        ppcVar8[-10] = pcVar6;
      }
      iStack_10 = iStack_10 + 1;
      ppcVar8 = ppcVar8 + 1;
      piVar7 = piVar7 + 0x15;
    } while (iStack_10 < unaff_ESI[9]);
  }
  return;
}



void __cdecl FUN_0042a8d0(int *param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  bool bVar4;
  int *piVar5;
  undefined4 *puVar6;
  int iVar7;
  bool bVar8;
  bool bVar9;
  int local_c;
  int *piStack_8;
  
  bVar8 = param_1[0x5b] != 0;
  iVar2 = param_1[0x66];
  bVar4 = false;
  if (bVar8) {
    if ((param_1[0x5c] < param_1[0x5b]) || (0x3f < param_1[0x5c])) {
      bVar4 = true;
    }
    bVar9 = param_1[0x49] == 1;
  }
  else {
    bVar9 = param_1[0x5c] == 0;
  }
  if (!bVar9) {
    bVar4 = true;
  }
  if ((param_1[0x5d] != 0) && (param_1[0x5e] != param_1[0x5d] + -1)) {
    bVar4 = true;
  }
  if ((0xd < param_1[0x5e]) || (bVar4)) {
    *(undefined4 *)(*param_1 + 0x14) = 0x10;
    *(int *)(*param_1 + 0x18) = param_1[0x5b];
    *(int *)(*param_1 + 0x1c) = param_1[0x5c];
    *(int *)(*param_1 + 0x20) = param_1[0x5d];
    *(int *)(*param_1 + 0x24) = param_1[0x5e];
    (**(code **)*param_1)(param_1);
  }
  local_c = 0;
  if (0 < param_1[0x49]) {
    piStack_8 = param_1 + 0x4a;
    do {
      iVar3 = *(int *)(*piStack_8 + 4);
      piVar5 = (int *)(iVar3 * 0x100 + param_1[0x23]);
      if ((bVar8) && (*piVar5 < 0)) {
        *(undefined4 *)(*param_1 + 0x14) = 0x73;
        *(int *)(*param_1 + 0x18) = iVar3;
        *(undefined4 *)(*param_1 + 0x1c) = 0;
        (**(code **)(*param_1 + 4))(param_1,0xffffffff);
      }
      iVar7 = param_1[0x5b];
      if (iVar7 <= param_1[0x5c]) {
        do {
          if (param_1[0x5d] != (piVar5[iVar7] & (piVar5[iVar7] < 0) - 1)) {
            *(undefined4 *)(*param_1 + 0x14) = 0x73;
            *(int *)(*param_1 + 0x18) = iVar3;
            *(int *)(*param_1 + 0x1c) = iVar7;
            (**(code **)(*param_1 + 4))(param_1,0xffffffff);
          }
          piVar5[iVar7] = param_1[0x5e];
          iVar7 = iVar7 + 1;
        } while (iVar7 <= param_1[0x5c]);
      }
      piStack_8 = piStack_8 + 1;
      local_c = local_c + 1;
    } while (local_c < param_1[0x49]);
  }
  if (param_1[0x5d] == 0) {
    if (bVar8) {
      *(code **)(iVar2 + 4) = FUN_0042ae20;
    }
    else {
      *(code **)(iVar2 + 4) = FUN_0042abd0;
    }
  }
  else if (bVar8) {
    *(undefined **)(iVar2 + 4) = &LAB_0042b150;
  }
  else {
    *(code **)(iVar2 + 4) = FUN_0042b060;
  }
  local_c = 0;
  if (0 < param_1[0x49]) {
    puVar6 = (undefined4 *)(iVar2 + 0x18);
    piVar5 = param_1 + 0x4a;
    do {
      if (bVar8) {
        iVar3 = *(int *)(*piVar5 + 0x18);
        piVar1 = (int *)(iVar2 + 0x2c + iVar3 * 4);
        FUN_00428870(iVar3,param_1,'\0',piVar1);
        *(int *)(iVar2 + 0x3c) = *piVar1;
      }
      else if (param_1[0x5d] == 0) {
        iVar3 = *(int *)(*piVar5 + 0x14);
        FUN_00428870(iVar3,param_1,'\x01',(int *)(iVar2 + 0x2c + iVar3 * 4));
      }
      *puVar6 = 0;
      local_c = local_c + 1;
      piVar5 = piVar5 + 1;
      puVar6 = puVar6 + 1;
    } while (local_c < param_1[0x49]);
  }
  *(undefined4 *)(iVar2 + 0x10) = 0;
  *(undefined4 *)(iVar2 + 0xc) = 0;
  *(undefined4 *)(iVar2 + 0x14) = 0;
  *(undefined *)(iVar2 + 8) = 0;
  *(int *)(iVar2 + 0x28) = param_1[0x3f];
  return;
}



undefined4 FUN_0042ab40(void)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  undefined4 *puVar5;
  int unaff_ESI;
  
  iVar2 = *(int *)(unaff_ESI + 0x198);
  piVar1 = (int *)(*(int *)(unaff_ESI + 0x194) + 0x14);
  *piVar1 = *piVar1 + ((int)(*(int *)(iVar2 + 0x10) + (*(int *)(iVar2 + 0x10) >> 0x1f & 7U)) >> 3);
  *(undefined4 *)(iVar2 + 0x10) = 0;
  uVar3 = (**(code **)(*(int *)(unaff_ESI + 0x194) + 8))();
  if ((char)uVar3 == '\0') {
    return uVar3;
  }
  iVar4 = 0;
  if (0 < *(int *)(unaff_ESI + 0x124)) {
    puVar5 = (undefined4 *)(iVar2 + 0x18);
    do {
      *puVar5 = 0;
      iVar4 = iVar4 + 1;
      puVar5 = puVar5 + 1;
    } while (iVar4 < *(int *)(unaff_ESI + 0x124));
  }
  *(undefined4 *)(iVar2 + 0x14) = 0;
  *(undefined4 *)(iVar2 + 0x28) = *(undefined4 *)(unaff_ESI + 0xfc);
  if (*(int *)(unaff_ESI + 0x17c) == 0) {
    *(undefined *)(iVar2 + 8) = 0;
  }
  return CONCAT31((int3)((uint)iVar4 >> 8),1);
}



undefined4 __cdecl FUN_0042abd0(byte *param_1,int param_2)

{
  undefined4 uVar1;
  int iVar2;
  undefined2 *puVar3;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  uint uVar7;
  byte *pbVar8;
  int iVar9;
  uint uVar10;
  byte *pbVar11;
  int local_40;
  int *local_3c;
  byte *local_28;
  byte *local_24;
  byte *local_20;
  byte *local_1c;
  byte *local_18;
  undefined4 local_14;
  int local_10 [4];
  
  pbVar6 = param_1;
  uVar1 = *(undefined4 *)(param_1 + 0x178);
  iVar2 = *(int *)(param_1 + 0x198);
  local_10[3] = uVar1;
  if (((*(int *)(param_1 + 0xfc) != 0) && (*(int *)(iVar2 + 0x28) == 0)) &&
     (local_10[3] = FUN_0042ab40(), (char)local_10[3] == '\0')) {
    return local_10[3];
  }
  if (*(char *)(iVar2 + 8) == '\0') {
    local_28 = **(byte ***)(param_1 + 0x18);
    local_24 = (*(byte ***)(param_1 + 0x18))[1];
    pbVar11 = *(byte **)(iVar2 + 0xc);
    pbVar8 = *(byte **)(iVar2 + 0x10);
    local_14 = *(undefined4 *)(iVar2 + 0x14);
    local_10[0] = *(int *)(iVar2 + 0x18);
    local_10[1] = *(undefined4 *)(iVar2 + 0x1c);
    local_18 = param_1;
    local_10[2] = *(undefined4 *)(iVar2 + 0x20);
    local_10[3] = *(undefined4 *)(iVar2 + 0x24);
    local_40 = 0;
    if (0 < *(int *)(param_1 + 0x140)) {
      local_3c = (int *)(param_1 + 0x144);
      param_1 = pbVar11;
      do {
        puVar3 = *(undefined2 **)(param_2 + local_40 * 4);
        iVar4 = *local_3c;
        iVar5 = *(int *)(iVar2 + 0x2c + *(int *)(*(int *)(pbVar6 + iVar4 * 4 + 0x128) + 0x14) * 4);
        if ((int)pbVar8 < 8) {
          uVar7 = FUN_00428b60(&local_28,pbVar11,pbVar8,0);
          if ((char)uVar7 == '\0') goto LAB_0042ae08;
          param_1 = local_20;
          pbVar8 = local_1c;
          pbVar11 = local_20;
          if (7 < (int)local_1c) goto LAB_0042acd4;
          iVar9 = 1;
LAB_0042ad01:
          uVar7 = FUN_00428c90(iVar9,pbVar11,&local_28,iVar5);
          if ((int)uVar7 < 0) goto LAB_0042ae08;
          param_1 = local_20;
          pbVar8 = local_1c;
          uVar10 = uVar7;
          pbVar11 = local_20;
        }
        else {
LAB_0042acd4:
          uVar7 = (int)pbVar11 >> ((char)pbVar8 - 8U & 0x1f) & 0xff;
          iVar9 = *(int *)(iVar5 + 0x90 + uVar7 * 4);
          if (iVar9 == 0) {
            iVar9 = 9;
            goto LAB_0042ad01;
          }
          uVar10 = (uint)*(byte *)(uVar7 + 0x490 + iVar5);
          pbVar8 = pbVar8 + -iVar9;
        }
        uVar7 = uVar10;
        if (uVar10 != 0) {
          if ((int)pbVar8 < (int)uVar10) {
            uVar7 = FUN_00428b60(&local_28,pbVar11,pbVar8,uVar10);
            if ((char)uVar7 == '\0') {
LAB_0042ae08:
              return uVar7 & 0xffffff00;
            }
            param_1 = local_20;
            pbVar8 = local_1c;
            pbVar11 = local_20;
          }
          pbVar8 = pbVar8 + -uVar10;
          uVar7 = (1 << ((byte)uVar10 & 0x1f)) - 1U & (int)pbVar11 >> ((byte)pbVar8 & 0x1f);
          pbVar11 = param_1;
          if ((int)uVar7 < *(int *)(&DAT_0043fa98 + uVar10 * 4)) {
            uVar7 = *(int *)(&DAT_0043fad8 + uVar10 * 4) + uVar7;
          }
        }
        local_10[iVar4] = local_10[iVar4] + uVar7;
        local_3c = local_3c + 1;
        *puVar3 = (short)(local_10[iVar4] << ((byte)uVar1 & 0x1f));
        local_40 = local_40 + 1;
      } while (local_40 < *(int *)(pbVar6 + 0x140));
    }
    **(byte ***)(pbVar6 + 0x18) = local_28;
    *(byte **)(*(int *)(pbVar6 + 0x18) + 4) = local_24;
    *(undefined4 *)(iVar2 + 0x14) = local_14;
    *(byte **)(iVar2 + 0x10) = pbVar8;
    *(int *)(iVar2 + 0x18) = local_10[0];
    *(int *)(iVar2 + 0x1c) = local_10[1];
    *(int *)(iVar2 + 0x20) = local_10[2];
    *(byte **)(iVar2 + 0xc) = pbVar11;
    *(int *)(iVar2 + 0x24) = local_10[3];
  }
  *(int *)(iVar2 + 0x28) = *(int *)(iVar2 + 0x28) + -1;
  return CONCAT31((int3)((uint)local_10[3] >> 8),1);
}



byte * __cdecl FUN_0042ae20(int param_1,int *param_2)

{
  int iVar1;
  byte *pbVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  uint uVar7;
  int iVar8;
  byte *pbVar9;
  int iVar10;
  uint uVar11;
  int iVar12;
  byte *local_14;
  byte *local_10;
  byte *local_c;
  byte *local_8;
  int local_4;
  
  iVar1 = *(int *)(param_1 + 0x198);
  pbVar2 = *(byte **)(param_1 + 0x170);
  uVar3 = *(undefined4 *)(param_1 + 0x178);
  pbVar6 = pbVar2;
  if (((*(int *)(param_1 + 0xfc) != 0) && (*(int *)(iVar1 + 0x28) == 0)) &&
     (pbVar6 = (byte *)FUN_0042ab40(), (char)pbVar6 == '\0')) {
    return pbVar6;
  }
  if (*(char *)(iVar1 + 8) == '\0') {
    if (*(int *)(iVar1 + 0x14) != 0) {
      *(int *)(iVar1 + 0x28) = *(int *)(iVar1 + 0x28) + -1;
      *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + -1;
      return (byte *)CONCAT31((int3)((uint)pbVar6 >> 8),1);
    }
    local_14 = **(byte ***)(param_1 + 0x18);
    iVar4 = *param_2;
    local_10 = (*(byte ***)(param_1 + 0x18))[1];
    iVar5 = *(int *)(iVar1 + 0x3c);
    pbVar9 = *(byte **)(iVar1 + 0xc);
    pbVar6 = *(byte **)(iVar1 + 0x10);
    iVar12 = 0;
    local_4 = param_1;
    for (iVar10 = *(int *)(param_1 + 0x16c); iVar10 <= (int)pbVar2; iVar10 = iVar10 + iVar8 + 1) {
      if ((int)pbVar6 < 8) {
        uVar7 = FUN_00428b60(&local_14,pbVar9,pbVar6,0);
        if ((char)uVar7 == '\0') goto LAB_0042afff;
        pbVar6 = local_8;
        pbVar9 = local_c;
        if (7 < (int)local_8) goto LAB_0042af02;
        iVar8 = 1;
LAB_0042af2b:
        uVar7 = FUN_00428c90(iVar8,pbVar9,&local_14,iVar5);
        pbVar6 = local_8;
        pbVar9 = local_c;
        if ((int)uVar7 < 0) goto LAB_0042afff;
      }
      else {
LAB_0042af02:
        uVar7 = (int)pbVar9 >> ((char)pbVar6 - 8U & 0x1f) & 0xff;
        iVar8 = *(int *)(iVar5 + 0x90 + uVar7 * 4);
        if (iVar8 == 0) {
          iVar8 = 9;
          goto LAB_0042af2b;
        }
        uVar7 = (uint)*(byte *)(uVar7 + 0x490 + iVar5);
        pbVar6 = pbVar6 + -iVar8;
      }
      iVar8 = (int)uVar7 >> 4;
      uVar11 = uVar7 & 0xf;
      if (uVar11 == 0) {
        if (iVar8 != 0xf) {
          iVar12 = 1 << ((byte)iVar8 & 0x1f);
          if (iVar8 != 0) {
            if (((int)pbVar6 < iVar8) &&
               (uVar7 = FUN_00428b60(&local_14,pbVar9,pbVar6,iVar8), pbVar6 = local_8,
               pbVar9 = local_c, (char)uVar7 == '\0')) goto LAB_0042afff;
            pbVar6 = pbVar6 + -iVar8;
            iVar12 = iVar12 + ((int)pbVar9 >> ((byte)pbVar6 & 0x1f) & iVar12 - 1U);
          }
          iVar12 = iVar12 + -1;
          break;
        }
      }
      else {
        if (((int)pbVar6 < (int)uVar11) &&
           (uVar7 = FUN_00428b60(&local_14,pbVar9,pbVar6,uVar11), pbVar6 = local_8, pbVar9 = local_c
           , (char)uVar7 == '\0')) {
LAB_0042afff:
          return (byte *)(uVar7 & 0xffffff00);
        }
        pbVar6 = pbVar6 + -uVar11;
        uVar7 = (1 << (sbyte)uVar11) - 1U & (int)pbVar9 >> ((byte)pbVar6 & 0x1f);
        if ((int)uVar7 < *(int *)(&DAT_0043fa98 + uVar11 * 4)) {
          uVar7 = *(int *)(&DAT_0043fad8 + uVar11 * 4) + uVar7;
        }
        *(short *)(iVar4 + (&DAT_0043fd78)[iVar10 + iVar8] * 2) =
             (short)(uVar7 << ((byte)uVar3 & 0x1f));
      }
    }
    **(byte ***)(param_1 + 0x18) = local_14;
    *(byte **)(*(int *)(param_1 + 0x18) + 4) = local_10;
    *(byte **)(iVar1 + 0xc) = pbVar9;
    *(byte **)(iVar1 + 0x10) = pbVar6;
    *(int *)(iVar1 + 0x14) = iVar12;
  }
  *(int *)(iVar1 + 0x28) = *(int *)(iVar1 + 0x28) + -1;
  return (byte *)CONCAT31((int3)((uint)pbVar6 >> 8),1);
}



uint __cdecl FUN_0042b060(int param_1,int param_2)

{
  undefined4 uVar1;
  int iVar2;
  ushort *puVar3;
  uint uVar4;
  byte *pbVar5;
  int iVar6;
  byte *pbVar7;
  ushort local_18;
  byte *local_14;
  byte *local_10;
  byte *local_c;
  byte *local_8;
  int local_4;
  
  uVar1 = *(undefined4 *)(param_1 + 0x178);
  iVar2 = *(int *)(param_1 + 0x198);
  if (((*(int *)(param_1 + 0xfc) != 0) && (*(int *)(iVar2 + 0x28) == 0)) &&
     (uVar4 = FUN_0042ab40(), (char)uVar4 == '\0')) {
    return uVar4;
  }
  local_14 = **(byte ***)(param_1 + 0x18);
  local_10 = (*(byte ***)(param_1 + 0x18))[1];
  iVar6 = 0;
  pbVar7 = *(byte **)(iVar2 + 0xc);
  pbVar5 = *(byte **)(iVar2 + 0x10);
  local_4 = param_1;
  if (0 < *(int *)(param_1 + 0x140)) {
    do {
      puVar3 = *(ushort **)(param_2 + iVar6 * 4);
      if (((int)pbVar5 < 1) &&
         (uVar4 = FUN_00428b60(&local_14,pbVar7,pbVar5,1), pbVar5 = local_8, pbVar7 = local_c,
         (char)uVar4 == '\0')) {
        return uVar4 & 0xffffff00;
      }
      pbVar5 = pbVar5 + -1;
      if (((int)pbVar7 >> ((byte)pbVar5 & 0x1f) & 1U) != 0) {
        local_18 = (ushort)(1 << ((byte)uVar1 & 0x1f));
        *puVar3 = *puVar3 | local_18;
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 < *(int *)(param_1 + 0x140));
  }
  **(byte ***)(param_1 + 0x18) = local_14;
  iVar6 = *(int *)(param_1 + 0x18);
  *(byte **)(iVar6 + 4) = local_10;
  *(int *)(iVar2 + 0x28) = *(int *)(iVar2 + 0x28) + -1;
  *(byte **)(iVar2 + 0xc) = pbVar7;
  *(byte **)(iVar2 + 0x10) = pbVar5;
  return CONCAT31((int3)((uint)iVar6 >> 8),1);
}



void FUN_0042b550(void)

{
  code **ppcVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  int unaff_ESI;
  undefined4 *puVar5;
  
  ppcVar1 = (code **)(***(code ***)(unaff_ESI + 4))();
  *(code ***)(unaff_ESI + 0x198) = ppcVar1;
  *ppcVar1 = FUN_0042a8d0;
  iVar4 = 0;
  ppcVar1[0xb] = (code *)0x0;
  ppcVar1[0xc] = (code *)0x0;
  ppcVar1[0xd] = (code *)0x0;
  ppcVar1[0xe] = (code *)0x0;
  puVar2 = (undefined4 *)(***(code ***)(unaff_ESI + 4))();
  *(undefined4 **)(unaff_ESI + 0x8c) = puVar2;
  if (0 < *(int *)(unaff_ESI + 0x24)) {
    do {
      iVar4 = iVar4 + 1;
      puVar5 = puVar2;
      for (iVar3 = 0x40; iVar3 != 0; iVar3 = iVar3 + -1) {
        *puVar5 = 0xffffffff;
        puVar5 = puVar5 + 1;
      }
      puVar2 = puVar2 + 0x40;
    } while (iVar4 < *(int *)(unaff_ESI + 0x24));
  }
  return;
}



void FUN_0042b5c0(void)

{
  int iVar1;
  int in_EAX;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iStack_4;
  
  iVar1 = *(int *)(in_EAX + 0x1a4);
  uVar2 = (***(code ***)(in_EAX + 4))();
  *(undefined4 *)(iVar1 + 8) = uVar2;
  uVar2 = (***(code ***)(in_EAX + 4))();
  *(undefined4 *)(iVar1 + 0xc) = uVar2;
  uVar2 = (***(code ***)(in_EAX + 4))();
  *(undefined4 *)(iVar1 + 0x10) = uVar2;
  uVar2 = (***(code ***)(in_EAX + 4))();
  *(undefined4 *)(iVar1 + 0x14) = uVar2;
  iVar3 = 0;
  iStack_4 = 0x5b6900;
  iVar6 = -0xe25100;
  iVar5 = -0xb2f480;
  iVar4 = 0x2c8d00;
  do {
    *(int *)(iVar3 + *(int *)(iVar1 + 8)) = iVar5 >> 0x10;
    *(int *)(iVar3 + *(int *)(iVar1 + 0xc)) = iVar6 >> 0x10;
    *(int *)(iVar3 + *(int *)(iVar1 + 0x10)) = iStack_4;
    *(int *)(iVar3 + *(int *)(iVar1 + 0x14)) = iVar4;
    iStack_4 = iStack_4 + -0xb6d2;
    iVar4 = iVar4 + -0x581a;
    iVar5 = iVar5 + 0x166e9;
    iVar6 = iVar6 + 0x1c5a2;
    iVar3 = iVar3 + 4;
  } while (-0x2b34e7 < iVar4);
  return;
}



void __cdecl FUN_0042b690(int param_1,int *param_2,int param_3,undefined4 *param_4,int param_5)

{
  int *piVar1;
  int *piVar2;
  byte bVar3;
  byte bVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  byte *pbVar11;
  undefined *puVar12;
  int iVar13;
  int iVar14;
  uint uVar15;
  int iVar16;
  
  param_5 = param_5 + -1;
  iVar5 = *(int *)(param_1 + 0x1a4);
  iVar6 = *(int *)(param_1 + 0x120);
  iVar7 = *(int *)(param_1 + 0x5c);
  iVar8 = *(int *)(iVar5 + 8);
  iVar9 = *(int *)(iVar5 + 0xc);
  iVar10 = *(int *)(iVar5 + 0x10);
  iVar5 = *(int *)(iVar5 + 0x14);
  if (-1 < param_5) {
    iVar16 = param_3 * 4;
    do {
      piVar1 = (int *)(iVar16 + *param_2);
      pbVar11 = *(byte **)(iVar16 + param_2[1]);
      piVar2 = (int *)(iVar16 + param_2[2]);
      puVar12 = (undefined *)*param_4;
      iVar16 = iVar16 + 4;
      param_4 = param_4 + 1;
      if (iVar7 != 0) {
        iVar14 = *piVar1 - (int)pbVar11;
        iVar13 = *piVar2 - (int)pbVar11;
        param_1 = iVar7;
        do {
          bVar3 = pbVar11[iVar13];
          uVar15 = (uint)pbVar11[iVar14];
          bVar4 = *pbVar11;
          *puVar12 = *(undefined *)(*(int *)(iVar8 + (uint)bVar3 * 4) + uVar15 + iVar6);
          puVar12[1] = *(undefined *)
                        ((*(int *)(iVar5 + (uint)bVar4 * 4) + *(int *)(iVar10 + (uint)bVar3 * 4) >>
                         0x10) + uVar15 + iVar6);
          puVar12[2] = *(undefined *)(*(int *)(iVar9 + (uint)bVar4 * 4) + uVar15 + iVar6);
          puVar12 = puVar12 + 3;
          pbVar11 = pbVar11 + 1;
          param_1 = param_1 + -1;
        } while (param_1 != 0);
      }
      param_5 = param_5 + -1;
    } while (-1 < param_5);
  }
  return;
}



void __cdecl FUN_0042b8d0(int param_1,int *param_2,int param_3,undefined4 *param_4,int param_5)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  byte bVar4;
  byte bVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  byte *pbVar12;
  undefined *puVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  uint uVar17;
  int iVar18;
  
  param_5 = param_5 + -1;
  iVar6 = *(int *)(param_1 + 0x5c);
  iVar7 = *(int *)(param_1 + 0x1a4);
  iVar8 = *(int *)(param_1 + 0x120);
  iVar9 = *(int *)(iVar7 + 8);
  iVar10 = *(int *)(iVar7 + 0xc);
  iVar11 = *(int *)(iVar7 + 0x10);
  iVar7 = *(int *)(iVar7 + 0x14);
  if (-1 < param_5) {
    iVar15 = param_3 * 4;
    do {
      piVar1 = (int *)(iVar15 + *param_2);
      piVar2 = (int *)(iVar15 + param_2[2]);
      pbVar12 = *(byte **)(iVar15 + param_2[1]);
      piVar3 = (int *)(iVar15 + param_2[3]);
      puVar13 = (undefined *)*param_4;
      param_4 = param_4 + 1;
      iVar15 = iVar15 + 4;
      if (iVar6 != 0) {
        iVar16 = *piVar1 - (int)pbVar12;
        iVar14 = *piVar2 - (int)pbVar12;
        iVar18 = *piVar3 - (int)pbVar12;
        param_1 = iVar6;
        do {
          bVar4 = pbVar12[iVar14];
          uVar17 = (uint)pbVar12[iVar16];
          bVar5 = *pbVar12;
          *puVar13 = *(undefined *)(((iVar8 - *(int *)(iVar9 + (uint)bVar4 * 4)) - uVar17) + 0xff);
          puVar13[1] = *(undefined *)
                        (((iVar8 - (*(int *)(iVar7 + (uint)bVar5 * 4) +
                                    *(int *)(iVar11 + (uint)bVar4 * 4) >> 0x10)) - uVar17) + 0xff);
          puVar13[2] = *(undefined *)
                        (((iVar8 - *(int *)(iVar10 + (uint)bVar5 * 4)) - uVar17) + 0xff);
          puVar13[3] = pbVar12[iVar18];
          pbVar12 = pbVar12 + 1;
          param_1 = param_1 + -1;
          puVar13 = puVar13 + 4;
        } while (param_1 != 0);
      }
      param_5 = param_5 + -1;
    } while (-1 < param_5);
  }
  return;
}



void FUN_0042ba30(void)

{
  code **ppcVar1;
  int iVar2;
  int iVar3;
  int *unaff_ESI;
  
  ppcVar1 = (code **)(**(code **)unaff_ESI[1])();
  unaff_ESI[0x69] = (int)ppcVar1;
  *ppcVar1 = FUN_0041c770;
  switch(unaff_ESI[10]) {
  case 1:
    if (unaff_ESI[9] != 1) {
LAB_0042ba7e:
      *(undefined4 *)(*unaff_ESI + 0x14) = 10;
      (**(code **)*unaff_ESI)();
    }
    break;
  case 2:
  case 3:
    if (unaff_ESI[9] != 3) goto LAB_0042ba7e;
    break;
  case 4:
  case 5:
    if (unaff_ESI[9] != 4) goto LAB_0042ba7e;
    break;
  default:
    if (unaff_ESI[9] < 1) goto LAB_0042ba7e;
  }
  iVar2 = unaff_ESI[0xb];
  if (iVar2 == 1) {
    unaff_ESI[0x19] = 1;
    if ((unaff_ESI[10] == 1) || (unaff_ESI[10] == 3)) {
      ppcVar1[1] = (code *)&LAB_0042b840;
      iVar2 = 1;
      if (1 < unaff_ESI[9]) {
        iVar3 = 0x54;
        do {
          *(undefined *)(unaff_ESI[0x31] + 0x30 + iVar3) = 0;
          iVar2 = iVar2 + 1;
          iVar3 = iVar3 + 0x54;
        } while (iVar2 < unaff_ESI[9]);
      }
      goto LAB_0042bb85;
    }
  }
  else if (iVar2 == 2) {
    iVar2 = unaff_ESI[10];
    unaff_ESI[0x19] = 3;
    if (iVar2 == 3) {
      ppcVar1[1] = FUN_0042b690;
      FUN_0042b5c0();
      goto LAB_0042bb85;
    }
    if (iVar2 == 1) {
      ppcVar1[1] = (code *)&LAB_0042b870;
      goto LAB_0042bb85;
    }
    if (iVar2 == 2) {
      ppcVar1[1] = (code *)&LAB_0042b7b0;
      goto LAB_0042bb85;
    }
  }
  else if (iVar2 == 4) {
    unaff_ESI[0x19] = 4;
    if (unaff_ESI[10] == 5) {
      ppcVar1[1] = FUN_0042b8d0;
      FUN_0042b5c0();
      goto LAB_0042bb85;
    }
    if (unaff_ESI[10] == 4) {
      ppcVar1[1] = (code *)&LAB_0042b7b0;
      goto LAB_0042bb85;
    }
  }
  else if (iVar2 == unaff_ESI[10]) {
    unaff_ESI[0x19] = unaff_ESI[9];
    ppcVar1[1] = (code *)&LAB_0042b7b0;
    goto LAB_0042bb85;
  }
  *(undefined4 *)(*unaff_ESI + 0x14) = 0x1b;
  (**(code **)*unaff_ESI)();
LAB_0042bb85:
  if (*(char *)((int)unaff_ESI + 0x4a) == '\0') {
    unaff_ESI[0x1a] = unaff_ESI[0x19];
    return;
  }
  unaff_ESI[0x1a] = 1;
  return;
}



undefined4 __cdecl FUN_0042bc60(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  code *pcVar4;
  int iVar5;
  char cVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  undefined4 uVar11;
  int iVar12;
  undefined4 *puVar13;
  int iVar14;
  uint uVar15;
  int iStack_2c;
  int *piStack_28;
  int iStack_1c;
  int iStack_18;
  int iStack_14;
  
  iVar1 = *(int *)(param_1 + 0x11c);
  iVar2 = *(int *)(param_1 + 0x188);
  iVar7 = *(int *)(iVar2 + 0x18);
  uVar8 = *(int *)(param_1 + 0x138) - 1;
  if (iVar7 < *(int *)(iVar2 + 0x1c)) {
    do {
      for (uVar15 = *(uint *)(iVar2 + 0x14); uVar15 <= uVar8; uVar15 = uVar15 + 1) {
        memset(*(void **)(iVar2 + 0x20),0,*(int *)(param_1 + 0x140) << 7);
        cVar6 = (**(code **)(*(int *)(param_1 + 0x198) + 4))(param_1,iVar2 + 0x20);
        if (cVar6 == '\0') {
          *(uint *)(iVar2 + 0x14) = uVar15;
          *(int *)(iVar2 + 0x18) = iVar7;
          return 0;
        }
        iVar9 = 0;
        iStack_2c = 0;
        iStack_14 = 0;
        if (0 < *(int *)(param_1 + 0x124)) {
          piStack_28 = (int *)(param_1 + 0x128);
          do {
            iVar3 = *piStack_28;
            if (*(char *)(iVar3 + 0x30) == '\0') {
              iVar9 = iVar9 + *(int *)(iVar3 + 0x3c);
              iStack_2c = iVar9;
            }
            else {
              iVar12 = *(int *)(iVar3 + 4) * 4;
              pcVar4 = *(code **)(*(int *)(param_1 + 0x19c) + 4 + iVar12);
              if (uVar15 < uVar8) {
                iVar10 = *(int *)(iVar3 + 0x34);
              }
              else {
                iVar10 = *(int *)(iVar3 + 0x44);
              }
              iVar5 = *(int *)(iVar3 + 0x40);
              iVar12 = *(int *)(iVar12 + param_2) + *(int *)(iVar3 + 0x24) * iVar7 * 4;
              iStack_18 = 0;
              if (0 < *(int *)(iVar3 + 0x38)) {
                do {
                  if (((*(uint *)(param_1 + 0x80) < iVar1 - 1U) ||
                      (iVar7 + iStack_18 < *(int *)(iVar3 + 0x48))) && (0 < iVar10)) {
                    puVar13 = (undefined4 *)(iVar2 + 0x20 + iVar9 * 4);
                    iVar14 = iVar5 * uVar15;
                    iStack_1c = iVar10;
                    do {
                      (*pcVar4)(param_1,iVar3,*puVar13,iVar12,iVar14);
                      iVar14 = iVar14 + *(int *)(iVar3 + 0x24);
                      puVar13 = puVar13 + 1;
                      iStack_1c = iStack_1c + -1;
                      iVar9 = iStack_2c;
                    } while (iStack_1c != 0);
                  }
                  iVar9 = iVar9 + *(int *)(iVar3 + 0x34);
                  iStack_18 = iStack_18 + 1;
                  iVar12 = iVar12 + *(int *)(iVar3 + 0x24) * 4;
                  iStack_2c = iVar9;
                } while (iStack_18 < *(int *)(iVar3 + 0x38));
              }
            }
            piStack_28 = piStack_28 + 1;
            iStack_14 = iStack_14 + 1;
          } while (iStack_14 < *(int *)(param_1 + 0x124));
        }
      }
      iVar7 = iVar7 + 1;
      *(undefined4 *)(iVar2 + 0x14) = 0;
    } while (iVar7 < *(int *)(iVar2 + 0x1c));
  }
  *(int *)(param_1 + 0x80) = *(int *)(param_1 + 0x80) + 1;
  *(int *)(param_1 + 0x88) = *(int *)(param_1 + 0x88) + 1;
  if (*(uint *)(param_1 + 0x80) < *(uint *)(param_1 + 0x11c)) {
    iVar1 = *(int *)(param_1 + 0x188);
    if (1 < *(int *)(param_1 + 0x124)) {
      *(undefined4 *)(iVar1 + 0x1c) = 1;
      *(undefined4 *)(iVar1 + 0x14) = 0;
      *(undefined4 *)(iVar1 + 0x18) = 0;
      return 3;
    }
    if (*(uint *)(param_1 + 0x80) < *(uint *)(param_1 + 0x11c) - 1) {
      uVar11 = *(undefined4 *)(*(int *)(param_1 + 0x128) + 0xc);
    }
    else {
      uVar11 = *(undefined4 *)(*(int *)(param_1 + 0x128) + 0x48);
    }
    *(undefined4 *)(iVar1 + 0x1c) = uVar11;
    *(undefined4 *)(iVar1 + 0x14) = 0;
    *(undefined4 *)(iVar1 + 0x18) = 0;
    return 3;
  }
  (**(code **)(*(int *)(param_1 + 400) + 0xc))(param_1);
  return 4;
}



int FUN_0042c110(int param_1,int param_2)

{
  int iVar1;
  code *pcVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  undefined4 *puVar7;
  uint uVar8;
  int iVar9;
  uint uStack_20;
  int iStack_1c;
  int iStack_18;
  int local_14;
  
  iVar1 = *(int *)(param_1 + 0x11c);
  iVar4 = *(int *)(param_1 + 0x188);
  while ((*(int *)(param_1 + 0x7c) < *(int *)(param_1 + 0x84) ||
         ((*(int *)(param_1 + 0x7c) == *(int *)(param_1 + 0x84) &&
          (*(uint *)(param_1 + 0x80) <= *(uint *)(param_1 + 0x88)))))) {
    iVar3 = (***(code ***)(param_1 + 400))(param_1);
    if (iVar3 == 0) {
      return 0;
    }
  }
  iVar3 = *(int *)(param_1 + 0xc4);
  local_14 = 0;
  if (0 < *(int *)(param_1 + 0x24)) {
    puVar7 = (undefined4 *)(iVar4 + 0x48);
    do {
      if (*(char *)(iVar3 + 0x30) != '\0') {
        iVar4 = (**(code **)(*(int *)(param_1 + 4) + 0x20))
                          (param_1,*puVar7,*(int *)(param_1 + 0x88) * *(int *)(iVar3 + 0xc),
                           *(int *)(iVar3 + 0xc),0);
        if (*(uint *)(param_1 + 0x88) < iVar1 - 1U) {
          uStack_20 = *(uint *)(iVar3 + 0xc);
        }
        else {
          uStack_20 = *(uint *)(iVar3 + 0x20) % *(uint *)(iVar3 + 0xc);
          if (uStack_20 == 0) {
            uStack_20 = *(uint *)(iVar3 + 0xc);
          }
        }
        pcVar2 = *(code **)(*(int *)(param_1 + 0x19c) + 4 + local_14 * 4);
        iStack_1c = *(int *)(param_2 + local_14 * 4);
        iStack_18 = 0;
        if (0 < (int)uStack_20) {
          uVar5 = *(uint *)(iVar3 + 0x1c);
          do {
            iVar6 = *(int *)(iVar4 + iStack_18 * 4);
            iVar9 = 0;
            uVar8 = 0;
            if (uVar5 != 0) {
              do {
                (*pcVar2)(param_1,iVar3,iVar6,iStack_1c,iVar9);
                uVar5 = *(uint *)(iVar3 + 0x1c);
                iVar9 = iVar9 + *(int *)(iVar3 + 0x24);
                uVar8 = uVar8 + 1;
                iVar6 = iVar6 + 0x80;
              } while (uVar8 < uVar5);
            }
            iStack_18 = iStack_18 + 1;
            iStack_1c = iStack_1c + *(int *)(iVar3 + 0x24) * 4;
          } while (iStack_18 < (int)uStack_20);
        }
      }
      local_14 = local_14 + 1;
      puVar7 = puVar7 + 1;
      iVar3 = iVar3 + 0x54;
    } while (local_14 < *(int *)(param_1 + 0x24));
  }
  *(int *)(param_1 + 0x88) = *(int *)(param_1 + 0x88) + 1;
  return 4 - (uint)(*(uint *)(param_1 + 0x88) < *(uint *)(param_1 + 0x11c));
}



uint FUN_0042c2a0(void)

{
  uint in_EAX;
  undefined4 uVar1;
  int *piVar2;
  int **ppiVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int unaff_EDI;
  undefined local_5;
  
  iVar4 = *(int *)(unaff_EDI + 0x188);
  local_5 = 0;
  if ((*(char *)(unaff_EDI + 200) == '\0') || (*(int *)(unaff_EDI + 0x8c) == 0)) {
    return in_EAX & 0xffffff00;
  }
  if (*(int *)(iVar4 + 0x70) == 0) {
    uVar1 = (***(code ***)(unaff_EDI + 4))();
    *(undefined4 *)(iVar4 + 0x70) = uVar1;
  }
  iVar4 = *(int *)(iVar4 + 0x70);
  ppiVar3 = *(int ***)(unaff_EDI + 0xc4);
  iVar6 = 0;
  if (0 < *(int *)(unaff_EDI + 0x24)) {
    iVar5 = 0;
    ppiVar3 = ppiVar3 + 0x13;
    do {
      piVar2 = *ppiVar3;
      if (((((piVar2 == (int *)0x0) || (*(short *)piVar2 == 0)) ||
           (*(short *)((int)piVar2 + 2) == 0)) ||
          ((*(short *)(piVar2 + 4) == 0 || (*(short *)(piVar2 + 8) == 0)))) ||
         ((*(short *)((int)piVar2 + 0x12) == 0 ||
          ((*(short *)(piVar2 + 1) == 0 ||
           (piVar2 = (int *)(*(int *)(unaff_EDI + 0x8c) + iVar5), *piVar2 < 0)))))) {
        return (uint)piVar2 & 0xffffff00;
      }
      *(int *)(iVar4 + 4) = piVar2[1];
      if (piVar2[1] != 0) {
        local_5 = 1;
      }
      *(int *)(iVar4 + 8) = piVar2[2];
      if (piVar2[2] != 0) {
        local_5 = 1;
      }
      *(int *)(iVar4 + 0xc) = piVar2[3];
      if (piVar2[3] != 0) {
        local_5 = 1;
      }
      *(int *)(iVar4 + 0x10) = piVar2[4];
      if (piVar2[4] != 0) {
        local_5 = 1;
      }
      *(int *)(iVar4 + 0x14) = piVar2[5];
      if (piVar2[5] != 0) {
        local_5 = 1;
      }
      iVar6 = iVar6 + 1;
      ppiVar3 = ppiVar3 + 0x15;
      iVar4 = iVar4 + 0x18;
      iVar5 = iVar5 + 0x100;
    } while (iVar6 < *(int *)(unaff_EDI + 0x24));
  }
  return CONCAT31((int3)((uint)ppiVar3 >> 8),local_5);
}



void __cdecl FUN_0042ca50(char param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  int unaff_EDI;
  undefined4 *puStack_10;
  
  puVar1 = (undefined4 *)(***(code ***)(unaff_EDI + 4))();
  *(undefined4 **)(unaff_EDI + 0x188) = puVar1;
  *puVar1 = &LAB_0042bbb0;
  puVar1[2] = &LAB_0042bc10;
  puVar1[0x1c] = 0;
  if (param_1 != '\0') {
    _param_1 = 0;
    if (0 < *(int *)(unaff_EDI + 0x24)) {
      puStack_10 = puVar1 + 0x12;
      do {
        uVar2 = (**(code **)(*(int *)(unaff_EDI + 4) + 0x14))();
        *puStack_10 = uVar2;
        _param_1 = _param_1 + 1;
        puStack_10 = puStack_10 + 1;
      } while (_param_1 < *(int *)(unaff_EDI + 0x24));
    }
    puVar1[1] = &LAB_0042bee0;
    puVar1[3] = FUN_0042c110;
    puVar1[4] = puVar1 + 0x12;
    return;
  }
  iVar3 = (**(code **)(*(int *)(unaff_EDI + 4) + 4))();
  puVar1[9] = iVar3 + 0x80;
  puVar1[10] = iVar3 + 0x100;
  puVar1[0xb] = iVar3 + 0x180;
  puVar1[0xc] = iVar3 + 0x200;
  puVar1[0xd] = iVar3 + 0x280;
  puVar1[0xe] = iVar3 + 0x300;
  puVar1[8] = iVar3;
  puVar1[0xf] = iVar3 + 0x380;
  puVar1[0x10] = iVar3 + 0x400;
  puVar1[0x11] = iVar3 + 0x480;
  puVar1[4] = 0;
  puVar1[1] = &LAB_004164f0;
  puVar1[3] = FUN_0042bc60;
  return;
}



void __thiscall FUN_0042cc40(void *this,int *param_1)

{
  short sVar1;
  int iVar2;
  short *psVar3;
  short *psVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int local_1c;
  int local_18;
  int local_14;
  int local_10;
  int local_c;
  int local_4;
  
  iVar2 = *(int *)(*(int *)((int)this + 0x1a8) + 0x18);
  local_14 = *param_1;
  iVar6 = param_1[4];
  local_4 = param_1[5];
  local_1c = param_1[2];
  local_18 = param_1[1];
  local_10 = param_1[3];
  iVar8 = local_14;
  if (local_14 < local_18) {
    do {
      if (local_1c <= local_10) {
        psVar3 = (short *)(*(int *)(iVar2 + iVar8 * 4) + (local_1c * 0x20 + iVar6) * 2);
        iVar5 = iVar6;
        iVar7 = local_1c;
        psVar4 = psVar3;
        do {
          for (; iVar5 <= local_4; iVar5 = iVar5 + 1) {
            sVar1 = *psVar3;
            psVar3 = psVar3 + 1;
            if (sVar1 != 0) {
              *param_1 = iVar8;
              local_14 = iVar8;
              goto LAB_0042ccfb;
            }
          }
          iVar7 = iVar7 + 1;
          psVar3 = psVar4 + 0x20;
          iVar5 = iVar6;
          psVar4 = psVar3;
        } while (iVar7 <= local_10);
      }
      iVar8 = iVar8 + 1;
    } while (iVar8 <= local_18);
LAB_0042ccfb:
    iVar8 = local_18;
    if (local_14 < local_18) {
      do {
        if (local_1c <= local_10) {
          psVar3 = (short *)(*(int *)(iVar2 + iVar8 * 4) + (local_1c * 0x20 + iVar6) * 2);
          iVar5 = iVar6;
          iVar7 = local_1c;
          psVar4 = psVar3;
          do {
            for (; iVar5 <= local_4; iVar5 = iVar5 + 1) {
              sVar1 = *psVar3;
              psVar3 = psVar3 + 1;
              if (sVar1 != 0) {
                param_1[1] = iVar8;
                local_18 = iVar8;
                goto LAB_0042cd7e;
              }
            }
            iVar7 = iVar7 + 1;
            psVar3 = psVar4 + 0x20;
            iVar5 = iVar6;
            psVar4 = psVar3;
          } while (iVar7 <= local_10);
        }
        iVar8 = iVar8 + -1;
      } while (local_14 <= iVar8);
    }
  }
LAB_0042cd7e:
  if (local_1c < local_10) {
    iVar8 = (local_1c * 0x20 + iVar6) * 2;
    iVar5 = local_14;
    local_c = local_1c;
    do {
      for (; iVar5 <= local_18; iVar5 = iVar5 + 1) {
        psVar3 = (short *)(*(int *)(iVar2 + iVar5 * 4) + iVar8);
        for (iVar7 = iVar6; iVar7 <= local_4; iVar7 = iVar7 + 1) {
          sVar1 = *psVar3;
          psVar3 = psVar3 + 1;
          if (sVar1 != 0) {
            local_1c = local_c;
            param_1[2] = local_c;
            goto LAB_0042cdf8;
          }
        }
      }
      local_c = local_c + 1;
      iVar8 = iVar8 + 0x40;
      iVar5 = local_14;
    } while (local_c <= local_10);
LAB_0042cdf8:
    if (local_1c < local_10) {
      iVar8 = (local_10 * 0x20 + iVar6) * 2;
      iVar5 = local_14;
      local_c = local_10;
      do {
        for (; iVar5 <= local_18; iVar5 = iVar5 + 1) {
          psVar3 = (short *)(*(int *)(iVar2 + iVar5 * 4) + iVar8);
          for (iVar7 = iVar6; iVar7 <= local_4; iVar7 = iVar7 + 1) {
            sVar1 = *psVar3;
            psVar3 = psVar3 + 1;
            if (sVar1 != 0) {
              local_10 = local_c;
              param_1[3] = local_c;
              goto LAB_0042ce70;
            }
          }
        }
        local_c = local_c + -1;
        iVar8 = iVar8 + -0x40;
        iVar5 = local_14;
      } while (local_1c <= local_c);
    }
  }
LAB_0042ce70:
  iVar8 = iVar6;
  if (iVar6 < local_4) {
    do {
      if (local_14 <= local_18) {
        iVar5 = local_14;
        do {
          psVar3 = (short *)(*(int *)(iVar2 + iVar5 * 4) + (local_1c * 0x20 + iVar8) * 2);
          for (iVar7 = local_1c; iVar7 <= local_10; iVar7 = iVar7 + 1) {
            if (*psVar3 != 0) {
              param_1[4] = iVar8;
              iVar6 = iVar8;
              goto LAB_0042ceed;
            }
            psVar3 = psVar3 + 0x20;
          }
          iVar5 = iVar5 + 1;
        } while (iVar5 <= local_18);
      }
      iVar8 = iVar8 + 1;
    } while (iVar8 <= local_4);
LAB_0042ceed:
    iVar8 = local_4;
    if (iVar6 < local_4) {
      do {
        if (local_14 <= local_18) {
          iVar5 = local_14;
          do {
            psVar3 = (short *)(*(int *)(iVar2 + iVar5 * 4) + (local_1c * 0x20 + iVar8) * 2);
            for (iVar7 = local_1c; iVar7 <= local_10; iVar7 = iVar7 + 1) {
              if (*psVar3 != 0) {
                param_1[5] = iVar8;
                local_4 = iVar8;
                goto LAB_0042cf6d;
              }
              psVar3 = psVar3 + 0x20;
            }
            iVar5 = iVar5 + 1;
          } while (iVar5 <= local_18);
        }
        iVar8 = iVar8 + -1;
      } while (iVar6 <= iVar8);
    }
  }
LAB_0042cf6d:
  iVar8 = (local_4 - iVar6) * 8;
  iVar5 = (local_10 - local_1c) * 0xc;
  iVar7 = (local_18 - local_14) * 0x10;
  param_1[6] = iVar8 * iVar8 + iVar5 * iVar5 + iVar7 * iVar7;
  iVar8 = 0;
  local_c = local_14;
  if (local_14 <= local_18) {
    do {
      if (local_1c <= local_10) {
        local_14 = (local_10 - local_1c) + 1;
        psVar3 = (short *)(*(int *)(iVar2 + local_c * 4) + (local_1c * 0x20 + iVar6) * 2);
        do {
          if (iVar6 <= local_4) {
            iVar5 = (local_4 - iVar6) + 1;
            psVar4 = psVar3;
            do {
              if (*psVar4 != 0) {
                iVar8 = iVar8 + 1;
              }
              psVar4 = psVar4 + 1;
              iVar5 = iVar5 + -1;
            } while (iVar5 != 0);
          }
          psVar3 = psVar3 + 0x20;
          local_14 = local_14 + -1;
        } while (local_14 != 0);
      }
      local_c = local_c + 1;
    } while (local_c <= local_18);
    param_1[7] = iVar8;
    return;
  }
  param_1[7] = 0;
  return;
}



void __cdecl FUN_0042d040(void *param_1,int param_2,int param_3)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  char cVar4;
  int iVar5;
  int *piVar6;
  int local_8;
  int local_4;
  
  local_4 = 1;
  if (1 < param_3) {
    local_8 = 2;
    piVar6 = (int *)(param_2 + 0x2c);
    do {
      iVar3 = 0;
      if (param_3 < local_8) {
        piVar1 = (int *)0x0;
        if (0 < local_4) {
          piVar2 = (int *)(param_2 + 0x18);
          piVar1 = (int *)0x0;
          iVar5 = local_4;
          do {
            if (iVar3 < *piVar2) {
              piVar1 = piVar2 + -6;
              iVar3 = *piVar2;
            }
            piVar2 = piVar2 + 8;
            iVar5 = iVar5 + -1;
          } while (iVar5 != 0);
        }
      }
      else {
        piVar1 = (int *)0x0;
        if (0 < local_4) {
          piVar2 = (int *)(param_2 + 0x1c);
          iVar5 = local_4;
          do {
            if ((iVar3 < *piVar2) && (0 < piVar2[-1])) {
              piVar1 = piVar2 + -7;
              iVar3 = *piVar2;
            }
            piVar2 = piVar2 + 8;
            iVar5 = iVar5 + -1;
          } while (iVar5 != 0);
        }
      }
      if (piVar1 == (int *)0x0) {
        return;
      }
      piVar6[-2] = piVar1[1];
      *piVar6 = piVar1[3];
      piVar6[2] = piVar1[5];
      piVar6[-3] = *piVar1;
      piVar6[-1] = piVar1[2];
      piVar6[1] = piVar1[4];
      iVar5 = (piVar1[1] - *piVar1) * 0x10;
      iVar3 = (piVar1[3] - piVar1[2]) * 0xc;
      cVar4 = iVar5 <= iVar3;
      if (!(bool)cVar4) {
        iVar3 = iVar5;
      }
      if (iVar3 < (piVar1[5] - piVar1[4]) * 8) {
        cVar4 = '\x02';
      }
      if (cVar4 == '\0') {
        iVar3 = (piVar1[1] + *piVar1) / 2;
        piVar1[1] = iVar3;
        piVar6[-3] = iVar3 + 1;
      }
      else if (cVar4 == '\x01') {
        iVar3 = (piVar1[3] + piVar1[2]) / 2;
        piVar1[3] = iVar3;
        piVar6[-1] = iVar3 + 1;
      }
      else if (cVar4 == '\x02') {
        iVar3 = (piVar1[5] + piVar1[4]) / 2;
        piVar1[5] = iVar3;
        piVar6[1] = iVar3 + 1;
      }
      FUN_0042cc40(param_1,piVar1);
      FUN_0042cc40(param_1,piVar6 + -3);
      local_8 = local_8 + 2;
      local_4 = local_4 + 1;
      piVar6 = piVar6 + 8;
    } while (local_4 < param_3);
  }
  return;
}



void __cdecl FUN_0042d1c0(int param_1,int param_2)

{
  int iVar1;
  int *in_EAX;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  ushort *puVar8;
  ushort *puVar9;
  int iVar10;
  int iVar11;
  int local_38;
  int local_34;
  int local_30;
  int local_2c;
  
  iVar6 = in_EAX[2];
  iVar1 = in_EAX[4];
  iVar4 = *in_EAX;
  iVar11 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  if (iVar4 <= in_EAX[1]) {
    local_38 = iVar4 * 8 + 4;
    do {
      if (iVar6 <= in_EAX[3]) {
        puVar8 = (ushort *)
                 (*(int *)(*(int *)(*(int *)(param_1 + 0x1a8) + 0x18) + iVar4 * 4) +
                 (iVar6 * 0x20 + iVar1) * 2);
        iVar2 = (in_EAX[3] - iVar6) + 1;
        iVar10 = iVar6 * 4 + 2;
        do {
          if (iVar1 <= in_EAX[5]) {
            iVar5 = iVar1 * 8 + 4;
            iVar7 = (in_EAX[5] - iVar1) + 1;
            puVar9 = puVar8;
            do {
              uVar3 = (uint)*puVar9;
              puVar9 = puVar9 + 1;
              if (uVar3 != 0) {
                local_34 = local_34 + local_38 * uVar3;
                local_30 = local_30 + iVar10 * uVar3;
                iVar11 = iVar11 + uVar3;
                local_2c = local_2c + iVar5 * uVar3;
              }
              iVar5 = iVar5 + 8;
              iVar7 = iVar7 + -1;
            } while (iVar7 != 0);
          }
          puVar8 = puVar8 + 0x20;
          iVar10 = iVar10 + 4;
          iVar2 = iVar2 + -1;
        } while (iVar2 != 0);
      }
      local_38 = local_38 + 8;
      iVar4 = iVar4 + 1;
    } while (iVar4 <= in_EAX[1]);
  }
  iVar6 = iVar11 >> 1;
  *(char *)(param_2 + **(int **)(param_1 + 0x74)) = (char)((iVar6 + local_34) / iVar11);
  *(char *)(param_2 + *(int *)(*(int *)(param_1 + 0x74) + 4)) = (char)((local_30 + iVar6) / iVar11);
  *(char *)(param_2 + *(int *)(*(int *)(param_1 + 0x74) + 8)) = (char)((local_2c + iVar6) / iVar11);
  return;
}



void __cdecl FUN_0042d340(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *unaff_EDI;
  
  piVar1 = (int *)(**(code **)unaff_EDI[1])();
  iVar3 = 0;
  *piVar1 = 0;
  piVar1[1] = 0x1f;
  piVar1[2] = 0;
  piVar1[3] = 0x3f;
  piVar1[4] = 0;
  piVar1[5] = 0x1f;
  FUN_0042cc40(unaff_EDI,piVar1);
  iVar2 = FUN_0042d040(unaff_EDI,(int)piVar1,param_1);
  if (0 < iVar2) {
    do {
      FUN_0042d1c0((int)unaff_EDI,iVar3);
      iVar3 = iVar3 + 1;
    } while (iVar3 < iVar2);
  }
  unaff_EDI[0x1c] = iVar2;
  *(undefined4 *)(*unaff_EDI + 0x14) = 0x60;
  *(int *)(*unaff_EDI + 0x18) = iVar2;
  (**(code **)(*unaff_EDI + 4))();
  return;
}



void __thiscall FUN_0042d3d0(void *this,int param_1,int param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int in_EAX;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int local_428;
  int local_424;
  int aiStack_400 [256];
  
  iVar1 = *(int *)(in_EAX + 0x70);
  iVar7 = (int)this + 0x1c;
  local_424 = 0x7fffffff;
  local_428 = 0;
  if (iVar1 < 1) {
    local_424 = 0x7fffffff;
  }
  else {
    piVar2 = *(int **)(in_EAX + 0x74);
    iVar11 = *piVar2;
    iVar3 = piVar2[1];
    iVar4 = piVar2[2];
    do {
      uVar5 = (uint)*(byte *)(iVar11 + local_428);
      if ((int)uVar5 < param_1) {
        iVar12 = (uVar5 - param_1) * 2;
        iVar12 = iVar12 * iVar12;
        iVar9 = param_1 + 0x18;
LAB_0042d45c:
        iVar6 = iVar9;
      }
      else {
        iVar6 = param_1 + 0x18;
        iVar9 = param_1;
        if (iVar6 < (int)uVar5) {
          iVar12 = (uVar5 - iVar6) * 2;
          iVar12 = iVar12 * iVar12;
          goto LAB_0042d45c;
        }
        iVar12 = 0;
        if (param_1 * 2 + 0x18 >> 1 < (int)uVar5) goto LAB_0042d45c;
      }
      uVar8 = (uint)*(byte *)(iVar3 + local_428);
      iVar6 = (uVar5 - iVar6) * 2;
      if ((int)uVar8 < (int)this) {
        iVar9 = (uVar8 - (int)this) * 3;
        iVar12 = iVar12 + iVar9 * iVar9;
        iVar9 = uVar8 - iVar7;
      }
      else {
        if (iVar7 < (int)uVar8) {
          iVar9 = (uVar8 - iVar7) * 3;
          iVar12 = iVar12 + iVar9 * iVar9;
        }
        else if ((int)uVar8 <= iVar7 + (int)this >> 1) {
          iVar9 = uVar8 - iVar7;
          goto LAB_0042d4c5;
        }
        iVar9 = uVar8 - (int)this;
      }
LAB_0042d4c5:
      uVar5 = (uint)*(byte *)(iVar4 + local_428);
      if ((int)uVar5 < param_2) {
        iVar12 = iVar12 + (uVar5 - param_2) * (uVar5 - param_2);
        iVar10 = uVar5 - (param_2 + 0x18);
      }
      else {
        iVar10 = param_2 + 0x18;
        if (iVar10 < (int)uVar5) {
          iVar12 = iVar12 + (uVar5 - iVar10) * (uVar5 - iVar10);
        }
        else if ((int)uVar5 <= param_2 * 2 + 0x18 >> 1) {
          iVar10 = uVar5 - iVar10;
          goto LAB_0042d523;
        }
        iVar10 = uVar5 - param_2;
      }
LAB_0042d523:
      iVar6 = iVar6 * iVar6 + iVar9 * 3 * iVar9 * 3 + iVar10 * iVar10;
      aiStack_400[local_428] = iVar12;
      if (iVar6 < local_424) {
        local_424 = iVar6;
      }
      local_428 = local_428 + 1;
    } while (local_428 < iVar1);
  }
  iVar7 = 0;
  iVar11 = 0;
  if (0 < iVar1) {
    do {
      if (aiStack_400[iVar11] <= local_424) {
        *(char *)(iVar7 + param_3) = (char)iVar11;
        iVar7 = iVar7 + 1;
      }
      iVar11 = iVar11 + 1;
    } while (iVar11 < iVar1);
  }
  return;
}



void __cdecl
FUN_0042d5a0(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,byte *param_7)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  byte *pbVar8;
  uint uVar9;
  int local_21c;
  int local_218;
  int local_214;
  int local_210;
  int local_208;
  int local_200 [128];
  
  piVar7 = local_200;
  for (iVar4 = 0x80; iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar7 = 0x7fffffff;
    piVar7 = piVar7 + 1;
  }
  local_210 = 0;
  if (0 < param_5) {
    do {
      bVar1 = *(byte *)(local_210 + param_6);
      uVar9 = (uint)bVar1;
      piVar7 = *(int **)(param_1 + 0x74);
      iVar5 = param_3 - (uint)*(byte *)(piVar7[1] + uVar9);
      iVar4 = iVar5 * 3;
      iVar6 = param_4 - (uint)*(byte *)(piVar7[2] + uVar9);
      iVar3 = (param_2 - (uint)*(byte *)(uVar9 + *piVar7)) * 2;
      iVar4 = iVar6 * iVar6 + iVar4 * iVar4 + iVar3 * iVar3;
      iVar6 = (iVar6 + 4) * 0x10;
      local_21c = (iVar3 + 8) * 0x20;
      piVar7 = local_200;
      local_218 = 3;
      pbVar8 = param_7;
      do {
        local_208 = 7;
        iVar3 = iVar4;
        local_214 = (iVar5 * 9 + 0x12) * 8;
        do {
          if (iVar3 < *piVar7) {
            *piVar7 = iVar3;
            *pbVar8 = bVar1;
          }
          iVar2 = iVar3 + iVar6;
          if (iVar2 < piVar7[1]) {
            piVar7[1] = iVar2;
            pbVar8[1] = bVar1;
          }
          iVar2 = iVar2 + iVar6 + 0x80;
          if (iVar2 < piVar7[2]) {
            piVar7[2] = iVar2;
            pbVar8[2] = bVar1;
          }
          iVar2 = iVar2 + iVar6 + 0x100;
          if (iVar2 < piVar7[3]) {
            piVar7[3] = iVar2;
            pbVar8[3] = bVar1;
          }
          iVar3 = iVar3 + local_214;
          local_214 = local_214 + 0x120;
          piVar7 = piVar7 + 4;
          pbVar8 = pbVar8 + 4;
          local_208 = local_208 + -1;
        } while (-1 < local_208);
        iVar4 = iVar4 + local_21c;
        local_21c = local_21c + 0x200;
        local_218 = local_218 + -1;
      } while (-1 < local_218);
      local_210 = local_210 + 1;
    } while (local_210 < param_5);
  }
  return;
}



void __thiscall FUN_0042d720(void *this,int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  int iVar2;
  short *psVar3;
  byte *pbVar4;
  void *this_00;
  int iVar5;
  int iVar6;
  int *piVar7;
  int local_18c;
  int local_188;
  byte local_184 [128];
  undefined local_104 [256];
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_18c;
  local_188 = *(int *)(*(int *)(param_1 + 0x1a8) + 0x18);
  iVar5 = (param_3 >> 2) * 0x20 + 4;
  iVar6 = (param_2 >> 2) * 0x20 + 4;
  this_00 = (void *)(((int)this >> 3) * 0x20 + 2);
  local_18c = param_1;
  iVar2 = FUN_0042d3d0(this_00,iVar6,iVar5,(int)local_104);
  FUN_0042d5a0(local_18c,iVar6,(int)this_00,iVar5,iVar2,(int)local_104,local_184);
  local_18c = (((int)this >> 3) * 0x100 + (param_3 >> 2) * 4) * 2;
  pbVar4 = local_184;
  piVar7 = (int *)(local_188 + (param_2 >> 2) * 0x10);
  iVar2 = 4;
  do {
    iVar6 = 8;
    iVar5 = local_18c;
    do {
      psVar3 = (short *)(*piVar7 + iVar5);
      *psVar3 = *pbVar4 + 1;
      psVar3[1] = pbVar4[1] + 1;
      psVar3[2] = pbVar4[2] + 1;
      pbVar1 = pbVar4 + 3;
      pbVar4 = pbVar4 + 4;
      iVar5 = iVar5 + 0x40;
      iVar6 = iVar6 + -1;
      psVar3[3] = *pbVar1 + 1;
    } while (iVar6 != 0);
    piVar7 = piVar7 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  ___security_check_cookie_4(local_4 ^ (uint)&local_18c);
  return;
}



void __cdecl FUN_0042d860(int param_1,int param_2,char **param_3,int param_4)

{
  byte *pbVar1;
  byte *pbVar2;
  short *psVar3;
  int iVar4;
  byte bVar5;
  int iVar6;
  int iVar7;
  char *pcVar8;
  byte *pbVar9;
  char **local_14;
  int local_10;
  
  iVar6 = *(int *)(*(int *)(param_1 + 0x1a8) + 0x18);
  iVar7 = *(int *)(param_1 + 0x5c);
  if (0 < param_4) {
    local_14 = param_3;
    local_10 = param_4;
    do {
      pbVar9 = *(byte **)((param_2 - (int)param_3) + (int)local_14);
      pcVar8 = *local_14;
      for (iVar4 = iVar7; iVar4 != 0; iVar4 = iVar4 + -1) {
        bVar5 = *pbVar9;
        pbVar1 = pbVar9 + 1;
        pbVar2 = pbVar9 + 2;
        psVar3 = (short *)(*(int *)(iVar6 + (uint)(bVar5 >> 3) * 4) +
                          ((int)(void *)(uint)(*pbVar1 >> 2) * 0x20 + (uint)(*pbVar2 >> 3)) * 2);
        pbVar9 = pbVar9 + 3;
        if (*psVar3 == 0) {
          FUN_0042d720((void *)(uint)(*pbVar1 >> 2),param_1,(uint)(bVar5 >> 3),(uint)(*pbVar2 >> 3))
          ;
        }
        *pcVar8 = *(char *)psVar3 + -1;
        pcVar8 = pcVar8 + 1;
      }
      local_14 = local_14 + 1;
      local_10 = local_10 + -1;
    } while (local_10 != 0);
  }
  return;
}



void __cdecl FUN_0042d930(int param_1,int param_2,int *param_3,int param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  byte *pbVar11;
  int iVar12;
  void *this;
  int iVar13;
  short *psVar14;
  int iVar15;
  uint uVar16;
  int iVar17;
  uint uVar18;
  int iVar19;
  uint uVar20;
  int iVar21;
  undefined *local_5c;
  int local_54;
  int local_50;
  int local_4c;
  int *local_48;
  int local_44;
  int local_40;
  int local_3c;
  int local_38;
  int local_24;
  
  iVar2 = *(int *)(param_1 + 0x5c);
  iVar3 = *(int *)(param_1 + 0x1a8);
  iVar4 = *(int *)(iVar3 + 0x18);
  iVar5 = *(int *)(param_1 + 0x120);
  piVar6 = *(int **)(param_1 + 0x74);
  iVar7 = *piVar6;
  iVar8 = piVar6[1];
  iVar9 = piVar6[2];
  iVar10 = *(int *)(iVar3 + 0x28);
  if (0 < param_4) {
    local_48 = param_3;
    local_24 = param_4;
    do {
      iVar12 = 0;
      pbVar11 = *(byte **)((int)local_48 + (param_2 - (int)param_3));
      local_5c = (undefined *)*local_48;
      if (*(char *)(iVar3 + 0x24) == '\0') {
        psVar14 = *(short **)(iVar3 + 0x20);
        local_38 = 1;
        param_4 = 3;
        *(undefined *)(iVar3 + 0x24) = 1;
      }
      else {
        pbVar11 = pbVar11 + iVar2 * 3 + -3;
        local_5c = local_5c + iVar2 + -1;
        psVar14 = (short *)(*(int *)(iVar3 + 0x20) + (iVar2 * 3 + 3) * 2);
        local_38 = -1;
        param_4 = -3;
        *(undefined *)(iVar3 + 0x24) = 0;
      }
      iVar17 = 0;
      iVar15 = 0;
      local_3c = 0;
      local_40 = 0;
      local_44 = 0;
      local_4c = 0;
      local_4c._0_2_ = 0;
      local_50 = 0;
      local_50._0_2_ = 0;
      local_54 = 0;
      local_54._0_2_ = 0;
      for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
        uVar18 = (uint)*(byte *)(*(int *)(iVar10 + (psVar14[param_4] + 8 + iVar17 >> 4) * 4) +
                                 (uint)*pbVar11 + iVar5);
        uVar20 = (uint)*(byte *)(*(int *)(iVar10 + (psVar14[param_4 + 1] + 8 + iVar12 >> 4) * 4) +
                                 (uint)pbVar11[1] + iVar5);
        uVar16 = (uint)*(byte *)(*(int *)(iVar10 + (psVar14[param_4 + 2] + 8 + iVar15 >> 4) * 4) +
                                 (uint)pbVar11[2] + iVar5);
        this = (void *)((int)uVar20 >> 2);
        iVar13 = (int)uVar16 >> 3;
        iVar15 = (int)this * 0x20 + iVar13;
        iVar17 = (int)uVar18 >> 3;
        iVar12 = *(int *)(iVar4 + iVar17 * 4);
        if (*(short *)(iVar12 + iVar15 * 2) == 0) {
          FUN_0042d720(this,param_1,iVar17,iVar13);
        }
        iVar12 = *(ushort *)(iVar12 + iVar15 * 2) - 1;
        *local_5c = (char)iVar12;
        iVar19 = uVar18 - *(byte *)(iVar12 + iVar7);
        iVar21 = uVar20 - *(byte *)(iVar12 + iVar8);
        iVar13 = uVar16 - *(byte *)(iVar12 + iVar9);
        *psVar14 = (short)local_54 + (short)iVar19 * 3;
        local_54 = local_44 + iVar19 * 5;
        iVar17 = iVar19 * 7;
        psVar14[1] = (short)local_50 + (short)iVar21 * 3;
        local_50 = local_40 + iVar21 * 5;
        iVar12 = iVar21 * 7;
        psVar14[2] = (short)local_4c + (short)iVar13 * 3;
        local_4c = local_3c + iVar13 * 5;
        local_5c = local_5c + local_38;
        iVar15 = iVar13 * 7;
        pbVar11 = pbVar11 + param_4;
        psVar14 = psVar14 + param_4;
        local_3c = iVar13;
        local_40 = iVar21;
        local_44 = iVar19;
      }
      local_48 = local_48 + 1;
      *psVar14 = (short)local_54;
      psVar14[1] = (short)local_50;
      local_24 = local_24 + -1;
      psVar14[2] = (short)local_4c;
    } while (local_24 != 0);
  }
  return;
}



void FUN_0042dbf0(void)

{
  int in_EAX;
  int iVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  
  iVar4 = *(int *)(in_EAX + 0x1a8);
  iVar1 = (***(code ***)(in_EAX + 4))();
  piVar2 = (int *)(iVar1 + 0x3fc);
  *(int **)(iVar4 + 0x28) = piVar2;
  iVar4 = 0;
  uVar3 = 0;
  iVar1 = 0;
  piVar5 = piVar2;
  do {
    piVar2[uVar3] = iVar4;
    *piVar5 = iVar1;
    uVar3 = uVar3 + 1;
    piVar5 = piVar5 + -1;
    iVar4 = iVar4 + 1;
    iVar1 = iVar1 + -1;
  } while ((int)uVar3 < 0x10);
  if ((int)uVar3 < 0x30) {
    piVar5 = piVar2 + -uVar3;
    do {
      piVar2[uVar3] = iVar4;
      *piVar5 = -iVar4;
      uVar3 = uVar3 + 1;
      piVar5 = piVar5 + -1;
      iVar4 = iVar4 + (~uVar3 & 1);
    } while ((int)uVar3 < 0x30);
  }
  if ((int)uVar3 < 0x100) {
    piVar5 = piVar2 + -uVar3;
    do {
      piVar2[uVar3] = iVar4;
      *piVar5 = -iVar4;
      uVar3 = uVar3 + 1;
      piVar5 = piVar5 + -1;
    } while ((int)uVar3 < 0x100);
  }
  return;
}



void __cdecl FUN_0042dcd0(int *param_1,char param_2)

{
  int iVar1;
  int iVar2;
  size_t _Size;
  undefined4 uVar3;
  int iVar4;
  
  iVar1 = param_1[0x6a];
  iVar2 = *(int *)(iVar1 + 0x18);
  if (param_1[0x13] != 0) {
    param_1[0x13] = 2;
  }
  if (param_2 == '\0') {
    if (param_1[0x13] == 2) {
      *(code **)(iVar1 + 4) = FUN_0042d930;
    }
    else {
      *(code **)(iVar1 + 4) = FUN_0042d860;
    }
    *(code **)(iVar1 + 8) = FUN_0041c770;
    iVar4 = param_1[0x1c];
    if (iVar4 < 1) {
      *(undefined4 *)(*param_1 + 0x14) = 0x38;
      *(undefined4 *)(*param_1 + 0x18) = 1;
      (**(code **)*param_1)(param_1);
    }
    if (0x100 < iVar4) {
      *(undefined4 *)(*param_1 + 0x14) = 0x39;
      *(undefined4 *)(*param_1 + 0x18) = 0x100;
      (**(code **)*param_1)(param_1);
    }
    if (param_1[0x13] == 2) {
      _Size = (param_1[0x17] + 2) * 6;
      if (*(int *)(iVar1 + 0x20) == 0) {
        uVar3 = (**(code **)(param_1[1] + 4))(param_1,1,_Size);
        *(undefined4 *)(iVar1 + 0x20) = uVar3;
      }
      memset(*(void **)(iVar1 + 0x20),0,_Size);
      if (*(int *)(iVar1 + 0x28) == 0) {
        FUN_0042dbf0();
      }
      *(undefined *)(iVar1 + 0x24) = 0;
    }
  }
  else {
    *(undefined **)(iVar1 + 4) = &LAB_0042cbc0;
    *(undefined **)(iVar1 + 8) = &LAB_0042dca0;
    *(undefined *)(iVar1 + 0x1c) = 1;
  }
  if (*(char *)(iVar1 + 0x1c) != '\0') {
    iVar4 = 0;
    do {
      memset(*(void **)(iVar2 + iVar4 * 4),0,0x1000);
      iVar4 = iVar4 + 1;
    } while (iVar4 < 0x20);
    *(undefined *)(iVar1 + 0x1c) = 0;
  }
  return;
}



void FUN_0042de10(void)

{
  code **ppcVar1;
  code *pcVar2;
  undefined4 uVar3;
  code *pcVar4;
  int iVar5;
  int *unaff_ESI;
  
  ppcVar1 = (code **)(**(code **)unaff_ESI[1])();
  unaff_ESI[0x6a] = (int)ppcVar1;
  *ppcVar1 = FUN_0042dcd0;
  ppcVar1[3] = (code *)&LAB_0042de00;
  ppcVar1[8] = (code *)0x0;
  ppcVar1[10] = (code *)0x0;
  if (unaff_ESI[0x19] != 3) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x2f;
    (**(code **)*unaff_ESI)();
  }
  pcVar2 = (code *)(**(code **)unaff_ESI[1])();
  ppcVar1[6] = pcVar2;
  iVar5 = 0;
  do {
    uVar3 = (**(code **)(unaff_ESI[1] + 4))();
    *(undefined4 *)(ppcVar1[6] + iVar5) = uVar3;
    iVar5 = iVar5 + 4;
  } while (iVar5 < 0x80);
  *(undefined *)(ppcVar1 + 7) = 1;
  if (*(char *)((int)unaff_ESI + 0x5a) == '\0') {
    ppcVar1[4] = (code *)0x0;
  }
  else {
    pcVar2 = (code *)unaff_ESI[0x15];
    if ((int)pcVar2 < 8) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x38;
      *(undefined4 *)(*unaff_ESI + 0x18) = 8;
      (**(code **)*unaff_ESI)();
    }
    if (0x100 < (int)pcVar2) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x39;
      *(undefined4 *)(*unaff_ESI + 0x18) = 0x100;
      (**(code **)*unaff_ESI)();
    }
    pcVar4 = (code *)(**(code **)(unaff_ESI[1] + 8))();
    ppcVar1[4] = pcVar4;
    ppcVar1[5] = pcVar2;
  }
  if (unaff_ESI[0x13] != 0) {
    unaff_ESI[0x13] = 2;
  }
  if (unaff_ESI[0x13] == 2) {
    pcVar2 = (code *)(**(code **)(unaff_ESI[1] + 4))();
    ppcVar1[8] = pcVar2;
    FUN_0042dbf0();
    return;
  }
  return;
}



void FUN_0042df50(void)

{
  int iVar1;
  int in_EAX;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iStack_4;
  
  iVar1 = *(int *)(in_EAX + 0x1a0);
  uVar2 = (***(code ***)(in_EAX + 4))();
  *(undefined4 *)(iVar1 + 0x10) = uVar2;
  uVar2 = (***(code ***)(in_EAX + 4))();
  *(undefined4 *)(iVar1 + 0x14) = uVar2;
  uVar2 = (***(code ***)(in_EAX + 4))();
  *(undefined4 *)(iVar1 + 0x18) = uVar2;
  uVar2 = (***(code ***)(in_EAX + 4))();
  *(undefined4 *)(iVar1 + 0x1c) = uVar2;
  iVar3 = 0;
  iStack_4 = 0x5b6900;
  iVar6 = -0xe25100;
  iVar5 = -0xb2f480;
  iVar4 = 0x2c8d00;
  do {
    *(int *)(iVar3 + *(int *)(iVar1 + 0x10)) = iVar5 >> 0x10;
    *(int *)(iVar3 + *(int *)(iVar1 + 0x14)) = iVar6 >> 0x10;
    *(int *)(iVar3 + *(int *)(iVar1 + 0x18)) = iStack_4;
    *(int *)(iVar3 + *(int *)(iVar1 + 0x1c)) = iVar4;
    iStack_4 = iStack_4 + -0xb6d2;
    iVar4 = iVar4 + -0x581a;
    iVar5 = iVar5 + 0x166e9;
    iVar6 = iVar6 + 0x1c5a2;
    iVar3 = iVar3 + 4;
  } while (-0x2b34e7 < iVar4);
  return;
}



void __cdecl FUN_0042e140(int param_1,int *param_2,int param_3,undefined4 *param_4)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  undefined *puVar11;
  byte *pbVar12;
  uint uVar13;
  uint uVar14;
  byte *pbVar15;
  int iVar16;
  byte *pbVar17;
  
  iVar3 = *(int *)(param_1 + 0x1a0);
  iVar4 = *(int *)(param_1 + 0x120);
  iVar5 = *(int *)(iVar3 + 0x10);
  iVar6 = *(int *)(iVar3 + 0x14);
  iVar7 = *(int *)(iVar3 + 0x18);
  iVar3 = *(int *)(iVar3 + 0x1c);
  pbVar17 = *(byte **)(*param_2 + param_3 * 4);
  pbVar15 = *(byte **)(param_2[1] + param_3 * 4);
  pbVar12 = *(byte **)(param_2[2] + param_3 * 4);
  puVar11 = (undefined *)*param_4;
  for (uVar13 = *(uint *)(param_1 + 0x5c) >> 1; uVar13 != 0; uVar13 = uVar13 - 1) {
    bVar1 = *pbVar12;
    bVar2 = *pbVar15;
    pbVar15 = pbVar15 + 1;
    pbVar12 = pbVar12 + 1;
    iVar8 = *(int *)(iVar5 + (uint)bVar1 * 4);
    iVar16 = *(int *)(iVar3 + (uint)bVar2 * 4);
    iVar9 = *(int *)(iVar7 + (uint)bVar1 * 4);
    uVar14 = (uint)*pbVar17;
    iVar10 = *(int *)(iVar6 + (uint)bVar2 * 4);
    *puVar11 = *(undefined *)(iVar8 + uVar14 + iVar4);
    iVar16 = iVar16 + iVar9 >> 0x10;
    puVar11[1] = *(undefined *)(iVar16 + uVar14 + iVar4);
    puVar11[2] = *(undefined *)(iVar4 + uVar14 + iVar10);
    uVar14 = (uint)pbVar17[1];
    puVar11[3] = *(undefined *)(iVar8 + uVar14 + iVar4);
    puVar11[4] = *(undefined *)(iVar16 + uVar14 + iVar4);
    puVar11[5] = *(undefined *)(iVar4 + uVar14 + iVar10);
    pbVar17 = pbVar17 + 2;
    puVar11 = puVar11 + 6;
  }
  if ((*(byte *)(param_1 + 0x5c) & 1) != 0) {
    iVar3 = *(int *)(iVar3 + (uint)*pbVar15 * 4);
    iVar7 = *(int *)(iVar7 + (uint)*pbVar12 * 4);
    uVar13 = (uint)*pbVar17;
    iVar6 = *(int *)(iVar6 + (uint)*pbVar15 * 4);
    *puVar11 = *(undefined *)(*(int *)(iVar5 + (uint)*pbVar12 * 4) + uVar13 + iVar4);
    puVar11[1] = *(undefined *)(uVar13 + (iVar3 + iVar7 >> 0x10) + iVar4);
    puVar11[2] = *(undefined *)(uVar13 + iVar6 + iVar4);
  }
  return;
}



void FUN_0042e4b0(void)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int unaff_EDI;
  
  puVar1 = (undefined4 *)(***(code ***)(unaff_EDI + 4))();
  *(undefined4 **)(unaff_EDI + 0x1a0) = puVar1;
  *puVar1 = &LAB_0042e020;
  *(undefined *)(puVar1 + 2) = 0;
  puVar1[10] = *(int *)(unaff_EDI + 100) * *(int *)(unaff_EDI + 0x5c);
  if (*(int *)(unaff_EDI + 0x114) == 2) {
    puVar1[1] = &LAB_0042e040;
    puVar1[3] = &LAB_0042e290;
    uVar2 = (**(code **)(*(int *)(unaff_EDI + 4) + 4))();
    puVar1[8] = uVar2;
    FUN_0042df50();
    return;
  }
  puVar1[8] = 0;
  puVar1[1] = &LAB_0042e100;
  puVar1[3] = FUN_0042e140;
  FUN_0042df50();
  return;
}



void FUN_0042e530(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int unaff_ESI;
  
  iVar1 = *(int *)(unaff_ESI + 0x118);
  iVar2 = *(int *)(unaff_ESI + 0x184);
  iVar3 = (***(code ***)(unaff_ESI + 4))();
  *(int *)(iVar2 + 0x38) = iVar3;
  *(int *)(iVar2 + 0x3c) = iVar3 + *(int *)(unaff_ESI + 0x24) * 4;
  iVar3 = 0;
  if (0 < *(int *)(unaff_ESI + 0x24)) {
    piVar6 = (int *)(*(int *)(unaff_ESI + 0xc4) + 0xc);
    do {
      iVar4 = (piVar6[6] * *piVar6) / *(int *)(unaff_ESI + 0x118);
      iVar5 = (***(code ***)(unaff_ESI + 4))();
      iVar5 = iVar5 + iVar4 * 4;
      *(int *)(*(int *)(iVar2 + 0x38) + iVar3 * 4) = iVar5;
      *(int *)(*(int *)(iVar2 + 0x3c) + iVar3 * 4) = iVar5 + (iVar1 + 4) * iVar4 * 4;
      iVar3 = iVar3 + 1;
      piVar6 = piVar6 + 0x15;
    } while (iVar3 < *(int *)(unaff_ESI + 0x24));
  }
  return;
}



void __cdecl FUN_0042e5e0(int param_1)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  int *piVar10;
  int iVar11;
  int local_20;
  int *local_1c;
  int local_14;
  
  iVar1 = *(int *)(param_1 + 0x118);
  iVar2 = *(int *)(param_1 + 0x184);
  local_20 = 0;
  if (0 < *(int *)(param_1 + 0x24)) {
    piVar10 = (int *)(*(int *)(param_1 + 0xc4) + 0xc);
    local_1c = (int *)(iVar2 + 8);
    do {
      iVar6 = (piVar10[6] * *piVar10) / *(int *)(param_1 + 0x118);
      puVar3 = *(undefined4 **)(*(int *)(iVar2 + 0x38) + local_20 * 4);
      iVar4 = *local_1c;
      puVar9 = *(undefined4 **)(*(int *)(iVar2 + 0x3c) + local_20 * 4);
      local_14 = (iVar1 + 2) * iVar6;
      if (0 < local_14) {
        puVar7 = puVar9;
        do {
          uVar5 = *(undefined4 *)((int)puVar7 + (iVar4 - (int)puVar9));
          *puVar7 = uVar5;
          *(undefined4 *)(((int)puVar3 - (int)puVar9) + (int)puVar7) = uVar5;
          puVar7 = puVar7 + 1;
          local_14 = local_14 + -1;
        } while (local_14 != 0);
      }
      if (0 < iVar6 * 2) {
        puVar7 = puVar9 + iVar6 * iVar1;
        puVar8 = (undefined4 *)(iVar4 + (iVar1 + -2) * iVar6 * 4);
        iVar11 = iVar6 * 2;
        do {
          *(undefined4 *)(((int)puVar9 - iVar4) + (int)puVar8) =
               *(undefined4 *)((int)puVar7 + (iVar4 - (int)puVar9));
          *puVar7 = *puVar8;
          puVar8 = puVar8 + 1;
          puVar7 = puVar7 + 1;
          iVar11 = iVar11 + -1;
        } while (iVar11 != 0);
      }
      if (0 < iVar6) {
        puVar9 = puVar3 + -iVar6;
        do {
          *puVar9 = *puVar3;
          puVar9 = puVar9 + 1;
          iVar6 = iVar6 + -1;
        } while (iVar6 != 0);
      }
      local_1c = local_1c + 1;
      piVar10 = piVar10 + 0x15;
      local_20 = local_20 + 1;
    } while (local_20 < *(int *)(param_1 + 0x24));
  }
  return;
}



void __cdecl FUN_0042e730(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  int *piVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  int local_10;
  
  iVar1 = *(int *)(param_1 + 0x118);
  iVar2 = *(int *)(param_1 + 0x184);
  local_10 = 0;
  if (0 < *(int *)(param_1 + 0x24)) {
    piVar7 = (int *)(*(int *)(param_1 + 0xc4) + 0xc);
    do {
      iVar3 = (piVar7[6] * *piVar7) / *(int *)(param_1 + 0x118);
      puVar9 = *(undefined4 **)(*(int *)(iVar2 + 0x3c) + local_10 * 4);
      if (0 < iVar3) {
        puVar6 = puVar9 + (iVar1 + 2) * iVar3;
        puVar5 = puVar9 + -iVar3;
        puVar8 = puVar9 + (iVar1 + 1) * iVar3;
        iVar4 = *(int *)(*(int *)(iVar2 + 0x38) + local_10 * 4) - (int)puVar9;
        do {
          *(undefined4 *)(iVar4 + (int)puVar5) = *(undefined4 *)(iVar4 + (int)puVar8);
          *puVar5 = *puVar8;
          *(undefined4 *)(iVar4 + (int)puVar6) = *(undefined4 *)(iVar4 + (int)puVar9);
          *puVar6 = *puVar9;
          puVar8 = puVar8 + 1;
          puVar5 = puVar5 + 1;
          puVar9 = puVar9 + 1;
          puVar6 = puVar6 + 1;
          iVar3 = iVar3 + -1;
        } while (iVar3 != 0);
      }
      local_10 = local_10 + 1;
      piVar7 = piVar7 + 0x15;
    } while (local_10 < *(int *)(param_1 + 0x24));
  }
  return;
}



void __cdecl FUN_0042e810(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  undefined4 *puVar4;
  uint uVar5;
  int *piVar6;
  int iVar7;
  uint uVar8;
  
  iVar2 = *(int *)(param_1 + 0x184);
  iVar7 = 0;
  if (0 < *(int *)(param_1 + 0x24)) {
    piVar6 = (int *)(*(int *)(param_1 + 0xc4) + 0xc);
    do {
      uVar5 = piVar6[6] * *piVar6;
      iVar3 = (int)uVar5 / *(int *)(param_1 + 0x118);
      uVar8 = (uint)piVar6[8] % uVar5;
      if ((uint)piVar6[8] % uVar5 == 0) {
        uVar8 = uVar5;
      }
      if (iVar7 == 0) {
        *(int *)(iVar2 + 0x48) = (int)(uVar8 - 1) / iVar3 + 1;
      }
      iVar3 = iVar3 * 2;
      if (0 < iVar3) {
        puVar1 = (undefined4 *)
                 (*(int *)(*(int *)(iVar2 + 0x38 + *(int *)(iVar2 + 0x40) * 4) + iVar7 * 4) +
                 uVar8 * 4);
        puVar4 = puVar1;
        do {
          *puVar4 = puVar1[-1];
          puVar4 = puVar4 + 1;
          iVar3 = iVar3 + -1;
        } while (iVar3 != 0);
      }
      iVar7 = iVar7 + 1;
      piVar6 = piVar6 + 0x15;
    } while (iVar7 < *(int *)(param_1 + 0x24));
  }
  return;
}



void FUN_0042eb20(void)

{
  int *in_EAX;
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  
  puVar1 = (undefined4 *)(**(code **)in_EAX[1])();
  in_EAX[0x61] = (int)puVar1;
  *puVar1 = &LAB_0042e8c0;
  if (*(char *)(in_EAX[0x68] + 8) != '\0') {
    if (in_EAX[0x46] < 2) {
      *(undefined4 *)(*in_EAX + 0x14) = 0x2f;
      (**(code **)*in_EAX)();
    }
    FUN_0042e530();
  }
  iVar3 = 0;
  if (0 < in_EAX[9]) {
    puVar1 = puVar1 + 2;
    do {
      uVar2 = (**(code **)(in_EAX[1] + 8))();
      *puVar1 = uVar2;
      iVar3 = iVar3 + 1;
      puVar1 = puVar1 + 1;
    } while (iVar3 < in_EAX[9]);
  }
  return;
}



void __cdecl
FUN_0042ed60(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5
            ,int *param_6)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  
  iVar2 = *(int *)(param_1 + 0x18c);
  puVar1 = (uint *)(iVar2 + 0x18);
  if (*(int *)(iVar2 + 0x18) == 0) {
    uVar4 = (**(code **)(*(int *)(param_1 + 4) + 0x1c))
                      (param_1,*(undefined4 *)(iVar2 + 8),*(undefined4 *)(iVar2 + 0x14),
                       *(undefined4 *)(iVar2 + 0x10),1);
    *(undefined4 *)(iVar2 + 0xc) = uVar4;
  }
  uVar3 = *puVar1;
  (**(code **)(*(int *)(param_1 + 0x1a0) + 4))
            (param_1,param_2,param_3,param_4,*(undefined4 *)(iVar2 + 0xc),puVar1,
             *(undefined4 *)(iVar2 + 0x10));
  if (uVar3 < *puVar1) {
    iVar5 = *puVar1 - uVar3;
    (**(code **)(*(int *)(param_1 + 0x1a8) + 4))(param_1,*(int *)(iVar2 + 0xc) + uVar3 * 4,0,iVar5);
    *param_6 = *param_6 + iVar5;
  }
  if (*(uint *)(iVar2 + 0x10) <= *puVar1) {
    *(int *)(iVar2 + 0x14) = *(int *)(iVar2 + 0x14) + *(uint *)(iVar2 + 0x10);
    *puVar1 = 0;
  }
  return;
}



void __cdecl FUN_0042ee10(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  uint uVar4;
  int in_stack_00000014;
  int *in_stack_00000018;
  int in_stack_0000001c;
  
  iVar1 = *(int *)(param_1 + 0x18c);
  if (*(int *)(iVar1 + 0x18) == 0) {
    uVar2 = (**(code **)(*(int *)(param_1 + 4) + 0x1c))
                      (param_1,*(undefined4 *)(iVar1 + 8),*(undefined4 *)(iVar1 + 0x14),
                       *(undefined4 *)(iVar1 + 0x10),0);
    *(undefined4 *)(iVar1 + 0xc) = uVar2;
  }
  uVar4 = *(int *)(iVar1 + 0x10) - *(int *)(iVar1 + 0x18);
  uVar3 = in_stack_0000001c - *in_stack_00000018;
  if (uVar3 < uVar4) {
    uVar4 = uVar3;
  }
  uVar3 = *(int *)(param_1 + 0x60) - *(int *)(iVar1 + 0x14);
  if (uVar3 < uVar4) {
    uVar4 = uVar3;
  }
  (**(code **)(*(int *)(param_1 + 0x1a8) + 4))
            (param_1,*(int *)(iVar1 + 0xc) + *(int *)(iVar1 + 0x18) * 4,
             in_stack_00000014 + *in_stack_00000018 * 4,uVar4);
  *in_stack_00000018 = *in_stack_00000018 + uVar4;
  *(int *)(iVar1 + 0x18) = *(int *)(iVar1 + 0x18) + uVar4;
  if (*(uint *)(iVar1 + 0x10) <= *(uint *)(iVar1 + 0x18)) {
    *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + *(uint *)(iVar1 + 0x10);
    *(undefined4 *)(iVar1 + 0x18) = 0;
  }
  return;
}



void __cdecl FUN_0042eeb0(char param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int unaff_ESI;
  
  puVar1 = (undefined4 *)(***(code ***)(unaff_ESI + 4))();
  *(undefined4 **)(unaff_ESI + 0x18c) = puVar1;
  *puVar1 = &LAB_0042ebe0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  if (*(char *)(unaff_ESI + 0x4a) != '\0') {
    puVar1[4] = *(undefined4 *)(unaff_ESI + 0x114);
    if (param_1 != '\0') {
      uVar2 = (**(code **)(*(int *)(unaff_ESI + 4) + 0x10))();
      puVar1[2] = uVar2;
      return;
    }
    uVar2 = (**(code **)(*(int *)(unaff_ESI + 4) + 8))();
    puVar1[3] = uVar2;
  }
  return;
}



void __cdecl FUN_0042ef40(int param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iStack_8;
  int iStack_4;
  
  iVar3 = *(int *)(param_1 + 0x150);
  iVar1 = (***(code ***)(param_1 + 4))(param_1,1,0x2000);
  iVar4 = 0;
  *(int *)(iVar3 + 8) = iVar1;
  iVar5 = 0;
  iVar7 = 0;
  iVar6 = 0;
  iStack_4 = 0;
  iStack_8 = 0;
  param_1 = 0x807fff;
  iVar3 = 0x8000;
  piVar2 = (int *)(iVar1 + 0x800);
  do {
    piVar2[0x300] = param_1;
    piVar2[0x400] = iStack_8;
    *piVar2 = iVar3;
    piVar2[-0x200] = iVar4;
    piVar2[-0x100] = iVar6;
    piVar2[0x100] = iVar7;
    piVar2[0x200] = iVar5;
    piVar2[0x500] = iStack_4;
    iVar3 = iVar3 + 0x1d2f;
    iVar4 = iVar4 + 0x4c8b;
    piVar2 = piVar2 + 1;
    iVar6 = iVar6 + 0x9646;
    iVar7 = iVar7 + -0x2b33;
    iVar5 = iVar5 + -0x54cd;
    param_1 = param_1 + 0x8000;
    iStack_8 = iStack_8 + -0x6b2f;
    iStack_4 = iStack_4 + -0x14d1;
  } while (iVar3 < 0x1d91d2);
  return;
}



void __cdecl FUN_0042f020(int param_1,byte **param_2,int *param_3,int param_4,int param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined *puVar5;
  undefined *puVar6;
  undefined *puVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  byte *pbVar11;
  uint uVar12;
  
  param_5 = param_5 + -1;
  iVar1 = *(int *)(param_1 + 0x1c);
  iVar2 = *(int *)(*(int *)(param_1 + 0x150) + 8);
  if (-1 < param_5) {
    iVar8 = param_4 * 4;
    do {
      pbVar11 = *param_2;
      iVar3 = *(int *)(iVar8 + param_3[2]);
      param_2 = param_2 + 1;
      iVar4 = *(int *)(iVar8 + *param_3);
      puVar5 = *(undefined **)(iVar8 + param_3[1]);
      iVar8 = iVar8 + 4;
      if (iVar1 != 0) {
        puVar6 = puVar5;
        param_1 = iVar1;
        do {
          uVar9 = (uint)pbVar11[2];
          uVar10 = (uint)pbVar11[1];
          uVar12 = (uint)*pbVar11;
          pbVar11 = pbVar11 + 3;
          puVar7 = puVar6 + 1;
          puVar7[(iVar4 - (int)puVar5) + -1] =
               (char)((uint)(*(int *)(iVar2 + 0x800 + uVar9 * 4) +
                             *(int *)(iVar2 + 0x400 + uVar10 * 4) + *(int *)(iVar2 + uVar12 * 4)) >>
                     0x10);
          *puVar6 = (char)((uint)(*(int *)(iVar2 + 0x1400 + uVar9 * 4) +
                                  *(int *)(iVar2 + 0x1000 + uVar10 * 4) +
                                 *(int *)(iVar2 + 0xc00 + uVar12 * 4)) >> 0x10);
          param_1 = param_1 + -1;
          puVar7[(iVar3 - (int)puVar5) + -1] =
               (char)((uint)(*(int *)(iVar2 + 0x1c00 + uVar9 * 4) +
                             *(int *)(iVar2 + 0x1800 + uVar10 * 4) +
                            *(int *)(iVar2 + 0x1400 + uVar12 * 4)) >> 0x10);
          puVar6 = puVar7;
        } while (param_1 != 0);
      }
      param_5 = param_5 + -1;
    } while (-1 < param_5);
  }
  return;
}



void __cdecl FUN_0042f140(int param_1,byte **param_2,int *param_3,int param_4,int param_5)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  param_5 = param_5 + -1;
  uVar1 = *(uint *)(param_1 + 0x1c);
  iVar2 = *(int *)(*(int *)(param_1 + 0x150) + 8);
  if (-1 < param_5) {
    iVar7 = param_4 * 4;
    do {
      pbVar4 = *param_2;
      param_2 = param_2 + 1;
      iVar3 = *(int *)(iVar7 + *param_3);
      iVar7 = iVar7 + 4;
      uVar5 = 0;
      if (uVar1 != 0) {
        do {
          uVar6 = uVar5 + 1;
          *(char *)(uVar5 + iVar3) =
               (char)((uint)(*(int *)(iVar2 + 0x800 + (uint)pbVar4[2] * 4) +
                             *(int *)(iVar2 + 0x400 + (uint)pbVar4[1] * 4) +
                            *(int *)(iVar2 + (uint)*pbVar4 * 4)) >> 0x10);
          pbVar4 = pbVar4 + 3;
          uVar5 = uVar6;
        } while (uVar6 < uVar1);
      }
      param_5 = param_5 + -1;
    } while (-1 < param_5);
  }
  return;
}



void __cdecl FUN_0042f1f0(int param_1,byte **param_2,int *param_3,int param_4,int param_5)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  byte *pbVar10;
  undefined *puVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int local_18;
  
  param_5 = param_5 + -1;
  iVar4 = *(int *)(param_1 + 0x1c);
  iVar5 = *(int *)(*(int *)(param_1 + 0x150) + 8);
  if (-1 < param_5) {
    iVar6 = param_4 * 4;
    do {
      pbVar10 = *param_2;
      piVar1 = (int *)(iVar6 + param_3[2]);
      param_2 = param_2 + 1;
      puVar11 = *(undefined **)(iVar6 + *param_3);
      piVar2 = (int *)(iVar6 + param_3[1]);
      piVar3 = (int *)(iVar6 + param_3[3]);
      iVar6 = iVar6 + 4;
      if (iVar4 != 0) {
        iVar7 = *piVar3 - (int)puVar11;
        iVar13 = *piVar2 - (int)puVar11;
        iVar8 = *piVar1 - (int)puVar11;
        local_18 = iVar4;
        do {
          iVar9 = 0xff - (uint)*pbVar10;
          iVar12 = 0xff - (uint)pbVar10[1];
          iVar14 = 0xff - (uint)pbVar10[2];
          puVar11[iVar7] = pbVar10[3];
          pbVar10 = pbVar10 + 4;
          *puVar11 = (char)((uint)(*(int *)(iVar5 + 0x800 + iVar14 * 4) +
                                   *(int *)(iVar5 + 0x400 + iVar12 * 4) +
                                  *(int *)(iVar5 + iVar9 * 4)) >> 0x10);
          puVar11 = puVar11 + 1;
          puVar11[iVar13 + -1] =
               (char)((uint)(*(int *)(iVar5 + 0x1400 + iVar14 * 4) +
                             *(int *)(iVar5 + 0x1000 + iVar12 * 4) +
                            *(int *)(iVar5 + 0xc00 + iVar9 * 4)) >> 0x10);
          local_18 = local_18 + -1;
          puVar11[iVar8 + -1] =
               (char)((uint)(*(int *)(iVar5 + 0x1c00 + iVar14 * 4) +
                             *(int *)(iVar5 + 0x1800 + iVar12 * 4) +
                            *(int *)(iVar5 + 0x1400 + iVar9 * 4)) >> 0x10);
        } while (local_18 != 0);
      }
      param_5 = param_5 + -1;
    } while (-1 < param_5);
  }
  return;
}



void FUN_0042f420(void)

{
  int iVar1;
  code **ppcVar2;
  int *unaff_ESI;
  
  ppcVar2 = (code **)(**(code **)unaff_ESI[1])();
  unaff_ESI[0x54] = (int)ppcVar2;
  *ppcVar2 = FUN_0041c770;
  switch(unaff_ESI[10]) {
  case 1:
    if (unaff_ESI[9] != 1) {
LAB_0042f472:
      *(undefined4 *)(*unaff_ESI + 0x14) = 9;
      (**(code **)*unaff_ESI)();
    }
    break;
  case 2:
  case 3:
    if (unaff_ESI[9] != 3) goto LAB_0042f472;
    break;
  case 4:
  case 5:
    if (unaff_ESI[9] != 4) goto LAB_0042f472;
    break;
  default:
    if (unaff_ESI[9] < 1) goto LAB_0042f472;
  }
  switch(unaff_ESI[0x10]) {
  case 1:
    if (unaff_ESI[0xf] != 1) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 10;
      (**(code **)*unaff_ESI)();
    }
    iVar1 = unaff_ESI[10];
    if (iVar1 != 1) {
      if (iVar1 == 2) {
        *ppcVar2 = FUN_0042ef40;
        ppcVar2[1] = FUN_0042f140;
        return;
      }
      if (iVar1 != 3) goto LAB_0042f502;
    }
    ppcVar2[1] = (code *)&LAB_0042f340;
    return;
  case 2:
    if (unaff_ESI[0xf] != 3) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 10;
      (**(code **)*unaff_ESI)();
    }
    if (unaff_ESI[10] != 2) {
LAB_0042f502:
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x1b;
      (**(code **)*unaff_ESI)();
      return;
    }
    break;
  case 3:
    if (unaff_ESI[0xf] != 3) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 10;
      (**(code **)*unaff_ESI)();
    }
    if (unaff_ESI[10] == 2) {
      *ppcVar2 = FUN_0042ef40;
      ppcVar2[1] = FUN_0042f020;
      return;
    }
    if (unaff_ESI[10] != 3) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x1b;
      (**(code **)*unaff_ESI)();
      return;
    }
    break;
  case 4:
    if (unaff_ESI[0xf] != 4) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 10;
      (**(code **)*unaff_ESI)();
    }
    if (unaff_ESI[10] != 4) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x1b;
      (**(code **)*unaff_ESI)();
      return;
    }
    break;
  case 5:
    if (unaff_ESI[0xf] != 4) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 10;
      (**(code **)*unaff_ESI)();
    }
    if (unaff_ESI[10] == 4) {
      *ppcVar2 = FUN_0042ef40;
      ppcVar2[1] = FUN_0042f1f0;
      return;
    }
    if (unaff_ESI[10] != 5) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x1b;
      (**(code **)*unaff_ESI)();
      return;
    }
    break;
  default:
    if ((unaff_ESI[0x10] != unaff_ESI[10]) || (unaff_ESI[0xf] != unaff_ESI[9])) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x1b;
      (**(code **)*unaff_ESI)();
    }
  }
  ppcVar2[1] = (code *)&LAB_0042f3a0;
  return;
}



void FUN_0042f740(void)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  int unaff_ESI;
  
  puVar1 = (undefined4 *)(***(code ***)(unaff_ESI + 4))();
  *(undefined4 **)(unaff_ESI + 0x140) = puVar1;
  *puVar1 = &LAB_0042f640;
  if ((*(char *)(unaff_ESI + 0xb0) == '\0') && (iVar3 = 0, 0 < *(int *)(unaff_ESI + 0x3c))) {
    puVar1 = puVar1 + 6;
    do {
      uVar2 = (**(code **)(*(int *)(unaff_ESI + 4) + 8))();
      *puVar1 = uVar2;
      iVar3 = iVar3 + 1;
      puVar1 = puVar1 + 1;
    } while (iVar3 < *(int *)(unaff_ESI + 0x3c));
  }
  return;
}



void FUN_0042f7b0(void)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  int *unaff_ESI;
  int *piVar5;
  
  if ((((unaff_ESI[8] == 0) || (unaff_ESI[7] == 0)) || (unaff_ESI[0xf] < 1)) || (unaff_ESI[9] < 1))
  {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x20;
    (**(code **)*unaff_ESI)();
  }
  if ((0xffdc < unaff_ESI[8]) || (0xffdc < unaff_ESI[7])) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x29;
    *(undefined4 *)(*unaff_ESI + 0x18) = 0xffdc;
    (**(code **)*unaff_ESI)();
  }
  if (unaff_ESI[0xe] != 8) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0xf;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[0xe];
    (**(code **)*unaff_ESI)();
  }
  if (10 < unaff_ESI[0xf]) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x1a;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[0xf];
    *(undefined4 *)(*unaff_ESI + 0x1c) = 10;
    (**(code **)*unaff_ESI)();
  }
  iVar4 = 0;
  unaff_ESI[0x36] = 1;
  unaff_ESI[0x37] = 1;
  if (0 < unaff_ESI[0xf]) {
    piVar5 = (int *)(unaff_ESI[0x11] + 0xc);
    do {
      if (((piVar5[-1] < 1) || (4 < piVar5[-1])) || ((*piVar5 < 1 || (4 < *piVar5)))) {
        *(undefined4 *)(*unaff_ESI + 0x14) = 0x12;
        (**(code **)*unaff_ESI)();
      }
      iVar2 = unaff_ESI[0x36];
      if (unaff_ESI[0x36] <= piVar5[-1]) {
        iVar2 = piVar5[-1];
      }
      unaff_ESI[0x36] = iVar2;
      iVar2 = unaff_ESI[0x37];
      if (unaff_ESI[0x37] <= *piVar5) {
        iVar2 = *piVar5;
      }
      iVar4 = iVar4 + 1;
      unaff_ESI[0x37] = iVar2;
      piVar5 = piVar5 + 0x15;
    } while (iVar4 < unaff_ESI[0xf]);
  }
  iVar4 = 0;
  if (0 < unaff_ESI[0xf]) {
    puVar3 = (undefined4 *)(unaff_ESI[0x11] + 0x24);
    do {
      puVar3[-8] = iVar4;
      *puVar3 = 8;
      iVar4 = iVar4 + 1;
      puVar3[-2] = (unaff_ESI[7] * puVar3[-7] + -1 + unaff_ESI[0x36] * 8) / (unaff_ESI[0x36] * 8);
      puVar3[-1] = (unaff_ESI[8] * puVar3[-6] + -1 + unaff_ESI[0x37] * 8) / (unaff_ESI[0x37] * 8);
      puVar3[1] = (unaff_ESI[7] * puVar3[-7] + -1 + unaff_ESI[0x36]) / unaff_ESI[0x36];
      iVar2 = unaff_ESI[8];
      iVar1 = unaff_ESI[0x37];
      *(undefined *)(puVar3 + 3) = 1;
      puVar3[2] = (iVar2 * puVar3[-6] + -1 + iVar1) / iVar1;
      puVar3 = puVar3 + 0x15;
    } while (iVar4 < unaff_ESI[0xf]);
  }
  unaff_ESI[0x38] = (unaff_ESI[0x37] * 8 + -1 + unaff_ESI[8]) / (unaff_ESI[0x37] * 8);
  return;
}



void FUN_0042f990(void)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  uint *puVar4;
  int *unaff_ESI;
  int iVar5;
  uint uVar6;
  int iStack_a38;
  int *piStack_a34;
  int *local_a30;
  int *piStack_a2c;
  int iStack_a28;
  uint uStack_a24;
  uint uStack_a20;
  uint uStack_a1c;
  uint auStack_a18 [640];
  char acStack_18 [12];
  uint local_c;
  
  local_c = DAT_0044a01c ^ (uint)&iStack_a38;
  if (unaff_ESI[0x2a] < 1) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x13;
    *(undefined4 *)(*unaff_ESI + 0x18) = 0;
    (**(code **)*unaff_ESI)();
  }
  piVar2 = (int *)unaff_ESI[0x2b];
  local_a30 = piVar2;
  if ((piVar2[5] == 0) && (piVar2[6] == 0x3f)) {
    *(undefined *)(unaff_ESI + 0x35) = 0;
    if (0 < unaff_ESI[0xf]) {
      memset(acStack_18,0,unaff_ESI[0xf]);
    }
  }
  else {
    *(undefined *)(unaff_ESI + 0x35) = 1;
    if (0 < unaff_ESI[0xf]) {
      puVar4 = auStack_a18;
      for (iVar5 = (unaff_ESI[0xf] & 0xffffffU) << 6; iVar5 != 0; iVar5 = iVar5 + -1) {
        *puVar4 = 0xffffffff;
        puVar4 = puVar4 + 1;
      }
    }
  }
  iStack_a38 = 1;
  if (0 < unaff_ESI[0x2a]) {
    do {
      piStack_a34 = (int *)*piVar2;
      if (((int)piStack_a34 < 1) || (4 < (int)piStack_a34)) {
        *(undefined4 *)(*unaff_ESI + 0x14) = 0x1a;
        *(int **)(*unaff_ESI + 0x18) = piStack_a34;
        *(undefined4 *)(*unaff_ESI + 0x1c) = 4;
        (**(code **)*unaff_ESI)();
      }
      iVar5 = 0;
      if (0 < (int)piStack_a34) {
        do {
          iVar1 = piVar2[iVar5 + 1];
          if ((iVar1 < 0) || (unaff_ESI[0xf] <= iVar1)) {
            *(undefined4 *)(*unaff_ESI + 0x14) = 0x13;
            *(int *)(*unaff_ESI + 0x18) = iStack_a38;
            (**(code **)*unaff_ESI)();
          }
          if ((0 < iVar5) && (iVar1 <= local_a30[iVar5])) {
            *(undefined4 *)(*unaff_ESI + 0x14) = 0x13;
            *(int *)(*unaff_ESI + 0x18) = iStack_a38;
            (**(code **)*unaff_ESI)();
          }
          iVar5 = iVar5 + 1;
          piVar2 = local_a30;
        } while (iVar5 < (int)piStack_a34);
      }
      uVar6 = piVar2[5];
      iStack_a28 = piVar2[6];
      uStack_a20 = piVar2[7];
      uStack_a1c = piVar2[8];
      piVar3 = piVar2;
      uStack_a24 = uVar6;
      if (*(char *)(unaff_ESI + 0x35) == '\0') {
        if ((((uVar6 != 0) || (iStack_a28 != 0x3f)) || (uStack_a20 != 0)) || (uStack_a1c != 0)) {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x11;
          *(int *)(*unaff_ESI + 0x18) = iStack_a38;
          (**(code **)*unaff_ESI)();
        }
        if (0 < (int)piStack_a34) {
          piStack_a2c = piStack_a34;
          do {
            piVar2 = piVar2 + 1;
            iVar5 = *piVar2;
            if (acStack_18[iVar5] != '\0') {
              *(undefined4 *)(*unaff_ESI + 0x14) = 0x13;
              *(int *)(*unaff_ESI + 0x18) = iStack_a38;
              (**(code **)*unaff_ESI)();
            }
            piStack_a2c = (int *)((int)piStack_a2c + -1);
            acStack_18[iVar5] = '\x01';
            piVar3 = local_a30;
          } while (piStack_a2c != (int *)0x0);
        }
      }
      else {
        if ((((0x3f < uVar6) || (iStack_a28 < (int)uVar6)) ||
            ((0x3f < iStack_a28 || ((10 < uStack_a20 || ((int)uStack_a1c < 0)))))) ||
           (10 < (int)uStack_a1c)) {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x11;
          *(int *)(*unaff_ESI + 0x18) = iStack_a38;
          (**(code **)*unaff_ESI)();
        }
        if (uVar6 == 0) {
          if (iStack_a28 != 0) {
            *(undefined4 *)(*unaff_ESI + 0x14) = 0x11;
            *(int *)(*unaff_ESI + 0x18) = iStack_a38;
            (**(code **)*unaff_ESI)();
          }
        }
        else if (piStack_a34 != (int *)0x1) {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x11;
          *(int *)(*unaff_ESI + 0x18) = iStack_a38;
          (**(code **)*unaff_ESI)();
        }
        if (0 < (int)piStack_a34) {
          piVar2 = piVar2 + 1;
          piStack_a2c = piStack_a34;
          do {
            puVar4 = auStack_a18 + *piVar2 * 0x40;
            piStack_a34 = piVar2;
            if ((uVar6 != 0) && ((int)*puVar4 < 0)) {
              *(undefined4 *)(*unaff_ESI + 0x14) = 0x11;
              *(int *)(*unaff_ESI + 0x18) = iStack_a38;
              (**(code **)*unaff_ESI)();
            }
            if ((int)uStack_a24 <= iStack_a28) {
              do {
                if ((int)puVar4[uVar6] < 0) {
                  if (uStack_a20 != 0) {
                    *(undefined4 *)(*unaff_ESI + 0x14) = 0x11;
                    *(int *)(*unaff_ESI + 0x18) = iStack_a38;
                    (**(code **)*unaff_ESI)();
                  }
                }
                else if ((uStack_a20 != puVar4[uVar6]) || (uStack_a1c != uStack_a20 - 1)) {
                  *(undefined4 *)(*unaff_ESI + 0x14) = 0x11;
                  *(int *)(*unaff_ESI + 0x18) = iStack_a38;
                  (**(code **)*unaff_ESI)();
                }
                puVar4[uVar6] = uStack_a1c;
                uVar6 = uVar6 + 1;
              } while ((int)uVar6 <= iStack_a28);
            }
            piVar2 = piStack_a34 + 1;
            piStack_a2c = (int *)((int)piStack_a2c + -1);
            uVar6 = uStack_a24;
          } while (piStack_a2c != (int *)0x0);
          piStack_a2c = (int *)0x0;
          piVar3 = local_a30;
          piStack_a34 = piVar2;
        }
      }
      iStack_a38 = iStack_a38 + 1;
      piVar2 = piVar3 + 9;
      local_a30 = piVar2;
    } while (iStack_a38 <= unaff_ESI[0x2a]);
  }
  iVar5 = 0;
  if (*(char *)(unaff_ESI + 0x35) == '\0') {
    if (0 < unaff_ESI[0xf]) {
      do {
        if (acStack_18[iVar5] == '\0') {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x2d;
          (**(code **)*unaff_ESI)();
        }
        iVar5 = iVar5 + 1;
      } while (iVar5 < unaff_ESI[0xf]);
    }
  }
  else if (0 < unaff_ESI[0xf]) {
    puVar4 = auStack_a18;
    do {
      if ((int)*puVar4 < 0) {
        *(undefined4 *)(*unaff_ESI + 0x14) = 0x2d;
        (**(code **)*unaff_ESI)();
      }
      iVar5 = iVar5 + 1;
      puVar4 = puVar4 + 0x40;
    } while (iVar5 < unaff_ESI[0xf]);
    ___security_check_cookie_4(local_c ^ (uint)&iStack_a38);
    return;
  }
  ___security_check_cookie_4(local_c ^ (uint)&iStack_a38);
  return;
}



void FUN_0042fd90(void)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *unaff_ESI;
  int *piVar5;
  
  if (unaff_ESI[0x2b] != 0) {
    piVar1 = (int *)(unaff_ESI[0x2b] + *(int *)(unaff_ESI[0x4f] + 0x1c) * 0x24);
    unaff_ESI[0x39] = *piVar1;
    iVar2 = 0;
    if (0 < *piVar1) {
      piVar5 = unaff_ESI + 0x3a;
      piVar4 = piVar1;
      do {
        piVar4 = piVar4 + 1;
        iVar2 = iVar2 + 1;
        *piVar5 = *piVar4 * 0x54 + unaff_ESI[0x11];
        piVar5 = piVar5 + 1;
      } while (iVar2 < *piVar1);
    }
    unaff_ESI[0x4b] = piVar1[5];
    unaff_ESI[0x4c] = piVar1[6];
    unaff_ESI[0x4d] = piVar1[7];
    unaff_ESI[0x4e] = piVar1[8];
    return;
  }
  if (4 < unaff_ESI[0xf]) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x1a;
    *(int *)(*unaff_ESI + 0x18) = unaff_ESI[0xf];
    *(undefined4 *)(*unaff_ESI + 0x1c) = 4;
    (**(code **)*unaff_ESI)();
  }
  iVar2 = 0;
  unaff_ESI[0x39] = unaff_ESI[0xf];
  if (0 < unaff_ESI[0xf]) {
    iVar3 = 0;
    piVar1 = unaff_ESI + 0x3a;
    do {
      *piVar1 = unaff_ESI[0x11] + iVar3;
      iVar2 = iVar2 + 1;
      piVar1 = piVar1 + 1;
      iVar3 = iVar3 + 0x54;
    } while (iVar2 < unaff_ESI[0xf]);
  }
  unaff_ESI[0x4b] = 0;
  unaff_ESI[0x4d] = 0;
  unaff_ESI[0x4e] = 0;
  unaff_ESI[0x4c] = 0x3f;
  return;
}



uint FUN_0042fe80(void)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int *unaff_ESI;
  uint local_8;
  int *piStack_4;
  
  iVar1 = unaff_ESI[0x39];
  if (iVar1 == 1) {
    iVar1 = unaff_ESI[0x3a];
    unaff_ESI[0x3e] = *(int *)(iVar1 + 0x1c);
    unaff_ESI[0x3f] = *(int *)(iVar1 + 0x20);
    uVar2 = *(uint *)(iVar1 + 0xc);
    uVar3 = *(uint *)(iVar1 + 0x20) / uVar2;
    uVar4 = *(uint *)(iVar1 + 0x20) % uVar2;
    *(undefined4 *)(iVar1 + 0x34) = 1;
    *(undefined4 *)(iVar1 + 0x38) = 1;
    *(undefined4 *)(iVar1 + 0x3c) = 1;
    *(undefined4 *)(iVar1 + 0x40) = 8;
    *(undefined4 *)(iVar1 + 0x44) = 1;
    if (uVar4 == 0) {
      uVar4 = uVar2;
    }
    *(uint *)(iVar1 + 0x48) = uVar4;
    unaff_ESI[0x40] = 1;
    unaff_ESI[0x41] = 0;
  }
  else {
    if ((iVar1 < 1) || (4 < iVar1)) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x1a;
      *(int *)(*unaff_ESI + 0x18) = unaff_ESI[0x39];
      *(undefined4 *)(*unaff_ESI + 0x1c) = 4;
      (**(code **)*unaff_ESI)();
    }
    unaff_ESI[0x40] = 0;
    local_8 = 0;
    unaff_ESI[0x3e] = (unaff_ESI[7] + -1 + unaff_ESI[0x36] * 8) / (unaff_ESI[0x36] * 8);
    uVar3 = (unaff_ESI[8] + -1 + unaff_ESI[0x37] * 8) / (unaff_ESI[0x37] * 8);
    unaff_ESI[0x3f] = uVar3;
    if (0 < unaff_ESI[0x39]) {
      piStack_4 = unaff_ESI + 0x3a;
      do {
        iVar1 = *piStack_4;
        uVar3 = *(uint *)(iVar1 + 8);
        uVar2 = *(uint *)(iVar1 + 0xc);
        *(uint *)(iVar1 + 0x40) = uVar3 * 8;
        uVar4 = *(uint *)(iVar1 + 0x1c) % uVar3;
        iVar5 = uVar2 * uVar3;
        *(uint *)(iVar1 + 0x34) = uVar3;
        *(uint *)(iVar1 + 0x38) = uVar2;
        *(int *)(iVar1 + 0x3c) = iVar5;
        if (uVar4 == 0) {
          uVar4 = uVar3;
        }
        *(uint *)(iVar1 + 0x44) = uVar4;
        uVar3 = *(uint *)(iVar1 + 0x20) % uVar2;
        if (uVar3 == 0) {
          uVar3 = uVar2;
        }
        *(uint *)(iVar1 + 0x48) = uVar3;
        if (10 < unaff_ESI[0x40] + iVar5) {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0xd;
          (**(code **)*unaff_ESI)();
        }
        for (; 0 < iVar5; iVar5 = iVar5 + -1) {
          unaff_ESI[unaff_ESI[0x40] + 0x41] = local_8;
          unaff_ESI[0x40] = unaff_ESI[0x40] + 1;
        }
        piStack_4 = piStack_4 + 1;
        uVar3 = local_8 + 1;
        local_8 = uVar3;
      } while ((int)uVar3 < unaff_ESI[0x39]);
    }
  }
  if (0 < unaff_ESI[0x30]) {
    uVar3 = unaff_ESI[0x3e] * unaff_ESI[0x30];
    if (0xfffe < (int)uVar3) {
      uVar3 = 0xffff;
    }
    unaff_ESI[0x2f] = uVar3;
  }
  return uVar3;
}



void __cdecl FUN_00430050(int *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = param_1[0x4f];
  iVar2 = *(int *)(iVar1 + 0x10);
  if (iVar2 == 0) {
    FUN_0042fd90();
    FUN_0042fe80();
    if (*(char *)(param_1 + 0x2c) == '\0') {
      (**(code **)param_1[0x54])(param_1);
      (**(code **)param_1[0x55])(param_1);
      (**(code **)param_1[0x51])(param_1,0);
    }
    (**(code **)param_1[0x56])(param_1);
    (**(code **)param_1[0x57])(param_1,*(undefined *)((int)param_1 + 0xb2));
    (**(code **)param_1[0x52])(param_1,(*(int *)(iVar1 + 0x18) < 2) - 1U & 3);
    (**(code **)param_1[0x50])(param_1,0);
    *(bool *)(iVar1 + 0xc) = *(char *)((int)param_1 + 0xb2) == '\0';
  }
  else {
    if (iVar2 == 1) {
      FUN_0042fd90();
      FUN_0042fe80();
      if (((param_1[0x4b] != 0) || (param_1[0x4d] == 0)) || (*(char *)((int)param_1 + 0xb1) != '\0')
         ) {
        (**(code **)param_1[0x57])(param_1,1);
        (**(code **)param_1[0x52])(param_1,2);
        *(undefined *)(iVar1 + 0xc) = 0;
        goto LAB_004301cc;
      }
      *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
      *(undefined4 *)(iVar1 + 0x10) = 2;
    }
    else if (iVar2 != 2) {
      *(undefined4 *)(*param_1 + 0x14) = 0x30;
      (**(code **)*param_1)(param_1);
      goto LAB_004301cc;
    }
    if (*(char *)((int)param_1 + 0xb2) == '\0') {
      FUN_0042fd90();
      FUN_0042fe80();
    }
    (**(code **)param_1[0x57])(param_1,0);
    (**(code **)param_1[0x52])(param_1,2);
    if (*(int *)(iVar1 + 0x1c) == 0) {
      (**(code **)(param_1[0x53] + 4))(param_1);
    }
    (**(code **)(param_1[0x53] + 8))(param_1);
    *(undefined *)(iVar1 + 0xc) = 0;
  }
LAB_004301cc:
  *(bool *)(iVar1 + 0xd) = *(int *)(iVar1 + 0x14) == *(int *)(iVar1 + 0x18) + -1;
  if (param_1[2] != 0) {
    *(int *)(param_1[2] + 0xc) = *(int *)(iVar1 + 0x14);
    *(undefined4 *)(param_1[2] + 0x10) = *(undefined4 *)(iVar1 + 0x18);
  }
  return;
}



void __cdecl FUN_00430200(int param_1)

{
  *(undefined *)(*(int *)(param_1 + 0x13c) + 0xc) = 0;
  (**(code **)(*(int *)(param_1 + 0x14c) + 4))(param_1);
  (**(code **)(*(int *)(param_1 + 0x14c) + 8))(param_1);
  return;
}



void FUN_004302a0(void)

{
  int in_EAX;
  code **ppcVar1;
  
  ppcVar1 = (code **)(***(code ***)(in_EAX + 4))();
  *(code ***)(in_EAX + 0x13c) = ppcVar1;
  *ppcVar1 = FUN_00430050;
  ppcVar1[1] = FUN_00430200;
  ppcVar1[2] = (code *)&LAB_00430230;
  *(undefined *)((int)ppcVar1 + 0xd) = 0;
  FUN_0042f7b0();
  if (*(int *)(in_EAX + 0xac) == 0) {
    *(undefined *)(in_EAX + 0xd4) = 0;
    *(undefined4 *)(in_EAX + 0xa8) = 1;
  }
  else {
    FUN_0042f990();
  }
  if (*(char *)(in_EAX + 0xd4) != '\0') {
    *(undefined *)(in_EAX + 0xb2) = 1;
  }
  ppcVar1[4] = (code *)0x0;
  ppcVar1[7] = (code *)0x0;
  ppcVar1[5] = (code *)0x0;
  if (*(char *)(in_EAX + 0xb2) != '\0') {
    ppcVar1[6] = (code *)(*(int *)(in_EAX + 0xa8) * 2);
    return;
  }
  ppcVar1[6] = *(code **)(in_EAX + 0xa8);
  return;
}



uint __cdecl FUN_00430430(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  char cVar5;
  undefined3 uVar9;
  int iVar6;
  undefined4 *puVar7;
  uint uVar8;
  uint uVar10;
  undefined4 uVar11;
  int iVar12;
  uint uVar13;
  int *piVar14;
  int iVar15;
  int local_24;
  int local_20;
  int iStack_14;
  int local_10;
  
  iVar1 = *(int *)(param_1 + 0xe0);
  iVar2 = *(int *)(param_1 + 0x148);
  uVar8 = *(uint *)(iVar2 + 0x10);
  uVar10 = *(int *)(param_1 + 0xf8) - 1;
  if ((int)uVar8 < *(int *)(iVar2 + 0x14)) {
    do {
      for (uVar13 = *(uint *)(iVar2 + 0xc); uVar13 <= uVar10; uVar13 = uVar13 + 1) {
        iVar15 = 0;
        local_10 = 0;
        if (0 < *(int *)(param_1 + 0xe4)) {
          piVar14 = (int *)(param_1 + 0xe8);
          do {
            iVar3 = *piVar14;
            if (uVar13 < uVar10) {
              iVar12 = *(int *)(iVar3 + 0x34);
            }
            else {
              iVar12 = *(int *)(iVar3 + 0x44);
            }
            iVar4 = *(int *)(iVar3 + 0x40);
            local_24 = uVar8 * 8;
            local_20 = 0;
            if (0 < *(int *)(iVar3 + 0x38)) {
              iVar6 = *(int *)(iVar3 + 0x34);
              do {
                if ((*(uint *)(iVar2 + 8) < iVar1 - 1U) ||
                   ((int)(local_20 + uVar8) < *(int *)(iVar3 + 0x48))) {
                  (**(code **)(*(int *)(param_1 + 0x158) + 4))
                            (param_1,iVar3,*(undefined4 *)(param_2 + *(int *)(iVar3 + 4) * 4),
                             *(undefined4 *)(iVar2 + 0x18 + iVar15 * 4),local_24,iVar4 * uVar13,
                             iVar12);
                  if ((iVar12 < *(int *)(iVar3 + 0x34)) &&
                     (memset(*(void **)(iVar2 + 0x18 + (iVar12 + iVar15) * 4),0,
                             (*(int *)(iVar3 + 0x34) - iVar12) * 0x80),
                     iVar12 < *(int *)(iVar3 + 0x34))) {
                    puVar7 = (undefined4 *)(iVar2 + 0x18 + (iVar12 + iVar15) * 4);
                    iStack_14 = iVar12;
                    do {
                      *(undefined2 *)*puVar7 = *(undefined2 *)puVar7[-1];
                      iStack_14 = iStack_14 + 1;
                      puVar7 = puVar7 + 1;
                    } while (iStack_14 < *(int *)(iVar3 + 0x34));
                  }
                }
                else {
                  memset(*(void **)(iVar2 + 0x18 + iVar15 * 4),0,iVar6 << 7);
                  iVar6 = 0;
                  if (0 < *(int *)(iVar3 + 0x34)) {
                    puVar7 = (undefined4 *)(iVar2 + 0x18 + iVar15 * 4);
                    do {
                      iVar6 = iVar6 + 1;
                      *(undefined2 *)*puVar7 = **(undefined2 **)(iVar2 + 0x14 + iVar15 * 4);
                      puVar7 = puVar7 + 1;
                    } while (iVar6 < *(int *)(iVar3 + 0x34));
                  }
                }
                iVar6 = *(int *)(iVar3 + 0x34);
                local_24 = local_24 + 8;
                local_20 = local_20 + 1;
                iVar15 = iVar15 + iVar6;
              } while (local_20 < *(int *)(iVar3 + 0x38));
            }
            local_10 = local_10 + 1;
            piVar14 = piVar14 + 1;
          } while (local_10 < *(int *)(param_1 + 0xe4));
        }
        cVar5 = (**(code **)(*(int *)(param_1 + 0x15c) + 4))(param_1,iVar2 + 0x18);
        if (cVar5 == '\0') {
          *(uint *)(iVar2 + 0x10) = uVar8;
          *(uint *)(iVar2 + 0xc) = uVar13;
          return uVar8 & 0xffffff00;
        }
      }
      uVar8 = uVar8 + 1;
      *(undefined4 *)(iVar2 + 0xc) = 0;
    } while ((int)uVar8 < *(int *)(iVar2 + 0x14));
  }
  *(int *)(iVar2 + 8) = *(int *)(iVar2 + 8) + 1;
  iVar1 = *(int *)(param_1 + 0x148);
  uVar9 = (undefined3)((uint)iVar1 >> 8);
  if (1 < *(int *)(param_1 + 0xe4)) {
    *(undefined4 *)(iVar1 + 0x14) = 1;
    *(undefined4 *)(iVar1 + 0xc) = 0;
    *(undefined4 *)(iVar1 + 0x10) = 0;
    return CONCAT31(uVar9,1);
  }
  if (*(uint *)(iVar1 + 8) < *(int *)(param_1 + 0xe0) - 1U) {
    uVar11 = *(undefined4 *)(*(int *)(param_1 + 0xe8) + 0xc);
  }
  else {
    uVar11 = *(undefined4 *)(*(int *)(param_1 + 0xe8) + 0x48);
  }
  *(undefined4 *)(iVar1 + 0x14) = uVar11;
  *(undefined4 *)(iVar1 + 0xc) = 0;
  *(undefined4 *)(iVar1 + 0x10) = 0;
  return CONCAT31(uVar9,1);
}



void FUN_004306d0(int param_1,undefined4 *param_2)

{
  undefined2 uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  undefined2 *puVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  uint uVar13;
  undefined2 *puVar14;
  int iVar15;
  uint uStack_2c;
  undefined4 *local_1c;
  undefined4 *local_18;
  int local_c;
  
  iVar15 = *(int *)(param_1 + 0x44);
  iVar2 = *(int *)(param_1 + 0x148);
  uVar11 = *(int *)(param_1 + 0xe0) - 1;
  local_c = 0;
  if (0 < *(int *)(param_1 + 0x3c)) {
    local_1c = (undefined4 *)(iVar2 + 0x40);
    local_18 = param_2;
    do {
      iVar6 = (**(code **)(*(int *)(param_1 + 4) + 0x20))
                        (param_1,*local_1c,*(int *)(iVar2 + 8) * *(int *)(iVar15 + 0xc),
                         *(int *)(iVar15 + 0xc),1);
      if (*(uint *)(iVar2 + 8) < uVar11) {
        uStack_2c = *(uint *)(iVar15 + 0xc);
      }
      else {
        uStack_2c = *(uint *)(iVar15 + 0x20) % *(uint *)(iVar15 + 0xc);
        if (uStack_2c == 0) {
          uStack_2c = *(uint *)(iVar15 + 0xc);
        }
      }
      uVar3 = *(uint *)(iVar15 + 0x1c);
      uVar4 = *(uint *)(iVar15 + 8);
      uVar10 = uVar3 % uVar4;
      if (0 < (int)uVar10) {
        uVar10 = uVar4 - uVar10;
      }
      iVar12 = 0;
      if (0 < (int)uStack_2c) {
        do {
          iVar5 = *(int *)(iVar6 + iVar12 * 4);
          (**(code **)(*(int *)(param_1 + 0x158) + 4))
                    (param_1,iVar15,*local_18,iVar5,iVar12 * 8,0,uVar3);
          if (0 < (int)uVar10) {
            puVar14 = (undefined2 *)(iVar5 + uVar3 * 0x80);
            memset(puVar14,0,uVar10 << 7);
            uVar1 = puVar14[-0x40];
            uVar7 = uVar10;
            if (0 < (int)uVar10) {
              do {
                *puVar14 = uVar1;
                puVar14 = puVar14 + 0x40;
                uVar7 = uVar7 - 1;
              } while (uVar7 != 0);
            }
          }
          iVar12 = iVar12 + 1;
        } while (iVar12 < (int)uStack_2c);
      }
      if (*(uint *)(iVar2 + 8) == uVar11) {
        uVar7 = (uVar3 + uVar10) / uVar4;
        if ((int)uStack_2c < *(int *)(iVar15 + 0xc)) {
          uVar13 = uStack_2c;
          do {
            puVar14 = *(undefined2 **)(iVar6 + uVar13 * 4);
            iVar12 = *(int *)(iVar6 + -4 + uVar13 * 4);
            memset(puVar14,0,(uVar3 + uVar10) * 0x80);
            if (uVar7 != 0) {
              uStack_2c = uVar7;
              do {
                uVar1 = *(undefined2 *)(uVar4 * 0x80 + -0x80 + iVar12);
                puVar8 = puVar14;
                uVar9 = uVar4;
                if (0 < (int)uVar4) {
                  do {
                    *puVar8 = uVar1;
                    uVar9 = uVar9 - 1;
                    puVar8 = puVar8 + 0x40;
                  } while (uVar9 != 0);
                }
                puVar14 = puVar14 + uVar4 * 0x40;
                iVar12 = iVar12 + uVar4 * 0x80;
                uStack_2c = uStack_2c - 1;
              } while (uStack_2c != 0);
            }
            uVar13 = uVar13 + 1;
          } while ((int)uVar13 < *(int *)(iVar15 + 0xc));
        }
      }
      local_1c = local_1c + 1;
      local_18 = local_18 + 1;
      local_c = local_c + 1;
      iVar15 = iVar15 + 0x54;
    } while (local_c < *(int *)(param_1 + 0x3c));
  }
  FUN_00430900(param_1);
  return;
}



uint __cdecl FUN_00430900(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  undefined3 uVar7;
  int iVar8;
  int iVar9;
  undefined4 uVar10;
  int *piVar11;
  int iVar12;
  int *piVar13;
  int *local_2c;
  int *piStack_28;
  int iStack_24;
  int iStack_20;
  int aiStack_10 [4];
  
  iVar1 = *(int *)(param_1 + 0x148);
  iVar12 = 0;
  if (0 < *(int *)(param_1 + 0xe4)) {
    local_2c = (int *)(param_1 + 0xe8);
    do {
      iVar3 = *(int *)(*local_2c + 0xc);
      iVar3 = (**(code **)(*(int *)(param_1 + 4) + 0x20))
                        (param_1,*(undefined4 *)(iVar1 + 0x40 + *(int *)(*local_2c + 4) * 4),
                         *(int *)(iVar1 + 8) * iVar3,iVar3,0);
      local_2c = local_2c + 1;
      aiStack_10[iVar12] = iVar3;
      iVar12 = iVar12 + 1;
    } while (iVar12 < *(int *)(param_1 + 0xe4));
  }
  iVar12 = *(int *)(iVar1 + 0x10);
  if (iVar12 < *(int *)(iVar1 + 0x14)) {
    do {
      local_2c = *(int **)(iVar1 + 0xc);
      if (local_2c < *(uint *)(param_1 + 0xf8)) {
        do {
          iVar3 = 0;
          iStack_20 = 0;
          if (0 < *(int *)(param_1 + 0xe4)) {
            piStack_28 = (int *)(param_1 + 0xe8);
            do {
              iVar2 = *piStack_28;
              iVar8 = *(int *)(iVar2 + 0x34);
              iVar4 = iVar8 * (int)local_2c;
              iStack_24 = 0;
              if (0 < *(int *)(iVar2 + 0x38)) {
                piVar11 = (int *)(aiStack_10[iStack_20] + iVar12 * 4);
                do {
                  iVar5 = *piVar11 + iVar4 * 0x80;
                  iVar9 = 0;
                  if (0 < iVar8) {
                    piVar13 = (int *)(iVar1 + 0x18 + iVar3 * 4);
                    do {
                      *piVar13 = iVar5;
                      iVar8 = *(int *)(iVar2 + 0x34);
                      iVar9 = iVar9 + 1;
                      iVar3 = iVar3 + 1;
                      piVar13 = piVar13 + 1;
                      iVar5 = iVar5 + 0x80;
                    } while (iVar9 < iVar8);
                  }
                  iStack_24 = iStack_24 + 1;
                  piVar11 = piVar11 + 1;
                } while (iStack_24 < *(int *)(iVar2 + 0x38));
              }
              piStack_28 = piStack_28 + 1;
              iStack_20 = iStack_20 + 1;
            } while (iStack_20 < *(int *)(param_1 + 0xe4));
          }
          uVar6 = (**(code **)(*(int *)(param_1 + 0x15c) + 4))(param_1,iVar1 + 0x18);
          if ((char)uVar6 == '\0') {
            *(int *)(iVar1 + 0x10) = iVar12;
            *(int **)(iVar1 + 0xc) = local_2c;
            return uVar6 & 0xffffff00;
          }
          local_2c = (int *)((int)local_2c + 1);
        } while (local_2c < *(uint *)(param_1 + 0xf8));
      }
      iVar12 = iVar12 + 1;
      *(undefined4 *)(iVar1 + 0xc) = 0;
    } while (iVar12 < *(int *)(iVar1 + 0x14));
  }
  *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + 1;
  iVar1 = *(int *)(param_1 + 0x148);
  uVar7 = (undefined3)((uint)iVar1 >> 8);
  if (*(int *)(param_1 + 0xe4) < 2) {
    if (*(uint *)(iVar1 + 8) < *(int *)(param_1 + 0xe0) - 1U) {
      uVar10 = *(undefined4 *)(*(int *)(param_1 + 0xe8) + 0xc);
    }
    else {
      uVar10 = *(undefined4 *)(*(int *)(param_1 + 0xe8) + 0x48);
    }
    *(undefined4 *)(iVar1 + 0x14) = uVar10;
    *(undefined4 *)(iVar1 + 0xc) = 0;
    *(undefined4 *)(iVar1 + 0x10) = 0;
    return CONCAT31(uVar7,1);
  }
  *(undefined4 *)(iVar1 + 0x14) = 1;
  *(undefined4 *)(iVar1 + 0xc) = 0;
  *(undefined4 *)(iVar1 + 0x10) = 0;
  return CONCAT31(uVar7,1);
}



void __cdecl FUN_00430b00(int param_1,char param_2)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  undefined4 *puStack_8;
  
  puStack_8 = (undefined4 *)(***(code ***)(param_1 + 4))(param_1,1,0x68);
  *(undefined4 **)(param_1 + 0x148) = puStack_8;
  *puStack_8 = &LAB_00430340;
  if (param_2 != '\0') {
    _param_2 = 0;
    if (0 < *(int *)(param_1 + 0x3c)) {
      piVar5 = (int *)(*(int *)(param_1 + 0x44) + 8);
      puStack_8 = puStack_8 + 0x10;
      do {
        iVar2 = piVar5[1];
        iVar4 = piVar5[6] + -1 + iVar2;
        iVar1 = piVar5[5] + -1 + *piVar5;
        uVar3 = (**(code **)(*(int *)(param_1 + 4) + 0x14))
                          (param_1,1,0,iVar1 - iVar1 % *piVar5,iVar4 - iVar4 % iVar2,iVar2);
        *puStack_8 = uVar3;
        _param_2 = _param_2 + 1;
        puStack_8 = puStack_8 + 1;
        piVar5 = piVar5 + 0x15;
      } while (_param_2 < *(int *)(param_1 + 0x3c));
    }
    return;
  }
  iVar4 = (**(code **)(*(int *)(param_1 + 4) + 4))(param_1,1,0x500);
  puStack_8[7] = iVar4 + 0x80;
  puStack_8[8] = iVar4 + 0x100;
  puStack_8[9] = iVar4 + 0x180;
  puStack_8[10] = iVar4 + 0x200;
  puStack_8[0xb] = iVar4 + 0x280;
  puStack_8[0xc] = iVar4 + 0x300;
  puStack_8[6] = iVar4;
  puStack_8[0xd] = iVar4 + 0x380;
  puStack_8[0xe] = iVar4 + 0x400;
  puStack_8[0xf] = iVar4 + 0x480;
  puStack_8[0x10] = 0;
  return;
}



void __cdecl
FUN_00430c70(int param_1,int param_2,uint *param_3,uint param_4,int param_5,uint *param_6,
            uint param_7)

{
  int iVar1;
  int iVar2;
  int iVar3;
  size_t _Size;
  uint uVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  int iStack_10;
  
  iVar1 = *(int *)(param_1 + 0x144);
  if (*param_3 < param_4) {
    while (*param_6 < param_7) {
      uVar8 = *(int *)(param_1 + 0xdc) - *(int *)(iVar1 + 0x34);
      uVar4 = param_4 - *param_3;
      if (uVar4 <= uVar8) {
        uVar8 = uVar4;
      }
      (**(code **)(*(int *)(param_1 + 0x150) + 4))
                (param_1,param_2 + *param_3 * 4,iVar1 + 8,*(undefined4 *)(iVar1 + 0x34),uVar8);
      *param_3 = *param_3 + uVar8;
      *(int *)(iVar1 + 0x34) = *(int *)(iVar1 + 0x34) + uVar8;
      piVar5 = (int *)(iVar1 + 0x30);
      *piVar5 = *piVar5 - uVar8;
      if ((*piVar5 == 0) && (*(int *)(iVar1 + 0x34) < *(int *)(param_1 + 0xdc))) {
        iStack_10 = 0;
        if (0 < *(int *)(param_1 + 0x3c)) {
          piVar5 = (int *)(iVar1 + 8);
          do {
            iVar2 = *(int *)(param_1 + 0xdc);
            _Size = *(size_t *)(param_1 + 0x1c);
            iVar6 = *piVar5;
            iVar3 = *(int *)(iVar1 + 0x34);
            for (iVar7 = iVar3; iVar7 < iVar2; iVar7 = iVar7 + 1) {
              memcpy(*(void **)(iVar6 + iVar7 * 4),*(void **)(iVar6 + -4 + iVar3 * 4),_Size);
            }
            iStack_10 = iStack_10 + 1;
            piVar5 = piVar5 + 1;
          } while (iStack_10 < *(int *)(param_1 + 0x3c));
        }
        *(undefined4 *)(iVar1 + 0x34) = *(undefined4 *)(param_1 + 0xdc);
      }
      if (*(int *)(iVar1 + 0x34) == *(int *)(param_1 + 0xdc)) {
        (**(code **)(*(int *)(param_1 + 0x154) + 4))(param_1,iVar1 + 8,0,param_5,*param_6);
        *(undefined4 *)(iVar1 + 0x34) = 0;
        *param_6 = *param_6 + 1;
      }
      if ((*(int *)(iVar1 + 0x30) == 0) && (*param_6 < param_7)) {
        iStack_10 = 0;
        if (0 < *(int *)(param_1 + 0x3c)) {
          piVar5 = (int *)(*(int *)(param_1 + 0x44) + 0xc);
          do {
            iVar1 = *piVar5;
            iVar2 = *(int *)(param_5 + iStack_10 * 4);
            iVar3 = piVar5[4];
            iVar7 = *param_6 * iVar1;
            for (iVar6 = iVar7; iVar6 < (int)(iVar1 * param_7); iVar6 = iVar6 + 1) {
              memcpy(*(void **)(iVar2 + iVar6 * 4),*(void **)(iVar2 + -4 + iVar7 * 4),iVar3 * 8);
            }
            iStack_10 = iStack_10 + 1;
            piVar5 = piVar5 + 0x15;
          } while (iStack_10 < *(int *)(param_1 + 0x3c));
        }
        *param_6 = param_7;
        return;
      }
      if (param_4 <= *param_3) {
        return;
      }
    }
  }
  return;
}



void FUN_004310a0(void)

{
  int iVar1;
  undefined4 *_Src;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  void *_Dst;
  int unaff_EDI;
  int iStack_20;
  int iStack_18;
  int iStack_10;
  void **ppvStack_c;
  
  iVar4 = *(int *)(unaff_EDI + 0x144);
  iVar1 = *(int *)(unaff_EDI + 0xdc);
  iStack_20 = (***(code ***)(unaff_EDI + 4))();
  iStack_10 = 0;
  if (0 < *(int *)(unaff_EDI + 0x3c)) {
    _Dst = (void *)(iStack_20 + iVar1 * 4);
    ppvStack_c = (void **)(iVar4 + 8);
    do {
      _Src = (undefined4 *)(**(code **)(*(int *)(unaff_EDI + 4) + 8))();
      memcpy(_Dst,_Src,iVar1 * 0xc);
      if (0 < iVar1) {
        puVar2 = (undefined4 *)(iVar1 * 0x10 + iStack_20);
        puVar3 = _Src + iVar1 * 2;
        iVar4 = iStack_20 - (int)_Src;
        iStack_18 = iVar1;
        do {
          *(undefined4 *)((int)_Src + iVar4) = *puVar3;
          *puVar2 = *_Src;
          puVar3 = puVar3 + 1;
          _Src = _Src + 1;
          puVar2 = puVar2 + 1;
          iStack_18 = iStack_18 + -1;
        } while (iStack_18 != 0);
      }
      iStack_20 = iStack_20 + iVar1 * 0x14;
      *ppvStack_c = _Dst;
      _Dst = (void *)((int)_Dst + iVar1 * 0x14);
      iStack_10 = iStack_10 + 1;
      ppvStack_c = ppvStack_c + 1;
    } while (iStack_10 < *(int *)(unaff_EDI + 0x3c));
  }
  return;
}



void FUN_004311c0(void)

{
  int in_EAX;
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  
  puVar1 = (undefined4 *)(***(code ***)(in_EAX + 4))();
  *(undefined4 **)(in_EAX + 0x144) = puVar1;
  *puVar1 = &LAB_00430c20;
  if (*(char *)(*(int *)(in_EAX + 0x154) + 8) == '\0') {
    puVar1[1] = FUN_00430c70;
    iVar3 = 0;
    if (0 < *(int *)(in_EAX + 0x3c)) {
      puVar1 = puVar1 + 2;
      do {
        uVar2 = (**(code **)(*(int *)(in_EAX + 4) + 8))();
        *puVar1 = uVar2;
        iVar3 = iVar3 + 1;
        puVar1 = puVar1 + 1;
      } while (iVar3 < *(int *)(in_EAX + 0x3c));
    }
    return;
  }
  puVar1[1] = &LAB_00430e90;
  FUN_004310a0();
  return;
}



void __cdecl FUN_00431260(uint *param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  uint *puVar6;
  undefined4 uVar7;
  double *pdVar8;
  double *pdVar9;
  ushort *puVar10;
  int iVar11;
  int *piVar12;
  float *pfVar13;
  short *psVar14;
  int local_c;
  
  puVar6 = param_1;
  uVar1 = param_1[0x56];
  local_c = 0;
  if (0 < (int)param_1[0xf]) {
    param_1 = (uint *)(param_1[0x11] + 0x10);
    do {
      uVar2 = *param_1;
      if ((3 < uVar2) || (puVar6[uVar2 + 0x12] == 0)) {
        *(undefined4 *)(*puVar6 + 0x14) = 0x34;
        *(uint *)(*puVar6 + 0x18) = uVar2;
        (**(code **)*puVar6)(puVar6);
      }
      uVar3 = puVar6[0x2e];
      uVar4 = puVar6[uVar2 + 0x12];
      if (uVar3 == 0) {
        if (*(int *)(uVar1 + 0xc + uVar2 * 4) == 0) {
          uVar7 = (**(code **)puVar6[1])(puVar6,1,0x100);
          *(undefined4 *)(uVar1 + 0xc + uVar2 * 4) = uVar7;
        }
        iVar5 = *(int *)(uVar1 + 0xc + uVar2 * 4);
        iVar11 = 0;
        do {
          *(uint *)(iVar5 + iVar11 * 4) = (uint)*(ushort *)(uVar4 + iVar11 * 2) * 8;
          iVar11 = iVar11 + 1;
        } while (iVar11 < 0x40);
      }
      else if (uVar3 == 1) {
        if (*(int *)(uVar1 + 0xc + uVar2 * 4) == 0) {
          uVar7 = (**(code **)puVar6[1])(puVar6,1,0x100);
          *(undefined4 *)(uVar1 + 0xc + uVar2 * 4) = uVar7;
        }
        piVar12 = (int *)(*(int *)(uVar1 + 0xc + uVar2 * 4) + 8);
        psVar14 = &DAT_0043f9da;
        puVar10 = (ushort *)(uVar4 + 4);
        do {
          piVar12[-2] = (int)((uint)puVar10[-2] * (int)psVar14[-1] + 0x400) >> 0xb;
          piVar12[-1] = (int)((uint)puVar10[-1] * (int)*psVar14 + 0x400) >> 0xb;
          *piVar12 = (int)((int)*(short *)((int)&DAT_0043f9d8 + -uVar4 + (int)puVar10) *
                           (uint)*puVar10 + 0x400) >> 0xb;
          piVar12[1] = (int)((int)*(short *)((int)&DAT_0043f9da + -uVar4 + (int)puVar10) *
                             (uint)puVar10[1] + 0x400) >> 0xb;
          psVar14 = psVar14 + 4;
          piVar12 = piVar12 + 4;
          puVar10 = puVar10 + 4;
        } while ((int)psVar14 < 0x43fa5a);
      }
      else if (uVar3 == 2) {
        if (*(int *)(uVar1 + 0x20 + uVar2 * 4) == 0) {
          uVar7 = (**(code **)puVar6[1])(puVar6,1,0x100);
          *(undefined4 *)(uVar1 + 0x20 + uVar2 * 4) = uVar7;
        }
        pdVar8 = (double *)&DAT_0043fa58;
        puVar10 = (ushort *)(uVar4 + 4);
        pfVar13 = (float *)(*(int *)(uVar1 + 0x20 + uVar2 * 4) + 8);
        do {
          pdVar9 = pdVar8 + 1;
          pfVar13[-2] = 1.0 / ((float)(uint)puVar10[-2] * (float)*pdVar8 * 8.0);
          pfVar13[-1] = 1.0 / ((float)(uint)puVar10[-1] * (float)*pdVar8 * 1.38704 * 8.0);
          *pfVar13 = 1.0 / ((float)(uint)*puVar10 * (float)*pdVar8 * 1.306563 * 8.0);
          pfVar13[1] = 1.0 / ((float)(uint)puVar10[1] * (float)*pdVar8 * 1.175876 * 8.0);
          pfVar13[2] = 1.0 / ((float)(uint)puVar10[2] * (float)*pdVar8 * 8.0);
          pfVar13[3] = 1.0 / ((float)(uint)puVar10[3] * (float)*pdVar8 * 0.785695 * 8.0);
          pfVar13[4] = 1.0 / ((float)(uint)puVar10[4] * (float)*pdVar8 * 0.5411961 * 8.0);
          pfVar13[5] = 1.0 / ((float)(uint)puVar10[5] * (float)*pdVar8 * 0.2758994 * 8.0);
          pdVar8 = pdVar9;
          puVar10 = puVar10 + 8;
          pfVar13 = pfVar13 + 8;
        } while ((int)pdVar9 < 0x43fa98);
      }
      else {
        *(undefined4 *)(*puVar6 + 0x14) = 0x30;
        (**(code **)*puVar6)(puVar6);
      }
      param_1 = param_1 + 0x15;
      local_c = local_c + 1;
    } while (local_c < (int)puVar6[0xf]);
  }
  return;
}



void FUN_004320f0(void)

{
  int iVar1;
  code **ppcVar2;
  int *unaff_EDI;
  
  ppcVar2 = (code **)(**(code **)unaff_EDI[1])();
  unaff_EDI[0x56] = (int)ppcVar2;
  *ppcVar2 = FUN_00431260;
  iVar1 = unaff_EDI[0x2e];
  if (iVar1 == 0) {
    ppcVar2[2] = (code *)&LAB_00435fb0;
  }
  else {
    if (iVar1 != 1) {
      if (iVar1 == 2) {
        ppcVar2[1] = (code *)&LAB_00431970;
        ppcVar2[7] = (code *)&LAB_00435c80;
      }
      else {
        *(undefined4 *)(*unaff_EDI + 0x14) = 0x30;
        (**(code **)*unaff_EDI)();
      }
      goto LAB_00432161;
    }
    ppcVar2[2] = FUN_004362d0;
  }
  ppcVar2[1] = (code *)&LAB_00431560;
LAB_00432161:
  ppcVar2[3] = (code *)0x0;
  ppcVar2[8] = (code *)0x0;
  ppcVar2[4] = (code *)0x0;
  ppcVar2[9] = (code *)0x0;
  ppcVar2[5] = (code *)0x0;
  ppcVar2[10] = (code *)0x0;
  ppcVar2[6] = (code *)0x0;
  ppcVar2[0xb] = (code *)0x0;
  return;
}



void __thiscall FUN_00432180(void *this,int param_1,int param_2)

{
  int iVar1;
  int in_EAX;
  int unaff_EBX;
  int iVar2;
  undefined4 local_4;
  
  if ((0 < in_EAX - unaff_EBX) && (iVar2 = 0, local_4 = this, 0 < param_2)) {
    do {
      iVar1 = *(int *)(param_1 + iVar2 * 4);
      local_4 = (void *)CONCAT31(local_4._1_3_,*(undefined *)(iVar1 + -1 + unaff_EBX));
      memset((void *)(iVar1 + unaff_EBX),(int)local_4,in_EAX - unaff_EBX);
      iVar2 = iVar2 + 1;
    } while (iVar2 < param_2);
  }
  return;
}



void __cdecl FUN_004321d0(int param_1,int *param_2,int param_3,int param_4,int param_5)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  code **ppcVar5;
  int iVar6;
  
  iVar3 = param_1;
  piVar1 = (int *)(param_1 + 0x3c);
  piVar2 = (int *)(param_1 + 0x154);
  iVar6 = *(int *)(param_1 + 0x44);
  param_1 = 0;
  if (0 < *piVar1) {
    ppcVar5 = (code **)(*piVar2 + 0xc);
    iVar4 = param_4 - (int)param_2;
    do {
      (**ppcVar5)(iVar3,iVar6,*param_2 + param_3 * 4,
                  *(int *)(iVar4 + (int)param_2) + *(int *)(iVar6 + 0xc) * param_5 * 4);
      param_1 = param_1 + 1;
      param_2 = param_2 + 1;
      ppcVar5 = ppcVar5 + 1;
      iVar6 = iVar6 + 0x54;
    } while (param_1 < *(int *)(iVar3 + 0x3c));
  }
  return;
}



void __cdecl FUN_00432260(int *param_1,int param_2,int *param_3,int param_4)

{
  int iVar1;
  int iVar2;
  undefined *puVar3;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int *piVar10;
  int local_20;
  int local_14;
  
  iVar4 = param_1[0x36] / *(int *)(param_2 + 8);
  iVar2 = *(int *)(param_2 + 0x1c);
  iVar5 = param_1[0x37] / *(int *)(param_2 + 0xc);
  FUN_00432180(param_1,(int)param_3,param_1[0x37]);
  local_14 = 0;
  if (0 < *(int *)(param_2 + 0xc)) {
    param_1 = param_3;
    do {
      iVar9 = 0;
      puVar3 = *(undefined **)(param_4 + local_14 * 4);
      for (iVar1 = iVar2 * 8; iVar1 != 0; iVar1 = iVar1 + -1) {
        iVar8 = 0;
        piVar10 = param_1;
        local_20 = iVar5;
        if (0 < iVar5) {
          do {
            pbVar6 = (byte *)(*piVar10 + iVar9);
            iVar7 = iVar4;
            if (0 < iVar4) {
              do {
                iVar8 = iVar8 + (uint)*pbVar6;
                pbVar6 = pbVar6 + 1;
                iVar7 = iVar7 + -1;
              } while (iVar7 != 0);
            }
            local_20 = local_20 + -1;
            piVar10 = piVar10 + 1;
          } while (local_20 != 0);
        }
        iVar9 = iVar9 + iVar4;
        *puVar3 = (char)((iVar8 + (iVar5 * iVar4) / 2) / (iVar5 * iVar4));
        puVar3 = puVar3 + 1;
      }
      param_1 = param_1 + iVar5;
      local_14 = local_14 + 1;
    } while (local_14 < *(int *)(param_2 + 0xc));
  }
  return;
}



void __cdecl FUN_004323e0(void *param_1,int param_2,byte **param_3,int param_4)

{
  int iVar1;
  byte *pbVar2;
  undefined *puVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  
  iVar1 = *(int *)(param_2 + 0x1c);
  FUN_00432180(param_1,(int)param_3,*(int *)((int)param_1 + 0xdc));
  param_1 = (void *)0x0;
  if (0 < *(int *)(param_2 + 0xc)) {
    iVar4 = param_4 - (int)param_3;
    do {
      puVar3 = *(undefined **)(iVar4 + (int)param_3);
      pbVar2 = *param_3;
      uVar5 = 0;
      for (iVar6 = iVar1 * 8; iVar6 != 0; iVar6 = iVar6 + -1) {
        *puVar3 = (char)((int)((uint)*pbVar2 + pbVar2[1] + uVar5) >> 1);
        puVar3 = puVar3 + 1;
        uVar5 = uVar5 ^ 1;
        pbVar2 = pbVar2 + 2;
      }
      param_1 = (void *)((int)param_1 + 1);
      param_3 = param_3 + 1;
    } while ((int)param_1 < *(int *)(param_2 + 0xc));
  }
  return;
}



void __cdecl FUN_00432490(void *param_1,int param_2,byte **param_3,int param_4)

{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  undefined *puVar5;
  uint uVar6;
  byte **local_c;
  int local_8;
  
  iVar2 = *(int *)(param_2 + 0x1c);
  FUN_00432180(param_1,(int)param_3,*(int *)((int)param_1 + 0xdc));
  local_8 = 0;
  if (0 < *(int *)(param_2 + 0xc)) {
    local_c = param_3;
    do {
      puVar5 = *(undefined **)(param_4 + local_8 * 4);
      pbVar3 = *local_c;
      pbVar4 = local_c[1];
      uVar6 = 1;
      for (iVar1 = iVar2 * 8; iVar1 != 0; iVar1 = iVar1 + -1) {
        *puVar5 = (char)((int)((uint)*pbVar3 + *pbVar4 + uVar6 + (uint)pbVar4[1] + (uint)pbVar3[1])
                        >> 2);
        puVar5 = puVar5 + 1;
        uVar6 = uVar6 ^ 3;
        pbVar3 = pbVar3 + 2;
        pbVar4 = pbVar4 + 2;
      }
      local_8 = local_8 + 1;
      local_c = local_c + 2;
    } while (local_8 < *(int *)(param_2 + 0xc));
  }
  return;
}



void __cdecl FUN_00432560(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  undefined *puVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  int iVar8;
  byte *pbVar9;
  void *this;
  int iVar10;
  byte **ppbVar11;
  byte *pbVar12;
  byte *pbVar13;
  int local_c;
  
  iVar2 = *(int *)(param_2 + 0x1c);
  this = (void *)(*(int *)(param_1 + 0xdc) + 2);
  ppbVar11 = (byte **)(param_3 + -4);
  FUN_00432180(this,(int)ppbVar11,(int)this);
  iVar10 = *(int *)(param_1 + 0xb4) * -0x50 + 0x4000;
  iVar8 = *(int *)(param_1 + 0xb4) * 0x10;
  local_c = 0;
  if (0 < *(int *)(param_2 + 0xc)) {
    do {
      pbVar3 = ppbVar11[2];
      puVar4 = *(undefined **)(param_4 + local_c * 4);
      pbVar5 = ppbVar11[1];
      pbVar6 = *ppbVar11;
      pbVar7 = ppbVar11[3];
      pbVar9 = pbVar5 + 2;
      pbVar13 = pbVar7 + 2;
      pbVar12 = pbVar6 + 2;
      *puVar4 = (char)(((uint)*pbVar13 +
                       (uint)*pbVar12 + (uint)*pbVar6 +
                       ((uint)*pbVar9 +
                        (uint)pbVar3[2] + (uint)*pbVar5 + (uint)pbVar7[1] + (uint)pbVar6[1] +
                        (uint)*pbVar3 + (uint)*pbVar6) * 2 + (uint)*pbVar7 * 3) * iVar8 + 0x8000 +
                       ((uint)pbVar5[1] + (uint)pbVar3[1] + (uint)*pbVar5 + (uint)*pbVar3) * iVar10
                      >> 0x10);
      iVar1 = iVar2 * 8 + -2;
      while( true ) {
        puVar4 = puVar4 + 1;
        pbVar3 = pbVar3 + 2;
        if (iVar1 == 0) break;
        *puVar4 = (char)(((uint)pbVar13[-1] +
                          ((uint)pbVar13[1] + (uint)pbVar12[1] + (uint)pbVar3[-1] + (uint)pbVar9[-1]
                           + (uint)*pbVar13 + (uint)pbVar3[2] + (uint)*pbVar12 + (uint)pbVar9[2]) *
                          2 + (uint)pbVar12[-1] + (uint)pbVar12[2] + (uint)pbVar13[2]) * iVar8 +
                         0x8000 + ((uint)pbVar3[1] + (uint)pbVar9[1] + (uint)*pbVar3 + (uint)*pbVar9
                                  ) * iVar10 >> 0x10);
        pbVar9 = pbVar9 + 2;
        pbVar12 = pbVar12 + 2;
        pbVar13 = pbVar13 + 2;
        iVar1 = iVar1 + -1;
      }
      *puVar4 = (char)(((uint)pbVar12[-1] +
                       (uint)pbVar13[-1] + (uint)pbVar12[1] +
                       ((uint)*pbVar12 +
                        (uint)*pbVar13 + (uint)pbVar9[1] + (uint)pbVar3[-1] + (uint)pbVar9[-1] +
                        (uint)pbVar3[1] + (uint)pbVar12[1]) * 2 + (uint)pbVar13[1] * 3) * iVar8 +
                       0x8000 + ((uint)*pbVar9 + (uint)*pbVar3 + (uint)pbVar9[1] + (uint)pbVar3[1])
                                * iVar10 >> 0x10);
      local_c = local_c + 1;
      ppbVar11 = ppbVar11 + 2;
    } while (local_c < *(int *)(param_2 + 0xc));
  }
  return;
}



void __cdecl FUN_004327e0(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  byte bVar2;
  int iVar3;
  undefined *puVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  int iVar8;
  byte **ppbVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  byte *pbVar13;
  int iVar14;
  uint uVar15;
  int local_c;
  
  iVar3 = *(int *)(param_2 + 0x1c);
  FUN_00432180((void *)(param_3 + -4),(int)(void *)(param_3 + -4),*(int *)(param_1 + 0xdc) + 2);
  iVar12 = (0x80 - *(int *)(param_1 + 0xb4)) * 0x200;
  iVar8 = *(int *)(param_1 + 0xb4) * 0x40;
  local_c = 0;
  if (0 < *(int *)(param_2 + 0xc)) {
    ppbVar9 = (byte **)(param_3 + 4);
    do {
      puVar4 = *(undefined **)(param_4 + local_c * 4);
      pbVar5 = ppbVar9[-2];
      pbVar6 = *ppbVar9;
      pbVar7 = ppbVar9[-1];
      uVar15 = (uint)*pbVar7;
      iVar14 = (uint)*pbVar5 + *pbVar6 + uVar15;
      pbVar13 = pbVar7 + 1;
      iVar10 = (uint)pbVar6[1] + (uint)pbVar5[1] + (uint)pbVar7[1];
      *puVar4 = (char)(((iVar14 * 2 - uVar15) + iVar10) * iVar8 + 0x8000 + uVar15 * iVar12 >> 0x10);
      for (iVar1 = iVar3 * 8 + -2; puVar4 = puVar4 + 1, iVar1 != 0; iVar1 = iVar1 + -1) {
        bVar2 = *pbVar13;
        pbVar13 = pbVar13 + 1;
        iVar11 = (uint)pbVar6[2] + (uint)pbVar5[2] + (uint)*pbVar13;
        *puVar4 = (char)(((iVar14 - (uint)bVar2) + iVar11 + iVar10) * iVar8 + 0x8000 +
                         (uint)bVar2 * iVar12 >> 0x10);
        pbVar5 = pbVar5 + 1;
        pbVar6 = pbVar6 + 1;
        iVar14 = iVar10;
        iVar10 = iVar11;
      }
      *puVar4 = (char)(((iVar10 * 2 - (uint)*pbVar13) + iVar14) * iVar8 + 0x8000 +
                       (uint)*pbVar13 * iVar12 >> 0x10);
      local_c = local_c + 1;
      ppbVar9 = ppbVar9 + 1;
    } while (local_c < *(int *)(param_2 + 0xc));
  }
  return;
}



void FUN_00432970(void)

{
  int iVar1;
  int iVar2;
  bool bVar3;
  code **ppcVar4;
  int *piVar5;
  int *unaff_ESI;
  code **ppcVar6;
  int iStack_4;
  
  bVar3 = true;
  ppcVar4 = (code **)(**(code **)unaff_ESI[1])();
  unaff_ESI[0x55] = (int)ppcVar4;
  *ppcVar4 = FUN_0041c770;
  ppcVar4[1] = FUN_004321d0;
  *(undefined *)(ppcVar4 + 2) = 0;
  if (*(char *)((int)unaff_ESI + 0xb3) != '\0') {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x19;
    (**(code **)*unaff_ESI)();
  }
  iStack_4 = 0;
  if (0 < unaff_ESI[0xf]) {
    piVar5 = (int *)(unaff_ESI[0x11] + 0xc);
    ppcVar6 = ppcVar4 + 3;
    do {
      iVar1 = piVar5[-1];
      iVar2 = unaff_ESI[0x36];
      if ((iVar1 == iVar2) && (*piVar5 == unaff_ESI[0x37])) {
        if (unaff_ESI[0x2d] == 0) {
          *ppcVar6 = (code *)&LAB_00432390;
        }
        else {
          *ppcVar6 = FUN_004327e0;
          *(undefined *)(ppcVar4 + 2) = 1;
        }
      }
      else if (iVar1 * 2 == iVar2) {
        if (*piVar5 == unaff_ESI[0x37]) {
          bVar3 = false;
          *ppcVar6 = FUN_004323e0;
        }
        else {
          if ((iVar1 * 2 != iVar2) || (*piVar5 * 2 != unaff_ESI[0x37])) goto LAB_00432a6c;
          if (unaff_ESI[0x2d] == 0) {
            *ppcVar6 = FUN_00432490;
          }
          else {
            *ppcVar6 = FUN_00432560;
            *(undefined *)(ppcVar4 + 2) = 1;
          }
        }
      }
      else {
LAB_00432a6c:
        if ((iVar2 % iVar1 == 0) && (unaff_ESI[0x37] % *piVar5 == 0)) {
          bVar3 = false;
          *ppcVar6 = FUN_00432260;
        }
        else {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x26;
          (**(code **)*unaff_ESI)();
        }
      }
      iStack_4 = iStack_4 + 1;
      ppcVar6 = ppcVar6 + 1;
      piVar5 = piVar5 + 0x15;
    } while (iStack_4 < unaff_ESI[0xf]);
  }
  if ((unaff_ESI[0x2d] != 0) && (!bVar3)) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 99;
    (**(code **)(*unaff_ESI + 4))();
  }
  return;
}



void __cdecl FUN_00432af0(int *param_1,char param_2)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  int iVar4;
  bool bVar5;
  undefined4 *local_c;
  int local_4;
  
  piVar2 = param_1;
  iVar1 = param_1[0x57];
  *(char *)(iVar1 + 0xc) = param_2;
  *(int **)(iVar1 + 0x20) = param_1;
  bVar5 = param_1[0x4b] == 0;
  if (param_1[0x4d] == 0) {
    if (bVar5) {
      *(code **)(iVar1 + 4) = FUN_00432f80;
    }
    else {
      *(code **)(iVar1 + 4) = FUN_004330f0;
    }
  }
  else if (bVar5) {
    *(undefined **)(iVar1 + 4) = &LAB_004332e0;
  }
  else {
    *(undefined **)(iVar1 + 4) = &LAB_004333a0;
    if (*(int *)(iVar1 + 0x40) == 0) {
      uVar3 = (**(code **)param_1[1])(param_1,1,1000);
      *(undefined4 *)(iVar1 + 0x40) = uVar3;
    }
  }
  if (param_2 == '\0') {
    *(undefined **)(iVar1 + 8) = &LAB_00433630;
  }
  else {
    *(code **)(iVar1 + 8) = FUN_00433680;
  }
  local_4 = 0;
  if (0 < param_1[0x39]) {
    local_c = (undefined4 *)(iVar1 + 0x24);
    param_1 = param_1 + 0x3a;
    do {
      iVar4 = *param_1;
      *local_c = 0;
      if (bVar5) {
        if (piVar2[0x4d] == 0) {
          iVar4 = *(int *)(iVar4 + 0x14);
          goto LAB_00432bc5;
        }
      }
      else {
        iVar4 = *(int *)(iVar4 + 0x18);
        *(int *)(iVar1 + 0x34) = iVar4;
LAB_00432bc5:
        if (param_2 == '\0') {
          FUN_004338f0(iVar4,(int *)(iVar1 + 0x4c + iVar4 * 4),bVar5);
        }
        else {
          if ((iVar4 < 0) || (3 < iVar4)) {
            *(undefined4 *)(*piVar2 + 0x14) = 0x32;
            *(int *)(*piVar2 + 0x18) = iVar4;
            (**(code **)*piVar2)(piVar2);
          }
          if (*(int *)(iVar1 + 0x5c + iVar4 * 4) == 0) {
            uVar3 = (**(code **)piVar2[1])(piVar2,1,0x404);
            *(undefined4 *)(iVar1 + 0x5c + iVar4 * 4) = uVar3;
          }
          memset(*(void **)(iVar1 + 0x5c + iVar4 * 4),0,0x404);
        }
      }
      param_1 = param_1 + 1;
      local_c = local_c + 1;
      local_4 = local_4 + 1;
    } while (local_4 < piVar2[0x39]);
  }
  *(undefined4 *)(iVar1 + 0x38) = 0;
  *(undefined4 *)(iVar1 + 0x3c) = 0;
  *(undefined4 *)(iVar1 + 0x18) = 0;
  *(undefined4 *)(iVar1 + 0x1c) = 0;
  iVar4 = piVar2[0x2f];
  *(undefined4 *)(iVar1 + 0x48) = 0;
  *(int *)(iVar1 + 0x44) = iVar4;
  return;
}



void __cdecl FUN_00432c80(uint param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 *puVar3;
  char cVar4;
  uint uVar5;
  uint uVar6;
  int unaff_ESI;
  uint uVar7;
  
  iVar2 = *(int *)(unaff_ESI + 0x1c);
  if (param_2 == 0) {
    *(undefined4 *)(**(int **)(unaff_ESI + 0x20) + 0x14) = 0x28;
    (**(code **)**(undefined4 **)(unaff_ESI + 0x20))(*(undefined4 **)(unaff_ESI + 0x20));
  }
  if (*(char *)(unaff_ESI + 0xc) == '\0') {
    uVar5 = iVar2 + param_2;
    uVar7 = ((1 << ((byte)param_2 & 0x1f)) - 1U & param_1) << (0x18U - (char)uVar5 & 0x1f) |
            *(uint *)(unaff_ESI + 0x18);
    if (7 < (int)uVar5) {
      uVar6 = uVar5 >> 3;
      uVar5 = uVar5 + uVar6 * -8;
      do {
        **(undefined **)(unaff_ESI + 0x10) = (char)(uVar7 >> 0x10);
        *(int *)(unaff_ESI + 0x10) = *(int *)(unaff_ESI + 0x10) + 1;
        piVar1 = (int *)(unaff_ESI + 0x14);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 == 0) {
          puVar3 = *(undefined4 **)(*(int *)(unaff_ESI + 0x20) + 0x18);
          cVar4 = (*(code *)puVar3[3])(*(int *)(unaff_ESI + 0x20));
          if (cVar4 == '\0') {
            *(undefined4 *)(**(int **)(unaff_ESI + 0x20) + 0x14) = 0x18;
            (**(code **)**(undefined4 **)(unaff_ESI + 0x20))(*(undefined4 **)(unaff_ESI + 0x20));
          }
          *(undefined4 *)(unaff_ESI + 0x10) = *puVar3;
          *(undefined4 *)(unaff_ESI + 0x14) = puVar3[1];
        }
        if (((int)uVar7 >> 0x10 & 0xffU) == 0xff) {
          **(undefined **)(unaff_ESI + 0x10) = 0;
          *(int *)(unaff_ESI + 0x10) = *(int *)(unaff_ESI + 0x10) + 1;
          piVar1 = (int *)(unaff_ESI + 0x14);
          *piVar1 = *piVar1 + -1;
          if (*piVar1 == 0) {
            puVar3 = *(undefined4 **)(*(int *)(unaff_ESI + 0x20) + 0x18);
            cVar4 = (*(code *)puVar3[3])(*(int *)(unaff_ESI + 0x20));
            if (cVar4 == '\0') {
              *(undefined4 *)(**(int **)(unaff_ESI + 0x20) + 0x14) = 0x18;
              (**(code **)**(undefined4 **)(unaff_ESI + 0x20))(*(undefined4 **)(unaff_ESI + 0x20));
            }
            *(undefined4 *)(unaff_ESI + 0x10) = *puVar3;
            *(undefined4 *)(unaff_ESI + 0x14) = puVar3[1];
          }
        }
        uVar7 = uVar7 << 8;
        uVar6 = uVar6 - 1;
      } while (uVar6 != 0);
    }
    *(uint *)(unaff_ESI + 0x18) = uVar7;
    *(uint *)(unaff_ESI + 0x1c) = uVar5;
  }
  return;
}



int FUN_00432dc0(void)

{
  int *piVar1;
  int in_EAX;
  int iVar2;
  int iVar3;
  char *pcVar4;
  
  iVar2 = *(int *)(in_EAX + 0x38);
  if (iVar2 != 0) {
    iVar3 = 0;
    iVar2 = iVar2 >> 1;
    if (iVar2 != 0) {
      do {
        iVar3 = iVar3 + 1;
        iVar2 = iVar2 >> 1;
      } while (iVar2 != 0);
      if (0xe < iVar3) {
        *(undefined4 *)(**(int **)(in_EAX + 0x20) + 0x14) = 0x28;
        (**(code **)**(undefined4 **)(in_EAX + 0x20))(*(undefined4 **)(in_EAX + 0x20));
      }
    }
    if (*(char *)(in_EAX + 0xc) == '\0') {
      iVar2 = *(int *)(in_EAX + 0x4c + *(int *)(in_EAX + 0x34) * 4);
      iVar2 = FUN_00432c80(*(uint *)(iVar2 + iVar3 * 0x40),
                           (int)*(char *)(iVar2 + 0x400 + iVar3 * 0x10));
    }
    else {
      iVar2 = *(int *)(in_EAX + 0x5c + *(int *)(in_EAX + 0x34) * 4);
      piVar1 = (int *)(iVar2 + iVar3 * 0x40);
      *piVar1 = *piVar1 + 1;
      iVar2 = iVar2 + iVar3 * 0x40;
    }
    if (iVar3 != 0) {
      iVar2 = FUN_00432c80(*(uint *)(in_EAX + 0x38),iVar3);
    }
    iVar3 = *(int *)(in_EAX + 0x3c);
    pcVar4 = *(char **)(in_EAX + 0x40);
    *(undefined4 *)(in_EAX + 0x38) = 0;
    if (*(char *)(in_EAX + 0xc) == '\0') {
      for (; iVar3 != 0; iVar3 = iVar3 + -1) {
        iVar2 = FUN_00432c80((int)*pcVar4,1);
        pcVar4 = pcVar4 + 1;
      }
    }
    *(undefined4 *)(in_EAX + 0x3c) = 0;
  }
  return iVar2;
}



void __cdecl FUN_00432e80(char param_1)

{
  int *piVar1;
  char cVar2;
  int in_EAX;
  int iVar3;
  undefined4 *puVar4;
  
  FUN_00432dc0();
  if (*(char *)(in_EAX + 0xc) == '\0') {
    FUN_00432c80(0x7f,7);
    *(undefined4 *)(in_EAX + 0x18) = 0;
    *(undefined4 *)(in_EAX + 0x1c) = 0;
    **(undefined **)(in_EAX + 0x10) = 0xff;
    *(int *)(in_EAX + 0x10) = *(int *)(in_EAX + 0x10) + 1;
    piVar1 = (int *)(in_EAX + 0x14);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      puVar4 = *(undefined4 **)(*(int *)(in_EAX + 0x20) + 0x18);
      cVar2 = (*(code *)puVar4[3])(*(int *)(in_EAX + 0x20));
      if (cVar2 == '\0') {
        *(undefined4 *)(**(int **)(in_EAX + 0x20) + 0x14) = 0x18;
        (**(code **)**(undefined4 **)(in_EAX + 0x20))(*(undefined4 **)(in_EAX + 0x20));
      }
      *(undefined4 *)(in_EAX + 0x10) = *puVar4;
      *(undefined4 *)(in_EAX + 0x14) = puVar4[1];
    }
    **(char **)(in_EAX + 0x10) = param_1 + -0x30;
    *(int *)(in_EAX + 0x10) = *(int *)(in_EAX + 0x10) + 1;
    piVar1 = (int *)(in_EAX + 0x14);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      puVar4 = *(undefined4 **)(*(int *)(in_EAX + 0x20) + 0x18);
      cVar2 = (*(code *)puVar4[3])(*(int *)(in_EAX + 0x20));
      if (cVar2 == '\0') {
        *(undefined4 *)(**(int **)(in_EAX + 0x20) + 0x14) = 0x18;
        (**(code **)**(undefined4 **)(in_EAX + 0x20))(*(undefined4 **)(in_EAX + 0x20));
      }
      *(undefined4 *)(in_EAX + 0x10) = *puVar4;
      *(undefined4 *)(in_EAX + 0x14) = puVar4[1];
    }
  }
  if (*(int *)(*(int *)(in_EAX + 0x20) + 300) == 0) {
    iVar3 = 0;
    if (0 < *(int *)(*(int *)(in_EAX + 0x20) + 0xe4)) {
      puVar4 = (undefined4 *)(in_EAX + 0x24);
      do {
        *puVar4 = 0;
        iVar3 = iVar3 + 1;
        puVar4 = puVar4 + 1;
      } while (iVar3 < *(int *)(*(int *)(in_EAX + 0x20) + 0xe4));
      return;
    }
  }
  else {
    *(undefined4 *)(in_EAX + 0x38) = 0;
    *(undefined4 *)(in_EAX + 0x3c) = 0;
  }
  return;
}



undefined4 __cdecl FUN_00432f80(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  int local_c;
  int *local_8;
  byte local_4;
  
  piVar4 = param_1;
  iVar1 = param_1[0x57];
  iVar2 = param_1[0x4e];
  *(undefined4 *)(iVar1 + 0x10) = *(undefined4 *)param_1[6];
  *(undefined4 *)(iVar1 + 0x14) = *(undefined4 *)(param_1[6] + 4);
  if ((param_1[0x2f] != 0) && (*(int *)(iVar1 + 0x44) == 0)) {
    FUN_00432e80((char)*(undefined4 *)(iVar1 + 0x48));
  }
  local_c = 0;
  if (0 < param_1[0x40]) {
    local_8 = param_1 + 0x41;
    do {
      iVar7 = *local_8;
      local_4 = (byte)iVar2;
      iVar3 = piVar4[iVar7 + 0x3a];
      iVar6 = (int)**(short **)(param_2 + local_c * 4) >> (local_4 & 0x1f);
      param_1 = (int *)(iVar6 - *(int *)(iVar1 + 0x24 + iVar7 * 4));
      *(int *)(iVar1 + 0x24 + iVar7 * 4) = iVar6;
      piVar5 = param_1;
      if ((int)param_1 < 0) {
        piVar5 = (int *)-(int)param_1;
        param_1 = (int *)((int)param_1 + -1);
      }
      iVar7 = 0;
      if (piVar5 != (int *)0x0) {
        iVar7 = 0;
        do {
          iVar7 = iVar7 + 1;
          piVar5 = (int *)((int)piVar5 >> 1);
        } while (piVar5 != (int *)0x0);
        if (0xb < iVar7) {
          *(undefined4 *)(*piVar4 + 0x14) = 6;
          (**(code **)*piVar4)(piVar4);
        }
      }
      if (*(char *)(iVar1 + 0xc) == '\0') {
        iVar3 = *(int *)(iVar1 + 0x4c + *(int *)(iVar3 + 0x14) * 4);
        FUN_00432c80(*(uint *)(iVar3 + iVar7 * 4),(int)*(char *)(iVar3 + 0x400 + iVar7));
      }
      else {
        piVar5 = (int *)(*(int *)(iVar1 + 0x5c + *(int *)(iVar3 + 0x14) * 4) + iVar7 * 4);
        *piVar5 = *piVar5 + 1;
      }
      if (iVar7 != 0) {
        FUN_00432c80((uint)param_1,iVar7);
      }
      local_8 = local_8 + 1;
      local_c = local_c + 1;
    } while (local_c < piVar4[0x40]);
  }
  *(undefined4 *)piVar4[6] = *(undefined4 *)(iVar1 + 0x10);
  iVar2 = piVar4[6];
  *(undefined4 *)(iVar2 + 4) = *(undefined4 *)(iVar1 + 0x14);
  if (piVar4[0x2f] != 0) {
    if (*(int *)(iVar1 + 0x44) == 0) {
      *(int *)(iVar1 + 0x44) = piVar4[0x2f];
      *(uint *)(iVar1 + 0x48) = *(int *)(iVar1 + 0x48) + 1U & 7;
    }
    *(int *)(iVar1 + 0x44) = *(int *)(iVar1 + 0x44) + -1;
  }
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}



undefined4 __cdecl FUN_004330f0(int *param_1,int *param_2)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  int *piVar10;
  int iVar11;
  
  iVar2 = param_1[0x4e];
  iVar3 = param_1[0x57];
  iVar4 = param_1[0x4c];
  *(undefined4 *)(iVar3 + 0x10) = *(undefined4 *)param_1[6];
  *(undefined4 *)(iVar3 + 0x14) = *(undefined4 *)(param_1[6] + 4);
  if ((param_1[0x2f] != 0) && (*(int *)(iVar3 + 0x44) == 0)) {
    FUN_00432e80((char)*(undefined4 *)(iVar3 + 0x48));
  }
  iVar5 = *param_2;
  iVar6 = param_1[0x4b];
  iVar8 = 0;
  if (iVar6 <= iVar4) {
    do {
      iVar9 = (int)*(short *)(iVar5 + (&DAT_0043fd78)[iVar6] * 2);
      if (iVar9 == 0) {
        iVar8 = iVar8 + 1;
      }
      else {
        if (iVar9 < 0) {
          piVar10 = (int *)(-iVar9 >> ((byte)iVar2 & 0x1f));
          param_2 = (int *)~(uint)piVar10;
        }
        else {
          piVar10 = (int *)(iVar9 >> ((byte)iVar2 & 0x1f));
          param_2 = piVar10;
        }
        if (piVar10 == (int *)0x0) {
          iVar8 = iVar8 + 1;
        }
        else {
          if (*(int *)(iVar3 + 0x38) != 0) {
            FUN_00432dc0();
          }
          if (0xf < iVar8) {
            iVar9 = (iVar8 - 0x10U >> 4) + 1;
            iVar8 = iVar8 + iVar9 * -0x10;
            do {
              if (*(char *)(iVar3 + 0xc) == '\0') {
                iVar11 = *(int *)(iVar3 + 0x4c + *(int *)(iVar3 + 0x34) * 4);
                FUN_00432c80(*(uint *)(iVar11 + 0x3c0),(int)*(char *)(iVar11 + 0x4f0));
              }
              else {
                piVar1 = (int *)(*(int *)(iVar3 + 0x5c + *(int *)(iVar3 + 0x34) * 4) + 0x3c0);
                *piVar1 = *piVar1 + 1;
              }
              iVar9 = iVar9 + -1;
            } while (iVar9 != 0);
          }
          iVar11 = (int)piVar10 >> 1;
          iVar9 = 1;
          if (iVar11 != 0) {
            do {
              iVar9 = iVar9 + 1;
              iVar11 = iVar11 >> 1;
            } while (iVar11 != 0);
            if (10 < iVar9) {
              *(undefined4 *)(*param_1 + 0x14) = 6;
              (**(code **)*param_1)(param_1);
            }
          }
          iVar8 = iVar8 * 0x10 + iVar9;
          if (*(char *)(iVar3 + 0xc) == '\0') {
            iVar11 = *(int *)(iVar3 + 0x4c + *(int *)(iVar3 + 0x34) * 4);
            FUN_00432c80(*(uint *)(iVar11 + iVar8 * 4),(int)*(char *)(iVar11 + 0x400 + iVar8));
          }
          else {
            piVar10 = (int *)(*(int *)(iVar3 + 0x5c + *(int *)(iVar3 + 0x34) * 4) + iVar8 * 4);
            *piVar10 = *piVar10 + 1;
          }
          FUN_00432c80((uint)param_2,iVar9);
          iVar8 = 0;
        }
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 <= iVar4);
    if ((0 < iVar8) &&
       (*(int *)(iVar3 + 0x38) = *(int *)(iVar3 + 0x38) + 1, *(int *)(iVar3 + 0x38) == 0x7fff)) {
      FUN_00432dc0();
    }
  }
  uVar7 = *(uint *)(iVar3 + 0x10);
  *(uint *)param_1[6] = uVar7;
  *(undefined4 *)(param_1[6] + 4) = *(undefined4 *)(iVar3 + 0x14);
  if (param_1[0x2f] != 0) {
    if (*(int *)(iVar3 + 0x44) == 0) {
      uVar7 = *(int *)(iVar3 + 0x48) + 1U & 7;
      *(int *)(iVar3 + 0x44) = param_1[0x2f];
      *(uint *)(iVar3 + 0x48) = uVar7;
    }
    *(int *)(iVar3 + 0x44) = *(int *)(iVar3 + 0x44) + -1;
  }
  return CONCAT31((int3)(uVar7 >> 8),1);
}



void __cdecl FUN_00433680(int *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *local_10;
  int local_c;
  undefined4 local_8;
  int local_4;
  
  local_4 = param_1[0x57];
  FUN_00432dc0();
  iVar1 = param_1[0x4b];
  local_8 = 0;
  local_c = 0;
  if (0 < param_1[0x39]) {
    local_10 = param_1 + 0x3a;
    do {
      if (iVar1 != 0) {
        iVar3 = *(int *)(*local_10 + 0x18);
LAB_004336e2:
        if (*(char *)((int)&local_8 + iVar3) == '\0') {
          iVar2 = iVar3 + 0x16;
          if (iVar1 != 0) {
            iVar2 = iVar3 + 0x1a;
          }
          piVar4 = param_1 + iVar2;
          if (*piVar4 == 0) {
            iVar2 = (**(code **)param_1[1])(param_1,0,0x112);
            *(undefined *)(iVar2 + 0x111) = 0;
            *piVar4 = iVar2;
          }
          FUN_00434230(*piVar4,*(int *)(local_4 + 0x5c + iVar3 * 4),param_1);
          *(undefined *)((int)&local_8 + iVar3) = 1;
        }
      }
      else if (param_1[0x4d] == 0) {
        iVar3 = *(int *)(*local_10 + 0x14);
        goto LAB_004336e2;
      }
      local_10 = local_10 + 1;
      local_c = local_c + 1;
    } while (local_c < param_1[0x39]);
  }
  return;
}



void __cdecl FUN_00433760(int *param_1,char param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  undefined4 uVar5;
  int local_8;
  undefined4 *local_4;
  
  piVar4 = param_1;
  iVar1 = param_1[0x57];
  if (param_2 == '\0') {
    *(code **)(iVar1 + 4) = FUN_00433e30;
    *(code **)(iVar1 + 8) = FUN_00433fa0;
  }
  else {
    *(undefined **)(iVar1 + 4) = &LAB_00434160;
    *(code **)(iVar1 + 8) = FUN_00434510;
  }
  local_8 = 0;
  if (0 < param_1[0x39]) {
    local_4 = (undefined4 *)(iVar1 + 0x14);
    param_1 = param_1 + 0x3a;
    do {
      iVar2 = *(int *)(*param_1 + 0x14);
      iVar3 = *(int *)(*param_1 + 0x18);
      if (param_2 == '\0') {
        FUN_004338f0(iVar2,(int *)(iVar1 + 0x2c + iVar2 * 4),'\x01');
        FUN_004338f0(iVar3,(int *)(iVar1 + 0x3c + iVar3 * 4),'\0');
      }
      else {
        if ((iVar2 < 0) || (3 < iVar2)) {
          *(undefined4 *)(*piVar4 + 0x14) = 0x32;
          *(int *)(*piVar4 + 0x18) = iVar2;
          (**(code **)*piVar4)(piVar4);
        }
        if ((iVar3 < 0) || (3 < iVar3)) {
          *(undefined4 *)(*piVar4 + 0x14) = 0x32;
          *(int *)(*piVar4 + 0x18) = iVar3;
          (**(code **)*piVar4)(piVar4);
        }
        if (*(int *)(iVar1 + 0x4c + iVar2 * 4) == 0) {
          uVar5 = (**(code **)piVar4[1])(piVar4,1,0x404);
          *(undefined4 *)(iVar1 + 0x4c + iVar2 * 4) = uVar5;
        }
        memset(*(void **)(iVar1 + 0x4c + iVar2 * 4),0,0x404);
        if (*(int *)(iVar1 + 0x5c + iVar3 * 4) == 0) {
          uVar5 = (**(code **)piVar4[1])(piVar4,1,0x404);
          *(undefined4 *)(iVar1 + 0x5c + iVar3 * 4) = uVar5;
        }
        memset(*(void **)(iVar1 + 0x5c + iVar3 * 4),0,0x404);
      }
      param_1 = param_1 + 1;
      *local_4 = 0;
      local_8 = local_8 + 1;
      local_4 = local_4 + 1;
    } while (local_8 < piVar4[0x39]);
  }
  *(undefined4 *)(iVar1 + 0xc) = 0;
  *(undefined4 *)(iVar1 + 0x10) = 0;
  *(int *)(iVar1 + 0x24) = piVar4[0x2f];
  *(undefined4 *)(iVar1 + 0x28) = 0;
  return;
}



void __fastcall FUN_004338f0(int param_1,int *param_2,char param_3)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  char *pcVar4;
  int *unaff_EBX;
  int iVar5;
  void *_Dst;
  uint uVar6;
  int iVar7;
  int iVar8;
  int iStack_51c;
  int iStack_518;
  int iStack_514;
  int iStack_510;
  int aiStack_50c [257];
  char acStack_108 [260];
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&iStack_51c;
  if ((param_1 < 0) || (3 < param_1)) {
    *(undefined4 *)(*unaff_EBX + 0x14) = 0x32;
    *(int *)(*unaff_EBX + 0x18) = param_1;
    (**(code **)*unaff_EBX)();
  }
  if (param_3 == '\0') {
    iStack_51c = unaff_EBX[param_1 + 0x1a];
  }
  else {
    iStack_51c = unaff_EBX[param_1 + 0x16];
  }
  if (iStack_51c == 0) {
    *(undefined4 *)(*unaff_EBX + 0x14) = 0x32;
    *(int *)(*unaff_EBX + 0x18) = param_1;
    (**(code **)*unaff_EBX)();
  }
  if (*param_2 == 0) {
    iVar3 = (**(code **)unaff_EBX[1])();
    *param_2 = iVar3;
  }
  iStack_514 = *param_2;
  iVar8 = 0;
  iVar3 = 1;
  do {
    uVar6 = (uint)*(byte *)(iStack_51c + iVar3);
    if (0x100 < (int)(uVar6 + iVar8)) {
      *(undefined4 *)(*unaff_EBX + 0x14) = 8;
      (**(code **)*unaff_EBX)();
    }
    if (uVar6 != 0) {
      memset(acStack_108 + iVar8,iVar3,uVar6);
      iVar8 = iVar8 + uVar6;
    }
    iVar3 = iVar3 + 1;
  } while (iVar3 < 0x11);
  acStack_108[iVar8] = '\0';
  iVar3 = 0;
  iVar7 = 0;
  iVar5 = (int)acStack_108[0];
  iStack_518 = iVar8;
  if (acStack_108[0] != '\0') {
    pcVar4 = acStack_108;
    do {
      cVar2 = *pcVar4;
      while (cVar2 == iVar5) {
        cVar2 = acStack_108[iVar7 + 1];
        aiStack_50c[iVar7] = iVar3;
        iVar7 = iVar7 + 1;
        iVar3 = iVar3 + 1;
      }
      if (1 << ((byte)iVar5 & 0x1f) <= iVar3) {
        *(undefined4 *)(*unaff_EBX + 0x14) = 8;
        (**(code **)*unaff_EBX)();
      }
      pcVar4 = acStack_108 + iVar7;
      iVar3 = iVar3 * 2;
      iVar5 = iVar5 + 1;
    } while (*pcVar4 != '\0');
  }
  _Dst = (void *)(iStack_514 + 0x400);
  memset(_Dst,0,0x100);
  iStack_510 = (-(uint)(param_3 != '\0') & 0xffffff10) + 0xff;
  iVar3 = 0;
  if (0 < iStack_518) {
    do {
      uVar6 = (uint)*(byte *)(iStack_51c + 0x11 + iVar3);
      if ((iStack_510 < (int)uVar6) || (*(char *)(uVar6 + (int)_Dst) != '\0')) {
        *(undefined4 *)(*unaff_EBX + 0x14) = 8;
        (**(code **)*unaff_EBX)();
      }
      piVar1 = aiStack_50c + iVar3;
      cVar2 = acStack_108[iVar3];
      iVar3 = iVar3 + 1;
      *(int *)(iStack_514 + uVar6 * 4) = *piVar1;
      *(char *)(uVar6 + (int)_Dst) = cVar2;
    } while (iVar3 < iStack_518);
  }
  ___security_check_cookie_4(local_4 ^ (uint)&iStack_51c);
  return;
}



undefined4 __cdecl FUN_00433b00(uint param_1)

{
  int iVar1;
  int *piVar2;
  undefined *in_EAX;
  undefined *puVar3;
  uint uVar4;
  undefined *puVar5;
  int *unaff_ESI;
  uint uVar6;
  
  iVar1 = unaff_ESI[3];
  puVar3 = in_EAX;
  if (in_EAX == (undefined *)0x0) {
    piVar2 = (int *)unaff_ESI[8];
    *(undefined4 *)(*piVar2 + 0x14) = 0x28;
    puVar3 = (undefined *)(**(code **)*piVar2)(piVar2);
  }
  puVar5 = in_EAX + iVar1;
  uVar6 = ((1 << ((byte)in_EAX & 0x1f)) - 1U & param_1) << (0x18U - (char)puVar5 & 0x1f) |
          unaff_ESI[2];
  do {
    if ((int)puVar5 < 8) {
      unaff_ESI[2] = uVar6;
      unaff_ESI[3] = (int)puVar5;
      return CONCAT31((int3)((uint)puVar3 >> 8),1);
    }
    puVar3 = (undefined *)*unaff_ESI;
    *puVar3 = (char)(uVar6 >> 0x10);
    puVar3 = puVar3 + 1;
    piVar2 = unaff_ESI + 1;
    *piVar2 = *piVar2 + -1;
    *unaff_ESI = (int)puVar3;
    if (*piVar2 == 0) {
      piVar2 = *(int **)(unaff_ESI[8] + 0x18);
      uVar4 = (*(code *)piVar2[3])(unaff_ESI[8]);
      if ((char)uVar4 == '\0') goto LAB_00433bdd;
      puVar3 = (undefined *)piVar2[1];
      *unaff_ESI = *piVar2;
      unaff_ESI[1] = (int)puVar3;
    }
    if (((int)uVar6 >> 0x10 & 0xffU) == 0xff) {
      puVar3 = (undefined *)*unaff_ESI;
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
      piVar2 = unaff_ESI + 1;
      *piVar2 = *piVar2 + -1;
      *unaff_ESI = (int)puVar3;
      if (*piVar2 == 0) {
        piVar2 = *(int **)(unaff_ESI[8] + 0x18);
        uVar4 = (*(code *)piVar2[3])(unaff_ESI[8]);
        if ((char)uVar4 == '\0') {
LAB_00433bdd:
          return uVar4 & 0xffffff00;
        }
        puVar3 = (undefined *)piVar2[1];
        *unaff_ESI = *piVar2;
        unaff_ESI[1] = (int)puVar3;
      }
    }
    puVar5 = puVar5 + -8;
    uVar6 = uVar6 << 8;
  } while( true );
}



uint __cdecl FUN_00433bf0(short *param_1,int *param_2,uint param_3,uint *param_4)

{
  int in_EAX;
  uint uVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  
  uVar6 = (int)*param_1 - (int)param_2;
  uVar1 = uVar6;
  if ((int)uVar6 < 0) {
    uVar1 = -uVar6;
    uVar6 = uVar6 - 1;
  }
  iVar3 = 0;
  if (uVar1 != 0) {
    do {
      iVar3 = iVar3 + 1;
      uVar1 = (int)uVar1 >> 1;
    } while (uVar1 != 0);
    if (0xb < iVar3) {
      piVar2 = *(int **)(in_EAX + 0x20);
      *(undefined4 *)(*piVar2 + 0x14) = 6;
      (**(code **)*piVar2)(piVar2);
    }
  }
  piVar2 = (int *)FUN_00433b00(*(uint *)(param_3 + iVar3 * 4));
  if (((char)piVar2 != '\0') &&
     ((iVar3 == 0 || (piVar2 = (int *)FUN_00433b00(uVar6), (char)piVar2 != '\0')))) {
    iVar3 = 0;
    param_2 = &DAT_0043fd7c;
    do {
      param_3 = (uint)param_1[*param_2];
      if (param_3 == 0) {
        iVar3 = iVar3 + 1;
      }
      else {
        for (; 0xf < iVar3; iVar3 = iVar3 + -0x10) {
          piVar2 = (int *)FUN_00433b00(param_4[0xf0]);
          if ((char)piVar2 == '\0') goto LAB_00433c4f;
        }
        uVar1 = param_3;
        if ((int)param_3 < 0) {
          uVar1 = -param_3;
          param_3 = param_3 - 1;
        }
        iVar4 = (int)uVar1 >> 1;
        iVar5 = 1;
        if (iVar4 != 0) {
          do {
            iVar5 = iVar5 + 1;
            iVar4 = iVar4 >> 1;
          } while (iVar4 != 0);
          if (10 < iVar5) {
            piVar2 = *(int **)(in_EAX + 0x20);
            *(undefined4 *)(*piVar2 + 0x14) = 6;
            (**(code **)*piVar2)(piVar2);
          }
        }
        piVar2 = (int *)FUN_00433b00(param_4[iVar3 * 0x10 + iVar5]);
        if (((char)piVar2 == '\0') || (piVar2 = (int *)FUN_00433b00(param_3), (char)piVar2 == '\0'))
        goto LAB_00433c4f;
        iVar3 = 0;
      }
      piVar2 = param_2 + 1;
      param_2 = piVar2;
    } while ((int)piVar2 < 0x43fe78);
    if ((iVar3 < 1) || (piVar2 = (int *)FUN_00433b00(*param_4), (char)piVar2 != '\0')) {
      return CONCAT31((int3)((uint)piVar2 >> 8),1);
    }
  }
LAB_00433c4f:
  return (uint)piVar2 & 0xffffff00;
}



uint __cdecl FUN_00433d70(char param_1)

{
  char *pcVar1;
  char **in_EAX;
  uint uVar2;
  int iVar3;
  char **ppcVar4;
  
  uVar2 = FUN_00433b00(0x7f);
  if ((char)uVar2 == '\0') {
    return uVar2 & 0xffffff00;
  }
  in_EAX[2] = (char *)0x0;
  in_EAX[3] = (char *)0x0;
  pcVar1 = *in_EAX;
  *pcVar1 = -1;
  ppcVar4 = in_EAX + 1;
  *ppcVar4 = *ppcVar4 + -1;
  *in_EAX = pcVar1 + 1;
  if (*ppcVar4 == (char *)0x0) {
    ppcVar4 = *(char ***)(in_EAX[8] + 0x18);
    uVar2 = (*(code *)ppcVar4[3])(in_EAX[8]);
    if ((char)uVar2 == '\0') goto LAB_00433e26;
    pcVar1 = ppcVar4[1];
    *in_EAX = *ppcVar4;
    in_EAX[1] = pcVar1;
  }
  pcVar1 = *in_EAX;
  *pcVar1 = param_1 + -0x30;
  ppcVar4 = in_EAX + 1;
  *ppcVar4 = *ppcVar4 + -1;
  *in_EAX = pcVar1 + 1;
  if (*ppcVar4 == (char *)0x0) {
    ppcVar4 = *(char ***)(in_EAX[8] + 0x18);
    uVar2 = (*(code *)ppcVar4[3])(in_EAX[8]);
    if ((char)uVar2 == '\0') {
LAB_00433e26:
      return uVar2 & 0xffffff00;
    }
    pcVar1 = ppcVar4[1];
    *in_EAX = *ppcVar4;
    in_EAX[1] = pcVar1;
  }
  iVar3 = 0;
  if (0 < *(int *)(in_EAX[8] + 0xe4)) {
    ppcVar4 = in_EAX + 4;
    do {
      *ppcVar4 = (char *)0x0;
      iVar3 = iVar3 + 1;
      ppcVar4 = ppcVar4 + 1;
    } while (iVar3 < *(int *)(in_EAX[8] + 0xe4));
  }
  return CONCAT31((int3)((uint)iVar3 >> 8),1);
}



uint __cdecl FUN_00433e30(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  int iVar8;
  int *piVar9;
  uint uVar10;
  int iVar11;
  int *local_14;
  uint local_10;
  undefined4 local_c;
  undefined4 local_8;
  int *local_4;
  
  piVar9 = param_1;
  iVar3 = param_1[0x57];
  uVar4 = *(undefined4 *)param_1[6];
  uVar5 = ((undefined4 *)param_1[6])[1];
  uVar6 = *(undefined4 *)(iVar3 + 0xc);
  uVar7 = *(undefined4 *)(iVar3 + 0x10);
  local_14 = *(int **)(iVar3 + 0x14);
  local_10 = *(uint *)(iVar3 + 0x18);
  local_c = *(undefined4 *)(iVar3 + 0x1c);
  local_8 = *(undefined4 *)(iVar3 + 0x20);
  local_4 = param_1;
  if ((param_1[0x2f] != 0) && (*(int *)(iVar3 + 0x24) == 0)) {
    uVar10 = FUN_00433d70((char)*(undefined4 *)(iVar3 + 0x28));
    if ((char)uVar10 == '\0') {
      return uVar10;
    }
  }
  iVar11 = 0;
  if (0 < param_1[0x40]) {
    param_1 = param_1 + 0x41;
    do {
      iVar8 = *param_1;
      uVar10 = FUN_00433bf0(*(short **)(param_2 + iVar11 * 4),(&local_14)[iVar8],
                            *(uint *)(iVar3 + 0x2c + *(int *)(piVar9[iVar8 + 0x3a] + 0x14) * 4),
                            *(uint **)(iVar3 + 0x3c + *(int *)(piVar9[iVar8 + 0x3a] + 0x18) * 4));
      if ((char)uVar10 == '\0') {
        return uVar10 & 0xffffff00;
      }
      iVar1 = iVar11 * 4;
      param_1 = param_1 + 1;
      iVar11 = iVar11 + 1;
      iVar2 = piVar9[0x40];
      (&local_14)[iVar8] = (int *)(int)**(short **)(param_2 + iVar1);
    } while (iVar11 < iVar2);
  }
  *(undefined4 *)piVar9[6] = uVar4;
  *(undefined4 *)(piVar9[6] + 4) = uVar5;
  *(undefined4 *)(iVar3 + 0xc) = uVar6;
  *(undefined4 *)(iVar3 + 0x10) = uVar7;
  *(int **)(iVar3 + 0x14) = local_14;
  *(uint *)(iVar3 + 0x18) = local_10;
  *(undefined4 *)(iVar3 + 0x1c) = local_c;
  *(undefined4 *)(iVar3 + 0x20) = local_8;
  if (piVar9[0x2f] != 0) {
    if (*(int *)(iVar3 + 0x24) == 0) {
      local_10 = *(int *)(iVar3 + 0x28) + 1U & 7;
      *(int *)(iVar3 + 0x24) = piVar9[0x2f];
      *(uint *)(iVar3 + 0x28) = local_10;
    }
    *(int *)(iVar3 + 0x24) = *(int *)(iVar3 + 0x24) + -1;
  }
  return CONCAT31((int3)(local_10 >> 8),1);
}



void __cdecl FUN_00433fa0(int *param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  
  uVar1 = *(undefined4 *)param_1[6];
  uVar2 = ((undefined4 *)param_1[6])[1];
  iVar3 = param_1[0x57];
  uVar10 = *(undefined4 *)(iVar3 + 0xc);
  uVar9 = *(undefined4 *)(iVar3 + 0x10);
  uVar4 = *(undefined4 *)(iVar3 + 0x14);
  uVar5 = *(undefined4 *)(iVar3 + 0x18);
  uVar6 = *(undefined4 *)(iVar3 + 0x1c);
  uVar7 = *(undefined4 *)(iVar3 + 0x20);
  uVar8 = FUN_00433b00(0x7f);
  if ((char)uVar8 == '\0') {
    *(undefined4 *)(*param_1 + 0x14) = 0x18;
    (**(code **)*param_1)(param_1);
  }
  else {
    uVar10 = 0;
    uVar9 = 0;
  }
  *(undefined4 *)param_1[6] = uVar1;
  *(undefined4 *)(param_1[6] + 4) = uVar2;
  *(undefined4 *)(iVar3 + 0xc) = uVar10;
  *(undefined4 *)(iVar3 + 0x10) = uVar9;
  *(undefined4 *)(iVar3 + 0x14) = uVar4;
  *(undefined4 *)(iVar3 + 0x18) = uVar5;
  *(undefined4 *)(iVar3 + 0x1c) = uVar6;
  *(undefined4 *)(iVar3 + 0x20) = uVar7;
  return;
}



int * __cdecl FUN_00434070(int *param_1,short *param_2,int param_3)

{
  int in_EAX;
  int *piVar1;
  int iVar2;
  int iVar3;
  int *unaff_EBX;
  int *piVar4;
  int iVar5;
  
  piVar1 = (int *)(*param_2 - param_3);
  if ((int)piVar1 < 0) {
    piVar1 = (int *)-(int)piVar1;
  }
  iVar5 = 0;
  if (piVar1 != (int *)0x0) {
    do {
      iVar5 = iVar5 + 1;
      piVar1 = (int *)((int)piVar1 >> 1);
    } while (piVar1 != (int *)0x0);
    piVar1 = (int *)0x0;
    if (0xb < iVar5) {
      *(undefined4 *)(*param_1 + 0x14) = 6;
      piVar1 = (int *)(**(code **)*param_1)(param_1);
    }
  }
  piVar4 = (int *)(in_EAX + iVar5 * 4);
  *piVar4 = *piVar4 + 1;
  iVar5 = 0;
  piVar4 = &DAT_0043fd7c;
  do {
    iVar3 = (int)param_2[*piVar4];
    if (iVar3 == 0) {
      iVar5 = iVar5 + 1;
    }
    else {
      if (0xf < iVar5) {
        iVar2 = (iVar5 - 0x10U >> 4) + 1;
        iVar5 = iVar5 + iVar2 * -0x10;
        unaff_EBX[0xf0] = unaff_EBX[0xf0] + iVar2;
      }
      if (iVar3 < 0) {
        iVar3 = -iVar3;
      }
      iVar3 = iVar3 >> 1;
      iVar2 = 1;
      if (iVar3 != 0) {
        do {
          iVar2 = iVar2 + 1;
          iVar3 = iVar3 >> 1;
        } while (iVar3 != 0);
        if (10 < iVar2) {
          *(undefined4 *)(*param_1 + 0x14) = 6;
          (**(code **)*param_1)(param_1);
        }
      }
      iVar2 = iVar5 * 0x10 + iVar2;
      unaff_EBX[iVar2] = unaff_EBX[iVar2] + 1;
      piVar1 = unaff_EBX + iVar2;
      iVar5 = 0;
    }
    piVar4 = piVar4 + 1;
  } while ((int)piVar4 < 0x43fe78);
  if (0 < iVar5) {
    *unaff_EBX = *unaff_EBX + 1;
  }
  return piVar1;
}



void __fastcall FUN_00434230(undefined4 *param_1,int param_2,int *param_3)

{
  char *pcVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int *piVar8;
  undefined4 *local_838;
  int *local_834;
  int local_830 [257];
  int local_42c [256];
  char cStack_29;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined local_8;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_838;
  local_834 = param_3;
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  local_838 = param_1;
  memset(local_830,0,0x404);
  piVar8 = local_42c;
  for (iVar4 = 0x101; iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar8 = -1;
    piVar8 = piVar8 + 1;
  }
  *(undefined4 *)(param_2 + 0x400) = 1;
  while( true ) {
    iVar4 = -1;
    iVar7 = 1000000000;
    iVar5 = 0;
    do {
      iVar6 = *(int *)(param_2 + iVar5 * 4);
      if ((iVar6 != 0) && (iVar6 <= iVar7)) {
        iVar4 = iVar5;
        iVar7 = iVar6;
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 < 0x101);
    iVar7 = -1;
    iVar5 = 1000000000;
    iVar6 = 0;
    do {
      iVar3 = *(int *)(param_2 + iVar6 * 4);
      if (((iVar3 != 0) && (iVar3 <= iVar5)) && (iVar6 != iVar4)) {
        iVar7 = iVar6;
        iVar5 = iVar3;
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 < 0x101);
    if (iVar7 < 0) break;
    piVar8 = (int *)(param_2 + iVar4 * 4);
    *piVar8 = *piVar8 + *(int *)(param_2 + iVar7 * 4);
    local_830[iVar4] = local_830[iVar4] + 1;
    iVar5 = local_42c[iVar4];
    piVar8 = local_42c + iVar4;
    *(undefined4 *)(param_2 + iVar7 * 4) = 0;
    while (-1 < iVar5) {
      iVar4 = *piVar8;
      local_830[iVar4] = local_830[iVar4] + 1;
      piVar8 = local_42c + iVar4;
      iVar5 = local_42c[iVar4];
    }
    local_830[iVar7] = local_830[iVar7] + 1;
    local_42c[iVar4] = iVar7;
    piVar8 = local_42c + iVar7;
    for (iVar4 = local_42c[iVar7]; -1 < iVar4; iVar4 = local_42c[iVar4]) {
      iVar4 = *piVar8;
      local_830[iVar4] = local_830[iVar4] + 1;
      piVar8 = local_42c + iVar4;
    }
  }
  iVar4 = 0;
  do {
    iVar7 = local_830[iVar4];
    if (iVar7 != 0) {
      if (0x20 < iVar7) {
        *(undefined4 *)(*local_834 + 0x14) = 0x27;
        (**(code **)*local_834)(local_834);
      }
      *(char *)((int)&local_28 + iVar7) = *(char *)((int)&local_28 + iVar7) + '\x01';
    }
    iVar4 = iVar4 + 1;
  } while (iVar4 < 0x101);
  iVar7 = 0x10;
  iVar4 = 0x1e;
  do {
    cVar2 = *(char *)((int)&local_28 + iVar4 + 2);
    while (cVar2 != '\0') {
      cVar2 = *(char *)((int)&local_28 + iVar4);
      iVar5 = iVar4;
      while (cVar2 == '\0') {
        cVar2 = (&cStack_29)[iVar5];
        iVar5 = iVar5 + -1;
      }
      pcVar1 = (char *)((int)&local_28 + iVar4 + 2);
      *pcVar1 = *pcVar1 + -2;
      pcVar1 = (char *)((int)&local_28 + iVar4 + 1);
      *pcVar1 = *pcVar1 + '\x01';
      pcVar1 = (char *)((int)&local_28 + iVar5 + 1);
      *pcVar1 = *pcVar1 + '\x02';
      *(char *)((int)&local_28 + iVar5) = *(char *)((int)&local_28 + iVar5) + -1;
      cVar2 = *(char *)((int)&local_28 + iVar4 + 2);
    }
    iVar4 = iVar4 + -1;
    iVar7 = iVar7 + -1;
  } while (iVar7 != 0);
  iVar4 = 0x10;
  cVar2 = (char)local_18;
  while (cVar2 == '\0') {
    cVar2 = (&cStack_29)[iVar4];
    iVar4 = iVar4 + -1;
  }
  *(char *)((int)&local_28 + iVar4) = *(char *)((int)&local_28 + iVar4) + -1;
  *local_838 = local_28;
  local_838[1] = local_24;
  local_838[2] = local_20;
  local_838[3] = local_1c;
  *(char *)(local_838 + 4) = (char)local_18;
  iVar4 = 0;
  iVar7 = 1;
  do {
    iVar5 = 0;
    do {
      if (local_830[iVar5] == iVar7) {
        *(char *)((int)local_838 + iVar4 + 0x11) = (char)iVar5;
        iVar4 = iVar4 + 1;
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 < 0x100);
    iVar7 = iVar7 + 1;
  } while (iVar7 < 0x21);
  *(undefined *)((int)local_838 + 0x111) = 0;
  ___security_check_cookie_4(local_4 ^ (uint)&local_838);
  return;
}



void __cdecl FUN_00434510(int *param_1)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  piVar3 = param_1;
  iVar1 = param_1[0x57];
  local_8 = 0;
  local_4 = 0;
  local_c = 0;
  if (0 < param_1[0x39]) {
    param_1 = param_1 + 0x3a;
    do {
      iVar5 = *(int *)(*param_1 + 0x14);
      iVar2 = *(int *)(*param_1 + 0x18);
      if (*(char *)((int)&local_8 + iVar5) == '\0') {
        if (piVar3[iVar5 + 0x16] == 0) {
          iVar4 = (**(code **)piVar3[1])(piVar3,0,0x112);
          *(undefined *)(iVar4 + 0x111) = 0;
          piVar3[iVar5 + 0x16] = iVar4;
        }
        FUN_00434230(piVar3[iVar5 + 0x16],*(int *)(iVar1 + 0x4c + iVar5 * 4),piVar3);
        *(undefined *)((int)&local_8 + iVar5) = 1;
      }
      if (*(char *)((int)&local_4 + iVar2) == '\0') {
        if (piVar3[iVar2 + 0x1a] == 0) {
          iVar5 = (**(code **)piVar3[1])(piVar3,0,0x112);
          *(undefined *)(iVar5 + 0x111) = 0;
          piVar3[iVar2 + 0x1a] = iVar5;
        }
        FUN_00434230(piVar3[iVar2 + 0x1a],*(int *)(iVar1 + 0x5c + iVar2 * 4),piVar3);
        *(undefined *)((int)&local_4 + iVar2) = 1;
      }
      param_1 = param_1 + 1;
      local_c = local_c + 1;
    } while (local_c < piVar3[0x39]);
  }
  return;
}



void FUN_00434610(void)

{
  code **ppcVar1;
  int unaff_ESI;
  
  ppcVar1 = (code **)(***(code ***)(unaff_ESI + 4))();
  *(code ***)(unaff_ESI + 0x15c) = ppcVar1;
  *ppcVar1 = FUN_00433760;
  ppcVar1[0xf] = (code *)0x0;
  ppcVar1[0xb] = (code *)0x0;
  ppcVar1[0x17] = (code *)0x0;
  ppcVar1[0x13] = (code *)0x0;
  ppcVar1[0x10] = (code *)0x0;
  ppcVar1[0xc] = (code *)0x0;
  ppcVar1[0x18] = (code *)0x0;
  ppcVar1[0x14] = (code *)0x0;
  ppcVar1[0x11] = (code *)0x0;
  ppcVar1[0xd] = (code *)0x0;
  ppcVar1[0x19] = (code *)0x0;
  ppcVar1[0x15] = (code *)0x0;
  ppcVar1[0x12] = (code *)0x0;
  ppcVar1[0xe] = (code *)0x0;
  ppcVar1[0x1a] = (code *)0x0;
  ppcVar1[0x16] = (code *)0x0;
  return;
}



void __cdecl FUN_00434980(int param_1,int param_2,int param_3,int *param_4,int param_5)

{
  undefined uVar1;
  int iVar2;
  short *psVar3;
  int *piVar4;
  int iVar5;
  undefined *puVar6;
  int iVar7;
  int *piVar8;
  bool bVar9;
  int local_40 [7];
  int local_24;
  int local_20 [7];
  int local_4;
  
  piVar4 = *(int **)(param_2 + 0x50);
  iVar2 = *(int *)(param_1 + 0x120) + 0x80;
  psVar3 = (short *)(param_3 + 0x30);
  param_1 = 6;
  piVar8 = local_40 + 1;
  do {
    if (((param_1 != 4) && (param_1 != 2)) && (param_1 != 0)) {
      if (((psVar3[-0x10] == 0) && (*psVar3 == 0)) && ((psVar3[0x10] == 0 && (psVar3[0x20] == 0))))
      {
        iVar5 = (int)psVar3[-0x18] * *piVar4 * 4;
        piVar8[-1] = iVar5;
      }
      else {
        iVar7 = (int)psVar3[0x10] * piVar4[0x28] * 0x1b37 +
                (int)psVar3[0x20] * piVar4[0x38] * -0x1712 + (int)psVar3[-0x10] * piVar4[8] * 0x73fc
                + (int)*psVar3 * piVar4[0x18] * -0x28ba;
        iVar5 = (int)psVar3[-0x18] * *piVar4 * 0x8000;
        piVar8[-1] = iVar7 + 0x1000 + iVar5 >> 0xd;
        iVar5 = (iVar5 - iVar7) + 0x1000 >> 0xd;
      }
      piVar8[7] = iVar5;
    }
    if (((param_1 != 5) && (param_1 != 3)) && (param_1 != 1)) {
      if ((((psVar3[-0xf] == 0) && (psVar3[1] == 0)) && (psVar3[0x11] == 0)) && (psVar3[0x21] == 0))
      {
        iVar5 = (int)psVar3[-0x17] * piVar4[1] * 4;
        *piVar8 = iVar5;
      }
      else {
        iVar7 = (int)psVar3[0x11] * piVar4[0x29] * 0x1b37 +
                (int)psVar3[0x21] * piVar4[0x39] * -0x1712 + (int)psVar3[1] * piVar4[0x19] * -0x28ba
                + (int)psVar3[-0xf] * piVar4[9] * 0x73fc;
        iVar5 = (int)psVar3[-0x17] * piVar4[1] * 0x8000;
        *piVar8 = iVar7 + 0x1000 + iVar5 >> 0xd;
        iVar5 = (iVar5 - iVar7) + 0x1000 >> 0xd;
      }
      piVar8[8] = iVar5;
    }
    if (((param_1 != 6) && (param_1 != 4)) && (param_1 != 2)) {
      if (((psVar3[-0xe] == 0) && (psVar3[2] == 0)) && ((psVar3[0x12] == 0 && (psVar3[0x22] == 0))))
      {
        iVar5 = (int)psVar3[-0x16] * piVar4[2] * 4;
        piVar8[1] = iVar5;
      }
      else {
        iVar7 = (int)psVar3[0x12] * piVar4[0x2a] * 0x1b37 +
                (int)psVar3[0x22] * piVar4[0x3a] * -0x1712 + (int)psVar3[2] * piVar4[0x1a] * -0x28ba
                + (int)psVar3[-0xe] * piVar4[10] * 0x73fc;
        iVar5 = (int)psVar3[-0x16] * piVar4[2] * 0x8000;
        piVar8[1] = iVar7 + 0x1000 + iVar5 >> 0xd;
        iVar5 = (iVar5 - iVar7) + 0x1000 >> 0xd;
      }
      piVar8[9] = iVar5;
    }
    if (((param_1 != 7) && (param_1 != 5)) && (param_1 != 3)) {
      if (((psVar3[-0xd] == 0) && (psVar3[3] == 0)) && ((psVar3[0x13] == 0 && (psVar3[0x23] == 0))))
      {
        iVar5 = (int)psVar3[-0x15] * piVar4[3] * 4;
        piVar8[2] = iVar5;
      }
      else {
        iVar7 = (int)psVar3[0x13] * piVar4[0x2b] * 0x1b37 +
                (int)psVar3[0x23] * piVar4[0x3b] * -0x1712 + (int)psVar3[3] * piVar4[0x1b] * -0x28ba
                + (int)psVar3[-0xd] * piVar4[0xb] * 0x73fc;
        iVar5 = (int)psVar3[-0x15] * piVar4[3] * 0x8000;
        piVar8[2] = iVar7 + 0x1000 + iVar5 >> 0xd;
        iVar5 = (iVar5 - iVar7) + 0x1000 >> 0xd;
      }
      piVar8[10] = iVar5;
    }
    iVar5 = param_1 + -2;
    psVar3 = psVar3 + 4;
    piVar4 = piVar4 + 4;
    piVar8 = piVar8 + 4;
    bVar9 = param_1 != 2;
    param_1 = param_1 + -4;
  } while (bVar9 && -1 < iVar5);
  puVar6 = (undefined *)(*param_4 + param_5);
  if (((local_40[1] == 0) && (local_40[3] == 0)) && ((local_40[5] == 0 && (local_24 == 0)))) {
    uVar1 = *(undefined *)((local_40[0] + 0x10 >> 5 & 0x3ffU) + iVar2);
    *puVar6 = uVar1;
  }
  else {
    iVar5 = local_40[1] * 0x73fc + local_40[3] * -0x28ba + local_40[5] * 0x1b37 + local_24 * -0x1712
    ;
    *puVar6 = *(undefined *)((iVar5 + 0x80000 + local_40[0] * 0x8000 >> 0x14 & 0x3ffU) + iVar2);
    uVar1 = *(undefined *)(((local_40[0] * 0x8000 - iVar5) + 0x80000 >> 0x14 & 0x3ffU) + iVar2);
  }
  puVar6[1] = uVar1;
  puVar6 = (undefined *)(param_4[1] + param_5);
  if ((((local_20[1] == 0) && (local_20[3] == 0)) && (local_20[5] == 0)) && (local_4 == 0)) {
    uVar1 = *(undefined *)((local_20[0] + 0x10 >> 5 & 0x3ffU) + iVar2);
    *puVar6 = uVar1;
    puVar6[1] = uVar1;
    return;
  }
  iVar5 = local_20[1] * 0x73fc + local_20[5] * 0x1b37 + local_4 * -0x1712 + local_20[3] * -0x28ba;
  *puVar6 = *(undefined *)((iVar5 + 0x80000 + local_20[0] * 0x8000 >> 0x14 & 0x3ffU) + iVar2);
  puVar6[1] = *(undefined *)(((local_20[0] * 0x8000 - iVar5) + 0x80000 >> 0x14 & 0x3ffU) + iVar2);
  return;
}



void __cdecl FUN_004362d0(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int local_4;
  
  piVar1 = (int *)(param_1 + 8);
  local_4 = 2;
  do {
    iVar6 = piVar1[5] + piVar1[-2];
    iVar10 = piVar1[-2] - piVar1[5];
    iVar5 = piVar1[-1] + piVar1[4];
    iVar2 = piVar1[-1] - piVar1[4];
    iVar7 = piVar1[3] + *piVar1;
    iVar3 = *piVar1 - piVar1[3];
    iVar8 = piVar1[2] + piVar1[1];
    iVar9 = piVar1[2];
    iVar4 = iVar8 + iVar6;
    iVar6 = iVar6 - iVar8;
    piVar1[-2] = iVar7 + iVar5 + iVar4;
    piVar1[2] = iVar4 - (iVar7 + iVar5);
    iVar4 = ((iVar6 - iVar7) + iVar5) * 0xb5 >> 8;
    piVar1[4] = iVar6 - iVar4;
    iVar5 = (piVar1[1] - iVar9) + iVar3;
    *piVar1 = iVar4 + iVar6;
    iVar6 = iVar10 + iVar2;
    iVar4 = (iVar5 - iVar6) * 0x62 >> 8;
    iVar9 = (iVar6 * 0x14e >> 8) + iVar4;
    iVar4 = (iVar5 * 0x8b >> 8) + iVar4;
    iVar5 = (iVar3 + iVar2) * 0xb5 >> 8;
    iVar6 = iVar5 + iVar10;
    iVar10 = iVar10 - iVar5;
    piVar1[3] = iVar10 + iVar4;
    piVar1[1] = iVar10 - iVar4;
    piVar1[-1] = iVar6 + iVar9;
    iVar5 = piVar1[0xd] + piVar1[6];
    iVar10 = piVar1[6] - piVar1[0xd];
    piVar1[5] = iVar6 - iVar9;
    iVar6 = piVar1[7] + piVar1[0xc];
    iVar2 = piVar1[7] - piVar1[0xc];
    iVar7 = piVar1[0xb] + piVar1[8];
    iVar3 = piVar1[8] - piVar1[0xb];
    iVar8 = piVar1[10] + piVar1[9];
    iVar9 = piVar1[10];
    iVar4 = iVar8 + iVar5;
    iVar5 = iVar5 - iVar8;
    piVar1[6] = iVar7 + iVar6 + iVar4;
    piVar1[10] = iVar4 - (iVar7 + iVar6);
    iVar6 = ((iVar5 - iVar7) + iVar6) * 0xb5 >> 8;
    piVar1[8] = iVar6 + iVar5;
    piVar1[0xc] = iVar5 - iVar6;
    iVar6 = (piVar1[9] - iVar9) + iVar3;
    iVar5 = iVar10 + iVar2;
    iVar4 = (iVar6 - iVar5) * 0x62 >> 8;
    iVar9 = (iVar5 * 0x14e >> 8) + iVar4;
    iVar4 = (iVar6 * 0x8b >> 8) + iVar4;
    iVar5 = (iVar3 + iVar2) * 0xb5 >> 8;
    iVar6 = iVar5 + iVar10;
    iVar10 = iVar10 - iVar5;
    piVar1[0xb] = iVar10 + iVar4;
    piVar1[9] = iVar10 - iVar4;
    piVar1[7] = iVar6 + iVar9;
    iVar5 = piVar1[0x15] + piVar1[0xe];
    iVar10 = piVar1[0xe] - piVar1[0x15];
    piVar1[0xd] = iVar6 - iVar9;
    iVar6 = piVar1[0xf] + piVar1[0x14];
    iVar2 = piVar1[0xf] - piVar1[0x14];
    iVar7 = piVar1[0x13] + piVar1[0x10];
    iVar3 = piVar1[0x10] - piVar1[0x13];
    iVar8 = piVar1[0x12] + piVar1[0x11];
    iVar9 = piVar1[0x12];
    iVar4 = iVar8 + iVar5;
    iVar5 = iVar5 - iVar8;
    piVar1[0xe] = iVar7 + iVar6 + iVar4;
    piVar1[0x12] = iVar4 - (iVar7 + iVar6);
    iVar6 = ((iVar5 - iVar7) + iVar6) * 0xb5 >> 8;
    piVar1[0x10] = iVar6 + iVar5;
    piVar1[0x14] = iVar5 - iVar6;
    iVar6 = (piVar1[0x11] - iVar9) + iVar3;
    iVar5 = iVar10 + iVar2;
    iVar4 = (iVar6 - iVar5) * 0x62 >> 8;
    iVar9 = (iVar5 * 0x14e >> 8) + iVar4;
    iVar4 = (iVar6 * 0x8b >> 8) + iVar4;
    iVar5 = (iVar3 + iVar2) * 0xb5 >> 8;
    iVar6 = iVar5 + iVar10;
    iVar10 = iVar10 - iVar5;
    piVar1[0x13] = iVar10 + iVar4;
    piVar1[0x11] = iVar10 - iVar4;
    piVar1[0xf] = iVar6 + iVar9;
    iVar5 = piVar1[0x16] + piVar1[0x1d];
    iVar10 = piVar1[0x16] - piVar1[0x1d];
    piVar1[0x15] = iVar6 - iVar9;
    iVar6 = piVar1[0x1c] + piVar1[0x17];
    iVar2 = piVar1[0x17] - piVar1[0x1c];
    iVar7 = piVar1[0x1b] + piVar1[0x18];
    iVar3 = piVar1[0x18] - piVar1[0x1b];
    iVar8 = piVar1[0x1a] + piVar1[0x19];
    iVar9 = piVar1[0x1a];
    iVar4 = iVar8 + iVar5;
    iVar5 = iVar5 - iVar8;
    piVar1[0x16] = iVar7 + iVar6 + iVar4;
    piVar1[0x1a] = iVar4 - (iVar7 + iVar6);
    iVar6 = ((iVar5 - iVar7) + iVar6) * 0xb5 >> 8;
    piVar1[0x18] = iVar6 + iVar5;
    piVar1[0x1c] = iVar5 - iVar6;
    iVar6 = (piVar1[0x19] - iVar9) + iVar3;
    iVar5 = iVar10 + iVar2;
    iVar4 = (iVar6 - iVar5) * 0x62 >> 8;
    iVar9 = (iVar6 * 0x8b >> 8) + iVar4;
    iVar4 = (iVar5 * 0x14e >> 8) + iVar4;
    iVar5 = (iVar3 + iVar2) * 0xb5 >> 8;
    iVar6 = iVar5 + iVar10;
    iVar10 = iVar10 - iVar5;
    piVar1[0x1b] = iVar10 + iVar9;
    piVar1[0x19] = iVar10 - iVar9;
    piVar1[0x17] = iVar6 + iVar4;
    piVar1[0x1d] = iVar6 - iVar4;
    piVar1 = piVar1 + 0x20;
    local_4 = local_4 + -1;
  } while (local_4 != 0);
  piVar1 = (int *)(param_1 + 0x40);
  param_1 = 2;
  do {
    iVar6 = piVar1[0x28] + piVar1[-0x10];
    iVar10 = piVar1[-0x10] - piVar1[0x28];
    iVar5 = piVar1[-8] + piVar1[0x20];
    iVar2 = piVar1[-8] - piVar1[0x20];
    iVar7 = piVar1[0x18] + *piVar1;
    iVar3 = *piVar1 - piVar1[0x18];
    iVar8 = piVar1[0x10] + piVar1[8];
    iVar9 = piVar1[0x10];
    iVar4 = iVar8 + iVar6;
    iVar6 = iVar6 - iVar8;
    piVar1[-0x10] = iVar7 + iVar5 + iVar4;
    piVar1[0x10] = iVar4 - (iVar7 + iVar5);
    iVar4 = ((iVar6 - iVar7) + iVar5) * 0xb5 >> 8;
    piVar1[0x20] = iVar6 - iVar4;
    iVar5 = (piVar1[8] - iVar9) + iVar3;
    *piVar1 = iVar4 + iVar6;
    iVar6 = iVar10 + iVar2;
    iVar4 = (iVar5 - iVar6) * 0x62 >> 8;
    iVar9 = (iVar6 * 0x14e >> 8) + iVar4;
    iVar4 = (iVar5 * 0x8b >> 8) + iVar4;
    iVar5 = (iVar3 + iVar2) * 0xb5 >> 8;
    iVar6 = iVar5 + iVar10;
    iVar10 = iVar10 - iVar5;
    piVar1[0x18] = iVar10 + iVar4;
    piVar1[8] = iVar10 - iVar4;
    piVar1[-8] = iVar6 + iVar9;
    iVar5 = piVar1[0x29] + piVar1[-0xf];
    iVar10 = piVar1[-0xf] - piVar1[0x29];
    piVar1[0x28] = iVar6 - iVar9;
    iVar6 = piVar1[-7] + piVar1[0x21];
    iVar2 = piVar1[-7] - piVar1[0x21];
    iVar7 = piVar1[0x19] + piVar1[1];
    iVar3 = piVar1[1] - piVar1[0x19];
    iVar8 = piVar1[0x11] + piVar1[9];
    iVar9 = piVar1[0x11];
    iVar4 = iVar8 + iVar5;
    iVar5 = iVar5 - iVar8;
    piVar1[-0xf] = iVar7 + iVar6 + iVar4;
    piVar1[0x11] = iVar4 - (iVar7 + iVar6);
    iVar6 = ((iVar5 - iVar7) + iVar6) * 0xb5 >> 8;
    piVar1[1] = iVar6 + iVar5;
    piVar1[0x21] = iVar5 - iVar6;
    iVar6 = (piVar1[9] - iVar9) + iVar3;
    iVar5 = iVar10 + iVar2;
    iVar4 = (iVar6 - iVar5) * 0x62 >> 8;
    iVar9 = (iVar5 * 0x14e >> 8) + iVar4;
    iVar4 = (iVar6 * 0x8b >> 8) + iVar4;
    iVar5 = (iVar3 + iVar2) * 0xb5 >> 8;
    iVar6 = iVar5 + iVar10;
    iVar10 = iVar10 - iVar5;
    piVar1[0x19] = iVar10 + iVar4;
    piVar1[9] = iVar10 - iVar4;
    piVar1[-7] = iVar6 + iVar9;
    iVar5 = piVar1[0x2a] + piVar1[-0xe];
    iVar10 = piVar1[-0xe] - piVar1[0x2a];
    piVar1[0x29] = iVar6 - iVar9;
    iVar6 = piVar1[-6] + piVar1[0x22];
    iVar2 = piVar1[-6] - piVar1[0x22];
    iVar7 = piVar1[0x1a] + piVar1[2];
    iVar3 = piVar1[2] - piVar1[0x1a];
    iVar8 = piVar1[0x12] + piVar1[10];
    iVar9 = piVar1[0x12];
    iVar4 = iVar8 + iVar5;
    iVar5 = iVar5 - iVar8;
    piVar1[-0xe] = iVar7 + iVar6 + iVar4;
    piVar1[0x12] = iVar4 - (iVar7 + iVar6);
    iVar6 = ((iVar5 - iVar7) + iVar6) * 0xb5 >> 8;
    piVar1[2] = iVar6 + iVar5;
    piVar1[0x22] = iVar5 - iVar6;
    iVar6 = (piVar1[10] - iVar9) + iVar3;
    iVar5 = iVar10 + iVar2;
    iVar4 = (iVar6 - iVar5) * 0x62 >> 8;
    iVar9 = (iVar5 * 0x14e >> 8) + iVar4;
    iVar4 = (iVar6 * 0x8b >> 8) + iVar4;
    iVar5 = (iVar3 + iVar2) * 0xb5 >> 8;
    iVar6 = iVar5 + iVar10;
    iVar10 = iVar10 - iVar5;
    piVar1[0x1a] = iVar10 + iVar4;
    piVar1[10] = iVar10 - iVar4;
    piVar1[-6] = iVar6 + iVar9;
    iVar5 = piVar1[-0xd] + piVar1[0x2b];
    iVar10 = piVar1[-0xd] - piVar1[0x2b];
    piVar1[0x2a] = iVar6 - iVar9;
    iVar6 = piVar1[0x23] + piVar1[-5];
    iVar2 = piVar1[-5] - piVar1[0x23];
    iVar7 = piVar1[0x1b] + piVar1[3];
    iVar3 = piVar1[3] - piVar1[0x1b];
    iVar8 = piVar1[0x13] + piVar1[0xb];
    iVar9 = piVar1[0x13];
    iVar4 = iVar8 + iVar5;
    iVar5 = iVar5 - iVar8;
    piVar1[-0xd] = iVar7 + iVar6 + iVar4;
    piVar1[0x13] = iVar4 - (iVar7 + iVar6);
    iVar6 = ((iVar5 - iVar7) + iVar6) * 0xb5 >> 8;
    piVar1[3] = iVar6 + iVar5;
    piVar1[0x23] = iVar5 - iVar6;
    iVar6 = (piVar1[0xb] - iVar9) + iVar3;
    iVar5 = iVar10 + iVar2;
    iVar4 = (iVar6 - iVar5) * 0x62 >> 8;
    iVar9 = (iVar6 * 0x8b >> 8) + iVar4;
    iVar4 = (iVar5 * 0x14e >> 8) + iVar4;
    iVar5 = (iVar3 + iVar2) * 0xb5 >> 8;
    iVar6 = iVar5 + iVar10;
    iVar10 = iVar10 - iVar5;
    piVar1[0x1b] = iVar10 + iVar9;
    piVar1[0xb] = iVar10 - iVar9;
    piVar1[-5] = iVar6 + iVar4;
    piVar1[0x2b] = iVar6 - iVar4;
    piVar1 = piVar1 + 4;
    param_1 = param_1 + -1;
  } while (param_1 != 0);
  return;
}



undefined4 * __thiscall FUN_004369a0(void *this,byte param_1)

{
  void *pvVar1;
  
  pvVar1 = *(void **)((int)this + 4);
  *(undefined ***)this = aTextFile::vftable;
  if (pvVar1 != (void *)0x0) {
    _eh_vector_destructor_iterator_(pvVar1,0xc,*(int *)((int)pvVar1 + -4),FUN_0041aaf0);
    operator_delete((void *)((int)pvVar1 + -4));
  }
  *(undefined4 *)((int)this + 4) = 0;
  *(undefined4 *)((int)this + 8) = 0;
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_00436a00(undefined4 *param_1)

{
  void *pvVar1;
  
  pvVar1 = (void *)param_1[1];
  *param_1 = aTextFile::vftable;
  if (pvVar1 != (void *)0x0) {
    _eh_vector_destructor_iterator_(pvVar1,0xc,*(int *)((int)pvVar1 + -4),FUN_0041aaf0);
    operator_delete((void *)((int)pvVar1 + -4));
  }
  param_1[2] = 0;
  param_1[1] = 0;
  return;
}



uint __thiscall FUN_00436a40(void *this,int param_1,undefined1 *param_2)

{
  void **ppvVar1;
  void *pvVar2;
  size_t _Size;
  bool bVar3;
  char cVar4;
  FILE *pFVar5;
  uint uVar6;
  uint *puVar7;
  undefined4 *puVar8;
  undefined1 *puVar9;
  uint uVar10;
  uint *puVar11;
  char *in_stack_ffffffa4;
  undefined4 uVar12;
  undefined *puVar13;
  char *in_stack_ffffffb0;
  void *_Dst;
  size_t sVar14;
  undefined **local_2c;
  FILE *local_28;
  uint local_24;
  undefined4 local_20;
  undefined4 local_1c;
  void *local_18;
  size_t local_14;
  undefined4 local_10;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_004390a3;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_18 = (void *)0x0;
  local_10 = 0;
  local_14 = 0;
  local_2c = aDiskFile::vftable;
  local_28 = (FILE *)0x0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_4._0_1_ = 3;
  local_4._1_3_ = 0;
  puVar13 = &DAT_0043b40c;
  uVar12 = 0x436ab4;
  FUN_0041aa80(this,(char *)0x7fffffff,"rb");
  local_4._0_1_ = 4;
  puVar9 = &DAT_0044d0d5;
  if (param_2 != (undefined1 *)0x0) {
    puVar9 = param_2;
  }
  FUN_0041aa80(puVar9,(char *)0x7fffffff,puVar9);
  local_4._0_1_ = 3;
  bVar3 = FUN_0041a810(&local_2c,in_stack_ffffffa4,uVar12,puVar13,in_stack_ffffffb0);
  if (bVar3) {
    cVar4 = FUN_0041a960(&local_2c,(int)&local_18);
    uVar6 = 0;
    pvVar2 = local_18;
    _Size = local_14;
    while (local_18 = pvVar2, local_14 = _Size, cVar4 != '\0') {
      _Dst = (void *)0x0;
      sVar14 = 0;
      if (pvVar2 != (void *)0x0) {
        FUN_0041b310();
        memcpy(_Dst,pvVar2,_Size);
        *(undefined *)(_Size + (int)_Dst) = 0;
        sVar14 = _Size;
      }
      FUN_00402b40((int *)&local_24,_Dst,sVar14);
      cVar4 = FUN_0041a960(&local_2c,(int)&local_18);
      uVar6 = local_24;
      pvVar2 = local_18;
      _Size = local_14;
    }
    fclose(local_28);
    pvVar2 = *(void **)(param_1 + 4);
    local_28 = (FILE *)0x0;
    if (pvVar2 != (void *)0x0) {
      _eh_vector_destructor_iterator_(pvVar2,0xc,*(int *)((int)pvVar2 + -4),FUN_0041aaf0);
      operator_delete((void *)((int)pvVar2 + -4));
    }
    uVar10 = -(uint)((int)((ulonglong)uVar6 * 0xc >> 0x20) != 0) | (uint)((ulonglong)uVar6 * 0xc);
    puVar7 = (uint *)operator_new(-(uint)(0xfffffffb < uVar10) | uVar10 + 4);
    local_4._0_1_ = 5;
    if (puVar7 == (uint *)0x0) {
      puVar11 = (uint *)0x0;
    }
    else {
      puVar11 = puVar7 + 1;
      *puVar7 = uVar6;
      _eh_vector_constructor_iterator_
                (puVar11,0xc,uVar6,(_func_void_void_ptr *)&LAB_0041aa20,FUN_0041aaf0);
    }
    local_4 = CONCAT31(local_4._1_3_,3);
    *(uint **)(param_1 + 4) = puVar11;
    *(undefined4 *)(param_1 + 8) = 0;
    puVar8 = (undefined4 *)FUN_0040e220((int)&local_24);
    for (puVar8 = (undefined4 *)*puVar8; puVar8 != (undefined4 *)0x0; puVar8 = (undefined4 *)*puVar8
        ) {
      ppvVar1 = (void **)(*(int *)(param_1 + 4) + *(int *)(param_1 + 8) * 0xc);
      if (puVar8[2] != *(int *)(*(int *)(param_1 + 4) + *(int *)(param_1 + 8) * 0xc)) {
        FUN_0041b310();
        memcpy(*ppvVar1,(void *)puVar8[2],puVar8[3]);
        pvVar2 = (void *)puVar8[3];
        ppvVar1[1] = pvVar2;
        *(undefined *)((int)pvVar2 + (int)*ppvVar1) = 0;
      }
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
    }
    local_4._1_3_ = (uint3)((uint)local_4 >> 8);
    local_4._0_1_ = 2;
    FUN_00402ab0();
    local_4 = (uint)local_4._1_3_ << 8;
    if (local_18 != (void *)0x0) {
      free(local_18);
    }
    local_4 = 0xffffffff;
    if (param_2 != (undefined1 *)0x0) {
      free(param_2);
    }
    uVar6 = CONCAT31((int3)((uint)param_2 >> 8),1);
  }
  else {
    local_4 = CONCAT31(local_4._1_3_,2);
    FUN_00402ab0();
    pFVar5 = local_28;
    if (local_28 != (FILE *)0x0) {
      pFVar5 = (FILE *)fclose(local_28);
    }
    local_4 = 0xffffffff;
    if (param_2 != (undefined1 *)0x0) {
      free(param_2);
    }
    uVar6 = (uint)pFVar5 & 0xffffff00;
  }
  ExceptionList = local_c;
  return uVar6;
}



void __fastcall FUN_00436ce0(int param_1)

{
  int iVar1;
  void *pvVar2;
  void **ppvVar3;
  void *pvVar4;
  void **in_EAX;
  
  iVar1 = *(int *)(param_1 + 8);
  *in_EAX = (void *)0x0;
  in_EAX[2] = (void *)0x0;
  in_EAX[1] = (void *)0x0;
  if (iVar1 < 1) {
    if (DAT_0044d228 != (void *)0x0) {
      FUN_0041b310();
      pvVar2 = *in_EAX;
      memcpy(pvVar2,DAT_0044d228,(size_t)DAT_0044d22c);
      pvVar4 = DAT_0044d22c;
      *(undefined *)((int)pvVar2 + (int)DAT_0044d22c) = 0;
      in_EAX[1] = pvVar4;
      return;
    }
  }
  else {
    ppvVar3 = *(void ***)(param_1 + 4);
    if (*ppvVar3 != (void *)0x0) {
      FUN_0041b310();
      pvVar2 = *in_EAX;
      memcpy(pvVar2,*ppvVar3,(size_t)ppvVar3[1]);
      pvVar4 = ppvVar3[1];
      in_EAX[1] = pvVar4;
      *(undefined *)((int)pvVar4 + (int)pvVar2) = 0;
    }
  }
  return;
}



void __fastcall FUN_00436d70(int param_1)

{
  FUN_00436ce0(param_1);
  return;
}



undefined4 * __thiscall FUN_00436d90(void *this,byte param_1)

{
  *(undefined ***)this = aCommChannel::vftable;
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_00436db0(undefined4 *param_1)

{
  *param_1 = aCommChannel::vftable;
  return;
}



uint __cdecl FUN_00436dc0(int *param_1)

{
  int *piVar1;
  int **ppiVar2;
  int iVar3;
  SOCKET SVar4;
  int **ppiVar5;
  int iVar6;
  int iVar7;
  int **unaff_EDI;
  fd_set *pfVar8;
  timeval local_10c;
  fd_set local_104;
  
  iVar7 = 0;
  iVar6 = 0;
  piVar1 = *unaff_EDI;
  local_104.fd_count = 0;
  ppiVar5 = unaff_EDI;
  while (piVar1 != (int *)0x0) {
    iVar3 = (**(code **)(**ppiVar5 + 8))();
    if (iVar7 < iVar3) {
      iVar7 = (**(code **)(**ppiVar5 + 8))();
    }
    if (local_104.fd_count < 0x40) {
      SVar4 = (**(code **)(**ppiVar5 + 8))();
      local_104.fd_array[local_104.fd_count] = SVar4;
      local_104.fd_count = local_104.fd_count + 1;
    }
    iVar6 = iVar6 + 1;
    ppiVar5 = unaff_EDI + iVar6;
    piVar1 = unaff_EDI[iVar6];
  }
  local_10c.tv_sec = 1;
  local_10c.tv_usec = 0;
  ppiVar5 = (int **)select(iVar7 + 1,&local_104,(fd_set *)0x0,(fd_set *)0x0,&local_10c);
  if (0 < (int)ppiVar5) {
    iVar7 = 0;
    piVar1 = *unaff_EDI;
    ppiVar2 = unaff_EDI;
    while (piVar1 != (int *)0x0) {
      pfVar8 = &local_104;
      SVar4 = (**(code **)(**ppiVar2 + 8))();
      iVar6 = __WSAFDIsSet(SVar4,pfVar8);
      if (iVar6 != 0) {
        *param_1 = iVar7;
        return CONCAT31((int3)((uint)iVar6 >> 8),1);
      }
      iVar7 = iVar7 + 1;
      ppiVar5 = unaff_EDI + iVar7;
      ppiVar2 = ppiVar5;
      piVar1 = unaff_EDI[iVar7];
    }
  }
  return (uint)ppiVar5 & 0xffffff00;
}



undefined4 * FUN_00436ea0(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00439048;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  local_4 = 0;
  *param_1 = aUdpSocket::vftable;
  FUN_0041ce60(param_1 + 2);
  param_1[7] = 0;
  param_1[1] = 0;
  ExceptionList = local_c;
  return param_1;
}



undefined4 * __thiscall FUN_00436f00(void *this,byte param_1)

{
  FUN_00436f20((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return (undefined4 *)this;
}



void __fastcall FUN_00436f20(undefined4 *param_1)

{
  SOCKET s;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00438518;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = aUdpSocket::vftable;
  local_4 = 0;
  s = param_1[1];
  if ((s != 0) && (s != 0xffffffff)) {
    closesocket(s);
  }
  param_1[7] = 0;
  param_1[1] = 0;
  param_1[2] = aIpAddr::vftable;
  if ((void *)param_1[3] != (void *)0x0) {
    free((void *)param_1[3]);
  }
  *param_1 = aCommChannel::vftable;
  ExceptionList = local_c;
  return;
}



bool __fastcall FUN_00436fb0(int param_1)

{
  return *(int *)(param_1 + 4) != 0;
}



undefined4 FUN_00436fc0(int param_1,undefined4 param_2)

{
  int iVar1;
  SOCKET SVar2;
  int unaff_ESI;
  
  SVar2 = *(SOCKET *)(unaff_ESI + 4);
  if ((SVar2 != 0) && (SVar2 != 0xffffffff)) {
    closesocket(SVar2);
  }
  *(undefined4 *)(unaff_ESI + 0x1c) = 0;
  *(undefined4 *)(unaff_ESI + 4) = 0;
  SVar2 = socket(2,2,0);
  *(SOCKET *)(unaff_ESI + 4) = SVar2;
  if (SVar2 == 0xffffffff) {
    *(undefined4 *)(unaff_ESI + 0x1c) = 0;
    *(undefined4 *)(unaff_ESI + 4) = 0;
    return 0;
  }
  if (*(int *)(param_1 + 4) != *(int *)(unaff_ESI + 0xc)) {
    FUN_0041b310();
    memcpy(*(void **)(unaff_ESI + 0xc),*(void **)(param_1 + 4),*(size_t *)(param_1 + 8));
    iVar1 = *(int *)(param_1 + 8);
    *(int *)(unaff_ESI + 0x10) = iVar1;
    *(undefined *)(iVar1 + (int)*(void **)(unaff_ESI + 0xc)) = 0;
  }
  *(undefined4 *)(unaff_ESI + 0x18) = *(undefined4 *)(param_1 + 0x10);
  *(undefined4 *)(unaff_ESI + 0x1c) = param_2;
  return 1;
}



void FUN_00437050(u_short param_1)

{
  u_short uVar1;
  SOCKET SVar2;
  int iVar3;
  int unaff_ESI;
  sockaddr local_14;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_14;
  SVar2 = *(SOCKET *)(unaff_ESI + 4);
  if ((SVar2 != 0) && (SVar2 != 0xffffffff)) {
    closesocket(SVar2);
  }
  *(undefined4 *)(unaff_ESI + 0x1c) = 0;
  *(undefined4 *)(unaff_ESI + 4) = 0;
  SVar2 = socket(2,2,0);
  *(SOCKET *)(unaff_ESI + 4) = SVar2;
  if (SVar2 != 0xffffffff) {
    local_14.sa_data[2] = '\0';
    local_14.sa_data[3] = '\0';
    local_14.sa_data[4] = '\0';
    local_14.sa_data[5] = '\0';
    local_14.sa_data[6] = '\0';
    local_14.sa_data[7] = '\0';
    local_14.sa_data[8] = '\0';
    local_14.sa_data[9] = '\0';
    local_14.sa_data[10] = '\0';
    local_14.sa_data[0xb] = '\0';
    local_14.sa_data[0xc] = '\0';
    local_14.sa_data[0xd] = '\0';
    local_14.sa_family = 2;
    local_14.sa_data[0] = '\0';
    local_14.sa_data[1] = '\0';
    uVar1 = htons(param_1);
    local_14.sa_data._0_2_ = uVar1;
    local_14.sa_data[2] = '\0';
    local_14.sa_data[3] = '\0';
    local_14.sa_data[4] = '\0';
    local_14.sa_data[5] = '\0';
    iVar3 = bind(*(SOCKET *)(unaff_ESI + 4),&local_14,0x10);
    if (iVar3 == 0) {
      ___security_check_cookie_4(local_4 ^ (uint)&local_14);
      return;
    }
    SVar2 = *(SOCKET *)(unaff_ESI + 4);
    if ((SVar2 != 0) && (SVar2 != 0xffffffff)) {
      closesocket(SVar2);
    }
  }
  *(undefined4 *)(unaff_ESI + 0x1c) = 0;
  *(undefined4 *)(unaff_ESI + 4) = 0;
  ___security_check_cookie_4(local_4 ^ (uint)&local_14);
  return;
}



void __fastcall FUN_00437110(int param_1,int param_2)

{
  int iVar1;
  char *unaff_EBX;
  int local_128;
  undefined4 local_124;
  timeval local_120;
  fd_set local_118;
  sockaddr local_14;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)&local_128;
  local_118.fd_array[0] = *(SOCKET *)(param_1 + 4);
  local_118.fd_count = 1;
  local_120.tv_sec = 1;
  local_120.tv_usec = 0;
  local_128 = 0x10;
  iVar1 = select(local_118.fd_array[0] + 1,&local_118,(fd_set *)0x0,(fd_set *)0x0,&local_120);
  if (iVar1 != 0) {
    iVar1 = recvfrom(*(SOCKET *)(param_1 + 4),unaff_EBX,0x100,0,&local_14,&local_128);
    if ((-1 < iVar1) && (param_2 != 0)) {
      local_124._0_1_ = local_14.sa_data[2];
      local_124._1_1_ = local_14.sa_data[3];
      local_124._2_1_ = local_14.sa_data[4];
      local_124._3_1_ = local_14.sa_data[5];
      FUN_0041d130(&local_124);
    }
    ___security_check_cookie_4(local_4 ^ (uint)&local_128);
    return;
  }
  ___security_check_cookie_4(local_4 ^ (uint)&local_128);
  return;
}



void __thiscall FUN_004371e0(void *this,int param_1,undefined4 param_2,int param_3)

{
  int iVar1;
  u_short uVar2;
  int unaff_ESI;
  undefined auStack_1c [4];
  int local_18;
  sockaddr local_14;
  uint local_4;
  
  local_4 = DAT_0044a01c ^ (uint)auStack_1c;
  local_14.sa_data[2] = '\0';
  local_14.sa_data[3] = '\0';
  local_14.sa_data[4] = '\0';
  local_14.sa_data[5] = '\0';
  local_14.sa_data[6] = '\0';
  local_14.sa_data[7] = '\0';
  local_14.sa_data[8] = '\0';
  local_14.sa_data[9] = '\0';
  local_14.sa_data[10] = '\0';
  local_14.sa_data[0xb] = '\0';
  local_14.sa_data[0xc] = '\0';
  local_14.sa_data[0xd] = '\0';
  local_14.sa_family = 2;
  local_14.sa_data[0] = '\0';
  local_14.sa_data[1] = '\0';
  uVar2 = htons((u_short)param_2);
  local_14.sa_data._2_4_ = *(undefined4 *)(unaff_ESI + 0x10);
  local_14.sa_data._0_2_ = uVar2;
  local_18 = sendto(*(SOCKET *)(param_1 + 4),(char *)this,param_3,0,&local_14,0x10);
  if (local_18 < 0) {
    ___security_check_cookie_4(local_4 ^ (uint)auStack_1c);
    return;
  }
  if (*(int *)(unaff_ESI + 4) != *(int *)(param_1 + 0xc)) {
    FUN_0041b310();
    memcpy(*(void **)(param_1 + 0xc),*(void **)(unaff_ESI + 4),*(size_t *)(unaff_ESI + 8));
    iVar1 = *(int *)(unaff_ESI + 8);
    *(int *)(param_1 + 0x10) = iVar1;
    *(undefined *)(iVar1 + (int)*(void **)(param_1 + 0xc)) = 0;
  }
  *(undefined4 *)(param_1 + 0x18) = *(undefined4 *)(unaff_ESI + 0x10);
  *(undefined4 *)(param_1 + 0x1c) = param_2;
  ___security_check_cookie_4(local_4 ^ (uint)auStack_1c);
  return;
}



undefined4 __fastcall FUN_004372c0(int param_1)

{
  return *(undefined4 *)(param_1 + 4);
}



void * __cdecl operator_new(uint param_1)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437328. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = operator_new(param_1);
  return pvVar1;
}



// Library Function - Single Match
//  @__security_check_cookie@4
// 
// Libraries: Visual Studio 2005 Release, Visual Studio 2008 Release, Visual Studio 2010 Release

void __fastcall ___security_check_cookie_4(int param_1)

{
  if (param_1 == DAT_0044a01c) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___report_gsfailure();
}



void __cdecl operator_delete(void *param_1)

{
                    // WARNING: Could not recover jumptable at 0x004372d8. Too many branches
                    // WARNING: Treating indirect jump as call
  operator_delete(param_1);
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  public: virtual void * __thiscall exception::`vector deleting destructor'(unsigned int)
//  public: virtual void * __thiscall std::exception::`vector deleting destructor'(unsigned int)
//  public: virtual void * __thiscall logic_error::`vector deleting destructor'(unsigned int)
//  public: virtual void * __thiscall type_info::`vector deleting destructor'(unsigned int)
// 
// Library: Visual Studio 2005 Release

int * __thiscall FID_conflict__vector_deleting_destructor_(void *this,byte param_1)

{
  int *piVar1;
  
  if ((param_1 & 2) == 0) {
    type_info::_type_info_dtor_internal_method((type_info *)this);
    piVar1 = (int *)this;
    if ((param_1 & 1) != 0) {
      operator_delete(this);
    }
  }
  else {
    piVar1 = (int *)((int)this + -4);
    _eh_vector_destructor_iterator_(this,0xc,*piVar1,type_info::_type_info_dtor_internal_method);
    if ((param_1 & 1) != 0) {
      operator_delete(piVar1);
    }
  }
  return piVar1;
}



void * __cdecl operator_new(uint param_1)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437328. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = operator_new(param_1);
  return pvVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3
// Library Function - Single Match
//  void __stdcall __ArrayUnwind(void *,unsigned int,int,void (__thiscall*)(void *))
// 
// Libraries: Visual Studio 2005 Release, Visual Studio 2008 Release, Visual Studio 2010 Release

void __ArrayUnwind(void *param_1,uint param_2,int param_3,_func_void_void_ptr *param_4)

{
  void *in_stack_ffffffc8;
  
  while( true ) {
    param_3 = param_3 + -1;
    if (param_3 < 0) break;
    (*param_4)(in_stack_ffffffc8);
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3
// Library Function - Single Match
//  void __stdcall `eh vector destructor iterator'(void *,unsigned int,int,void (__thiscall*)(void
// *))
// 
// Library: Visual Studio 2005 Release

void _eh_vector_destructor_iterator_
               (void *param_1,uint param_2,int param_3,_func_void_void_ptr *param_4)

{
  void *in_stack_ffffffd0;
  
  while( true ) {
    param_3 = param_3 + -1;
    if (param_3 < 0) break;
    (*param_4)(in_stack_ffffffd0);
  }
  FUN_004373d7();
  return;
}



void FUN_004373d7(void)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x1c) == 0) {
    __ArrayUnwind(*(void **)(unaff_EBP + 8),*(uint *)(unaff_EBP + 0xc),*(int *)(unaff_EBP + 0x10),
                  *(_func_void_void_ptr **)(unaff_EBP + 0x14));
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3

_onexit_t __cdecl FUN_004373ef(_onexit_t param_1)

{
  _onexit_t p_Var1;
  undefined4 local_24;
  int local_20 [5];
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_00446c10;
  uStack_c = 0x4373fb;
  local_20[0] = _decode_pointer(DAT_0044d24c);
  if (local_20[0] == -1) {
    p_Var1 = _onexit(param_1);
  }
  else {
    _lock(8);
    local_8 = (undefined *)0x0;
    local_20[0] = _decode_pointer(DAT_0044d24c);
    local_24 = _decode_pointer(DAT_0044d248);
    p_Var1 = (_onexit_t)__dllonexit(param_1,local_20,&local_24);
    DAT_0044d24c = _encode_pointer(local_20[0]);
    DAT_0044d248 = _encode_pointer(local_24);
    local_8 = (undefined *)0xfffffffe;
    FUN_00437485();
  }
  return p_Var1;
}



void FUN_00437485(void)

{
  _unlock(8);
  return;
}



int __cdecl FUN_0043748e(_onexit_t param_1)

{
  _onexit_t p_Var1;
  
  p_Var1 = FUN_004373ef(param_1);
  return (p_Var1 != (_onexit_t)0x0) - 1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3
// Library Function - Single Match
//  void __stdcall `eh vector constructor iterator'(void *,unsigned int,int,void (__thiscall*)(void
// *),void (__thiscall*)(void *))
// 
// Libraries: Visual Studio 2005 Release, Visual Studio 2008 Release, Visual Studio 2010 Release

void _eh_vector_constructor_iterator_
               (void *param_1,uint param_2,int param_3,_func_void_void_ptr *param_4,
               _func_void_void_ptr *param_5)

{
  void *in_stack_ffffffcc;
  int local_20;
  
  for (local_20 = 0; local_20 < param_3; local_20 = local_20 + 1) {
    (*param_4)(in_stack_ffffffcc);
  }
  FUN_004374ed();
  return;
}



void FUN_004374ed(void)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x20) == 0) {
    __ArrayUnwind(*(void **)(unaff_EBP + 8),*(uint *)(unaff_EBP + 0xc),*(int *)(unaff_EBP + -0x1c),
                  *(_func_void_void_ptr **)(unaff_EBP + 0x18));
  }
  return;
}



void __cdecl operator_delete__(void *param_1)

{
                    // WARNING: Could not recover jumptable at 0x00437506. Too many branches
                    // WARNING: Treating indirect jump as call
  operator_delete__(param_1);
  return;
}



void _purecall(void)

{
                    // WARNING: Could not recover jumptable at 0x0043750c. Too many branches
                    // WARNING: Treating indirect jump as call
  _purecall();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___tmainCRTStartup
// 
// Library: Visual Studio 2005 Release

int ___tmainCRTStartup(void)

{
  bool bVar1;
  void *Exchange;
  void *pvVar2;
  int iVar3;
  BOOL BVar4;
  
  Exchange = StackBase;
  bVar1 = false;
  do {
    pvVar2 = (void *)InterlockedCompareExchange((LONG *)&DAT_0044d240,(LONG)Exchange,0);
    if (pvVar2 == (void *)0x0) {
LAB_004375a8:
      if (DAT_0044d23c == 1) {
        _amsg_exit(0x1f);
      }
      else if (DAT_0044d23c == 0) {
        DAT_0044d23c = 1;
        iVar3 = _initterm_e(&DAT_0043b23c,&DAT_0043b248);
        if (iVar3 != 0) {
          return 0xff;
        }
      }
      else {
        DAT_0044c36c = 1;
      }
      if (DAT_0044d23c == 1) {
        _initterm(&DAT_0043b21c,&DAT_0043b238);
        DAT_0044d23c = 2;
      }
      if (!bVar1) {
        InterlockedExchange((LONG *)&DAT_0044d240,0);
      }
      if ((DAT_0044d244 != (code *)0x0) &&
         (BVar4 = __IsNonwritableInCurrentImage((PBYTE)&DAT_0044d244), BVar4 != 0)) {
        (*DAT_0044d244)(0,2,0);
      }
      *(undefined4 *)__initenv_exref = DAT_0044c354;
      DAT_0044c368 = FUN_00403c50(DAT_0044c350,DAT_0044c358);
      if (DAT_0044c35c != 0) {
        if (DAT_0044c36c == 0) {
          _cexit();
        }
        return DAT_0044c368;
      }
                    // WARNING: Subroutine does not return
      exit(DAT_0044c368);
    }
    if (pvVar2 == Exchange) {
      bVar1 = true;
      goto LAB_004375a8;
    }
    Sleep(1000);
  } while( true );
}



void entry(void)

{
  ___security_init_cookie();
  ___tmainCRTStartup();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  ___report_gsfailure
// 
// Libraries: Visual Studio 2005 Release, Visual Studio 2008 Release, Visual Studio 2010 Release

void __cdecl ___report_gsfailure(void)

{
  undefined4 in_EAX;
  HANDLE hProcess;
  undefined4 in_ECX;
  undefined4 in_EDX;
  undefined4 unaff_EBX;
  undefined4 unaff_EBP;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined2 in_ES;
  undefined2 in_CS;
  undefined2 in_SS;
  undefined2 in_DS;
  undefined2 in_FS;
  undefined2 in_GS;
  byte in_AF;
  byte in_TF;
  byte in_IF;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  undefined4 unaff_retaddr;
  UINT uExitCode;
  undefined4 local_32c;
  undefined4 local_328;
  
  _DAT_0044c488 =
       (uint)(in_NT & 1) * 0x4000 | (uint)SBORROW4((int)&stack0xfffffffc,0x328) * 0x800 |
       (uint)(in_IF & 1) * 0x200 | (uint)(in_TF & 1) * 0x100 | (uint)((int)&local_32c < 0) * 0x80 |
       (uint)(&stack0x00000000 == (undefined *)0x32c) * 0x40 | (uint)(in_AF & 1) * 0x10 |
       (uint)((POPCOUNT((uint)&local_32c & 0xff) & 1U) == 0) * 4 |
       (uint)(&stack0xfffffffc < (undefined *)0x328) | (uint)(in_ID & 1) * 0x200000 |
       (uint)(in_VIP & 1) * 0x100000 | (uint)(in_VIF & 1) * 0x80000 | (uint)(in_AC & 1) * 0x40000;
  _DAT_0044c48c = &stack0x00000004;
  _DAT_0044c3c8 = 0x10001;
  _DAT_0044c370 = 0xc0000409;
  _DAT_0044c374 = 1;
  local_32c = DAT_0044a01c;
  local_328 = DAT_0044a020;
  _DAT_0044c37c = unaff_retaddr;
  _DAT_0044c454 = in_GS;
  _DAT_0044c458 = in_FS;
  _DAT_0044c45c = in_ES;
  _DAT_0044c460 = in_DS;
  _DAT_0044c464 = unaff_EDI;
  _DAT_0044c468 = unaff_ESI;
  _DAT_0044c46c = unaff_EBX;
  _DAT_0044c470 = in_EDX;
  _DAT_0044c474 = in_ECX;
  _DAT_0044c478 = in_EAX;
  _DAT_0044c47c = unaff_EBP;
  DAT_0044c480 = unaff_retaddr;
  _DAT_0044c484 = in_CS;
  _DAT_0044c490 = in_SS;
  DAT_0044c3c0 = IsDebuggerPresent();
  _crt_debugger_hook(1);
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
  UnhandledExceptionFilter((_EXCEPTION_POINTERS *)&PTR_DAT_0043b274);
  if (DAT_0044c3c0 == 0) {
    _crt_debugger_hook(1);
  }
  uExitCode = 0xc0000409;
  hProcess = GetCurrentProcess();
  TerminateProcess(hProcess,uExitCode);
  return;
}



// WARNING: This is an inlined function
// WARNING: Unable to track spacebase fully for stack
// WARNING: Variable defined which should be unmapped: param_2
// Library Function - Single Match
//  __SEH_prolog4
// 
// Library: Visual Studio

void __cdecl __SEH_prolog4(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 unaff_EBX;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined4 unaff_retaddr;
  uint auStack_1c [5];
  undefined local_8 [8];
  
  iVar1 = -param_2;
  *(undefined4 *)((int)auStack_1c + iVar1 + 0x10) = unaff_EBX;
  *(undefined4 *)((int)auStack_1c + iVar1 + 0xc) = unaff_ESI;
  *(undefined4 *)((int)auStack_1c + iVar1 + 8) = unaff_EDI;
  *(uint *)((int)auStack_1c + iVar1 + 4) = DAT_0044a01c ^ (uint)&param_2;
  *(undefined4 *)((int)auStack_1c + iVar1) = unaff_retaddr;
  ExceptionList = local_8;
  return;
}



// WARNING: This is an inlined function
// Library Function - Single Match
//  __SEH_epilog4
// 
// Library: Visual Studio

void __SEH_epilog4(void)

{
  undefined4 *unaff_EBP;
  undefined4 unaff_retaddr;
  
  ExceptionList = (void *)unaff_EBP[-4];
  *unaff_EBP = unaff_retaddr;
  return;
}



void __cdecl _unlock(int _File)

{
                    // WARNING: Could not recover jumptable at 0x00437948. Too many branches
                    // WARNING: Treating indirect jump as call
  _unlock(_File);
  return;
}



void __dllonexit(void)

{
                    // WARNING: Could not recover jumptable at 0x0043794e. Too many branches
                    // WARNING: Treating indirect jump as call
  __dllonexit();
  return;
}



void __cdecl _lock(int _File)

{
                    // WARNING: Could not recover jumptable at 0x00437954. Too many branches
                    // WARNING: Treating indirect jump as call
  _lock(_File);
  return;
}



void __cdecl _amsg_exit(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x0043795a. Too many branches
                    // WARNING: Treating indirect jump as call
  _amsg_exit(param_1);
  return;
}



// Library Function - Single Match
//  __ValidateImageBase
// 
// Library: Visual Studio 2005 Release

BOOL __cdecl __ValidateImageBase(PBYTE pImageBase)

{
  if ((*(short *)pImageBase == 0x5a4d) &&
     (*(int *)(pImageBase + *(int *)(pImageBase + 0x3c)) == 0x4550)) {
    return (uint)(*(short *)((int)(pImageBase + *(int *)(pImageBase + 0x3c)) + 0x18) == 0x10b);
  }
  return 0;
}



// Library Function - Single Match
//  __FindPESection
// 
// Library: Visual Studio 2005 Release

PIMAGE_SECTION_HEADER __cdecl __FindPESection(PBYTE pImageBase,DWORD_PTR rva)

{
  int iVar1;
  PIMAGE_SECTION_HEADER p_Var2;
  uint uVar3;
  
  iVar1 = *(int *)(pImageBase + 0x3c);
  uVar3 = 0;
  p_Var2 = (PIMAGE_SECTION_HEADER)
           (pImageBase + *(ushort *)(pImageBase + iVar1 + 0x14) + 0x18 + iVar1);
  if (*(ushort *)(pImageBase + iVar1 + 6) != 0) {
    do {
      if ((p_Var2->VirtualAddress <= rva) &&
         (rva < (p_Var2->Misc).PhysicalAddress + p_Var2->VirtualAddress)) {
        return p_Var2;
      }
      uVar3 = uVar3 + 1;
      p_Var2 = p_Var2 + 1;
    } while (uVar3 < *(ushort *)(pImageBase + iVar1 + 6));
  }
  return (PIMAGE_SECTION_HEADER)0x0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3
// Library Function - Single Match
//  __IsNonwritableInCurrentImage
// 
// Library: Visual Studio 2005 Release

BOOL __cdecl __IsNonwritableInCurrentImage(PBYTE pTarget)

{
  BOOL BVar1;
  PIMAGE_SECTION_HEADER p_Var2;
  PBYTE pImageBase;
  
  BVar1 = __ValidateImageBase((PBYTE)&IMAGE_DOS_HEADER_00400000);
  if ((BVar1 != 0) &&
     (p_Var2 = __FindPESection(pImageBase,(int)pTarget - (int)pImageBase),
     p_Var2 != (PIMAGE_SECTION_HEADER)0x0)) {
    return ~(p_Var2->Characteristics >> 0x1f) & 1;
  }
  return 0;
}



void _initterm(void)

{
                    // WARNING: Could not recover jumptable at 0x00437a8e. Too many branches
                    // WARNING: Treating indirect jump as call
  _initterm();
  return;
}



void _initterm_e(void)

{
                    // WARNING: Could not recover jumptable at 0x00437a94. Too many branches
                    // WARNING: Treating indirect jump as call
  _initterm_e();
  return;
}



// Library Function - Single Match
//  ___security_init_cookie
// 
// Library: Visual Studio 2005 Release

void __cdecl ___security_init_cookie(void)

{
  DWORD DVar1;
  DWORD DVar2;
  DWORD DVar3;
  uint uVar4;
  LARGE_INTEGER local_14;
  _FILETIME local_c;
  
  local_c.dwLowDateTime = 0;
  local_c.dwHighDateTime = 0;
  if ((DAT_0044a01c == 0xbb40e64e) || ((DAT_0044a01c & 0xffff0000) == 0)) {
    GetSystemTimeAsFileTime(&local_c);
    uVar4 = local_c.dwHighDateTime ^ local_c.dwLowDateTime;
    DVar1 = GetCurrentProcessId();
    DVar2 = GetCurrentThreadId();
    DVar3 = GetTickCount();
    QueryPerformanceCounter(&local_14);
    DAT_0044a01c = uVar4 ^ DVar1 ^ DVar2 ^ DVar3 ^ local_14.s.HighPart ^ local_14.s.LowPart;
    if (DAT_0044a01c == 0xbb40e64e) {
      DAT_0044a01c = 0xbb40e64f;
    }
    else if ((DAT_0044a01c & 0xffff0000) == 0) {
      DAT_0044a01c = DAT_0044a01c | DAT_0044a01c << 0x10;
    }
    DAT_0044a020 = ~DAT_0044a01c;
  }
  else {
    DAT_0044a020 = ~DAT_0044a01c;
  }
  return;
}



void __cdecl _crt_debugger_hook(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x00437b5a. Too many branches
                    // WARNING: Treating indirect jump as call
  _crt_debugger_hook(param_1);
  return;
}



void __thiscall type_info::_type_info_dtor_internal_method(type_info *this)

{
                    // WARNING: Could not recover jumptable at 0x00437b60. Too many branches
                    // WARNING: Treating indirect jump as call
  _type_info_dtor_internal_method(this);
  return;
}



void _except_handler4_common(void)

{
                    // WARNING: Could not recover jumptable at 0x00437b66. Too many branches
                    // WARNING: Treating indirect jump as call
  _except_handler4_common();
  return;
}



int closesocket(SOCKET s)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437b78. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = closesocket(s);
  return iVar1;
}



SOCKET socket(int af,int type,int protocol)

{
  SOCKET SVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437b7e. Too many branches
                    // WARNING: Treating indirect jump as call
  SVar1 = socket(af,type,protocol);
  return SVar1;
}



int bind(SOCKET s,sockaddr *addr,int namelen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437b84. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = bind(s,addr,namelen);
  return iVar1;
}



int WSACleanup(void)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437b8a. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = WSACleanup();
  return iVar1;
}



int sendto(SOCKET s,char *buf,int len,int flags,sockaddr *to,int tolen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437b90. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = sendto(s,buf,len,flags,to,tolen);
  return iVar1;
}



u_short htons(u_short hostshort)

{
  u_short uVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437b96. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar1 = htons(hostshort);
  return uVar1;
}



int select(int nfds,fd_set *readfds,fd_set *writefds,fd_set *exceptfds,timeval *timeout)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437b9c. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = select(nfds,readfds,writefds,exceptfds,timeout);
  return iVar1;
}



int recvfrom(SOCKET s,char *buf,int len,int flags,sockaddr *from,int *fromlen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437ba2. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = recvfrom(s,buf,len,flags,from,fromlen);
  return iVar1;
}



int WSAStartup(WORD wVersionRequired,LPWSADATA lpWSAData)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437ba8. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = WSAStartup(wVersionRequired,lpWSAData);
  return iVar1;
}



hostent * gethostbyname(char *name)

{
  hostent *phVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437bae. Too many branches
                    // WARNING: Treating indirect jump as call
  phVar1 = gethostbyname(name);
  return phVar1;
}



int __WSAFDIsSet(SOCKET param_1,fd_set *param_2)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437bb4. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = __WSAFDIsSet(param_1,param_2);
  return iVar1;
}



ulonglong __fastcall FUN_00437bc0(undefined4 param_1,undefined4 param_2)

{
  ulonglong uVar1;
  uint uVar2;
  float fVar3;
  float10 in_ST0;
  uint local_20;
  float fStack_1c;
  
  if (DAT_0044d234 == 0) {
    uVar1 = (ulonglong)ROUND(in_ST0);
    local_20 = (uint)uVar1;
    fStack_1c = (float)(uVar1 >> 0x20);
    fVar3 = (float)in_ST0;
    if ((local_20 != 0) || (fVar3 = fStack_1c, (uVar1 & 0x7fffffff00000000) != 0)) {
      if ((int)fVar3 < 0) {
        uVar1 = uVar1 + (0x80000000 < ((uint)(float)(in_ST0 - (float10)uVar1) ^ 0x80000000));
      }
      else {
        uVar2 = (uint)(0x80000000 < (uint)(float)(in_ST0 - (float10)uVar1));
        uVar1 = CONCAT44((int)fStack_1c - (uint)(local_20 < uVar2),local_20 - uVar2);
      }
    }
    return uVar1;
  }
  return CONCAT44(param_2,(int)in_ST0);
}



void * __cdecl memset(void *_Dst,int _Val,size_t _Size)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437c6c. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = memset(_Dst,_Val,_Size);
  return pvVar1;
}



void * __cdecl memcpy(void *_Dst,void *_Src,size_t _Size)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00437c72. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = memcpy(_Dst,_Src,_Size);
  return pvVar1;
}



// WARNING: This is an inlined function

void __alloca_probe(void)

{
  undefined *in_EAX;
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 unaff_retaddr;
  undefined auStack_4 [4];
  
  puVar2 = (undefined4 *)((int)&stack0x00000000 - (int)in_EAX & ~-(uint)(&stack0x00000000 < in_EAX))
  ;
  for (puVar1 = (undefined4 *)((uint)auStack_4 & 0xfffff000); puVar2 < puVar1;
      puVar1 = puVar1 + -0x400) {
  }
  *puVar2 = unaff_retaddr;
  return;
}



// Library Function - Single Match
//  __allmul
// 
// Library: Visual Studio

longlong __allmul(uint param_1,uint param_2,uint param_3,uint param_4)

{
  if ((param_4 | param_2) == 0) {
    return (ulonglong)param_1 * (ulonglong)param_3;
  }
  return CONCAT44((int)((ulonglong)param_1 * (ulonglong)param_3 >> 0x20) +
                  param_2 * param_3 + param_1 * param_4,
                  (int)((ulonglong)param_1 * (ulonglong)param_3));
}



// Library Function - Single Match
//  __aulldvrm
// 
// Library: Visual Studio

undefined8 __aulldvrm(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



// Library Function - Single Match
//  __aulldiv
// 
// Library: Visual Studio

undefined8 __aulldiv(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



void _setjmp3(void)

{
                    // WARNING: Could not recover jumptable at 0x00437df8. Too many branches
                    // WARNING: Treating indirect jump as call
  _setjmp3();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3

undefined4 FUN_00437e04(void)

{
  return 1;
}



// WARNING: Removing unreachable block (ram,0x00437e8f)
// WARNING: Removing unreachable block (ram,0x00437e7c)
// Library Function - Single Match
//  __get_sse2_info
// 
// Libraries: Visual Studio 2005 Release, Visual Studio 2008 Release

undefined4 __get_sse2_info(void)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  byte in_AF;
  byte in_TF;
  byte in_IF;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  uint uVar4;
  uint local_8;
  
  local_8 = 0;
  uVar4 = (uint)(in_NT & 1) * 0x4000 | (uint)(in_IF & 1) * 0x200 | (uint)(in_TF & 1) * 0x100 | 0x40
          | (uint)(in_AF & 1) * 0x10 | 4 | (uint)(in_ID & 1) * 0x200000 |
          (uint)(in_VIP & 1) * 0x100000 | (uint)(in_VIF & 1) * 0x80000 | (uint)(in_AC & 1) * 0x40000
  ;
  uVar1 = uVar4 ^ 0x200000;
  if (((uint)((uVar1 & 0x4000) != 0) * 0x4000 | (uint)((uVar1 & 0x400) != 0) * 0x400 |
       (uint)((uVar1 & 0x200) != 0) * 0x200 | (uint)((uVar1 & 0x100) != 0) * 0x100 |
       (uint)((uVar1 & 0x40) != 0) * 0x40 | (uint)((uVar1 & 0x10) != 0) * 0x10 |
       (uint)((uVar1 & 4) != 0) * 4 | (uint)((uVar1 & 0x200000) != 0) * 0x200000 |
      (uint)((uVar1 & 0x40000) != 0) * 0x40000) != uVar4) {
    cpuid_basic_info(0);
    iVar2 = cpuid_Version_info(1);
    local_8 = *(uint *)(iVar2 + 8);
  }
  if (((local_8 & 0x4000000) == 0) || (iVar2 = FUN_00437e04(), iVar2 == 0)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  return uVar3;
}



void Unwind_00437ed0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 8));
  return;
}



void Unwind_00437f00(void)

{
  int unaff_EBP;
  
  FUN_00411ad0(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_00437f30(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
  return;
}



void Unwind_00437f60(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x14));
  return;
}



void Unwind_00437f6b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x20));
  return;
}



void Unwind_00437fa0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 4));
  return;
}



void Unwind_00437fab(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x10));
  return;
}



void Unwind_00437fb6(void)

{
  int unaff_EBP;
  
  _eh_vector_destructor_iterator_((void *)(*(int *)(unaff_EBP + -0x10) + 0x1c),0xc,2,FUN_0041aaf0);
  return;
}



void Unwind_00437fcc(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x34));
  return;
}



void Unwind_00438000(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 4));
  return;
}



void Unwind_0043800b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x10));
  return;
}



void Unwind_00438040(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 4));
  return;
}



void Unwind_0043804b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x14));
  return;
}



void Unwind_00438080(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x20));
  return;
}



void Unwind_004380b0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_004380e0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00438110(void)

{
  int unaff_EBP;
  
  FUN_00411ad0(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_00438140(void)

{
  int unaff_EBP;
  
  FUN_00411ad0(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_00438170(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x10));
  return;
}



void Unwind_00438178(void)

{
  int unaff_EBP;
  
  FUN_00411ad0(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_004381a0(void)

{
  int unaff_EBP;
  
  FUN_00411ad0(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_004381a8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004381b0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004381b8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004381c0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004381c8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004381d0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004381d8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004381e0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004381e8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004381f0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004381f8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00438200(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_00438208(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00438210(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00438218(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_00438220(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00438228(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_00438230(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00438260(void)

{
  int unaff_EBP;
  
  FUN_00411ad0(*(undefined4 **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438290(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x28));
  return;
}



void Unwind_004382c0(void)

{
  int unaff_EBP;
  
  FUN_0041d230(*(undefined4 **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004382c8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x2c));
  return;
}



void Unwind_004382d3(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x38));
  return;
}



void Unwind_004382de(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x44));
  return;
}



void Unwind_004382e9(void)

{
  int unaff_EBP;
  
  FUN_0040f660((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x54));
  return;
}



void Unwind_00438310(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x10));
  return;
}



void Unwind_00438318(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_00438320(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + -0x118) & 1) != 0) {
    *(uint *)(unaff_EBP + -0x118) = *(uint *)(unaff_EBP + -0x118) & 0xfffffffe;
    FUN_0041aaf0(*(void ***)(unaff_EBP + -0x114));
    return;
  }
  return;
}



void Unwind_00438370(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004383a0(void)

{
  FUN_0041b600();
  return;
}



void Unwind_004383d0(void)

{
  int unaff_EBP;
  
  FUN_004103a0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x18));
  return;
}



void Unwind_00438400(void)

{
  FUN_0041b600();
  return;
}



void Unwind_00438430(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + -0x1c) & 1) != 0) {
    *(uint *)(unaff_EBP + -0x1c) = *(uint *)(unaff_EBP + -0x1c) & 0xfffffffe;
    FUN_0041aaf0((void **)(unaff_EBP + -0x18));
    return;
  }
  return;
}



void Unwind_00438470(void)

{
  FUN_0041b600();
  return;
}



void Unwind_004384c0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x14));
  return;
}



void Unwind_004384cb(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x20));
  return;
}



void Unwind_004384d6(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x2c));
  return;
}



void Unwind_004384e1(void)

{
  int unaff_EBP;
  
  FUN_0041b5e0((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x38));
  return;
}



void Unwind_00438510(void)

{
  int unaff_EBP;
  
  FUN_00436db0(*(undefined4 **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438540(void)

{
  FUN_0041b600();
  return;
}



void Unwind_00438570(void)

{
  FUN_0041b600();
  return;
}



void Unwind_004385a0(void)

{
  FUN_0041b600();
  return;
}



void Unwind_004385d0(void)

{
  FUN_0041b600();
  return;
}



void Unwind_004385d8(void)

{
  FUN_00411a00();
  return;
}



void Unwind_00438600(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_00438640(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 4));
  return;
}



void Unwind_00438670(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
  return;
}



void Unwind_00438678(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0xc));
  return;
}



void Unwind_004386a0(void)

{
  FUN_0041b600();
  return;
}



void Unwind_004386a8(void)

{
  FUN_00411a00();
  return;
}



void Unwind_004386d0(void)

{
  FUN_0041b600();
  return;
}



void Unwind_00438700(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x3c));
  return;
}



void Unwind_00438708(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x30));
  return;
}



void Unwind_00438710(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_00438718(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00438720(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00438750(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_00438758(void)

{
  FUN_0041b600();
  return;
}



void Unwind_00438780(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438788(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 8));
  return;
}



void Unwind_00438793(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x1c));
  return;
}



void Unwind_0043879e(void)

{
  int unaff_EBP;
  
  FUN_0041b5e0((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x2c));
  return;
}



void Unwind_004387d0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_004387d8(void)

{
  int unaff_EBP;
  
  FUN_00411ad0(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_004387e0(void)

{
  int unaff_EBP;
  
  FUN_0041cf00((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x14));
  return;
}



void Unwind_00438810(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043881b(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438826(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438831(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043883c(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438847(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438852(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043885d(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438868(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438873(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043887e(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438889(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438894(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043889f(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004388aa(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004388b5(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004388c0(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004388cb(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004388d6(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004388e1(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004388ec(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004388f7(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438902(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043890d(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438918(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438923(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043892e(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438939(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438944(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043894f(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043895a(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438965(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438970(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043897b(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438986(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438991(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_0043899c(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004389a7(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004389b2(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004389bd(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004389c8(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004389d3(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004389de(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004389e9(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004389f4(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004389ff(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a0a(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a15(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a20(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a2b(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a36(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a41(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a4c(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a57(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a62(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a6d(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438a78(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438aa0(void)

{
  int unaff_EBP;
  
  FUN_0040f660((undefined4 *)(unaff_EBP + 4));
  return;
}



void Unwind_00438ad0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_00438b00(void)

{
  int unaff_EBP;
  
  FUN_0041d230(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_00438b08(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x2c));
  return;
}



void Unwind_00438b13(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x38));
  return;
}



void Unwind_00438b1e(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x44));
  return;
}



void Unwind_00438b29(void)

{
  int unaff_EBP;
  
  FUN_0040f660((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x54));
  return;
}



void Unwind_00438b34(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x68));
  return;
}



void Unwind_00438b3f(void)

{
  FUN_00411a00();
  return;
}



void Unwind_00438b70(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x14));
  return;
}



void Unwind_00438b78(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438ba0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00438ba8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_00438bd0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x14));
  return;
}



void Unwind_00438bd8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438be0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x14));
  return;
}



void Unwind_00438c10(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0xc));
  return;
}



void Unwind_00438c18(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
  return;
}



void Unwind_00438c40(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x1c));
  return;
}



void Unwind_00438c90(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438cc0(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_00438cf0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0xc));
  return;
}



void Unwind_00438cf8(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 0x18));
  return;
}



void Unwind_00438d20(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438d50(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438d5b(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438d90(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 0xc));
  return;
}



void Unwind_00438dc0(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438dcb(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438dd6(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438e00(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00438e30(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_00438e3b(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_00438e70(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438ea0(void)

{
  int unaff_EBP;
  
  FUN_0041dd20((undefined4 *)(unaff_EBP + -0x20));
  return;
}



void Unwind_00438ed0(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00438f00(void)

{
  FUN_0041b600();
  return;
}



void Unwind_00438f30(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x10));
  return;
}



void Unwind_00438f60(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x10));
  return;
}



void Unwind_00438f6b(void)

{
  FUN_0041c130();
  return;
}



void Unwind_00438f76(void)

{
  FUN_0041c130();
  return;
}



void Unwind_00438fa0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x10));
  return;
}



void Unwind_00438fab(void)

{
  FUN_0041c130();
  return;
}



void Unwind_00438fb6(void)

{
  FUN_0041c130();
  return;
}



void Unwind_00438fe0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439010(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_00439040(void)

{
  int unaff_EBP;
  
  FUN_00436db0(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_00439070(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439078(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439080(void)

{
  int unaff_EBP;
  
  FUN_0041a7e0((undefined4 *)(unaff_EBP + -0x2c));
  return;
}



void Unwind_00439088(void)

{
  FUN_00402ab0();
  return;
}



void Unwind_00439090(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
  return;
}



void Unwind_00439098(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_004390c0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_004390f0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0xc));
  return;
}



void Unwind_00439120(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x2c));
  return;
}



void Unwind_00439128(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x20));
  return;
}



void Unwind_00439130(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x14));
  return;
}



void Unwind_00439138(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439170(void)

{
  FUN_0041b600();
  return;
}



void Unwind_004391a0(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + -0x28) & 1) != 0) {
    *(uint *)(unaff_EBP + -0x28) = *(uint *)(unaff_EBP + -0x28) & 0xfffffffe;
    FUN_0041aaf0(*(void ***)(unaff_EBP + 8));
    return;
  }
  return;
}



void Unwind_004391b9(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004391c1(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004391f0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x14));
  return;
}



void Unwind_00439220(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + -0x10) & 1) != 0) {
    *(uint *)(unaff_EBP + -0x10) = *(uint *)(unaff_EBP + -0x10) & 0xfffffffe;
    FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
    return;
  }
  return;
}



void Unwind_00439260(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + -0x10) & 1) != 0) {
    *(uint *)(unaff_EBP + -0x10) = *(uint *)(unaff_EBP + -0x10) & 0xfffffffe;
    FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
    return;
  }
  return;
}



void Unwind_004392a0(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + 8) & 1) != 0) {
    *(uint *)(unaff_EBP + 8) = *(uint *)(unaff_EBP + 8) & 0xfffffffe;
    FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
    return;
  }
  return;
}



void Unwind_004392e0(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + -0x10) & 1) != 0) {
    *(uint *)(unaff_EBP + -0x10) = *(uint *)(unaff_EBP + -0x10) & 0xfffffffe;
    FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
    return;
  }
  return;
}



void Unwind_00439320(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439328(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + -0x1c) & 1) != 0) {
    *(uint *)(unaff_EBP + -0x1c) = *(uint *)(unaff_EBP + -0x1c) & 0xfffffffe;
    FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
    return;
  }
  return;
}



void Unwind_00439360(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439368(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + -0x1c) & 1) != 0) {
    *(uint *)(unaff_EBP + -0x1c) = *(uint *)(unaff_EBP + -0x1c) & 0xfffffffe;
    FUN_0041aaf0(*(void ***)(unaff_EBP + 8));
    return;
  }
  return;
}



void Unwind_004393a0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x10));
  return;
}



void Unwind_004393a8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_004393b0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x30));
  return;
}



void Unwind_004393b8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004393c0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004393c8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004393f0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004393f8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439420(void)

{
  int unaff_EBP;
  
  FUN_0041cf00((undefined4 *)(unaff_EBP + 8));
  return;
}



void Unwind_00439450(void)

{
  int unaff_EBP;
  
  FUN_00406f40((undefined4 *)(*(int *)(unaff_EBP + -0x14) + 0xc));
  return;
}



void Unwind_0043945b(void)

{
  int unaff_EBP;
  
  FUN_00406f40((undefined4 *)(*(int *)(unaff_EBP + -0x14) + 0x38));
  return;
}



void Unwind_00439490(void)

{
  int unaff_EBP;
  
  FUN_00406f40((undefined4 *)(*(int *)(unaff_EBP + 4) + 0xc));
  return;
}



void Unwind_0043949b(void)

{
  int unaff_EBP;
  
  FUN_00406f40((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x38));
  return;
}



void Unwind_004394a6(void)

{
  int unaff_EBP;
  
  operator_delete__(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004394d0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1c));
  return;
}



void Unwind_00439500(void)

{
  int unaff_EBP;
  
  FUN_0041cf00((undefined4 *)(unaff_EBP + -0x38));
  return;
}



void Unwind_00439550(void)

{
  int unaff_EBP;
  
  FUN_0041c6f0(*(undefined4 **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00439558(void)

{
  int unaff_EBP;
  
  FUN_00408cc0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x3c));
  return;
}



void Unwind_00439563(void)

{
  int unaff_EBP;
  
  FUN_0041b5e0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0xa8));
  return;
}



void Unwind_00439571(void)

{
  FUN_0041c130();
  return;
}



void Unwind_004395a0(void)

{
  int unaff_EBP;
  
  FUN_0041c6f0(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_004395f0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x160));
  return;
}



void Unwind_004395fb(void)

{
  int unaff_EBP;
  
  FUN_0040f660((undefined4 *)(unaff_EBP + -0x154));
  return;
}



void Unwind_00439606(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x140));
  return;
}



void Unwind_00439611(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -300));
  return;
}



void Unwind_0043961c(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -300));
  return;
}



void Unwind_00439627(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x140));
  return;
}



void Unwind_00439632(void)

{
  int unaff_EBP;
  
  FUN_0040f660((undefined4 *)(unaff_EBP + -0x140));
  return;
}



void Unwind_0043963d(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x140));
  return;
}



void Unwind_00439648(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -300));
  return;
}



void Unwind_00439653(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x140));
  return;
}



void Unwind_004396d0(void)

{
  int unaff_EBP;
  
  FUN_0041c6f0(*(undefined4 **)(unaff_EBP + -0x10));
  return;
}



void Unwind_004396d8(void)

{
  int unaff_EBP;
  
  FUN_0041b5e0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x54));
  return;
}



void Unwind_00439700(void)

{
  FUN_0041b600();
  return;
}



void Unwind_00439730(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x470));
  return;
}



void Unwind_0043973b(void)

{
  FUN_00402ab0();
  return;
}



void Unwind_00439746(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x44c));
  return;
}



void Unwind_00439780(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x20));
  return;
}



void Unwind_00439788(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x14));
  return;
}



void Unwind_00439790(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439798(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004397a0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004397d0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439800(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439830(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439838(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_00439840(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439870(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x14));
  return;
}



void Unwind_00439878(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439880(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439888(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439890(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004398c0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_004398c8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004398d0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004398d8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_004398e0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004398e8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x30));
  return;
}



void Unwind_004398f0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x2c));
  return;
}



void Unwind_004398f8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x28));
  return;
}



void Unwind_00439920(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439928(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439950(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439958(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x48));
  return;
}



void Unwind_00439960(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x3c));
  return;
}



void Unwind_00439968(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x30));
  return;
}



void Unwind_00439970(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_00439978(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004399a0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_004399d0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_004399d8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439a00(void)

{
  int unaff_EBP;
  
  FUN_0041c6f0(*(undefined4 **)(unaff_EBP + -0x10));
  return;
}



void Unwind_00439a08(void)

{
  int unaff_EBP;
  
  FUN_0041cf00((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x40));
  return;
}



void Unwind_00439a13(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x5c));
  return;
}



void Unwind_00439a1e(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x68));
  return;
}



void Unwind_00439a29(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x74));
  return;
}



void Unwind_00439a34(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x80));
  return;
}



void Unwind_00439a42(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + -0x10) + 0x8c));
  return;
}



void Unwind_00439a50(void)

{
  int unaff_EBP;
  
  FUN_00436f20((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x98));
  return;
}



void Unwind_00439a5e(void)

{
  int unaff_EBP;
  
  FUN_00436f20((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0xb8));
  return;
}



void Unwind_00439a6c(void)

{
  int unaff_EBP;
  
  FUN_00421dc0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0xd8));
  return;
}



void Unwind_00439aa0(void)

{
  int unaff_EBP;
  
  FUN_0041c6f0(*(undefined4 **)(unaff_EBP + 4));
  return;
}



void Unwind_00439aa8(void)

{
  int unaff_EBP;
  
  FUN_0041cf00((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x40));
  return;
}



void Unwind_00439ab3(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x5c));
  return;
}



void Unwind_00439abe(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x68));
  return;
}



void Unwind_00439ac9(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x74));
  return;
}



void Unwind_00439ad4(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x80));
  return;
}



void Unwind_00439ae2(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(*(int *)(unaff_EBP + 4) + 0x8c));
  return;
}



void Unwind_00439af0(void)

{
  int unaff_EBP;
  
  FUN_00436f20((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x98));
  return;
}



void Unwind_00439b20(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x30));
  return;
}



void Unwind_00439b28(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x3c));
  return;
}



void Unwind_00439b30(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x48));
  return;
}



void Unwind_00439b38(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x48));
  return;
}



void Unwind_00439b40(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439b48(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_00439b50(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439b80(void)

{
  FUN_00402ab0();
  return;
}



void Unwind_00439b88(void)

{
  int unaff_EBP;
  
  FUN_0041a7e0((undefined4 *)(unaff_EBP + -0x54));
  return;
}



void Unwind_00439b90(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x4c));
  return;
}



void Unwind_00439b98(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x40));
  return;
}



void Unwind_00439ba0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x5c));
  return;
}



void Unwind_00439ba8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x34));
  return;
}



void Unwind_00439bb0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1c));
  return;
}



void Unwind_00439bb8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x28));
  return;
}



void Unwind_00439be0(void)

{
  int unaff_EBP;
  
  FUN_0041a7e0((undefined4 *)(unaff_EBP + -0x68));
  return;
}



void Unwind_00439be8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xa0));
  return;
}



void Unwind_00439bf3(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xac));
  return;
}



void Unwind_00439bfe(void)

{
  FUN_0041b600();
  return;
}



void Unwind_00439c06(void)

{
  int unaff_EBP;
  
  if ((*(uint *)(unaff_EBP + -0x94) & 1) != 0) {
    *(uint *)(unaff_EBP + -0x94) = *(uint *)(unaff_EBP + -0x94) & 0xfffffffe;
    FUN_0041aaf0((void **)(unaff_EBP + -0x88));
    return;
  }
  return;
}



void Unwind_00439c28(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x78));
  return;
}



void Unwind_00439c30(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x94));
  return;
}



void Unwind_00439c3b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x88));
  return;
}



void Unwind_00439c46(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x94));
  return;
}



void Unwind_00439c51(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x88));
  return;
}



void Unwind_00439c5c(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x78));
  return;
}



void Unwind_00439c90(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_00439cc0(void)

{
  FUN_0041b600();
  return;
}



void Unwind_00439cc8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439cd0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_00439d00(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x16c));
  return;
}



void Unwind_00439d0b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x160));
  return;
}



void Unwind_00439d16(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x144));
  return;
}



void Unwind_00439d21(void)

{
  int unaff_EBP;
  
  FUN_004037f0((void **)(unaff_EBP + -0x138));
  return;
}



void Unwind_00439d2e(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x160));
  return;
}



void Unwind_00439d39(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x160));
  return;
}



void Unwind_00439d44(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x160));
  return;
}



void Unwind_00439d4f(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x14c));
  return;
}



void Unwind_00439d90(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439d9b(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439dd0(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_00439e00(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_00439e0b(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_00439e40(void)

{
  int unaff_EBP;
  
  FUN_004062b0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x40));
  return;
}



void Unwind_00439e4b(void)

{
  int unaff_EBP;
  
  FUN_004070c0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x94));
  return;
}



void Unwind_00439e59(void)

{
  int unaff_EBP;
  
  FUN_00403110((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x1a8));
  return;
}



void Unwind_00439e67(void)

{
  int unaff_EBP;
  
  FUN_0041d3f0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x224));
  return;
}



void Unwind_00439e75(void)

{
  int unaff_EBP;
  
  FUN_004011f0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x2c4));
  return;
}



void Unwind_00439e83(void)

{
  FUN_00409400();
  return;
}



void Unwind_00439e91(void)

{
  FUN_0041c130();
  return;
}



void Unwind_00439e9e(void)

{
  int unaff_EBP;
  
  FUN_0041b5e0((undefined4 *)(*(int *)(unaff_EBP + -0x10) + 0x390));
  return;
}



void Unwind_00439ed0(void)

{
  int unaff_EBP;
  
  FUN_004062b0((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x40));
  return;
}



void Unwind_00439edb(void)

{
  int unaff_EBP;
  
  FUN_004070c0((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x94));
  return;
}



void Unwind_00439ee9(void)

{
  int unaff_EBP;
  
  FUN_00403110((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x1a8));
  return;
}



void Unwind_00439ef7(void)

{
  int unaff_EBP;
  
  FUN_0041d3f0((undefined4 *)(*(int *)(unaff_EBP + 4) + 0x224));
  return;
}



void Unwind_00439f20(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x158));
  return;
}



void Unwind_00439f2b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x14c));
  return;
}



void Unwind_00439f36(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x11c));
  return;
}



void Unwind_00439f41(void)

{
  int unaff_EBP;
  
  FUN_004037f0((void **)(unaff_EBP + -0x13c));
  return;
}



void Unwind_00439f4e(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x14c));
  return;
}



void Unwind_00439f59(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x14c));
  return;
}



void Unwind_00439f64(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x14c));
  return;
}



void Unwind_00439fa0(void)

{
  int unaff_EBP;
  
  FUN_00436f20((undefined4 *)(unaff_EBP + -0x30));
  return;
}



void Unwind_00439fa8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5c));
  return;
}



void Unwind_00439fb0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x50));
  return;
}



void Unwind_00439fb8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5c));
  return;
}



void Unwind_00439fe0(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_00439fe8(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_00439ff0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x48));
  return;
}



void Unwind_00439ff8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x30));
  return;
}



void Unwind_0043a000(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x3c));
  return;
}



void Unwind_0043a008(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -100));
  return;
}



void Unwind_0043a013(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x54));
  return;
}



void Unwind_0043a01b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x50));
  return;
}



void Unwind_0043a040(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_0043a048(void)

{
  int unaff_EBP;
  
  FUN_0041a7e0((undefined4 *)(unaff_EBP + -0x7c));
  return;
}



void Unwind_0043a050(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x94));
  return;
}



void Unwind_0043a05b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x88));
  return;
}



void Unwind_0043a066(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xa0));
  return;
}



void Unwind_0043a071(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0xa4));
  return;
}



void Unwind_0043a07c(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x58));
  return;
}



void Unwind_0043a084(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x70));
  return;
}



void Unwind_0043a08c(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x28));
  return;
}



void Unwind_0043a094(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x34));
  return;
}



void Unwind_0043a09c(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x4c));
  return;
}



void Unwind_0043a0a4(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -100));
  return;
}



void Unwind_0043a0ac(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x40));
  return;
}



void Unwind_0043a0e0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_0043a0e8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a110(void)

{
  int unaff_EBP;
  
  FUN_0041cf00((undefined4 *)(unaff_EBP + 0x14));
  return;
}



void Unwind_0043a118(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_0043a120(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_0043a128(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a130(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_0043a138(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_0043a140(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a170(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a1a0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x30));
  return;
}



void Unwind_0043a1a8(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_0043a1b0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a1b8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a1e0(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_0043a1eb(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_0043a1f6(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 0xc));
  return;
}



void Unwind_0043a201(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 0xc));
  return;
}



void Unwind_0043a230(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xac));
  return;
}



void Unwind_0043a23b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x6c));
  return;
}



void Unwind_0043a243(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5c));
  return;
}



void Unwind_0043a24b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x78));
  return;
}



void Unwind_0043a253(void)

{
  int unaff_EBP;
  
  FUN_0041cf00((undefined4 *)(unaff_EBP + -0x94));
  return;
}



void Unwind_0043a25e(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xa0));
  return;
}



void Unwind_0043a269(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xb8));
  return;
}



void Unwind_0043a274(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_0043a27f(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a28a(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a295(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a2a0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a2ab(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a2b6(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x44));
  return;
}



void Unwind_0043a2be(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x50));
  return;
}



void Unwind_0043a2c6(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a2d1(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a2dc(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a2e7(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a2f2(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a2fd(void)

{
  int unaff_EBP;
  
  FUN_004037f0((void **)(unaff_EBP + -0x38));
  return;
}



void Unwind_0043a307(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x50));
  return;
}



void Unwind_0043a30f(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x44));
  return;
}



void Unwind_0043a317(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0xd4));
  return;
}



void Unwind_0043a322(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a350(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_0043a358(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a360(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a368(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a390(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x54));
  return;
}



void Unwind_0043a398(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x60));
  return;
}



void Unwind_0043a3a0(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_0043a3a8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x48));
  return;
}



void Unwind_0043a3b0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x48));
  return;
}



void Unwind_0043a3b8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x48));
  return;
}



void Unwind_0043a3c0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x30));
  return;
}



void Unwind_0043a3c8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_0043a3d0(void)

{
  int unaff_EBP;
  
  FUN_004037f0((void **)(unaff_EBP + -0x30));
  return;
}



void Unwind_0043a3da(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x48));
  return;
}



void Unwind_0043a400(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x10));
  return;
}



void Unwind_0043a408(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_0043a410(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x51c));
  return;
}



void Unwind_0043a41b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x540));
  return;
}



void Unwind_0043a426(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_0043a431(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x554));
  return;
}



void Unwind_0043a43c(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x554));
  return;
}



void Unwind_0043a447(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x528));
  return;
}



void Unwind_0043a452(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x548));
  return;
}



void Unwind_0043a45d(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x528));
  return;
}



void Unwind_0043a468(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x528));
  return;
}



void Unwind_0043a4b0(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_0043a4b8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a4c0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a4f0(void)

{
  int unaff_EBP;
  
  FUN_0041cf00((undefined4 *)(unaff_EBP + -0x134));
  return;
}



void Unwind_0043a4fb(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x14c));
  return;
}



void Unwind_0043a506(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x11c));
  return;
}



void Unwind_0043a511(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x140));
  return;
}



void Unwind_0043a51c(void)

{
  int unaff_EBP;
  
  FUN_0041cf00(*(undefined4 **)(unaff_EBP + -0x120));
  return;
}



void Unwind_0043a527(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x140));
  return;
}



void Unwind_0043a560(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x20));
  return;
}



void Unwind_0043a568(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x14));
  return;
}



void Unwind_0043a570(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_0043a578(void)

{
  int unaff_EBP;
  
  FUN_00436a00((undefined4 *)(unaff_EBP + -0x24));
  return;
}



void Unwind_0043a580(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a5b0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0xeb0));
  return;
}



void Unwind_0043a5f0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x634));
  return;
}



void Unwind_0043a5fb(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x610));
  return;
}



void Unwind_0043a640(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_0043a648(void)

{
  int unaff_EBP;
  
  FUN_0040e650((undefined4 *)(unaff_EBP + -0x40));
  return;
}



void Unwind_0043a650(void)

{
  int unaff_EBP;
  
  FUN_0040e650((undefined4 *)(unaff_EBP + -0x28));
  return;
}



void Unwind_0043a658(void)

{
  int unaff_EBP;
  
  FUN_0041a7e0((undefined4 *)(unaff_EBP + -0x48));
  return;
}



void Unwind_0043a660(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x4c));
  return;
}



void Unwind_0043a690(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x210));
  return;
}



void Unwind_0043a69b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x224));
  return;
}



void Unwind_0043a6a6(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1e0));
  return;
}



void Unwind_0043a6b1(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1d4));
  return;
}



void Unwind_0043a6bc(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1c8));
  return;
}



void Unwind_0043a6c7(void)

{
  int unaff_EBP;
  
  FUN_004037f0((void **)(unaff_EBP + -0x200));
  return;
}



void Unwind_0043a6d4(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1d4));
  return;
}



void Unwind_0043a6df(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1d4));
  return;
}



void Unwind_0043a6ea(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -400));
  return;
}



void Unwind_0043a6f5(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x154));
  return;
}



void Unwind_0043a700(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x160));
  return;
}



void Unwind_0043a70b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1b4));
  return;
}



void Unwind_0043a716(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x13c));
  return;
}



void Unwind_0043a721(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x178));
  return;
}



void Unwind_0043a72c(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x148));
  return;
}



void Unwind_0043a737(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1a8));
  return;
}



void Unwind_0043a742(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x19c));
  return;
}



void Unwind_0043a74d(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x184));
  return;
}



void Unwind_0043a758(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x16c));
  return;
}



void Unwind_0043a7a0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 4));
  return;
}



void Unwind_0043a7a8(void)

{
  int unaff_EBP;
  
  FUN_0040c3d0((undefined4 *)(unaff_EBP + -0x114));
  return;
}



void Unwind_0043a7b3(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x140));
  return;
}



void Unwind_0043a7be(void)

{
  int unaff_EBP;
  
  FUN_0040f660((undefined4 *)(unaff_EBP + -0x134));
  return;
}



void Unwind_0043a7c9(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x134));
  return;
}



void Unwind_0043a7d4(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x144));
  return;
}



void Unwind_0043a7e2(void)

{
  int unaff_EBP;
  
  FUN_004103a0((undefined4 *)(*(int *)(unaff_EBP + -0x144) + 0x18));
  return;
}



void Unwind_0043a820(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x30));
  return;
}



void Unwind_0043a828(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_0043a830(void)

{
  thunk_FUN_00402ab0();
  return;
}



void Unwind_0043a838(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a840(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a848(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a850(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a858(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a860(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a868(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a870(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a878(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a880(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043a8b0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 0x14));
  return;
}



void Unwind_0043a8b8(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + 8));
  return;
}



void Unwind_0043a8c0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + 4));
  return;
}



void Unwind_0043a8f0(void)

{
  int unaff_EBP;
  
  FUN_00409460((undefined4 *)(unaff_EBP + -0x3d8));
  return;
}



void Unwind_0043a8fb(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5cc));
  return;
}



void Unwind_0043a906(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x590));
  return;
}



void Unwind_0043a911(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5b4));
  return;
}



void Unwind_0043a91c(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5a8));
  return;
}



void Unwind_0043a927(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x59c));
  return;
}



void Unwind_0043a932(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x584));
  return;
}



void Unwind_0043a93d(void)

{
  int unaff_EBP;
  
  FUN_0041eaa0((undefined4 *)(unaff_EBP + -0x520));
  return;
}



void Unwind_0043a948(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5c0));
  return;
}



void Unwind_0043a953(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5c0));
  return;
}



void Unwind_0043a95e(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5c0));
  return;
}



void Unwind_0043a969(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5c0));
  return;
}



void Unwind_0043a974(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5c0));
  return;
}



void Unwind_0043a97f(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x5c0));
  return;
}



void Unwind_0043a98a(void)

{
  int unaff_EBP;
  
  FUN_004194b0((undefined4 *)(unaff_EBP + -0x570));
  return;
}



void Unwind_0043a995(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x5d0));
  return;
}



void Unwind_0043a9a3(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x5d0));
  return;
}



void Unwind_0043a9ae(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x578));
  return;
}



void Unwind_0043a9b9(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x5d0));
  return;
}



void Unwind_0043aa00(void)

{
  int unaff_EBP;
  
  FUN_0041a7e0((undefined4 *)(unaff_EBP + -0x24c));
  return;
}



void Unwind_0043aa0b(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x240));
  return;
}



void Unwind_0043aa16(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x228));
  return;
}



void Unwind_0043aa21(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x240));
  return;
}



void Unwind_0043aa2c(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0(*(void ***)(unaff_EBP + -0x22c));
  return;
}



void Unwind_0043aa37(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x240));
  return;
}



void Unwind_0043aa70(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x24));
  return;
}



void Unwind_0043aa78(void)

{
  FUN_0041b600();
  return;
}



void Unwind_0043aa80(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x18));
  return;
}



void Unwind_0043aab0(void)

{
  int unaff_EBP;
  
  FUN_0041aaf0((void **)(unaff_EBP + -0x1c));
  return;
}



void Unwind_0043aab8(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x20));
  return;
}



void Unwind_0043aae0(void)

{
  FUN_00405450();
  return;
}



void Unwind_0043aae8(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_0043aaf3(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_0043aafe(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 8));
  return;
}



void Unwind_0043ab30(void)

{
  int unaff_EBP;
  
  FUN_0040f660((undefined4 *)(unaff_EBP + -0x34));
  return;
}



void Unwind_0043ab38(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_0043ab43(void)

{
  int unaff_EBP;
  
  FUN_0040f660((undefined4 *)(unaff_EBP + -0x20));
  return;
}



void Unwind_0043ab4b(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + -0x38));
  return;
}



void Unwind_0043ab56(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}



void Unwind_0043ab61(void)

{
  int unaff_EBP;
  
  operator_delete(*(void **)(unaff_EBP + 4));
  return;
}


